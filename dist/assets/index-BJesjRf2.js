import{r as qf,a as zf}from"./vendor-DavUf6mE.js";import{r as D,u as id,L as z,R as re,a as ad,b as vi,B as $f,c as Hf,d as we}from"./router-C5tqCKHH.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var ga={exports:{}},_n={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fc;function Gf(){if(fc)return _n;fc=1;var s=qf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(c,d,m){var f,g={},y=null,T=null;m!==void 0&&(y=""+m),d.key!==void 0&&(y=""+d.key),d.ref!==void 0&&(T=d.ref);for(f in d)n.call(d,f)&&!a.hasOwnProperty(f)&&(g[f]=d[f]);if(c&&c.defaultProps)for(f in d=c.defaultProps,d)g[f]===void 0&&(g[f]=d[f]);return{$$typeof:e,type:c,key:y,ref:T,props:g,_owner:i.current}}return _n.Fragment=t,_n.jsx=l,_n.jsxs=l,_n}var pc;function Wf(){return pc||(pc=1,ga.exports=Gf()),ga.exports}var r=Wf(),Rr={},gc;function Kf(){if(gc)return Rr;gc=1;var s=zf();return Rr.createRoot=s.createRoot,Rr.hydrateRoot=s.hydrateRoot,Rr}var Qf=Kf();/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Xf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),G=(s,e)=>{const t=D.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:c="",children:d,...m},f)=>D.createElement("svg",{ref:f,...Xf,width:i,height:i,stroke:n,strokeWidth:l?Number(a)*24/Number(i):a,className:["lucide",`lucide-${Jf(s)}`,c].join(" "),...m},[...e.map(([g,y])=>D.createElement(g,y)),...Array.isArray(d)?d:[d]]));return t.displayName=`${s}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=G("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=G("Anchor",[["path",{d:"M12 22V8",key:"qkxhtm"}],["path",{d:"M5 12H2a10 10 0 0 0 20 0h-3",key:"1hv3nh"}],["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yf=G("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=G("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=G("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=G("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=G("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=G("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=G("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=G("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=G("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=G("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=G("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=G("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=G("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=G("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=G("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=G("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=G("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=G("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const np=G("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vc=G("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rp=G("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=G("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=G("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=G("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=G("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=G("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=G("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=G("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=G("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=G("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=G("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=G("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=G("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ld=G("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=G("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=G("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _c=G("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=G("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cd=G("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=G("Ship",[["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"iegodh"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-9-4-9 4c0 2.9.94 5.34 2.81 7.76",key:"fp8vka"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M12 10v4",key:"1kjpxc"}],["path",{d:"M12 2v3",key:"qbqxhf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wc=G("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=G("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dp=G("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=G("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=G("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hp=G("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=G("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=G("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mp=G("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=G("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fp=G("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),pp="/assets/Logo-CCi9SGbJ.png";function Yn(){const[s,e]=D.useState(!1),t=id(),[n,i]=D.useState(!1),a=[{name:"Accueil",path:"/"},{name:"Bateaux",path:"/bateaux"},{name:"À propos",path:"/a-propos"},{name:"Contact",path:"/contact"}],l=g=>t.pathname===g,c=typeof window<"u"?localStorage.getItem("userPrenom"):null,d=typeof window<"u"?localStorage.getItem("userRole"):null,m=()=>{localStorage.removeItem("token"),localStorage.removeItem("userNom"),localStorage.removeItem("userPrenom"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("userTel"),window.location.href="/connexion"},f=()=>{window.scrollTo({top:0,behavior:"smooth"})};return r.jsx("header",{className:"bg-white shadow-sm fixed w-full top-0 z-50 border-b border-gray-100",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsxs("div",{className:"flex justify-between items-center h-16",children:[r.jsx(z,{to:"/",className:"flex items-center space-x-2",children:r.jsx("img",{src:pp,alt:"Logo SailingLoc",className:"h-9 w-auto"})}),r.jsx("nav",{className:"hidden md:flex space-x-8",children:a.map(g=>r.jsx(z,{to:g.path,onClick:f,className:`px-3 py-2 text-sm font-medium transition-colors ${l(g.path)?"text-blue-600 border-b-2 border-blue-600":"text-gray-700 hover:text-blue-600"}`,children:g.name},g.name))}),r.jsx("div",{className:"hidden md:flex items-center space-x-4",children:c?r.jsxs(r.Fragment,{children:[r.jsx(z,{to:"/favoris",className:"text-blue-600 hover:text-blue-800 px-4 py-2 text-sm font-medium transition-colors flex items-center",children:r.jsx(vc,{className:"h-5 w-5"})}),d==="proprietaire"&&r.jsx(z,{to:"/gestion-bateaux",className:"text-blue-600 hover:text-blue-800 px-4 py-2 text-sm font-medium transition-colors flex items-center",children:"Gestion bateaux"}),d==="admin"&&r.jsx(z,{to:"/admin",className:"bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors shadow-sm flex items-center",children:"Dashboard Admin"}),r.jsxs("div",{className:"relative",children:[r.jsx("button",{onClick:()=>i(g=>!g),className:"bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-medium hover:bg-blue-700 transition-colors shadow-sm flex items-center justify-center focus:outline-none",children:r.jsx(Sn,{className:"h-5 w-5"})}),n&&r.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-4 z-50 border border-gray-100",children:[r.jsxs("div",{className:"px-4 py-2 text-gray-700 text-sm mb-2",children:["Bienvenue ",r.jsx("span",{className:"font-bold text-blue-700",children:c})]}),r.jsx(z,{to:"/mes-reservations",onClick:()=>i(!1),className:"block w-full text-left px-4 py-2 text-blue-600 hover:bg-blue-50 text-sm font-medium",children:"Mes Réservations"}),r.jsxs(z,{to:"/profil",onClick:()=>i(!1),className:"w-full text-left px-4 py-2 text-blue-600 hover:bg-blue-50 text-sm font-medium flex items-center gap-2 border-t border-gray-100 mt-2",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6l4 2"})}),"Settings"]}),r.jsx("button",{onClick:m,className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 text-sm font-medium border-t border-gray-100 mt-2",children:"Déconnexion"})]})]})]}):r.jsxs(r.Fragment,{children:[r.jsx(z,{to:"/connexion",className:"text-gray-700 hover:text-blue-600 px-4 py-2 text-sm font-medium transition-colors",onClick:f,children:"Connexion"}),r.jsx(z,{to:"/inscription",className:"bg-orange-500 text-white px-6 py-2 rounded-full text-sm font-medium hover:bg-orange-600 transition-colors shadow-sm",onClick:f,children:"Inscription"})]})}),r.jsx("button",{className:"md:hidden p-2",onClick:()=>e(!s),children:s?r.jsx(It,{size:24}):r.jsx(cp,{size:24})})]}),s&&r.jsx("div",{className:"md:hidden border-t border-gray-100",children:r.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 bg-white",children:[a.map(g=>r.jsx(z,{to:g.path,className:`block px-3 py-2 text-base font-medium ${l(g.path)?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,onClick:()=>{e(!1),f()},children:g.name},g.name)),r.jsx("div",{className:"mt-4 space-y-2",children:c?r.jsxs(r.Fragment,{children:[d==="proprietaire"&&r.jsx(z,{to:"/gestion-bateaux",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),f()},children:"Gestion bateaux"}),d==="admin"&&r.jsx(z,{to:"/admin",className:"block w-full text-center bg-red-600 text-white px-3 py-2 rounded-lg text-base font-medium hover:bg-red-700 transition-colors",onClick:()=>{e(!1),f()},children:"Dashboard Admin"}),r.jsx(z,{to:"/favoris",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),f()},children:r.jsx(vc,{className:"h-5 w-5"})}),r.jsx(z,{to:"/mes-reservations",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),f()},children:"Mes Réservations"}),r.jsxs("div",{className:"relative",children:[r.jsx("button",{onClick:()=>i(g=>!g),className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",children:r.jsx(Sn,{className:"h-5 w-5"})}),n&&r.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-4 z-50 border border-gray-100",children:[r.jsxs("div",{className:"px-4 py-2 text-gray-700 text-sm mb-2",children:["Bienvenue ",r.jsx("span",{className:"font-bold text-blue-700",children:c})]}),r.jsx("button",{onClick:m,className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 text-sm font-medium",children:"Déconnexion"})]})]})]}):r.jsxs(r.Fragment,{children:[r.jsx(z,{to:"/connexion",className:"block w-full text-center border border-orange-500 text-orange-500 px-3 py-2 rounded-full text-base font-medium hover:bg-orange-50 transition-colors",onClick:()=>{e(!1),f()},children:"Connexion"}),r.jsx(z,{to:"/inscription",className:"block w-full text-center bg-orange-500 text-white px-3 py-2 rounded-full text-base font-medium hover:bg-orange-600 transition-colors",onClick:()=>{e(!1),f()},children:"Inscription"})]})})]})})]})})}function gp(){const[s,e]=D.useState(""),t=typeof window<"u"?localStorage.getItem("userPrenom"):null,n=i=>{i.preventDefault(),console.log("Newsletter signup:",s),e(""),alert("Inscription réussie !")};return r.jsx("footer",{className:"bg-blue-900 text-white",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-12",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold mb-6",children:"MODE DE PAIEMENT"}),r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-8 h-8 bg-white rounded flex items-center justify-center",children:r.jsx(tp,{className:"h-5 w-5 text-blue-900"})}),r.jsx("span",{children:"Carte bancaire"})]})})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold mb-6",children:"INFORMATIONS"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(z,{to:"/",className:"block hover:text-blue-300 transition-colors",children:"Accueil"}),r.jsx(z,{to:"/bateaux",className:"block hover:text-blue-300 transition-colors",children:"Bateaux"}),r.jsx(z,{to:"/a-propos",className:"block hover:text-blue-300 transition-colors",children:"À propos"}),r.jsx(z,{to:"/contact",className:"block hover:text-blue-300 transition-colors",children:"Contact"}),r.jsx(z,{to:"/mentions-legales",className:"block hover:text-blue-300 transition-colors",children:"Mentions légales"}),r.jsx(z,{to:"/politique-confidentialite",className:"block hover:text-blue-300 transition-colors",children:"Politique de confidentialité"}),r.jsx(z,{to:"/cgu-cgv",className:"block hover:text-blue-300 transition-colors",children:"CGU / CGV"}),t?r.jsxs(r.Fragment,{children:[r.jsx(z,{to:"/connexion",className:"block hover:text-blue-300 transition-colors",children:"Connexion"}),r.jsx(z,{to:"/inscription",className:"block hover:text-blue-300 transition-colors",children:"Inscription"})]}):r.jsxs(r.Fragment,{children:[r.jsx(z,{to:"/connexion",className:"block hover:text-blue-300 transition-colors",children:"Connexion"}),r.jsx(z,{to:"/inscription",className:"block hover:text-blue-300 transition-colors",children:"Inscription"})]})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold mb-6",children:"RECEVEZ NOTRE NEWSLETTER"}),r.jsx("p",{className:"text-blue-200 mb-6 leading-relaxed",children:"Recevez nos offres et actualités directement dans votre boîte mail pour ne rien manquer de nos nouveautés."}),r.jsxs("form",{onSubmit:n,className:"space-y-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx(Qs,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsx("input",{type:"email",value:s,onChange:i=>e(i.target.value),placeholder:"Votre email",className:"w-full pl-10 pr-4 py-3 rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsx("button",{type:"submit",className:"w-full bg-orange-500 text-white py-3 px-6 rounded-lg font-medium hover:bg-orange-600 transition-colors",children:"ENVOYER"})]})]})]}),r.jsx("div",{className:"border-t border-blue-800 mt-12 pt-8",children:r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center",children:[r.jsxs("div",{className:"flex space-x-6 mb-6 sm:mb-0",children:[r.jsx("a",{href:"#",className:"text-blue-200 hover:text-white transition-colors",children:r.jsx(sp,{size:28})}),r.jsx("a",{href:"#",className:"text-blue-200 hover:text-white transition-colors",children:r.jsx(ip,{size:28})}),r.jsx("a",{href:"#",className:"text-blue-200 hover:text-white transition-colors",children:r.jsx(fp,{size:28})}),r.jsx("a",{href:"#",className:"text-blue-200 hover:text-white transition-colors",children:r.jsx(ap,{size:28})})]}),r.jsx("p",{className:"text-blue-200",children:"© 2025 SailingLoc - Tous droits réservés"})]})})]})})}function Un({rating:s,maxRating:e=5,size:t=16,interactive:n=!1,onRatingChange:i}){const a=Array.from({length:e},(l,c)=>{const d=c+1,m=d<=s,f=d-.5<=s&&s<d;return r.jsx("button",{type:"button",onClick:()=>n&&i&&i(d),className:`${n?"cursor-pointer hover:scale-110":"cursor-default"} transition-transform`,disabled:!n,children:r.jsx(yo,{size:t,className:`${m||f?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},c)});return r.jsx("div",{className:"flex items-center space-x-1",children:a})}function bo({boat:s,viewMode:e="grid"}){return e==="list"?r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:r.jsxs("div",{className:"flex items-center space-x-6",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("img",{src:s.image,alt:s.nom,className:"w-32 h-24 object-cover rounded-lg"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:s.nom}),r.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[r.jsx(Un,{rating:s.rating||0,size:16}),r.jsxs("span",{className:"text-sm text-gray-600",children:["(",s.reviews||0,")"]})]})]}),r.jsxs("div",{className:"flex items-center space-x-4 mb-3 text-sm text-gray-600",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(ut,{size:16}),r.jsx("span",{className:"capitalize",children:s.type})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(_i,{size:16}),r.jsxs("span",{children:[s.longueur,"m"]})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Qt,{size:16}),r.jsxs("span",{children:[s.capacite," pers."]})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(ut,{size:16}),r.jsx("span",{children:s.localisation})]})]}),s.description&&r.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-3",children:s.description})]}),r.jsxs("div",{className:"flex-shrink-0 text-right",children:[r.jsxs("div",{className:"text-2xl font-bold text-blue-600 mb-3",children:[s.prix_jour,"€",r.jsx("span",{className:"text-base font-normal text-gray-600",children:"/jour"})]}),r.jsx(z,{to:`/bateaux/${s._id}`,className:"bg-orange-500 text-white px-6 py-2 rounded-full text-sm font-medium hover:bg-orange-600 transition-colors shadow-sm",children:"Réserver"})]})]})}):r.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:s.image,alt:s.nom,className:"w-full h-56 object-cover"}),r.jsx("div",{className:"absolute top-4 left-4 bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:s.type})]}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900 leading-tight",children:s.nom}),r.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[r.jsx(Un,{rating:s.rating||0,size:16}),r.jsxs("span",{className:"text-sm text-gray-600",children:["(",s.reviews||0,")"]})]})]}),r.jsxs("div",{className:"flex items-center space-x-4 mb-4 text-sm text-gray-600",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(ut,{size:16}),r.jsx("span",{className:"capitalize",children:s.type})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Qt,{size:16}),r.jsxs("span",{children:[s.capacite," pers."]})]})]}),s.description&&r.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4",children:s.description}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[s.prix_jour,"€",r.jsx("span",{className:"text-base font-normal text-gray-600",children:"/jour"})]}),r.jsx(z,{to:`/bateaux/${s._id}`,className:"bg-orange-500 text-white px-6 py-2 rounded-full text-sm font-medium hover:bg-orange-600 transition-colors shadow-sm",children:"Réserver"})]})]})]})}function xp({boats:s,onReset:e,searchFilters:t}){const[n,i]=D.useState("nom"),[a,l]=D.useState("asc"),[c,d]=D.useState(!1),[m,f]=D.useState(!1);re.useEffect(()=>{f(!0)},[]);const g=[...s].sort((N,A)=>{let I,S;switch(n){case"prix_jour":I=N.prix_jour,S=A.prix_jour;break;case"longueur":I=N.longueur,S=A.longueur;break;case"capacite":I=N.capacite,S=A.capacite;break;case"nom":default:I=N.nom.toLowerCase(),S=A.nom.toLowerCase();break}return a==="asc"?I>S?1:-1:I<S?1:-1}),y=N=>{n===N?l(a==="asc"?"desc":"asc"):(i(N),l("asc"))},T=N=>n!==N?null:a==="asc"?r.jsx(Zf,{size:16}):r.jsx(Yf,{size:16}),k=(N,A)=>{if(!A)return"";switch(N){case"destination":return A.charAt(0).toUpperCase()+A.slice(1).replace("-"," ");case"type":return A.charAt(0).toUpperCase()+A.slice(1);case"dateDebut":case"dateFin":return new Date(A).toLocaleDateString("fr-FR");default:return A}},C=Object.entries(t).filter(([N,A])=>A);return r.jsx("section",{id:"search-results",className:`py-20 bg-white scroll-mt-20 transition-all duration-700 ease-out ${m?"opacity-100 translate-y-0":"opacity-0 translate-y-8"}`,ref:N=>{N&&(N.scrollIntoView=A=>{const O=N.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:O,behavior:A?.behavior||"smooth"})})},children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-2 h-12 bg-gradient-to-b from-blue-500 to-blue-600 rounded-full"}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Résultats de votre recherche"}),r.jsxs("p",{className:"text-xl text-gray-600",children:[s.length," bateau",s.length>1?"x":""," trouvé",s.length>1?"s":""," pour vos critères"]})]})]}),r.jsxs("button",{onClick:e,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2",children:[r.jsx(It,{size:20}),r.jsx("span",{children:"Réinitialiser"})]})]}),C.length>0&&r.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200 animate-pulse",children:[r.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-3",children:"Filtres actifs :"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:C.map(([N,A])=>r.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:[N==="destination"?"📍":N==="type"?"🚢":N.includes("date")?"📅":"🔍",k(N,A)]},N))})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8 p-4 bg-gray-50 rounded-lg",children:[r.jsxs("button",{onClick:()=>d(!c),className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[r.jsx(Oa,{size:16}),r.jsx("span",{children:"Filtres avancés"})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Trier par :"}),r.jsx("div",{className:"flex gap-2",children:[{key:"nom",label:"Nom"},{key:"prix_jour",label:"Prix"},{key:"longueur",label:"Longueur"},{key:"capacite",label:"Capacité"}].map(({key:N,label:A})=>r.jsxs("button",{onClick:()=>y(N),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1 ${n===N?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:[A,T(N)]},N))})]})]}),c&&r.jsxs("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filtres avancés"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix maximum par jour"}),r.jsx("input",{type:"number",placeholder:"€",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longueur minimum"}),r.jsx("input",{type:"number",placeholder:"mètres",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacité minimum"}),r.jsx("input",{type:"number",placeholder:"personnes",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),g.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:g.map(N=>r.jsx(bo,{boat:N},N._id))}):r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-gray-400 mb-4",children:r.jsx(Oa,{size:64})}),r.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun résultat"}),r.jsx("p",{className:"text-gray-500",children:"Essayez de modifier vos critères de recherche"})]})]})})}const Xe="https://sailingloc-back-lilac.vercel.app",ae={LOGIN:`${Xe}/api/auth/login`,REGISTER:`${Xe}/api/auth/register`,DASHBOARD:`${Xe}/api/auth/dashboard`,USERS:`${Xe}/api/auth/users`,BOATS:`${Xe}/api/boats`,BOAT_DETAIL:s=>`${Xe}/api/boats/${s}`,MY_BOATS:`${Xe}/api/boats/my-boats`,BOOKINGS:`${Xe}/api/bookings`,MY_BOOKINGS:`${Xe}/api/bookings/my-bookings`,REVIEWS:`${Xe}/api/reviews`,BOAT_REVIEWS:s=>`${Xe}/api/reviews/boat/${s}`,FIVE_STAR_REVIEWS:`${Xe}/api/reviews/five-stars`,CONTACT:`${Xe}/api/contact`},Me=s=>({"Content-Type":"application/json",Authorization:s?`Bearer ${s}`:""}),ce=async(s,e={})=>{try{const t=await fetch(s,{...e,headers:{"Content-Type":"application/json",...e.headers}});if(!t.ok){const n=await t.json().catch(()=>({}));throw new Error(n.message||`Erreur HTTP: ${t.status}`)}return await t.json()}catch(t){throw console.error("Erreur API:",t),t}};function yp(){const[s,e]=D.useState([]),[t,n]=D.useState([]),[i,a]=D.useState(!0),[l,c]=D.useState(""),[d,m]=D.useState([]),[f,g]=D.useState(!0),[y,T]=D.useState({destination:"",dateDebut:"",dateFin:"",type:""}),[k,C]=D.useState(!1);D.useEffect(()=>{N(),O()},[]);const N=async()=>{try{a(!0),console.log("🔄 Récupération des bateaux depuis l'API MongoDB...");const p=await ce(ae.BOATS);console.log(`✅ ${p.length||0} bateaux récupérés depuis MongoDB`),e(p)}catch(p){console.error("❌ Erreur lors de la récupération des bateaux:",p),c("Erreur lors de la récupération des bateaux: "+p.message)}finally{a(!1)}},A=async()=>{try{C(!0);let p=s.filter(b=>y.destination&&b.destination!==y.destination||y.type&&b.type!==y.type?!1:(y.dateDebut&&y.dateFin,!0));n(p),C(!1),p.length>0?setTimeout(()=>{const b=document.getElementById("search-results");b&&b.scrollIntoView?b.scrollIntoView({behavior:"smooth"}):b?.scrollIntoView({behavior:"smooth",block:"start"})},300):alert("Aucun bateau trouvé pour vos critères de recherche. Essayez de modifier vos filtres.")}catch(p){console.error("Erreur lors de la recherche:",p),C(!1)}},I=(p,b)=>{T(w=>({...w,[p]:b}))},S=()=>{T({destination:"",dateDebut:"",dateFin:"",type:""}),n([])},O=async()=>{try{g(!0),console.log("🔄 Récupération des avis 5 étoiles depuis MongoDB...");const p=await ce(`${ae.FIVE_STAR_REVIEWS}?limit=6`);console.log("✅ Données avis 5 étoiles reçues depuis MongoDB:",p),p.data&&p.data.length>0?(console.log(`📝 ${p.data.length} avis 5 étoiles trouvés dans MongoDB`),m(p.data)):(console.log("⚠️ Aucun avis 5 étoiles trouvé dans MongoDB"),m([]))}catch(p){console.error("❌ Erreur lors de la récupération des avis:",p),m([])}finally{g(!1)}},P=s.slice(0,6),L=!!localStorage.getItem("userId"),v=[{id:1,name:"Saint-Malo",image:"https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=800",description:"La cité corsaire et ses îles sauvages"},{id:2,name:"Les Glénan",image:"https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=800",description:"Archipel breton aux eaux turquoise"},{id:3,name:"Marseille",image:"https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=800",description:"Calanques et îles du Frioul"}];return r.jsxs("div",{className:"min-h-screen",children:[r.jsxs("section",{className:"relative h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700",children:[r.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.4}}),r.jsx("div",{className:"relative z-10 flex items-center justify-center h-full px-4",children:r.jsxs("div",{className:"text-center text-white max-w-4xl",children:[r.jsx("h1",{className:"text-6xl md:text-8xl font-bold mb-8 tracking-wider",children:"SAILINGLOC"}),r.jsx("p",{className:"text-xl md:text-2xl mb-12 font-light max-w-3xl mx-auto leading-relaxed",children:"Découvrez les plus beaux bateaux pour vos aventures en mer"}),r.jsx("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl p-6 max-w-5xl mx-auto shadow-2xl",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx(ut,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsxs("select",{className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700",value:y.destination,onChange:p=>I("destination",p.target.value),children:[r.jsx("option",{value:"",children:"Destination"}),r.jsx("option",{value:"saint-malo",children:"Saint-Malo"}),r.jsx("option",{value:"les-glenan",children:"Les Glénan"}),r.jsx("option",{value:"crozon",children:"Crozon"}),r.jsx("option",{value:"la-rochelle",children:"La Rochelle"}),r.jsx("option",{value:"marseille",children:"Marseille"}),r.jsx("option",{value:"cannes",children:"Cannes"}),r.jsx("option",{value:"ajaccio",children:"Ajaccio"}),r.jsx("option",{value:"barcelone",children:"Barcelone"}),r.jsx("option",{value:"palma",children:"Palma de Majorque"}),r.jsx("option",{value:"athenes",children:"Athènes"}),r.jsx("option",{value:"venise",children:"Venise"}),r.jsx("option",{value:"amsterdam",children:"Amsterdam"}),r.jsx("option",{value:"split",children:"Split"})]})]}),r.jsxs("div",{className:"relative",children:[r.jsx(Ln,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsx("input",{type:"date",placeholder:"Date de début",className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700",value:y.dateDebut,onChange:p=>I("dateDebut",p.target.value)})]}),r.jsxs("div",{className:"relative",children:[r.jsx(Ln,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsx("input",{type:"date",placeholder:"Date de fin",className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700",value:y.dateFin,onChange:p=>I("dateFin",p.target.value)})]}),r.jsxs("div",{className:"relative",children:[r.jsx(Fe,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsxs("select",{className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700",value:y.type,onChange:p=>I("type",p.target.value),children:[r.jsx("option",{value:"",children:"Type bateau"}),r.jsx("option",{value:"voilier",children:"Voilier"}),r.jsx("option",{value:"yacht",children:"Yacht"}),r.jsx("option",{value:"catamaran",children:"Catamaran"})]})]}),r.jsx("button",{onClick:A,disabled:k,className:"bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:k?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),r.jsx("span",{children:"Recherche..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(_c,{size:20}),r.jsx("span",{children:"Rechercher"})]})})]})})]})})]}),r.jsx("section",{className:"py-20 bg-gray-50",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsxs("div",{className:"text-center mb-16",children:[r.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Nos bateaux vedettes"}),r.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Découvrez notre sélection de bateaux les plus populaires pour vos escapades en mer"})]}),i?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Chargement des bateaux..."})]}):l?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(Fe,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Erreur de chargement"}),r.jsx("p",{className:"text-gray-500",children:l})]}):P.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(Fe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun bateau disponible"}),r.jsx("p",{className:"text-gray-500",children:"Revenez bientôt pour découvrir nos bateaux !"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:P.map(p=>r.jsx(bo,{boat:p},p._id))}),s.length>6&&r.jsx("div",{className:"text-center mt-12",children:r.jsxs(z,{to:"/bateaux",className:"inline-flex items-center space-x-2 bg-blue-600 text-white px-8 py-3 rounded-full font-medium hover:bg-blue-700 transition-colors",children:[r.jsx("span",{children:"Voir tous les bateaux"}),r.jsx(yc,{size:20})]})})]})}),t.length>0&&r.jsx(xp,{boats:t,onReset:S,searchFilters:y}),r.jsx("section",{className:"py-20 bg-gradient-to-br from-blue-50 to-white",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsxs("div",{className:"text-center mb-16",children:[r.jsxs("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:["Ce que disent nos ",r.jsx("span",{className:"text-blue-600",children:"navigateurs"})," 5 étoiles"]}),r.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Découvrez les expériences exceptionnelles de nos clients les plus satisfaits"})]}),f?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Chargement des avis 5 étoiles depuis la table reviews..."})]}):d.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(Fe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun avis 5 étoiles disponible"}),r.jsx("p",{className:"text-gray-500",children:"Revenez bientôt pour découvrir les avis exceptionnels de nos navigateurs !"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:d.map(p=>r.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-8 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-4 right-4 bg-gradient-to-r from-yellow-400 to-yellow-500 text-white px-3 py-1 rounded-full text-xs font-bold shadow-lg",children:"⭐ 5 ÉTOILES"}),r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-white font-semibold text-lg",children:p.userId?.nom?.charAt(0)||"U"})}),r.jsxs("div",{children:[r.jsxs("h4",{className:"font-semibold text-gray-900",children:[p.userId?.nom," ",p.userId?.prenom]}),r.jsx("p",{className:"text-sm text-gray-500",children:p.boatId?.nom||"Bateau"})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"flex items-center space-x-1 mb-2",children:[...Array(5)].map((b,w)=>r.jsx(yo,{size:20,className:"text-yellow-400 fill-current"},w))}),r.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Excellent"})]})]}),r.jsx("div",{className:"mb-6",children:r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(An,{className:"h-6 w-6 text-blue-500 mt-1 flex-shrink-0"}),r.jsxs("blockquote",{className:"text-gray-700 leading-relaxed italic text-lg",children:['"',p.comment,'"']})]})}),r.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 pt-4 border-t border-gray-100",children:[r.jsx("span",{children:new Date(p.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}),p.boatId?.type&&r.jsx("span",{className:"capitalize bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs font-medium",children:p.boatId.type})]})]},p._id))}),d.length>6&&r.jsx("div",{className:"text-center mt-12",children:r.jsxs(z,{to:"/avis",className:"inline-flex items-center space-x-2 bg-blue-600 text-white px-8 py-3 rounded-full font-medium hover:bg-blue-700 transition-colors",children:[r.jsx("span",{children:"Voir tous les avis"}),r.jsx(yc,{size:20})]})})]})}),r.jsx("section",{className:"py-20 bg-gray-50",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsx("div",{className:"text-center mb-16",children:r.jsxs("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:["Cap sur les ",r.jsx("span",{className:"text-blue-600",children:"destinations"})," les plus prisées par nos navigateurs !"]})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:v.map(p=>r.jsx("div",{className:"relative group cursor-pointer",children:r.jsxs("div",{className:"relative overflow-hidden rounded-2xl shadow-xl",children:[r.jsx("img",{src:p.image,alt:p.name,className:"w-full h-80 object-cover group-hover:scale-105 transition-transform duration-500"}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),r.jsxs("div",{className:"absolute bottom-8 left-8 text-white",children:[r.jsx("h3",{className:"text-2xl font-bold mb-2",children:p.name}),r.jsx("p",{className:"text-lg opacity-90",children:p.description})]})]})},p.id))})]})}),r.jsx("section",{className:"py-20 bg-blue-600",children:r.jsxs("div",{className:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8",children:[r.jsx("h2",{className:"text-4xl font-bold text-white mb-6",children:"Prêt à vivre l'aventure ?"}),r.jsx("p",{className:"text-xl text-blue-100 mb-8",children:"Rejoignez SailingLoc et commencez à explorer les mers du monde"}),r.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:L?r.jsxs(z,{to:"/bateaux",className:"inline-flex items-center space-x-2 bg-white text-blue-600 px-8 py-3 rounded-full font-medium hover:bg-gray-50 transition-colors",children:[r.jsx(_c,{size:20}),r.jsx("span",{children:"Rechercher un bateau"})]}):r.jsxs(r.Fragment,{children:[r.jsxs(z,{to:"/register",className:"inline-flex items-center space-x-2 bg-white text-blue-600 px-8 py-3 rounded-full font-medium hover:bg-gray-50 transition-colors",children:[r.jsx(hp,{size:20}),r.jsx("span",{children:"S'inscrire"})]}),r.jsx(z,{to:"/login",className:"inline-flex items-center space-x-2 border-2 border-white text-white px-8 py-3 rounded-full font-medium hover:bg-white hover:text-blue-600 transition-colors",children:r.jsx("span",{children:"Se connecter"})})]})})]})})]})}function bp(){const[s,e]=D.useState([]),[t,n]=D.useState([]),[i,a]=D.useState(!0),[l,c]=D.useState(""),[d,m]=D.useState({type:"",priceRange:"",capacity:""}),[f,g]=D.useState("grid");D.useEffect(()=>{y()},[]);const y=async()=>{try{a(!0),console.log("🔄 Récupération des bateaux depuis l'API MongoDB...");const C=await ce(ae.BOATS);console.log(`✅ ${C.length||0} bateaux récupérés depuis MongoDB`),e(C),n(C)}catch(C){console.error("❌ Erreur lors de la récupération des bateaux:",C),c("Erreur lors de la récupération des bateaux: "+C.message)}finally{a(!1)}},T=(C,N)=>{const A={...d,[C]:N};m(A);let I=s;if(A.type&&(I=I.filter(S=>S.type.toLowerCase().includes(A.type.toLowerCase()))),A.priceRange){const[S,O]=A.priceRange.split("-").map(Number);I=I.filter(P=>P.prix_jour>=S&&(O?P.prix_jour<=O:!0))}A.capacity&&(I=I.filter(S=>S.capacite>=parseInt(A.capacity))),n(I)},k=()=>{m({type:"",priceRange:"",capacity:""}),n(s)};return i?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Chargement des bateaux..."})]})}):l?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Fe,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Erreur de chargement"}),r.jsx("p",{className:"text-gray-500",children:l})]})}):r.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[r.jsx("div",{className:"bg-white shadow-sm border-b",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[r.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-4 sm:mb-0",children:"Nos bateaux"}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("span",{className:"text-sm text-gray-600",children:[t.length," bateau",t.length>1?"x":""," trouvé",t.length>1?"s":""]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>g("grid"),className:`p-2 rounded-md ${f==="grid"?"bg-blue-100 text-blue-600":"text-gray-400"}`,children:r.jsx(np,{size:20})}),r.jsx("button",{onClick:()=>g("list"),className:`p-2 rounded-md ${f==="list"?"bg-blue-100 text-blue-600":"text-gray-400"}`,children:r.jsx(op,{size:20})})]})]})]})})}),r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[r.jsx("div",{className:"lg:w-1/4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[r.jsx(Oa,{size:20}),r.jsx("span",{children:"Filtres"})]}),r.jsx("button",{onClick:k,className:"text-sm text-blue-600 hover:text-blue-700",children:"Effacer"})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de bateau"}),r.jsxs("select",{value:d.type,onChange:C=>T("type",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Tous les types"}),r.jsx("option",{value:"voilier",children:"Voilier"}),r.jsx("option",{value:"yacht",children:"Yacht"}),r.jsx("option",{value:"catamaran",children:"Catamaran"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fourchette de prix"}),r.jsxs("select",{value:d.priceRange,onChange:C=>T("priceRange",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Tous les prix"}),r.jsx("option",{value:"0-100",children:"0€ - 100€"}),r.jsx("option",{value:"100-200",children:"100€ - 200€"}),r.jsx("option",{value:"200-300",children:"200€ - 300€"}),r.jsx("option",{value:"300-500",children:"300€ - 500€"}),r.jsx("option",{value:"500-1000",children:"500€+"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacité minimale"}),r.jsxs("select",{value:d.capacity,onChange:C=>T("capacity",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Toutes capacités"}),r.jsx("option",{value:"2",children:"2+ personnes"}),r.jsx("option",{value:"4",children:"4+ personnes"}),r.jsx("option",{value:"6",children:"6+ personnes"}),r.jsx("option",{value:"8",children:"8+ personnes"}),r.jsx("option",{value:"10",children:"10+ personnes"})]})]})]})]})}),r.jsx("div",{className:"lg:w-3/4",children:t.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(Fe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun bateau trouvé"}),r.jsx("p",{className:"text-gray-500",children:"Essayez de modifier vos filtres ou revenez plus tard."})]}):r.jsx("div",{className:f==="grid"?"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6":"space-y-4",children:t.map(C=>r.jsx(bo,{boat:C,viewMode:f},C._id))})})]})})]})}const vp="/assets/apropos-Dvd8oeAQ.png";function _p(){const s=[{icon:Fe,title:"Large choix de bateaux",description:"Une sélection rigoureuse de bateaux entretenus et vérifiés pour votre sécurité et votre confort."},{icon:ds,title:"Réservation facile et rapide",description:"Réservez en quelques clics avec notre système de réservation en ligne simple et intuitif."},{icon:cd,title:"Paiements sécurisés et service fiable",description:"Transactions 100% sécurisées et équipe disponible 7j/7 pour vous accompagner."}];return r.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[r.jsxs("section",{className:"relative py-24 bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800",children:[r.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),r.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[r.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-8",children:"À propos"}),r.jsx("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto leading-relaxed",children:"Une question ? Écrivez-nous, on vous répond en et si bien !"})]})]}),r.jsx("section",{className:"py-20 bg-white",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[r.jsx("div",{children:r.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl",children:[r.jsx("h2",{className:"text-3xl font-bold mb-6",children:"À PROPOS"}),r.jsxs("p",{style:{fontSize:"1.1rem",color:"var(--color-gray-800)",marginBottom:"1.5rem"},children:["SailingLoc est une start-up innovante fondée par M. Voisin, spécialisée dans la mise en relation pour la location de voiliers et de bateaux à moteur. Basée à La Rochelle (Charente-Maritime), SailingLoc propose une plateforme collaborative, sécurisée et centrée sur l’expérience utilisateur.",r.jsx("br",{}),r.jsx("br",{}),"Notre service s’adresse aussi bien aux passionnés de navigation qu’aux vacanciers occasionnels, en facilitant la location de bateaux auprès de particuliers ou de professionnels partout en Europe. Que ce soit pour une sortie en mer, une croisière en famille, entre amis ou en couple, SailingLoc vous invite à vivre des aventures maritimes authentiques et inoubliables."]}),r.jsx("h2",{className:"text-orange-500 text-[1.3rem] mb-4 font-bold",children:"Informations légales"}),r.jsxs("ul",{style:{fontSize:"1.08rem",color:"var(--color-gray-800)",listStyle:"none",padding:0,lineHeight:1.8},children:[r.jsxs("li",{children:[r.jsx("b",{children:"Dénomination sociale"})," : SailingLoc"]}),r.jsxs("li",{children:[r.jsx("b",{children:"Date de création"})," : 15/03/2024"]}),r.jsxs("li",{children:[r.jsx("b",{children:"Siège social"})," : 12 Quai Louis Durand, 17000 La Rochelle"]}),r.jsxs("li",{children:[r.jsx("b",{children:"Statut juridique"})," : Société par Actions Simplifiée (SAS)"]}),r.jsxs("li",{children:[r.jsx("b",{children:"Capital social"})," : 15 000 €"]}),r.jsxs("li",{children:[r.jsx("b",{children:"Numéro RCS"})," : LA ROCHELLE B 923 456 789"]}),r.jsxs("li",{children:[r.jsx("b",{children:"SIREN"})," : 923 456 789"]}),r.jsxs("li",{children:[r.jsx("b",{children:"SIRET"})," : 923 456 789 00014"]}),r.jsxs("li",{children:[r.jsx("b",{children:"Code APE/NAF"})," : 7990Z – Services de réservation et activités connexes"]}),r.jsxs("li",{children:[r.jsx("b",{children:"TVA intracommunautaire"})," : FR42923456789"]})]})]})}),r.jsx("div",{className:"relative",children:r.jsx("img",{src:vp,alt:"À propos SailingLoc",className:"rounded-2xl shadow-2xl w-full"})})]})})}),r.jsx("section",{className:"py-16 bg-gray-50",children:r.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:r.jsxs("p",{className:"text-lg text-gray-700 leading-relaxed",children:["Notre ",r.jsx("strong",{children:"mission"})," rendre la navigation ",r.jsx("strong",{children:"accessible"}),", ",r.jsx("strong",{children:"simple"})," et ",r.jsx("strong",{children:"sécurisée"}),"pour tous les passionnés de mer."]})})}),r.jsx("section",{className:"py-20 bg-white",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsx("div",{className:"text-center mb-16",children:r.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"Nos trois piliers"})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:s.map((e,t)=>r.jsxs("div",{className:"text-center group",children:[r.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-blue-100 rounded-full mb-6 group-hover:bg-blue-600 transition-colors",children:r.jsx(e.icon,{className:"h-10 w-10 text-blue-600 group-hover:text-white transition-colors"})}),r.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:e.title}),r.jsx("p",{className:"text-gray-600 leading-relaxed",children:e.description})]},t))})]})}),r.jsx("section",{className:"py-20 bg-gradient-to-r from-blue-600 to-blue-800",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[r.jsx("h2",{className:"text-4xl font-bold text-white mb-6",children:"Prêt à naviguer avec nous ?"}),r.jsx("p",{className:"text-xl text-blue-100 mb-10 max-w-2xl mx-auto",children:"Découvrez notre sélection de bateaux et réservez votre prochaine aventure"}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[r.jsx(z,{to:"/bateaux",className:"bg-white text-blue-600 px-8 py-4 rounded-full font-medium hover:bg-gray-100 transition-colors text-center",children:"Voir les bateaux"}),r.jsx(z,{to:"/contact",className:"bg-orange-500 text-white px-8 py-4 rounded-full font-medium hover:bg-orange-600 transition-colors text-center",children:"Nous contacter"})]})]})})]})}function wp(){const[s,e]=D.useState({nom:"",prenom:"",telephone:"",message:"",email:""}),[t,n]=D.useState(!1),[i,a]=D.useState(!1),[l,c]=D.useState({}),d=g=>{const{name:y,value:T}=g.target;e(k=>({...k,[y]:T})),l[y]&&c(k=>({...k,[y]:""}))},m=()=>{const g={};return s.nom.trim()||(g.nom="Le nom est requis"),s.prenom.trim()||(g.prenom="Le prénom est requis"),s.email.trim()?/\S+@\S+\.\S+/.test(s.email)||(g.email="L'email n'est pas valide"):g.email="L'email est requis",s.telephone.trim()||(g.telephone="Le téléphone est requis"),s.message.trim()?s.message.trim().length<10&&(g.message="Le message doit contenir au moins 10 caractères"):g.message="Le message est requis",c(g),Object.keys(g).length===0},f=async g=>{if(g.preventDefault(),!!m()){n(!0);try{console.log("🔄 Envoi du message de contact..."),await ce(ae.CONTACT,{method:"POST",body:JSON.stringify({nom:s.nom,prenom:s.prenom,telephone:s.telephone,message:s.message,email:s.email})}),console.log("✅ Message envoyé avec succès"),a(!0),e({nom:"",prenom:"",telephone:"",message:"",email:""}),setTimeout(()=>{a(!1)},5e3)}catch(y){console.error("❌ Erreur lors de l'envoi du message:",y),alert(y.message||"Erreur lors de l'envoi du message.")}finally{n(!1)}}};return r.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[i&&r.jsx("div",{className:"fixed top-24 right-4 z-50 animate-slide-in-right",children:r.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-4 rounded-xl shadow-2xl flex items-center space-x-3 max-w-md border border-green-400",children:[r.jsx("div",{className:"animate-bounce-in",children:r.jsx(Jr,{className:"h-7 w-7 text-green-100 flex-shrink-0"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-bold text-lg",children:"Message envoyé ! 🎉"}),r.jsx("p",{className:"text-green-100 text-sm",children:"Nous vous répondrons dans les plus brefs délais."})]}),r.jsx("button",{onClick:()=>a(!1),className:"text-green-100 hover:text-white transition-colors duration-200 hover:bg-green-400 hover:bg-opacity-20 rounded-full p-1",children:r.jsx(It,{className:"h-5 w-5"})})]})}),r.jsxs("section",{className:"relative py-24 bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800",children:[r.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),r.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[r.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-8",children:"Contact"}),r.jsx("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto leading-relaxed",children:"Nous simplifions la location de bateaux dans plus de 60 destinations, pour que vous puissiez profiter à tous vos besoins de navigation."})]})]}),r.jsx("section",{className:"py-20 bg-white",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[r.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[r.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:r.jsx(ld,{className:"h-8 w-8 text-blue-900"})}),r.jsx("h3",{className:"text-xl font-bold mb-4",children:"TÉLÉPHONE"}),r.jsx("p",{className:"text-blue-100 mb-2",children:"+33 2 99 40 78 90"}),r.jsx("p",{className:"text-sm text-blue-200",children:"Lun-Ven : 9h-18h"})]}),r.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[r.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:r.jsx(Qs,{className:"h-8 w-8 text-blue-900"})}),r.jsx("h3",{className:"text-xl font-bold mb-4",children:"INFORMATIONS"}),r.jsx("p",{className:"text-blue-100 mb-2",children:"sailinglocequipe@gmail.com"}),r.jsx("p",{className:"text-sm text-blue-200",children:"Réponse sous 24h"})]}),r.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[r.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:r.jsx(ut,{className:"h-8 w-8 text-blue-900"})}),r.jsx("h3",{className:"text-xl font-bold mb-4",children:"ADRESSE"}),r.jsx("p",{className:"text-blue-100 mb-2",children:"12 Quai Louis Durand"}),r.jsx("p",{className:"text-sm text-blue-200",children:"17000 La Rochelle"})]}),r.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[r.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:r.jsx(ds,{className:"h-8 w-8 text-blue-900"})}),r.jsx("h3",{className:"text-xl font-bold mb-4",children:"HORAIRES"}),r.jsx("p",{className:"text-blue-100 mb-2",children:"Lun-Sam : 9h-18h"}),r.jsx("p",{className:"text-sm text-blue-200",children:"Fermé le dimanche"})]})]})})}),r.jsx("section",{className:"py-20 bg-gray-50",children:r.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 md:p-12",children:[r.jsxs("div",{className:"text-center mb-12",children:[r.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Formulaire de contact"}),r.jsx("p",{className:"text-gray-600",children:"Remplissez le formulaire ci-dessous et nous vous répondrons rapidement"})]}),r.jsxs("form",{onSubmit:f,className:"space-y-8",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"nom",className:"block text-sm font-bold text-gray-900 mb-3",children:"NOM"}),r.jsx("input",{type:"text",id:"nom",name:"nom",value:s.nom,onChange:d,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.nom?"border-red-500":"border-gray-200"}`,placeholder:"Votre nom"}),l.nom&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.nom})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"prenom",className:"block text-sm font-bold text-gray-900 mb-3",children:"PRÉNOM"}),r.jsx("input",{type:"text",id:"prenom",name:"prenom",value:s.prenom,onChange:d,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.prenom?"border-red-500":"border-gray-200"}`,placeholder:"Votre prénom"}),l.prenom&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.prenom})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-bold text-gray-900 mb-3",children:"EMAIL"}),r.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:d,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.email?"border-red-500":"border-gray-200"}`,placeholder:"Votre email"}),l.email&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.email})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"telephone",className:"block text-sm font-bold text-gray-900 mb-3",children:"TÉLÉPHONE"}),r.jsx("input",{type:"tel",id:"telephone",name:"telephone",value:s.telephone,onChange:d,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.telephone?"border-red-500":"border-gray-200"}`,placeholder:"Votre numéro de téléphone"}),l.telephone&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.telephone})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"message",className:"block text-sm font-bold text-gray-900 mb-3",children:"MESSAGE"}),r.jsx("textarea",{id:"message",name:"message",value:s.message,onChange:d,rows:6,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.message?"border-red-500":"border-gray-200"}`,placeholder:"Votre message..."}),l.message&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.message})]}),r.jsx("div",{className:"text-center",children:r.jsx("button",{type:"submit",disabled:t,className:`inline-flex items-center space-x-3 px-12 py-4 rounded-full font-bold text-lg transition-colors ${t?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white shadow-lg`,children:t?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}),r.jsx("span",{children:"Envoi en cours..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(up,{size:24}),r.jsx("span",{children:"ENVOYER"})]})})})]})]})})})]})}function ud({isOpen:s,onClose:e,boatData:t,bookingId:n,onReviewAdded:i}){const[a,l]=D.useState({rating:5,comment:"",images:[]}),[c,d]=D.useState(!1),[m,f]=D.useState(""),[g,y]=D.useState(""),T=S=>{l(O=>({...O,rating:S}))},k=S=>{const{name:O,value:P}=S.target;l(L=>({...L,[O]:P}))},C=S=>{const O=Array.from(S.target.files);if(O.length+a.images.length>5){f("Maximum 5 images autorisées");return}const P=O.map(L=>({name:L.name,url:URL.createObjectURL(L),file:L}));l(L=>({...L,images:[...L.images,...P]}))},N=S=>{l(O=>({...O,images:O.images.filter((P,L)=>L!==S)}))},A=async S=>{if(S.preventDefault(),!a.comment.trim()){f("Veuillez ajouter un commentaire");return}d(!0),f("");try{const O=localStorage.getItem("token");if(!O)throw new Error("Vous devez être connecté");const P=a.images.map(v=>v.url);console.log("🔄 Ajout de l'avis dans MongoDB...");const L=await ce(ae.REVIEWS,{method:"POST",headers:Me(O),body:JSON.stringify({boatId:t._id,bookingId:n,rating:a.rating,comment:a.comment.trim(),images:P})});console.log("✅ Avis ajouté avec succès:",L),y("Avis ajouté avec succès !"),i&&i(L.data),setTimeout(()=>{e(),y("")},2e3)}catch(O){console.error("❌ Erreur lors de l'ajout de l'avis:",O),f(O.message)}finally{d(!1)}},I=()=>{l({rating:5,comment:"",images:[]}),f(""),y(""),e()};return s?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[r.jsx(Et,{className:"h-6 w-6 text-blue-600"}),"Laisser un avis"]}),r.jsx("button",{onClick:I,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:r.jsx(It,{className:"h-6 w-6 text-gray-500"})})]}),r.jsxs("form",{onSubmit:A,className:"p-6 space-y-6",children:[m&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:m}),g&&r.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:g}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsxs("h3",{className:"font-medium text-gray-900 mb-2",children:["Bateau : ",t?.nom]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Type : ",t?.type]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Note globale *"}),r.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(S=>r.jsx("button",{type:"button",onClick:()=>T(S),className:`p-1 transition-colors ${S<=a.rating?"text-yellow-400 hover:text-yellow-500":"text-gray-300 hover:text-gray-400"}`,children:r.jsx(yo,{className:"h-8 w-8 fill-current"})},S))}),r.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[a.rating===1&&"Très mauvais",a.rating===2&&"Mauvais",a.rating===3&&"Moyen",a.rating===4&&"Bon",a.rating===5&&"Excellent"]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Votre avis *"}),r.jsx("textarea",{name:"comment",value:a.comment,onChange:k,rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Partagez votre expérience avec ce bateau... (minimum 10 caractères)",required:!0}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.comment.length,"/1000 caractères"]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ajouter des photos (optionnel)"}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[r.jsx(ms,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Glissez-déposez vos photos ici ou cliquez pour sélectionner"}),r.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:C,className:"hidden",id:"image-upload"}),r.jsx("label",{htmlFor:"image-upload",className:"inline-block bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors cursor-pointer",children:"Sélectionner des photos"}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Maximum 5 images (JPG, PNG, GIF, WebP)"})]}),a.images.length>0&&r.jsxs("div",{className:"mt-4",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Images sélectionnées :"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:a.images.map((S,O)=>r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:S.url,alt:`Image ${O+1}`,className:"w-full h-24 object-cover rounded-lg"}),r.jsx("button",{type:"button",onClick:()=>N(O),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:r.jsx(Yr,{className:"h-4 w-4"})})]},O))})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:I,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),r.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:c?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Envoi en cours..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Et,{className:"h-4 w-4"}),"Publier l'avis"]})})]})]})]})}):null}function Np({review:s,onHelpfulClick:e}){const t=i=>new Date(i).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),n=()=>{e&&e(s._id)};return r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:s.userId?.nom?.charAt(0)||"U"})}),r.jsxs("div",{children:[r.jsxs("h4",{className:"font-medium text-gray-900",children:[s.userId?.nom," ",s.userId?.prenom]}),r.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[r.jsx(Ln,{className:"h-4 w-4"}),r.jsx("span",{children:t(s.createdAt)})]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx(Un,{rating:s.rating,size:20}),r.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[s.rating===1&&"Très mauvais",s.rating===2&&"Mauvais",s.rating===3&&"Moyen",s.rating===4&&"Bon",s.rating===5&&"Excellent"]})]})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("div",{className:"flex items-start space-x-2",children:[r.jsx(An,{className:"h-5 w-5 text-gray-400 mt-0.5 flex-shrink-0"}),r.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.comment})]})}),s.images&&s.images.length>0&&r.jsx("div",{className:"mb-4",children:r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:s.images.map((i,a)=>r.jsx("div",{className:"relative",children:r.jsx("img",{src:i,alt:`Image ${a+1}`,className:"w-full h-24 object-cover rounded-lg",onError:l=>{l.target.style.display="none"}})},a))})}),r.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[r.jsx("div",{className:"flex items-center space-x-4",children:r.jsxs("button",{onClick:n,className:"flex items-center space-x-2 text-gray-600 hover:text-blue-600 transition-colors",children:[r.jsx(dp,{className:"h-4 w-4"}),r.jsxs("span",{className:"text-sm",children:["Utile (",s.helpful||0,")"]})]})}),s.bookingId&&r.jsx("div",{className:"text-xs text-gray-500",children:"Avis basé sur une réservation"})]})]})}function Ep(){const{id:s}=ad(),[e,t]=D.useState(null),[n,i]=D.useState(!0),[a,l]=D.useState(""),[c,d]=D.useState([]),[m,f]=D.useState(!1),[g,y]=D.useState(0),[T,k]=D.useState(0);D.useEffect(()=>{C(),N()},[s]);const C=async()=>{try{i(!0),console.log("🔄 Récupération des détails du bateau depuis MongoDB...");const P=await ce(ae.BOAT_DETAIL(s));console.log("✅ Détails du bateau récupérés:",P),t(P)}catch(P){console.error("❌ Erreur lors de la récupération des détails:",P),l("Bateau non trouvé: "+P.message)}finally{i(!1)}},N=async()=>{try{console.log("🔄 Récupération des avis du bateau depuis MongoDB...");const P=await ce(ae.BOAT_REVIEWS(s));console.log("✅ Avis du bateau récupérés:",P),d(P.data||[]),y(P.averageRating||0),k(P.total||0)}catch(P){console.error("❌ Erreur lors de la récupération des avis:",P)}},A=()=>{f(!0)},I=P=>{N(),f(!1)},S=()=>{f(!1)},O=async P=>{try{(await fetch(`sailingloc-back-lilac.vercel.app/api/reviews/${P}/helpful`,{method:"PUT"})).ok&&N()}catch(L){console.error("Erreur lors du marquage utile:",L)}};return n?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Mn,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Chargement du bateau..."})]})}):a||!e?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Fe,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:a||"Bateau non trouvé"}),r.jsx(z,{to:"/bateaux",className:"text-blue-600 hover:text-blue-700",children:"Retourner à la liste des bateaux"})]})}):r.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[r.jsx("div",{className:"bg-white shadow-sm border-b",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[r.jsxs(z,{to:"/bateaux",className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 mb-4",children:[r.jsx(go,{size:20}),r.jsx("span",{children:"Retour aux bateaux"})]}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e.nom}),r.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Un,{rating:e.rating||0}),r.jsxs("span",{className:"text-sm text-gray-600",children:["(",e.reviews||0," avis)"]})]}),r.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[r.jsx(ut,{size:16}),r.jsx("span",{className:"capitalize",children:e.type})]})]})]})}),r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:e.image,alt:e.nom,className:"w-full h-96 object-cover rounded-lg shadow-lg"}),r.jsx("div",{className:"absolute top-4 left-4 bg-blue-600 text-white px-3 py-1 rounded-md font-medium",children:e.type})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Description"}),e.description?r.jsx("p",{className:"text-gray-600 mb-6",children:e.description}):r.jsx("p",{className:"text-gray-500 italic mb-6",children:"Aucune description disponible pour ce bateau."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Caractéristiques"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Qt,{size:16,className:"text-blue-600"}),r.jsxs("span",{children:["Capacité : ",e.capacite," personnes"]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(_i,{size:16,className:"text-blue-600"}),r.jsxs("span",{children:["Longueur : ",e.longueur,"m"]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(ut,{size:16,className:"text-blue-600"}),r.jsxs("span",{children:["Localisation : ",e.localisation]})]})]})]}),e.equipements&&e.equipements.length>0&&r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Équipements"}),r.jsx("div",{className:"space-y-2 text-sm",children:e.equipements.map((P,L)=>r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(ep,{size:16,className:"text-green-600"}),r.jsx("span",{children:P})]},L))})]})]})]})]}),r.jsx("div",{className:"lg:col-span-1",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-24",children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[e.prix_jour,"€"]}),r.jsx("div",{className:"text-gray-600",children:"par jour"})]}),r.jsxs("div",{className:"space-y-4 mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Capacité"}),r.jsxs("span",{className:"font-medium",children:[e.capacite," personnes"]})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Type"}),r.jsx("span",{className:"font-medium capitalize",children:e.type})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Longueur"}),r.jsxs("span",{className:"font-medium",children:[e.longueur,"m"]})]})]}),r.jsx(z,{to:`/reservation/${s}`,className:"w-full bg-orange-500 text-white py-3 px-6 rounded-lg font-medium hover:bg-orange-600 transition-colors flex items-center justify-center",children:"Réserver ce bateau"}),r.jsx("div",{className:"text-center mt-4",children:r.jsx("p",{className:"text-xs text-gray-500",children:"Réservation sécurisée • Annulation gratuite"})})]})})]}),r.jsx("div",{className:"mt-8",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[r.jsx(An,{className:"h-6 w-6 text-blue-600"}),"Avis des clients"]}),r.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Un,{rating:g,size:20}),r.jsxs("span",{className:"text-sm text-gray-600",children:["(",T," avis)"]})]}),g>0&&r.jsxs("span",{className:"text-sm text-gray-500",children:["Note moyenne : ",g.toFixed(1),"/5"]})]})]}),r.jsxs("button",{onClick:A,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[r.jsx(An,{className:"h-4 w-4"}),"Laisser un avis"]})]}),r.jsx("div",{className:"space-y-4",children:c.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(An,{size:48,className:"mx-auto mb-2 text-gray-300"}),r.jsx("p",{children:"Aucun avis pour le moment"}),r.jsx("p",{className:"text-sm",children:"Soyez le premier à laisser un avis !"})]}):c.map(P=>r.jsx(Np,{review:P,onHelpfulClick:O},P._id))})]})})]}),r.jsx(ud,{isOpen:m,onClose:S,onReviewAdded:I,boatData:e})]})}function dd(s){var e,t,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var i=s.length;for(e=0;e<i;e++)s[e]&&(t=dd(s[e]))&&(n&&(n+=" "),n+=t)}else for(t in s)s[t]&&(n&&(n+=" "),n+=t);return n}function fs(){for(var s,e,t=0,n="",i=arguments.length;t<i;t++)(s=arguments[t])&&(e=dd(s))&&(n&&(n+=" "),n+=e);return n}function Tp(s){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=s:t.appendChild(document.createTextNode(s))}Tp(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Zn=s=>typeof s=="number"&&!isNaN(s),gs=s=>typeof s=="string",St=s=>typeof s=="function",jp=s=>gs(s)||Zn(s),Ua=s=>gs(s)||St(s)?s:null,Ip=(s,e)=>s===!1||Zn(s)&&s>0?s:e,Fa=s=>D.isValidElement(s)||gs(s)||St(s)||Zn(s);function Ap(s,e,t=300){let{scrollHeight:n,style:i}=s;requestAnimationFrame(()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${t}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(e,t)})})}function Sp({enter:s,exit:e,appendPosition:t=!1,collapse:n=!0,collapseDuration:i=300}){return function({children:a,position:l,preventExitTransition:c,done:d,nodeRef:m,isIn:f,playToast:g}){let y=t?`${s}--${l}`:s,T=t?`${e}--${l}`:e,k=D.useRef(0);return D.useLayoutEffect(()=>{let C=m.current,N=y.split(" "),A=I=>{I.target===m.current&&(g(),C.removeEventListener("animationend",A),C.removeEventListener("animationcancel",A),k.current===0&&I.type!=="animationcancel"&&C.classList.remove(...N))};C.classList.add(...N),C.addEventListener("animationend",A),C.addEventListener("animationcancel",A)},[]),D.useEffect(()=>{let C=m.current,N=()=>{C.removeEventListener("animationend",N),n?Ap(C,d,i):d()};f||(c?N():(k.current=1,C.className+=` ${T}`,C.addEventListener("animationend",N)))},[f]),re.createElement(re.Fragment,null,a)}}function Nc(s,e){return{content:hd(s.content,s.props),containerId:s.props.containerId,id:s.props.toastId,theme:s.props.theme,type:s.props.type,data:s.props.data||{},isLoading:s.props.isLoading,icon:s.props.icon,reason:s.removalReason,status:e}}function hd(s,e,t=!1){return D.isValidElement(s)&&!gs(s.type)?D.cloneElement(s,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):St(s)?s({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):s}function Rp({closeToast:s,theme:e,ariaLabel:t="close"}){return re.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:n=>{n.stopPropagation(),s(!0)},"aria-label":t},re.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},re.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function Cp({delay:s,isRunning:e,closeToast:t,type:n="default",hide:i,className:a,controlledProgress:l,progress:c,rtl:d,isIn:m,theme:f}){let g=i||l&&c===0,y={animationDuration:`${s}ms`,animationPlayState:e?"running":"paused"};l&&(y.transform=`scaleX(${c})`);let T=fs("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${f}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":d}),k=St(a)?a({rtl:d,type:n,defaultClassName:T}):fs(T,a),C={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{m&&t()}};return re.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":g},re.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${f} Toastify__progress-bar--${n}`}),re.createElement("div",{role:"progressbar","aria-hidden":g?"true":"false","aria-label":"notification timer",className:k,style:y,...C}))}var kp=1,md=()=>`${kp++}`;function Pp(s,e,t){let n=1,i=0,a=[],l=[],c=e,d=new Map,m=new Set,f=I=>(m.add(I),()=>m.delete(I)),g=()=>{l=Array.from(d.values()),m.forEach(I=>I())},y=({containerId:I,toastId:S,updateId:O})=>{let P=I?I!==s:s!==1,L=d.has(S)&&O==null;return P||L},T=(I,S)=>{d.forEach(O=>{var P;(S==null||S===O.props.toastId)&&((P=O.toggle)==null||P.call(O,I))})},k=I=>{var S,O;(O=(S=I.props)==null?void 0:S.onClose)==null||O.call(S,I.removalReason),I.isActive=!1},C=I=>{if(I==null)d.forEach(k);else{let S=d.get(I);S&&k(S)}g()},N=()=>{i-=a.length,a=[]},A=I=>{var S,O;let{toastId:P,updateId:L}=I.props,v=L==null;I.staleId&&d.delete(I.staleId),I.isActive=!0,d.set(P,I),g(),t(Nc(I,v?"added":"updated")),v&&((O=(S=I.props).onOpen)==null||O.call(S))};return{id:s,props:c,observe:f,toggle:T,removeToast:C,toasts:d,clearQueue:N,buildToast:(I,S)=>{if(y(S))return;let{toastId:O,updateId:P,data:L,staleId:v,delay:p}=S,b=P==null;b&&i++;let w={...c,style:c.toastStyle,key:n++,...Object.fromEntries(Object.entries(S).filter(([j,_])=>_!=null)),toastId:O,updateId:P,data:L,isIn:!1,className:Ua(S.className||c.toastClassName),progressClassName:Ua(S.progressClassName||c.progressClassName),autoClose:S.isLoading?!1:Ip(S.autoClose,c.autoClose),closeToast(j){d.get(O).removalReason=j,C(O)},deleteToast(){let j=d.get(O);if(j!=null){if(t(Nc(j,"removed")),d.delete(O),i--,i<0&&(i=0),a.length>0){A(a.shift());return}g()}}};w.closeButton=c.closeButton,S.closeButton===!1||Fa(S.closeButton)?w.closeButton=S.closeButton:S.closeButton===!0&&(w.closeButton=Fa(c.closeButton)?c.closeButton:!0);let E={content:I,props:w,staleId:v};c.limit&&c.limit>0&&i>c.limit&&b?a.push(E):Zn(p)?setTimeout(()=>{A(E)},p):A(E)},setProps(I){c=I},setToggle:(I,S)=>{let O=d.get(I);O&&(O.toggle=S)},isToastActive:I=>{var S;return(S=d.get(I))==null?void 0:S.isActive},getSnapshot:()=>l}}var He=new Map,Fn=[],Ba=new Set,Dp=s=>Ba.forEach(e=>e(s)),fd=()=>He.size>0;function Op(){Fn.forEach(s=>gd(s.content,s.options)),Fn=[]}var Vp=(s,{containerId:e})=>{var t;return(t=He.get(e||1))==null?void 0:t.toasts.get(s)};function pd(s,e){var t;if(e)return!!((t=He.get(e))!=null&&t.isToastActive(s));let n=!1;return He.forEach(i=>{i.isToastActive(s)&&(n=!0)}),n}function Lp(s){if(!fd()){Fn=Fn.filter(e=>s!=null&&e.options.toastId!==s);return}if(s==null||jp(s))He.forEach(e=>{e.removeToast(s)});else if(s&&("containerId"in s||"id"in s)){let e=He.get(s.containerId);e?e.removeToast(s.id):He.forEach(t=>{t.removeToast(s.id)})}}var Mp=(s={})=>{He.forEach(e=>{e.props.limit&&(!s.containerId||e.id===s.containerId)&&e.clearQueue()})};function gd(s,e){Fa(s)&&(fd()||Fn.push({content:s,options:e}),He.forEach(t=>{t.buildToast(s,e)}))}function Up(s){var e;(e=He.get(s.containerId||1))==null||e.setToggle(s.id,s.fn)}function xd(s,e){He.forEach(t=>{(e==null||!(e!=null&&e.containerId)||e?.containerId===t.id)&&t.toggle(s,e?.id)})}function Fp(s){let e=s.containerId||1;return{subscribe(t){let n=Pp(e,s,Dp);He.set(e,n);let i=n.observe(t);return Op(),()=>{i(),He.delete(e)}},setProps(t){var n;(n=He.get(e))==null||n.setProps(t)},getSnapshot(){var t;return(t=He.get(e))==null?void 0:t.getSnapshot()}}}function Bp(s){return Ba.add(s),()=>{Ba.delete(s)}}function qp(s){return s&&(gs(s.toastId)||Zn(s.toastId))?s.toastId:md()}function er(s,e){return gd(s,e),e.toastId}function wi(s,e){return{...e,type:e&&e.type||s,toastId:qp(e)}}function Ni(s){return(e,t)=>er(e,wi(s,t))}function J(s,e){return er(s,wi("default",e))}J.loading=(s,e)=>er(s,wi("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function zp(s,{pending:e,error:t,success:n},i){let a;e&&(a=gs(e)?J.loading(e,i):J.loading(e.render,{...i,...e}));let l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(m,f,g)=>{if(f==null){J.dismiss(a);return}let y={type:m,...l,...i,data:g},T=gs(f)?{render:f}:f;return a?J.update(a,{...y,...T}):J(T.render,{...y,...T}),g},d=St(s)?s():s;return d.then(m=>c("success",n,m)).catch(m=>c("error",t,m)),d}J.promise=zp;J.success=Ni("success");J.info=Ni("info");J.error=Ni("error");J.warning=Ni("warning");J.warn=J.warning;J.dark=(s,e)=>er(s,wi("default",{theme:"dark",...e}));function $p(s){Lp(s)}J.dismiss=$p;J.clearWaitingQueue=Mp;J.isActive=pd;J.update=(s,e={})=>{let t=Vp(s,e);if(t){let{props:n,content:i}=t,a={delay:100,...n,...e,toastId:e.toastId||s,updateId:md()};a.toastId!==s&&(a.staleId=s);let l=a.render||i;delete a.render,er(l,a)}};J.done=s=>{J.update(s,{progress:1})};J.onChange=Bp;J.play=s=>xd(!0,s);J.pause=s=>xd(!1,s);function Hp(s){var e;let{subscribe:t,getSnapshot:n,setProps:i}=D.useRef(Fp(s)).current;i(s);let a=(e=D.useSyncExternalStore(t,n,n))==null?void 0:e.slice();function l(c){if(!a)return[];let d=new Map;return s.newestOnTop&&a.reverse(),a.forEach(m=>{let{position:f}=m.props;d.has(f)||d.set(f,[]),d.get(f).push(m)}),Array.from(d,m=>c(m[0],m[1]))}return{getToastToRender:l,isToastActive:pd,count:a?.length}}function Gp(s){let[e,t]=D.useState(!1),[n,i]=D.useState(!1),a=D.useRef(null),l=D.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:c,pauseOnHover:d,closeToast:m,onClick:f,closeOnClick:g}=s;Up({id:s.toastId,containerId:s.containerId,fn:t}),D.useEffect(()=>{if(s.pauseOnFocusLoss)return y(),()=>{T()}},[s.pauseOnFocusLoss]);function y(){document.hasFocus()||A(),window.addEventListener("focus",N),window.addEventListener("blur",A)}function T(){window.removeEventListener("focus",N),window.removeEventListener("blur",A)}function k(v){if(s.draggable===!0||s.draggable===v.pointerType){I();let p=a.current;l.canCloseOnClick=!0,l.canDrag=!0,p.style.transition="none",s.draggableDirection==="x"?(l.start=v.clientX,l.removalDistance=p.offsetWidth*(s.draggablePercent/100)):(l.start=v.clientY,l.removalDistance=p.offsetHeight*(s.draggablePercent===80?s.draggablePercent*1.5:s.draggablePercent)/100)}}function C(v){let{top:p,bottom:b,left:w,right:E}=a.current.getBoundingClientRect();v.nativeEvent.type!=="touchend"&&s.pauseOnHover&&v.clientX>=w&&v.clientX<=E&&v.clientY>=p&&v.clientY<=b?A():N()}function N(){t(!0)}function A(){t(!1)}function I(){l.didMove=!1,document.addEventListener("pointermove",O),document.addEventListener("pointerup",P)}function S(){document.removeEventListener("pointermove",O),document.removeEventListener("pointerup",P)}function O(v){let p=a.current;if(l.canDrag&&p){l.didMove=!0,e&&A(),s.draggableDirection==="x"?l.delta=v.clientX-l.start:l.delta=v.clientY-l.start,l.start!==v.clientX&&(l.canCloseOnClick=!1);let b=s.draggableDirection==="x"?`${l.delta}px, var(--y)`:`0, calc(${l.delta}px + var(--y))`;p.style.transform=`translate3d(${b},0)`,p.style.opacity=`${1-Math.abs(l.delta/l.removalDistance)}`}}function P(){S();let v=a.current;if(l.canDrag&&l.didMove&&v){if(l.canDrag=!1,Math.abs(l.delta)>l.removalDistance){i(!0),s.closeToast(!0),s.collapseAll();return}v.style.transition="transform 0.2s, opacity 0.2s",v.style.removeProperty("transform"),v.style.removeProperty("opacity")}}let L={onPointerDown:k,onPointerUp:C};return c&&d&&(L.onMouseEnter=A,s.stacked||(L.onMouseLeave=N)),g&&(L.onClick=v=>{f&&f(v),l.canCloseOnClick&&m(!0)}),{playToast:N,pauseToast:A,isRunning:e,preventExitTransition:n,toastRef:a,eventHandlers:L}}var Wp=typeof window<"u"?D.useLayoutEffect:D.useEffect,Ei=({theme:s,type:e,isLoading:t,...n})=>re.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:s==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...n});function Kp(s){return re.createElement(Ei,{...s},re.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function Qp(s){return re.createElement(Ei,{...s},re.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Xp(s){return re.createElement(Ei,{...s},re.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Jp(s){return re.createElement(Ei,{...s},re.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Yp(){return re.createElement("div",{className:"Toastify__spinner"})}var qa={info:Qp,warning:Kp,success:Xp,error:Jp,spinner:Yp},Zp=s=>s in qa;function eg({theme:s,type:e,isLoading:t,icon:n}){let i=null,a={theme:s,type:e};return n===!1||(St(n)?i=n({...a,isLoading:t}):D.isValidElement(n)?i=D.cloneElement(n,a):t?i=qa.spinner():Zp(e)&&(i=qa[e](a))),i}var tg=s=>{let{isRunning:e,preventExitTransition:t,toastRef:n,eventHandlers:i,playToast:a}=Gp(s),{closeButton:l,children:c,autoClose:d,onClick:m,type:f,hideProgressBar:g,closeToast:y,transition:T,position:k,className:C,style:N,progressClassName:A,updateId:I,role:S,progress:O,rtl:P,toastId:L,deleteToast:v,isIn:p,isLoading:b,closeOnClick:w,theme:E,ariaLabel:j}=s,_=fs("Toastify__toast",`Toastify__toast-theme--${E}`,`Toastify__toast--${f}`,{"Toastify__toast--rtl":P},{"Toastify__toast--close-on-click":w}),Ke=St(C)?C({rtl:P,position:k,type:f,defaultClassName:_}):fs(_,C),ot=eg(s),Rs=!!O||!d,F={closeToast:y,type:f,theme:E},ne=null;return l===!1||(St(l)?ne=l(F):D.isValidElement(l)?ne=D.cloneElement(l,F):ne=Rp(F)),re.createElement(T,{isIn:p,done:v,position:k,preventExitTransition:t,nodeRef:n,playToast:a},re.createElement("div",{id:L,tabIndex:0,onClick:m,"data-in":p,className:Ke,...i,style:N,ref:n,...p&&{role:S,"aria-label":j}},ot!=null&&re.createElement("div",{className:fs("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!b})},ot),hd(c,s,!e),ne,!s.customProgressBar&&re.createElement(Cp,{...I&&!Rs?{key:`p-${I}`}:{},rtl:P,theme:E,delay:d,isRunning:e,isIn:p,closeToast:y,hide:g,type:f,className:A,controlledProgress:Rs,progress:O||0})))},sg=(s,e=!1)=>({enter:`Toastify--animate Toastify__${s}-enter`,exit:`Toastify--animate Toastify__${s}-exit`,appendPosition:e}),ng=Sp(sg("bounce",!0)),rg={position:"top-right",transition:ng,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:s=>s.altKey&&s.code==="KeyT"};function vo(s){let e={...rg,...s},t=s.stacked,[n,i]=D.useState(!0),a=D.useRef(null),{getToastToRender:l,isToastActive:c,count:d}=Hp(e),{className:m,style:f,rtl:g,containerId:y,hotKeys:T}=e;function k(N){let A=fs("Toastify__toast-container",`Toastify__toast-container--${N}`,{"Toastify__toast-container--rtl":g});return St(m)?m({position:N,rtl:g,defaultClassName:A}):fs(A,Ua(m))}function C(){t&&(i(!0),J.play())}return Wp(()=>{var N;if(t){let A=a.current.querySelectorAll('[data-in="true"]'),I=12,S=(N=e.position)==null?void 0:N.includes("top"),O=0,P=0;Array.from(A).reverse().forEach((L,v)=>{let p=L;p.classList.add("Toastify__toast--stacked"),v>0&&(p.dataset.collapsed=`${n}`),p.dataset.pos||(p.dataset.pos=S?"top":"bot");let b=O*(n?.2:1)+(n?0:I*v);p.style.setProperty("--y",`${S?b:b*-1}px`),p.style.setProperty("--g",`${I}`),p.style.setProperty("--s",`${1-(n?P:0)}`),O+=p.offsetHeight,P+=.025})}},[n,d,t]),D.useEffect(()=>{function N(A){var I;let S=a.current;T(A)&&((I=S.querySelector('[tabIndex="0"]'))==null||I.focus(),i(!1),J.pause()),A.key==="Escape"&&(document.activeElement===S||S!=null&&S.contains(document.activeElement))&&(i(!0),J.play())}return document.addEventListener("keydown",N),()=>{document.removeEventListener("keydown",N)}},[T]),re.createElement("section",{ref:a,className:"Toastify",id:y,onMouseEnter:()=>{t&&(i(!1),J.pause())},onMouseLeave:C,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},l((N,A)=>{let I=A.length?{...f}:{...f,pointerEvents:"none"};return re.createElement("div",{tabIndex:-1,className:k(N),"data-stacked":t,style:I,key:`c-${N}`},A.map(({content:S,props:O})=>re.createElement(tg,{...O,stacked:t,collapseAll:C,isIn:c(O.toastId,O.containerId),key:`t-${O.key}`},S)))}))}function ig(){const s=vi(),[e,t]=D.useState({email:"",password:""}),[n,i]=D.useState(!1),[a,l]=D.useState(!1),[c,d]=D.useState({}),m=()=>{const g={};return e.email?/\S+@\S+\.\S+/.test(e.email)||(g.email="L'email n'est pas valide"):g.email="L'email est requis",e.password?e.password.length<6&&(g.password="Le mot de passe doit contenir au moins 6 caractères"):g.password="Le mot de passe est requis",d(g),Object.keys(g).length===0},f=async g=>{if(g.preventDefault(),!!m()){l(!0);try{console.log("🔄 Connexion en cours...");const y=await ce(ae.LOGIN,{method:"POST",body:JSON.stringify({email:e.email,password:e.password})});console.log("✅ Connexion réussie:",y),localStorage.setItem("token",y.token),localStorage.setItem("userPrenom",y.user.prenom),localStorage.setItem("userRole",y.user.role),localStorage.setItem("userId",y.user.id),localStorage.setItem("userNom",y.user.nom),localStorage.setItem("userEmail",y.user.email),localStorage.setItem("userTel",y.user.tel),J.success(r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#16a34a"},children:"Connexion réussie !"}),r.jsx("br",{}),"Bienvenue ",r.jsx("span",{style:{color:"#16a34a"},children:y.user.prenom})," 👋"]})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1}),y.user.role==="admin"?s("/admin"):s("/")}catch(y){console.error("❌ Erreur lors de la connexion:",y),alert(y.message||"Erreur lors de la connexion.")}finally{l(!1)}}};return r.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[r.jsxs("section",{className:"relative py-16 bg-gradient-to-br from-blue-800 via-blue-900 to-blue-800",children:[r.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),r.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[r.jsx("div",{className:"flex items-center justify-center mb-6",children:r.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white tracking-wider",children:"SAILINGLOC"})}),r.jsx("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto",children:"Connectez-vous pour accéder à votre espace personnel"})]})]}),r.jsx("section",{className:"py-16",children:r.jsx("div",{className:"max-w-md mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"CONNEXION"}),r.jsx("p",{className:"text-gray-600",children:"Accédez à votre compte SailingLoc"})]}),r.jsxs("form",{onSubmit:f,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"EMAIL"}),r.jsx("div",{className:"relative",children:r.jsx("input",{type:"email",id:"email",name:"email",value:e.email,onChange:g=>t(y=>({...y,email:g.target.value})),className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.email?"border-red-500":"border-gray-200"}`,placeholder:"votre@email.com"})}),c.email&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:c.email})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"MOT DE PASSE"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:n?"text":"password",id:"password",name:"password",value:e.password,onChange:g=>t(y=>({...y,password:g.target.value})),className:`w-full pl-10 pr-12 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.password?"border-red-500":"border-gray-200"}`,placeholder:"Votre mot de passe"}),r.jsx("button",{type:"button",onClick:()=>i(!n),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:n?r.jsx(Da,{size:20}):r.jsx(Ks,{size:20})})]}),c.password&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:c.password})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Se souvenir de moi"})]}),r.jsx(z,{to:"/mot-de-passe-oublie",className:"text-sm text-blue-600 hover:text-blue-700",children:"Mot de passe oublié ?"})]}),r.jsx("button",{type:"submit",disabled:a,className:`w-full py-3 px-6 rounded-full font-bold text-lg transition-colors ${a?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white shadow-lg`,children:a?r.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[r.jsx(Mn,{className:"animate-spin h-5 w-5 text-white"}),r.jsx("span",{children:"CONNEXION..."})]}):"SE CONNECTER"})]}),r.jsx("div",{className:"mt-8 text-center",children:r.jsxs("p",{className:"text-gray-600",children:["Pas encore de compte ?"," ",r.jsx(z,{to:"/inscription",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Créer un compte"})]})})]})})})]})}function ag(){const[s,e]=D.useState({prenom:"",nom:"",email:"",telephone:"",password:"",confirmPassword:"",acceptTerms:!1,userType:"client"}),[t,n]=D.useState(!1),[i,a]=D.useState(!1),[l,c]=D.useState({}),[d,m]=D.useState(!1),f=vi(),g=k=>{const{name:C,value:N,type:A,checked:I}=k.target;e(S=>({...S,[C]:A==="checkbox"?I:N})),l[C]&&c(S=>({...S,[C]:""}))},y=()=>{const k={};return s.prenom.trim()||(k.prenom="Le prénom est requis"),s.nom.trim()||(k.nom="Le nom est requis"),s.email.trim()?/\S+@\S+\.\S+/.test(s.email)||(k.email="Format d'email invalide"):k.email="L'email est requis",s.telephone.trim()||(k.telephone="Le téléphone est requis"),s.password.trim()?s.password.length<6&&(k.password="Le mot de passe doit contenir au moins 6 caractères"):k.password="Le mot de passe est requis",s.password!==s.confirmPassword&&(k.confirmPassword="Les mots de passe ne correspondent pas"),s.acceptTerms||(k.acceptTerms="Vous devez accepter les conditions d'utilisation"),c(k),Object.keys(k).length===0},T=async k=>{if(k.preventDefault(),!!y()){m(!0);try{await new Promise(N=>setTimeout(N,1e3)),console.log("🔄 Création de l'utilisateur dans MongoDB...");const C=await ce(ae.REGISTER,{method:"POST",body:JSON.stringify({nom:s.nom,prenom:s.prenom,email:s.email,password:s.password,tel:s.telephone.replace(/\D/g,""),role:s.userType})});console.log("✅ Utilisateur créé avec succès:",C),localStorage.setItem("userNom",C.user.nom),J.success(r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#16a34a"},children:"Inscription réussie !"}),r.jsx("br",{}),"Bienvenue ",r.jsx("span",{style:{color:"#16a34a"},children:C.user.nom})," 👋"]})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1}),setTimeout(()=>f("/connexion"),3100)}catch(C){console.error("❌ Erreur lors de la création de l'utilisateur:",C),J.error(C.message||"Erreur lors de l'inscription.",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#fde6e6",color:"#991b1b",fontWeight:500,fontSize:18,border:"2px solid #991b1b"},icon:!1})}finally{m(!1)}}};return r.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[r.jsx(vo,{}),r.jsxs("section",{className:"relative py-16 bg-gradient-to-br from-blue-800 via-blue-900 to-blue-800",children:[r.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),r.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[r.jsxs("div",{className:"flex items-center justify-center mb-6",children:[r.jsx(Bs,{className:"h-12 w-12 text-white mr-4"}),r.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white tracking-wider",children:"SAILINGLOC"})]}),r.jsx("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto",children:"Rejoignez la communauté des passionnés de navigation"})]})]}),r.jsx("section",{className:"py-16",children:r.jsx("div",{className:"max-w-lg mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"INSCRIPTION"}),r.jsx("p",{className:"text-gray-600",children:"Créez votre compte SailingLoc"})]}),r.jsxs("div",{className:"mb-8",children:[r.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"TYPE DE COMPTE"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("label",{className:`flex items-center justify-center p-4 border-2 rounded-lg cursor-pointer transition-colors ${s.userType==="client"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"}`,children:[r.jsx("input",{type:"radio",name:"userType",value:"client",checked:s.userType==="client",onChange:g,className:"sr-only"}),r.jsxs("div",{className:"text-center",children:[r.jsx(Sn,{className:"h-8 w-8 mx-auto mb-2"}),r.jsx("span",{className:"font-semibold",children:"CLIENT"}),r.jsx("p",{className:"text-xs mt-1",children:"Louer des bateaux"})]})]}),r.jsxs("label",{className:`flex items-center justify-center p-4 border-2 rounded-lg cursor-pointer transition-colors ${s.userType==="proprietaire"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"}`,children:[r.jsx("input",{type:"radio",name:"userType",value:"proprietaire",checked:s.userType==="proprietaire",onChange:g,className:"sr-only"}),r.jsxs("div",{className:"text-center",children:[r.jsx(Bs,{className:"h-8 w-8 mx-auto mb-2"}),r.jsx("span",{className:"font-semibold",children:"PROPRIÉTAIRE"}),r.jsx("p",{className:"text-xs mt-1",children:"Mettre en location"})]})]})]})]}),r.jsxs("form",{onSubmit:T,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"prenom",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"PRÉNOM"}),r.jsxs("div",{className:"relative",children:[r.jsx(Sn,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsx("input",{type:"text",id:"prenom",name:"prenom",value:s.prenom,onChange:g,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.prenom?"border-red-500":"border-gray-200"}`,placeholder:"Prénom"})]}),l.prenom&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.prenom})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"nom",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"NOM"}),r.jsxs("div",{className:"relative",children:[r.jsx(Sn,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsx("input",{type:"text",id:"nom",name:"nom",value:s.nom,onChange:g,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.nom?"border-red-500":"border-gray-200"}`,placeholder:"Nom"})]}),l.nom&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.nom})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"EMAIL"}),r.jsxs("div",{className:"relative",children:[r.jsx(Qs,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:g,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.email?"border-red-500":"border-gray-200"}`,placeholder:"votre@email.com"})]}),l.email&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.email})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"telephone",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"TÉLÉPHONE"}),r.jsxs("div",{className:"relative",children:[r.jsx(ld,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsx("input",{type:"tel",id:"telephone",name:"telephone",value:s.telephone,onChange:g,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.telephone?"border-red-500":"border-gray-200"}`,placeholder:"06 12 34 56 78"})]}),l.telephone&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.telephone})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"MOT DE PASSE"}),r.jsxs("div",{className:"relative",children:[r.jsx(Va,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsx("input",{type:t?"text":"password",id:"password",name:"password",value:s.password,onChange:g,className:`w-full pl-10 pr-12 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.password?"border-red-500":"border-gray-200"}`,placeholder:"Mot de passe"}),r.jsx("button",{type:"button",onClick:()=>n(!t),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:t?r.jsx(Da,{size:20}):r.jsx(Ks,{size:20})})]}),l.password&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.password})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"CONFIRMER LE MOT DE PASSE"}),r.jsxs("div",{className:"relative",children:[r.jsx(Va,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsx("input",{type:i?"text":"password",id:"confirmPassword",name:"confirmPassword",value:s.confirmPassword,onChange:g,className:`w-full pl-10 pr-12 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.confirmPassword?"border-red-500":"border-gray-200"}`,placeholder:"Confirmer le mot de passe"}),r.jsx("button",{type:"button",onClick:()=>a(!i),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:i?r.jsx(Da,{size:20}):r.jsx(Ks,{size:20})})]}),l.confirmPassword&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.confirmPassword})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"flex items-start space-x-3",children:[r.jsx("input",{type:"checkbox",name:"acceptTerms",checked:s.acceptTerms,onChange:g,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsxs("span",{className:"text-sm text-gray-600",children:["J'accepte les"," ",r.jsx(z,{to:"/conditions",className:"text-blue-600 hover:text-blue-700",children:"conditions d'utilisation"})," ","et la"," ",r.jsx(z,{to:"/confidentialite",className:"text-blue-600 hover:text-blue-700",children:"politique de confidentialité"})]})]}),l.acceptTerms&&r.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.acceptTerms})]}),r.jsx("button",{type:"submit",disabled:d,className:`w-full py-3 px-6 rounded-full font-bold text-lg transition-colors ${d?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white shadow-lg`,children:d?r.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),r.jsx("span",{children:"INSCRIPTION..."})]}):"CRÉER MON COMPTE"})]}),r.jsx("div",{className:"mt-8 text-center",children:r.jsxs("p",{className:"text-gray-600",children:["Déjà un compte ?"," ",r.jsx(z,{to:"/connexion",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Se connecter"})]})})]})})})]})}function og(){let s=[];if(typeof window<"u")try{s=JSON.parse(localStorage.getItem("favorisBoats"))||[]}catch{s=[]}return r.jsx("div",{className:"min-h-screen bg-gray-50 pt-24 flex flex-col items-center",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-2xl text-center",children:[r.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-6",children:"Mes favoris"}),s.length===0?r.jsx("p",{className:"text-gray-600",children:"Aucun bateau en favori pour le moment."}):r.jsx("ul",{className:"space-y-4",children:s.map((e,t)=>r.jsxs("li",{className:"border-b pb-4 text-left",children:[r.jsx("strong",{children:e.name})," — ",e.location]},t))})]})})}const lg=()=>{};var Ec={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd=function(s){const e=[];let t=0;for(let n=0;n<s.length;n++){let i=s.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<s.length&&(s.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(s.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},cg=function(s){const e=[];let t=0,n=0;for(;t<s.length;){const i=s[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=s[t++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=s[t++],l=s[t++],c=s[t++],d=((i&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const a=s[t++],l=s[t++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|l&63)}}return e.join("")},bd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<s.length;i+=3){const a=s[i],l=i+1<s.length,c=l?s[i+1]:0,d=i+2<s.length,m=d?s[i+2]:0,f=a>>2,g=(a&3)<<4|c>>4;let y=(c&15)<<2|m>>6,T=m&63;d||(T=64,l||(y=64)),n.push(t[f],t[g],t[y],t[T])}return n.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(yd(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):cg(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<s.length;){const a=t[s.charAt(i++)],c=i<s.length?t[s.charAt(i)]:0;++i;const m=i<s.length?t[s.charAt(i)]:64;++i;const g=i<s.length?t[s.charAt(i)]:64;if(++i,a==null||c==null||m==null||g==null)throw new ug;const y=a<<2|c>>4;if(n.push(y),m!==64){const T=c<<4&240|m>>2;if(n.push(T),g!==64){const k=m<<6&192|g;n.push(k)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class ug extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dg=function(s){const e=yd(s);return bd.encodeByteArray(e,!0)},Zr=function(s){return dg(s).replace(/\./g,"")},vd=function(s){try{return bd.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mg=()=>hg().__FIREBASE_DEFAULTS__,fg=()=>{if(typeof process>"u"||typeof Ec>"u")return;const s=Ec.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},pg=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&vd(s[1]);return e&&JSON.parse(e)},Ti=()=>{try{return lg()||mg()||fg()||pg()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},_d=s=>Ti()?.emulatorHosts?.[s],wd=s=>{const e=_d(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},Nd=()=>Ti()?.config,Ed=s=>Ti()?.[`_${s}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _o(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=s.iat||0,a=s.sub||s.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Zr(JSON.stringify(t)),Zr(JSON.stringify(l)),""].join(".")}const Rn={};function xg(){const s={prod:[],emulator:[]};for(const e of Object.keys(Rn))Rn[e]?s.emulator.push(e):s.prod.push(e);return s}function yg(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let Tc=!1;function wo(s,e){if(typeof window>"u"||typeof document>"u"||!ns(window.location.host)||Rn[s]===e||Rn[s]||Tc)return;Rn[s]=e;function t(y){return`__firebase__banner__${y}`}const n="__firebase__banner",a=xg().prod.length>0;function l(){const y=document.getElementById(n);y&&y.remove()}function c(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function d(y,T){y.setAttribute("width","24"),y.setAttribute("id",T),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function m(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{Tc=!0,l()},y}function f(y,T){y.setAttribute("id",T),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function g(){const y=yg(n),T=t("text"),k=document.getElementById(T)||document.createElement("span"),C=t("learnmore"),N=document.getElementById(C)||document.createElement("a"),A=t("preprendIcon"),I=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const S=y.element;c(S),f(N,C);const O=m();d(I,A),S.append(I,k,N,O),document.body.appendChild(S)}a?(k.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Be(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Be())}function vg(){const s=Ti()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _g(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wg(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function Ng(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Eg(){const s=Be();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function Tg(){return!vg()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jg(){try{return typeof indexedDB=="object"}catch{return!1}}function Ig(){return new Promise((s,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),s(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ag="FirebaseError";class _t extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=Ag,Object.setPrototypeOf(this,_t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,tr.prototype.create)}}class tr{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],l=a?Sg(a,n):"Error",c=`${this.serviceName}: ${l} (${i}).`;return new _t(i,c,n)}}function Sg(s,e){return s.replace(Rg,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Rg=/\{\$([^}]+)}/g;function Cg(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function xs(s,e){if(s===e)return!0;const t=Object.keys(s),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const a=s[i],l=e[i];if(jc(a)&&jc(l)){if(!xs(a,l))return!1}else if(a!==l)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function jc(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sr(s){const e=[];for(const[t,n]of Object.entries(s))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Nn(s){const e={};return s.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function En(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function kg(s,e){const t=new Pg(s,e);return t.subscribe.bind(t)}class Pg{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");Dg(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=ya),i.error===void 0&&(i.error=ya),i.complete===void 0&&(i.complete=ya);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Dg(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function ya(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(s){return s&&s._delegate?s._delegate:s}class Xt{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const us="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new gg;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Lg(e))try{this.getOrInitializeService({instanceIdentifier:us})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=us){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=us){return this.instances.has(e)}getOptions(e=us){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&l.resolve(i)}return i}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Vg(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=us){return this.component?this.component.multipleInstances?e:us:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Vg(s){return s===us?void 0:s}function Lg(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Og(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Y;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Y||(Y={}));const Ug={debug:Y.DEBUG,verbose:Y.VERBOSE,info:Y.INFO,warn:Y.WARN,error:Y.ERROR,silent:Y.SILENT},Fg=Y.INFO,Bg={[Y.DEBUG]:"log",[Y.VERBOSE]:"log",[Y.INFO]:"info",[Y.WARN]:"warn",[Y.ERROR]:"error"},qg=(s,e,...t)=>{if(e<s.logLevel)return;const n=new Date().toISOString(),i=Bg[e];if(i)console[i](`[${n}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class No{constructor(e){this.name=e,this._logLevel=Fg,this._logHandler=qg,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Y))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ug[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Y.DEBUG,...e),this._logHandler(this,Y.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Y.VERBOSE,...e),this._logHandler(this,Y.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Y.INFO,...e),this._logHandler(this,Y.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Y.WARN,...e),this._logHandler(this,Y.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Y.ERROR,...e),this._logHandler(this,Y.ERROR,...e)}}const zg=(s,e)=>e.some(t=>s instanceof t);let Ic,Ac;function $g(){return Ic||(Ic=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hg(){return Ac||(Ac=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jd=new WeakMap,za=new WeakMap,Id=new WeakMap,ba=new WeakMap,Eo=new WeakMap;function Gg(s){const e=new Promise((t,n)=>{const i=()=>{s.removeEventListener("success",a),s.removeEventListener("error",l)},a=()=>{t($t(s.result)),i()},l=()=>{n(s.error),i()};s.addEventListener("success",a),s.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&jd.set(t,s)}).catch(()=>{}),Eo.set(e,s),e}function Wg(s){if(za.has(s))return;const e=new Promise((t,n)=>{const i=()=>{s.removeEventListener("complete",a),s.removeEventListener("error",l),s.removeEventListener("abort",l)},a=()=>{t(),i()},l=()=>{n(s.error||new DOMException("AbortError","AbortError")),i()};s.addEventListener("complete",a),s.addEventListener("error",l),s.addEventListener("abort",l)});za.set(s,e)}let $a={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return za.get(s);if(e==="objectStoreNames")return s.objectStoreNames||Id.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return $t(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function Kg(s){$a=s($a)}function Qg(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=s.call(va(this),e,...t);return Id.set(n,e.sort?e.sort():[e]),$t(n)}:Hg().includes(s)?function(...e){return s.apply(va(this),e),$t(jd.get(this))}:function(...e){return $t(s.apply(va(this),e))}}function Xg(s){return typeof s=="function"?Qg(s):(s instanceof IDBTransaction&&Wg(s),zg(s,$g())?new Proxy(s,$a):s)}function $t(s){if(s instanceof IDBRequest)return Gg(s);if(ba.has(s))return ba.get(s);const e=Xg(s);return e!==s&&(ba.set(s,e),Eo.set(e,s)),e}const va=s=>Eo.get(s);function Jg(s,e,{blocked:t,upgrade:n,blocking:i,terminated:a}={}){const l=indexedDB.open(s,e),c=$t(l);return n&&l.addEventListener("upgradeneeded",d=>{n($t(l.result),d.oldVersion,d.newVersion,$t(l.transaction),d)}),t&&l.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),c.then(d=>{a&&d.addEventListener("close",()=>a()),i&&d.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),c}const Yg=["get","getKey","getAll","getAllKeys","count"],Zg=["put","add","delete","clear"],_a=new Map;function Sc(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(_a.get(e))return _a.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=Zg.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Yg.includes(t)))return;const a=async function(l,...c){const d=this.transaction(l,i?"readwrite":"readonly");let m=d.store;return n&&(m=m.index(c.shift())),(await Promise.all([m[t](...c),i&&d.done]))[0]};return _a.set(e,a),a}Kg(s=>({...s,get:(e,t,n)=>Sc(e,t)||s.get(e,t,n),has:(e,t)=>!!Sc(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(tx(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function tx(s){return s.getComponent()?.type==="VERSION"}const Ha="@firebase/app",Rc="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rt=new No("@firebase/app"),sx="@firebase/app-compat",nx="@firebase/analytics-compat",rx="@firebase/analytics",ix="@firebase/app-check-compat",ax="@firebase/app-check",ox="@firebase/auth",lx="@firebase/auth-compat",cx="@firebase/database",ux="@firebase/data-connect",dx="@firebase/database-compat",hx="@firebase/functions",mx="@firebase/functions-compat",fx="@firebase/installations",px="@firebase/installations-compat",gx="@firebase/messaging",xx="@firebase/messaging-compat",yx="@firebase/performance",bx="@firebase/performance-compat",vx="@firebase/remote-config",_x="@firebase/remote-config-compat",wx="@firebase/storage",Nx="@firebase/storage-compat",Ex="@firebase/firestore",Tx="@firebase/ai",jx="@firebase/firestore-compat",Ix="firebase",Ax="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga="[DEFAULT]",Sx={[Ha]:"fire-core",[sx]:"fire-core-compat",[rx]:"fire-analytics",[nx]:"fire-analytics-compat",[ax]:"fire-app-check",[ix]:"fire-app-check-compat",[ox]:"fire-auth",[lx]:"fire-auth-compat",[cx]:"fire-rtdb",[ux]:"fire-data-connect",[dx]:"fire-rtdb-compat",[hx]:"fire-fn",[mx]:"fire-fn-compat",[fx]:"fire-iid",[px]:"fire-iid-compat",[gx]:"fire-fcm",[xx]:"fire-fcm-compat",[yx]:"fire-perf",[bx]:"fire-perf-compat",[vx]:"fire-rc",[_x]:"fire-rc-compat",[wx]:"fire-gcs",[Nx]:"fire-gcs-compat",[Ex]:"fire-fst",[jx]:"fire-fst-compat",[Tx]:"fire-vertex","fire-js":"fire-js",[Ix]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn=new Map,Rx=new Map,Wa=new Map;function Cc(s,e){try{s.container.addComponent(e)}catch(t){Rt.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function ys(s){const e=s.name;if(Wa.has(e))return Rt.debug(`There were multiple attempts to register component ${e}.`),!1;Wa.set(e,s);for(const t of Bn.values())Cc(t,s);for(const t of Rx.values())Cc(t,s);return!0}function ji(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Je(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ht=new tr("app","Firebase",Cx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Xt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ht.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Es=Ax;function Ad(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const n={name:Ga,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Ht.create("bad-app-name",{appName:String(i)});if(t||(t=Nd()),!t)throw Ht.create("no-options");const a=Bn.get(i);if(a){if(xs(t,a.options)&&xs(n,a.config))return a;throw Ht.create("duplicate-app",{appName:i})}const l=new Mg(i);for(const d of Wa.values())l.addComponent(d);const c=new kx(t,n,l);return Bn.set(i,c),c}function To(s=Ga){const e=Bn.get(s);if(!e&&s===Ga&&Nd())return Ad();if(!e)throw Ht.create("no-app",{appName:s});return e}function kc(){return Array.from(Bn.values())}function dt(s,e,t){let n=Sx[s]??s;t&&(n+=`-${t}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${n}" with version "${e}":`];i&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Rt.warn(l.join(" "));return}ys(new Xt(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px="firebase-heartbeat-database",Dx=1,qn="firebase-heartbeat-store";let wa=null;function Sd(){return wa||(wa=Jg(Px,Dx,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(qn)}catch(t){console.warn(t)}}}}).catch(s=>{throw Ht.create("idb-open",{originalErrorMessage:s.message})})),wa}async function Ox(s){try{const t=(await Sd()).transaction(qn),n=await t.objectStore(qn).get(Rd(s));return await t.done,n}catch(e){if(e instanceof _t)Rt.warn(e.message);else{const t=Ht.create("idb-get",{originalErrorMessage:e?.message});Rt.warn(t.message)}}}async function Pc(s,e){try{const n=(await Sd()).transaction(qn,"readwrite");await n.objectStore(qn).put(e,Rd(s)),await n.done}catch(t){if(t instanceof _t)Rt.warn(t.message);else{const n=Ht.create("idb-set",{originalErrorMessage:t?.message});Rt.warn(n.message)}}}function Rd(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx=1024,Lx=30;class Mx{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Fx(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Dc();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>Lx){const i=Bx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Rt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Dc(),{heartbeatsToSend:t,unsentEntries:n}=Ux(this._heartbeatsCache.heartbeats),i=Zr(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Rt.warn(e),""}}}function Dc(){return new Date().toISOString().substring(0,10)}function Ux(s,e=Vx){const t=[];let n=s.slice();for(const i of s){const a=t.find(l=>l.agent===i.agent);if(a){if(a.dates.push(i.date),Oc(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Oc(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class Fx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jg()?Ig().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Ox(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Pc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Pc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Oc(s){return Zr(JSON.stringify({version:2,heartbeats:s})).length}function Bx(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let n=1;n<s.length;n++)s[n].date<t&&(t=s[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(s){ys(new Xt("platform-logger",e=>new ex(e),"PRIVATE")),ys(new Xt("heartbeat",e=>new Mx(e),"PRIVATE")),dt(Ha,Rc,s),dt(Ha,Rc,"esm2020"),dt("fire-js","")}qx("");var zx="firebase",$x="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dt(zx,$x,"app");function Cd(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Hx=Cd,kd=new tr("auth","Firebase",Cd());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei=new No("@firebase/auth");function Gx(s,...e){ei.logLevel<=Y.WARN&&ei.warn(`Auth (${Es}): ${s}`,...e)}function Br(s,...e){ei.logLevel<=Y.ERROR&&ei.error(`Auth (${Es}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function at(s,...e){throw jo(s,...e)}function ht(s,...e){return jo(s,...e)}function Pd(s,e,t){const n={...Hx(),[e]:t};return new tr("auth","Firebase",n).create(e,{appName:s.name})}function At(s){return Pd(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jo(s,...e){if(typeof s!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=s.name),s._errorFactory.create(t,...n)}return kd.create(s,...e)}function W(s,e,...t){if(!s)throw jo(e,...t)}function Tt(s){const e="INTERNAL ASSERTION FAILED: "+s;throw Br(e),new Error(e)}function Ct(s,e){s||Tt(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ka(){return typeof self<"u"&&self.location?.href||""}function Wx(){return Vc()==="http:"||Vc()==="https:"}function Vc(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Wx()||wg()||"connection"in navigator)?navigator.onLine:!0}function Qx(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ct(t>e,"Short delay should be less than long delay!"),this.isMobile=bg()||Ng()}get(){return Kx()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(s,e){Ct(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Tt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Tt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Tt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Yx=new nr(3e4,6e4);function rs(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function is(s,e,t,n,i={}){return Od(s,i,async()=>{let a={},l={};n&&(e==="GET"?l=n:a={body:JSON.stringify(n)});const c=sr({key:s.config.apiKey,...l}).slice(1),d=await s._getAdditionalHeaders();d["Content-Type"]="application/json",s.languageCode&&(d["X-Firebase-Locale"]=s.languageCode);const m={method:e,headers:d,...a};return _g()||(m.referrerPolicy="no-referrer"),s.emulatorConfig&&ns(s.emulatorConfig.host)&&(m.credentials="include"),Dd.fetch()(await Vd(s,s.config.apiHost,t,c),m)})}async function Od(s,e,t){s._canInitEmulator=!1;const n={...Xx,...e};try{const i=new e0(s),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Cr(s,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const c=a.ok?l.errorMessage:l.error.message,[d,m]=c.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cr(s,"credential-already-in-use",l);if(d==="EMAIL_EXISTS")throw Cr(s,"email-already-in-use",l);if(d==="USER_DISABLED")throw Cr(s,"user-disabled",l);const f=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw Pd(s,f,m);at(s,f)}}catch(i){if(i instanceof _t)throw i;at(s,"network-request-failed",{message:String(i)})}}async function rr(s,e,t,n,i={}){const a=await is(s,e,t,n,i);return"mfaPendingCredential"in a&&at(s,"multi-factor-auth-required",{_serverResponse:a}),a}async function Vd(s,e,t,n){const i=`${e}${t}?${n}`,a=s,l=a.config.emulator?Io(s.config,i):`${s.config.apiScheme}://${i}`;return Jx.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function Zx(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class e0{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(ht(this.auth,"network-request-failed")),Yx.get())})}}function Cr(s,e,t){const n={appName:s.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=ht(s,e,n);return i.customData._tokenResponse=t,i}function Lc(s){return s!==void 0&&s.enterprise!==void 0}class t0{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Zx(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function s0(s,e){return is(s,"GET","/v2/recaptchaConfig",rs(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n0(s,e){return is(s,"POST","/v1/accounts:delete",e)}async function ti(s,e){return is(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cn(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function r0(s,e=!1){const t=Ce(s),n=await t.getIdToken(e),i=Ao(n);W(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,l=a?.sign_in_provider;return{claims:i,token:n,authTime:Cn(Na(i.auth_time)),issuedAtTime:Cn(Na(i.iat)),expirationTime:Cn(Na(i.exp)),signInProvider:l||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Na(s){return Number(s)*1e3}function Ao(s){const[e,t,n]=s.split(".");if(e===void 0||t===void 0||n===void 0)return Br("JWT malformed, contained fewer than 3 sections"),null;try{const i=vd(t);return i?JSON.parse(i):(Br("Failed to decode base64 JWT payload"),null)}catch(i){return Br("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Mc(s){const e=Ao(s);return W(e,"internal-error"),W(typeof e.exp<"u","internal-error"),W(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zn(s,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof _t&&i0(n)&&s.auth.currentUser===s&&await s.auth.signOut(),n}}function i0({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Cn(this.lastLoginAt),this.creationTime=Cn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function si(s){const e=s.auth,t=await s.getIdToken(),n=await zn(s,ti(e,{idToken:t}));W(n?.users.length,e,"internal-error");const i=n.users[0];s._notifyReloadListener(i);const a=i.providerUserInfo?.length?Ld(i.providerUserInfo):[],l=l0(s.providerData,a),c=s.isAnonymous,d=!(s.email&&i.passwordHash)&&!l?.length,m=c?d:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Qa(i.createdAt,i.lastLoginAt),isAnonymous:m};Object.assign(s,f)}async function o0(s){const e=Ce(s);await si(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function l0(s,e){return[...s.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function Ld(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c0(s,e){const t=await Od(s,{},async()=>{const n=sr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=s.config,l=await Vd(s,i,"/v1/token",`key=${a}`),c=await s._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:c,body:n};return s.emulatorConfig&&ns(s.emulatorConfig.host)&&(d.credentials="include"),Dd.fetch()(l,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function u0(s,e){return is(s,"POST","/v2/accounts:revokeToken",rs(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){W(e.idToken,"internal-error"),W(typeof e.idToken<"u","internal-error"),W(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Mc(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){W(e.length!==0,"internal-error");const t=Mc(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(W(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:a}=await c0(e,t);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:a}=t,l=new qs;return n&&(W(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),i&&(W(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),a&&(W(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new qs,this.toJSON())}_performRefresh(){return Tt("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(s,e){W(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class rt{constructor({uid:e,auth:t,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new a0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Qa(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await zn(this,this.stsTokenManager.getToken(this.auth,e));return W(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return r0(this,e)}reload(){return o0(this)}_assign(e){this!==e&&(W(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new rt({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){W(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await si(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Je(this.auth.app))return Promise.reject(At(this.auth));const e=await this.getIdToken();return await zn(this,n0(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,d=t._redirectEventId??void 0,m=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:g,emailVerified:y,isAnonymous:T,providerData:k,stsTokenManager:C}=t;W(g&&C,e,"internal-error");const N=qs.fromJSON(this.name,C);W(typeof g=="string",e,"internal-error"),Lt(n,e.name),Lt(i,e.name),W(typeof y=="boolean",e,"internal-error"),W(typeof T=="boolean",e,"internal-error"),Lt(a,e.name),Lt(l,e.name),Lt(c,e.name),Lt(d,e.name),Lt(m,e.name),Lt(f,e.name);const A=new rt({uid:g,auth:e,email:i,emailVerified:y,displayName:n,isAnonymous:T,photoURL:l,phoneNumber:a,tenantId:c,stsTokenManager:N,createdAt:m,lastLoginAt:f});return k&&Array.isArray(k)&&(A.providerData=k.map(I=>({...I}))),d&&(A._redirectEventId=d),A}static async _fromIdTokenResponse(e,t,n=!1){const i=new qs;i.updateFromServerResponse(t);const a=new rt({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await si(a),a}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];W(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?Ld(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!a?.length,c=new qs;c.updateFromIdToken(n);const d=new rt({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:l}),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Qa(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(d,m),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uc=new Map;function jt(s){Ct(s instanceof Function,"Expected a class definition");let e=Uc.get(s);return e?(Ct(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,Uc.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Md.type="NONE";const Fc=Md;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(s,e,t){return`firebase:${s}:${e}:${t}`}class zs{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=qr(this.userKey,i.apiKey,a),this.fullPersistenceKey=qr("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ti(this.auth,{idToken:e}).catch(()=>{});return t?rt._fromGetAccountInfoResponse(this.auth,t,e):null}return rt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new zs(jt(Fc),e,n);const i=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let a=i[0]||jt(Fc);const l=qr(n,e.config.apiKey,e.name);let c=null;for(const m of t)try{const f=await m._get(l);if(f){let g;if(typeof f=="string"){const y=await ti(e,{idToken:f}).catch(()=>{});if(!y)break;g=await rt._fromGetAccountInfoResponse(e,y,f)}else g=rt._fromJSON(e,f);m!==a&&(c=g),a=m;break}}catch{}const d=i.filter(m=>m._shouldAllowMigration);return!a._shouldAllowMigration||!d.length?new zs(a,e,n):(a=d[0],c&&await a._set(l,c.toJSON()),await Promise.all(t.map(async m=>{if(m!==a)try{await m._remove(l)}catch{}})),new zs(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(qd(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ud(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($d(e))return"Blackberry";if(Hd(e))return"Webos";if(Fd(e))return"Safari";if((e.includes("chrome/")||Bd(e))&&!e.includes("edge/"))return"Chrome";if(zd(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=s.match(t);if(n?.length===2)return n[1]}return"Other"}function Ud(s=Be()){return/firefox\//i.test(s)}function Fd(s=Be()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Bd(s=Be()){return/crios\//i.test(s)}function qd(s=Be()){return/iemobile/i.test(s)}function zd(s=Be()){return/android/i.test(s)}function $d(s=Be()){return/blackberry/i.test(s)}function Hd(s=Be()){return/webos/i.test(s)}function So(s=Be()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function d0(s=Be()){return So(s)&&!!window.navigator?.standalone}function h0(){return Eg()&&document.documentMode===10}function Gd(s=Be()){return So(s)||zd(s)||Hd(s)||$d(s)||/windows phone/i.test(s)||qd(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wd(s,e=[]){let t;switch(s){case"Browser":t=Bc(Be());break;case"Worker":t=`${Bc(Be())}-${s}`;break;default:t=s}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Es}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=a=>new Promise((l,c)=>{try{const d=e(a);l(d)}catch(d){c(d)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f0(s,e={}){return is(s,"GET","/v2/passwordPolicy",rs(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0=6;class g0{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??p0,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qc(this),this.idTokenSubscription=new qc(this),this.beforeStateQueue=new m0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=kd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=jt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await zs.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ti(this,{idToken:e}),n=await rt._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Je(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,l=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===l)&&c?.user&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return W(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await si(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Qx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Je(this.app))return Promise.reject(At(this));const t=e?Ce(e):null;return t&&W(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&W(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Je(this.app)?Promise.reject(At(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Je(this.app)?Promise.reject(At(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(jt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await f0(this),t=new g0(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new tr("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await u0(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&jt(e)||this._popupRedirectResolver;W(t,this,"argument-error"),this.redirectPersistenceManager=await zs.create(this,[jt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(W(c,this,"internal-error"),c.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,n,i);return()=>{l=!0,d()}}else{const d=e.addObserver(t);return()=>{l=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return W(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Wd(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Je(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Gx(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ts(s){return Ce(s)}class qc{constructor(e){this.auth=e,this.observer=null,this.addObserver=kg(t=>this.observer=t)}get next(){return W(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ii={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function y0(s){Ii=s}function Kd(s){return Ii.loadJS(s)}function b0(){return Ii.recaptchaEnterpriseScript}function v0(){return Ii.gapiScript}function _0(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class w0{constructor(){this.enterprise=new N0}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class N0{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const E0="recaptcha-enterprise",Qd="NO_RECAPTCHA";class T0{constructor(e){this.type=E0,this.auth=Ts(e)}async verify(e="verify",t=!1){async function n(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,c)=>{s0(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const m=new t0(d);return a.tenantId==null?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,l(m.siteKey)}}).catch(d=>{c(d)})})}function i(a,l,c){const d=window.grecaptcha;Lc(d)?d.enterprise.ready(()=>{d.enterprise.execute(a,{action:e}).then(m=>{l(m)}).catch(()=>{l(Qd)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new w0().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{n(this.auth).then(c=>{if(!t&&Lc(window.grecaptcha))i(c,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let d=b0();d.length!==0&&(d+=c),Kd(d).then(()=>{i(c,a,l)}).catch(m=>{l(m)})}}).catch(c=>{l(c)})})}}async function zc(s,e,t,n=!1,i=!1){const a=new T0(s);let l;if(i)l=Qd;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const d=c.phoneEnrollmentInfo.phoneNumber,m=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:m,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const d=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Xa(s,e,t,n,i){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await zc(s,e,t,t==="getOobCode");return n(s,a)}else return n(s,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await zc(s,e,t,t==="getOobCode");return n(s,l)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0(s,e){const t=ji(s,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(xs(a,e??{}))return i;at(i,"already-initialized")}return t.initialize({options:e})}function I0(s,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(jt);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(n,e?.popupRedirectResolver)}function A0(s,e,t){const n=Ts(s);W(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=Xd(e),{host:l,port:c}=S0(e),d=c===null?"":`:${c}`,m={url:`${a}//${l}${d}/`},f=Object.freeze({host:l,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){W(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),W(xs(m,n.config.emulator)&&xs(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=m,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,ns(l)?(_o(`${a}//${l}${d}`),wo("Auth",!0)):R0()}function Xd(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function S0(s){const e=Xd(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:$c(n.substr(a.length+1))}}else{const[a,l]=n.split(":");return{host:a,port:$c(l)}}}function $c(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function R0(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Tt("not implemented")}_getIdTokenResponse(e){return Tt("not implemented")}_linkToIdToken(e,t){return Tt("not implemented")}_getReauthenticationResolver(e){return Tt("not implemented")}}async function C0(s,e){return is(s,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k0(s,e){return rr(s,"POST","/v1/accounts:signInWithPassword",rs(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P0(s,e){return rr(s,"POST","/v1/accounts:signInWithEmailLink",rs(s,e))}async function D0(s,e){return rr(s,"POST","/v1/accounts:signInWithEmailLink",rs(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n extends Ro{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new $n(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new $n(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xa(e,t,"signInWithPassword",k0);case"emailLink":return P0(e,{email:this._email,oobCode:this._password});default:at(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xa(e,n,"signUpPassword",C0);case"emailLink":return D0(e,{idToken:t,email:this._email,oobCode:this._password});default:at(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $s(s,e){return rr(s,"POST","/v1/accounts:signInWithIdp",rs(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O0="http://localhost";class bs extends Ro{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new bs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):at("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...a}=t;if(!n||!i)return null;const l=new bs(n,i);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return $s(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,$s(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$s(e,t)}buildRequest(){const e={requestUri:O0,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=sr(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function L0(s){const e=Nn(En(s)).link,t=e?Nn(En(e)).deep_link_id:null,n=Nn(En(s)).deep_link_id;return(n?Nn(En(n)).link:null)||n||t||e||s}class Co{constructor(e){const t=Nn(En(e)),n=t.apiKey??null,i=t.oobCode??null,a=V0(t.mode??null);W(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=L0(e);try{return new Co(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(){this.providerId=sn.PROVIDER_ID}static credential(e,t){return $n._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Co.parseLink(t);return W(n,"argument-error"),$n._fromEmailAndCode(e,n.code,n.tenantId)}}sn.PROVIDER_ID="password";sn.EMAIL_PASSWORD_SIGN_IN_METHOD="password";sn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir extends Jd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt extends ir{constructor(){super("facebook.com")}static credential(e){return bs._fromParams({providerId:Mt.PROVIDER_ID,signInMethod:Mt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mt.credentialFromTaggedObject(e)}static credentialFromError(e){return Mt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mt.credential(e.oauthAccessToken)}catch{return null}}}Mt.FACEBOOK_SIGN_IN_METHOD="facebook.com";Mt.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut extends ir{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return bs._fromParams({providerId:Ut.PROVIDER_ID,signInMethod:Ut.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ut.credentialFromTaggedObject(e)}static credentialFromError(e){return Ut.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Ut.credential(t,n)}catch{return null}}}Ut.GOOGLE_SIGN_IN_METHOD="google.com";Ut.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft extends ir{constructor(){super("github.com")}static credential(e){return bs._fromParams({providerId:Ft.PROVIDER_ID,signInMethod:Ft.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ft.credentialFromTaggedObject(e)}static credentialFromError(e){return Ft.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ft.credential(e.oauthAccessToken)}catch{return null}}}Ft.GITHUB_SIGN_IN_METHOD="github.com";Ft.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt extends ir{constructor(){super("twitter.com")}static credential(e,t){return bs._fromParams({providerId:Bt.PROVIDER_ID,signInMethod:Bt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Bt.credentialFromTaggedObject(e)}static credentialFromError(e){return Bt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Bt.credential(t,n)}catch{return null}}}Bt.TWITTER_SIGN_IN_METHOD="twitter.com";Bt.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M0(s,e){return rr(s,"POST","/v1/accounts:signUp",rs(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const a=await rt._fromIdTokenResponse(e,n,i),l=Hc(n);return new vs({user:a,providerId:l,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Hc(n);return new vs({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Hc(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni extends _t{constructor(e,t,n,i){super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,ni.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new ni(e,t,n,i)}}function Yd(s,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?ni._fromErrorAndOperation(s,a,e,n):a})}async function U0(s,e,t=!1){const n=await zn(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return vs._forOperation(s,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F0(s,e,t=!1){const{auth:n}=s;if(Je(n.app))return Promise.reject(At(n));const i="reauthenticate";try{const a=await zn(s,Yd(n,i,e,s),t);W(a.idToken,n,"internal-error");const l=Ao(a.idToken);W(l,n,"internal-error");const{sub:c}=l;return W(s.uid===c,n,"user-mismatch"),vs._forOperation(s,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&at(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zd(s,e,t=!1){if(Je(s.app))return Promise.reject(At(s));const n="signIn",i=await Yd(s,n,e),a=await vs._fromIdTokenResponse(s,n,i);return t||await s._updateCurrentUser(a.user),a}async function B0(s,e){return Zd(Ts(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eh(s){const e=Ts(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function q0(s,e,t){if(Je(s.app))return Promise.reject(At(s));const n=Ts(s),l=await Xa(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",M0).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&eh(s),d}),c=await vs._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(c.user),c}function z0(s,e,t){return Je(s.app)?Promise.reject(At(s)):B0(Ce(s),sn.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&eh(s),n})}function $0(s,e,t,n){return Ce(s).onIdTokenChanged(e,t,n)}function H0(s,e,t){return Ce(s).beforeAuthStateChanged(e,t)}function G0(s){return Ce(s).signOut()}const ri="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ri,"1"),this.storage.removeItem(ri),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0=1e3,K0=10;class sh extends th{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Gd(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,d)=>{this.notifyListeners(l,d)});return}const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(n);!t&&this.localCache[n]===l||this.notifyListeners(n,l)},a=this.storage.getItem(n);h0()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,K0):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},W0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}sh.type="LOCAL";const Q0=sh;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh extends th{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}nh.type="SESSION";const rh=nh;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const n=new Ai(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:a}=t.data,l=this.handlersMap[i];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(l).map(async m=>m(t.origin,a)),d=await X0(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ai.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ko(s="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,l;return new Promise((c,d)=>{const m=ko("",20);i.port1.start();const f=setTimeout(()=>{d(new Error("unsupported_event"))},n);l={messageChannel:i,onMessage(g){const y=g;if(y.data.eventId===m)switch(y.data.status){case"ack":clearTimeout(f),a=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(y.data.response);break;default:clearTimeout(f),clearTimeout(a),d(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(){return window}function Y0(s){mt().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(){return typeof mt().WorkerGlobalScope<"u"&&typeof mt().importScripts=="function"}async function Z0(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ey(){return navigator?.serviceWorker?.controller||null}function ty(){return ih()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah="firebaseLocalStorageDb",sy=1,ii="firebaseLocalStorage",oh="fbase_key";class ar{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Si(s,e){return s.transaction([ii],e?"readwrite":"readonly").objectStore(ii)}function ny(){const s=indexedDB.deleteDatabase(ah);return new ar(s).toPromise()}function Ja(){const s=indexedDB.open(ah,sy);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const n=s.result;try{n.createObjectStore(ii,{keyPath:oh})}catch(i){t(i)}}),s.addEventListener("success",async()=>{const n=s.result;n.objectStoreNames.contains(ii)?e(n):(n.close(),await ny(),e(await Ja()))})})}async function Gc(s,e,t){const n=Si(s,!0).put({[oh]:e,value:t});return new ar(n).toPromise()}async function ry(s,e){const t=Si(s,!1).get(e),n=await new ar(t).toPromise();return n===void 0?null:n.value}function Wc(s,e){const t=Si(s,!0).delete(e);return new ar(t).toPromise()}const iy=800,ay=3;class lh{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ja(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>ay)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ih()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ai._getInstance(ty()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Z0(),!this.activeServiceWorker)return;this.sender=new J0(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ey()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ja();return await Gc(e,ri,"1"),await Wc(e,ri),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Gc(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>ry(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Wc(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Si(i,!1).getAll();return new ar(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),iy)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}lh.type="LOCAL";const oy=lh;new nr(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ly(s,e){return e?jt(e):(W(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po extends Ro{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $s(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $s(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $s(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function cy(s){return Zd(s.auth,new Po(s),s.bypassAuthState)}function uy(s){const{auth:e,user:t}=s;return W(t,e,"internal-error"),F0(t,new Po(s),s.bypassAuthState)}async function dy(s){const{auth:e,user:t}=s;return W(t,e,"internal-error"),U0(t,new Po(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e,t,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:a,error:l,type:c}=e;if(l){this.reject(l);return}const d={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(d))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return cy;case"linkViaPopup":case"linkViaRedirect":return dy;case"reauthViaPopup":case"reauthViaRedirect":return uy;default:at(this.auth,"internal-error")}}resolve(e){Ct(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ct(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hy=new nr(2e3,1e4);class Fs extends ch{constructor(e,t,n,i,a){super(e,t,i,a),this.provider=n,this.authWindow=null,this.pollId=null,Fs.currentPopupAction&&Fs.currentPopupAction.cancel(),Fs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return W(e,this.auth,"internal-error"),e}async onExecution(){Ct(this.filter.length===1,"Popup operations only handle one event");const e=ko();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ht(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ht(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fs.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ht(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,hy.get())};e()}}Fs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my="pendingRedirect",zr=new Map;class fy extends ch{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=zr.get(this.auth._key());if(!e){try{const n=await py(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}zr.set(this.auth._key(),e)}return this.bypassAuthState||zr.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function py(s,e){const t=yy(e),n=xy(s);if(!await n._isAvailable())return!1;const i=await n._get(t)==="true";return await n._remove(t),i}function gy(s,e){zr.set(s._key(),e)}function xy(s){return jt(s._redirectPersistence)}function yy(s){return qr(my,s.config.apiKey,s.name)}async function by(s,e,t=!1){if(Je(s.app))return Promise.reject(At(s));const n=Ts(s),i=ly(n,e),l=await new fy(n,i,t).execute();return l&&!t&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy=10*60*1e3;class _y{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wy(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!uh(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ht(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vy&&this.cachedEventUids.clear(),this.cachedEventUids.has(Kc(e))}saveEventToCache(e){this.cachedEventUids.add(Kc(e)),this.lastProcessedEventTime=Date.now()}}function Kc(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function uh({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function wy(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return uh(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ny(s,e={}){return is(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ey=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ty=/^https?/;async function jy(s){if(s.config.emulator)return;const{authorizedDomains:e}=await Ny(s);for(const t of e)try{if(Iy(t))return}catch{}at(s,"unauthorized-domain")}function Iy(s){const e=Ka(),{protocol:t,hostname:n}=new URL(e);if(s.startsWith("chrome-extension://")){const l=new URL(s);return l.hostname===""&&n===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===n}if(!Ty.test(t))return!1;if(Ey.test(s))return n===s;const i=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay=new nr(3e4,6e4);function Qc(){const s=mt().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function Sy(s){return new Promise((e,t)=>{function n(){Qc(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Qc(),t(ht(s,"network-request-failed"))},timeout:Ay.get()})}if(mt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(mt().gapi?.load)n();else{const i=_0("iframefcb");return mt()[i]=()=>{gapi.load?n():t(ht(s,"network-request-failed"))},Kd(`${v0()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw $r=null,e})}let $r=null;function Ry(s){return $r=$r||Sy(s),$r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy=new nr(5e3,15e3),ky="__/auth/iframe",Py="emulator/auth/iframe",Dy={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Oy=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Vy(s){const e=s.config;W(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?Io(e,Py):`https://${s.config.authDomain}/${ky}`,n={apiKey:e.apiKey,appName:s.name,v:Es},i=Oy.get(s.config.apiHost);i&&(n.eid=i);const a=s._getFrameworks();return a.length&&(n.fw=a.join(",")),`${t}?${sr(n).slice(1)}`}async function Ly(s){const e=await Ry(s),t=mt().gapi;return W(t,s,"internal-error"),e.open({where:document.body,url:Vy(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Dy,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const l=ht(s,"network-request-failed"),c=mt().setTimeout(()=>{a(l)},Cy.get());function d(){mt().clearTimeout(c),i(n)}n.ping(d).then(d,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Uy=500,Fy=600,By="_blank",qy="http://localhost";class Xc{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zy(s,e,t,n=Uy,i=Fy){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const d={...My,width:n.toString(),height:i.toString(),top:a,left:l},m=Be().toLowerCase();t&&(c=Bd(m)?By:t),Ud(m)&&(e=e||qy,d.scrollbars="yes");const f=Object.entries(d).reduce((y,[T,k])=>`${y}${T}=${k},`,"");if(d0(m)&&c!=="_self")return $y(e||"",c),new Xc(null);const g=window.open(e||"",c,f);W(g,s,"popup-blocked");try{g.focus()}catch{}return new Xc(g)}function $y(s,e){const t=document.createElement("a");t.href=s,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="__/auth/handler",Gy="emulator/auth/handler",Wy=encodeURIComponent("fac");async function Jc(s,e,t,n,i,a){W(s.config.authDomain,s,"auth-domain-config-required"),W(s.config.apiKey,s,"invalid-api-key");const l={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:n,v:Es,eventId:i};if(e instanceof Jd){e.setDefaultLanguage(s.languageCode),l.providerId=e.providerId||"",Cg(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,g]of Object.entries({}))l[f]=g}if(e instanceof ir){const f=e.getScopes().filter(g=>g!=="");f.length>0&&(l.scopes=f.join(","))}s.tenantId&&(l.tid=s.tenantId);const c=l;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const d=await s._getAppCheckToken(),m=d?`#${Wy}=${encodeURIComponent(d)}`:"";return`${Ky(s)}?${sr(c).slice(1)}${m}`}function Ky({config:s}){return s.emulator?Io(s,Gy):`https://${s.authDomain}/${Hy}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea="webStorageSupport";class Qy{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rh,this._completeRedirectFn=by,this._overrideRedirectResult=gy}async _openPopup(e,t,n,i){Ct(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await Jc(e,t,n,Ka(),i);return zy(e,a,ko())}async _openRedirect(e,t,n,i){await this._originValidation(e);const a=await Jc(e,t,n,Ka(),i);return Y0(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Ct(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Ly(e),n=new _y(e);return t.register("authEvent",i=>(W(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ea,{type:Ea},i=>{const a=i?.[0]?.[Ea];a!==void 0&&t(!!a),at(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=jy(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Gd()||Fd()||So()}}const Xy=Qy;var Yc="@firebase/auth",Zc="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){W(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yy(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Zy(s){ys(new Xt("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=n.options;W(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:l,authDomain:c,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Wd(s)},m=new x0(n,i,a,d);return I0(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ys(new Xt("auth-internal",e=>{const t=Ts(e.getProvider("auth").getImmediate());return(n=>new Jy(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),dt(Yc,Zc,Yy(s)),dt(Yc,Zc,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb=5*60,tb=Ed("authIdTokenMaxAge")||eb;let eu=null;const sb=s=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>tb)return;const i=t?.token;eu!==i&&(eu=i,await fetch(s,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function nb(s=To()){const e=ji(s,"auth");if(e.isInitialized())return e.getImmediate();const t=j0(s,{popupRedirectResolver:Xy,persistence:[oy,Q0,rh]}),n=Ed("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const l=sb(a.toString());H0(t,l,()=>l(t.currentUser)),$0(t,c=>l(c))}}const i=_d("auth");return i&&A0(t,`http://${i}`),t}function rb(){return document.getElementsByTagName("head")?.[0]??document}y0({loadJS(s){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",s),n.onload=e,n.onerror=i=>{const a=ht("internal-error");a.customData=i,t(a)},n.type="text/javascript",n.charset="UTF-8",rb().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Zy("Browser");var tu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gt,dh;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,p){function b(){}b.prototype=p.prototype,v.D=p.prototype,v.prototype=new b,v.prototype.constructor=v,v.C=function(w,E,j){for(var _=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)_[Ke-2]=arguments[Ke];return p.prototype[E].apply(w,_)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,p,b){b||(b=0);var w=Array(16);if(typeof p=="string")for(var E=0;16>E;++E)w[E]=p.charCodeAt(b++)|p.charCodeAt(b++)<<8|p.charCodeAt(b++)<<16|p.charCodeAt(b++)<<24;else for(E=0;16>E;++E)w[E]=p[b++]|p[b++]<<8|p[b++]<<16|p[b++]<<24;p=v.g[0],b=v.g[1],E=v.g[2];var j=v.g[3],_=p+(j^b&(E^j))+w[0]+3614090360&4294967295;p=b+(_<<7&4294967295|_>>>25),_=j+(E^p&(b^E))+w[1]+3905402710&4294967295,j=p+(_<<12&4294967295|_>>>20),_=E+(b^j&(p^b))+w[2]+606105819&4294967295,E=j+(_<<17&4294967295|_>>>15),_=b+(p^E&(j^p))+w[3]+3250441966&4294967295,b=E+(_<<22&4294967295|_>>>10),_=p+(j^b&(E^j))+w[4]+4118548399&4294967295,p=b+(_<<7&4294967295|_>>>25),_=j+(E^p&(b^E))+w[5]+1200080426&4294967295,j=p+(_<<12&4294967295|_>>>20),_=E+(b^j&(p^b))+w[6]+2821735955&4294967295,E=j+(_<<17&4294967295|_>>>15),_=b+(p^E&(j^p))+w[7]+4249261313&4294967295,b=E+(_<<22&4294967295|_>>>10),_=p+(j^b&(E^j))+w[8]+1770035416&4294967295,p=b+(_<<7&4294967295|_>>>25),_=j+(E^p&(b^E))+w[9]+2336552879&4294967295,j=p+(_<<12&4294967295|_>>>20),_=E+(b^j&(p^b))+w[10]+4294925233&4294967295,E=j+(_<<17&4294967295|_>>>15),_=b+(p^E&(j^p))+w[11]+2304563134&4294967295,b=E+(_<<22&4294967295|_>>>10),_=p+(j^b&(E^j))+w[12]+1804603682&4294967295,p=b+(_<<7&4294967295|_>>>25),_=j+(E^p&(b^E))+w[13]+4254626195&4294967295,j=p+(_<<12&4294967295|_>>>20),_=E+(b^j&(p^b))+w[14]+2792965006&4294967295,E=j+(_<<17&4294967295|_>>>15),_=b+(p^E&(j^p))+w[15]+1236535329&4294967295,b=E+(_<<22&4294967295|_>>>10),_=p+(E^j&(b^E))+w[1]+4129170786&4294967295,p=b+(_<<5&4294967295|_>>>27),_=j+(b^E&(p^b))+w[6]+3225465664&4294967295,j=p+(_<<9&4294967295|_>>>23),_=E+(p^b&(j^p))+w[11]+643717713&4294967295,E=j+(_<<14&4294967295|_>>>18),_=b+(j^p&(E^j))+w[0]+3921069994&4294967295,b=E+(_<<20&4294967295|_>>>12),_=p+(E^j&(b^E))+w[5]+3593408605&4294967295,p=b+(_<<5&4294967295|_>>>27),_=j+(b^E&(p^b))+w[10]+38016083&4294967295,j=p+(_<<9&4294967295|_>>>23),_=E+(p^b&(j^p))+w[15]+3634488961&4294967295,E=j+(_<<14&4294967295|_>>>18),_=b+(j^p&(E^j))+w[4]+3889429448&4294967295,b=E+(_<<20&4294967295|_>>>12),_=p+(E^j&(b^E))+w[9]+568446438&4294967295,p=b+(_<<5&4294967295|_>>>27),_=j+(b^E&(p^b))+w[14]+3275163606&4294967295,j=p+(_<<9&4294967295|_>>>23),_=E+(p^b&(j^p))+w[3]+4107603335&4294967295,E=j+(_<<14&4294967295|_>>>18),_=b+(j^p&(E^j))+w[8]+1163531501&4294967295,b=E+(_<<20&4294967295|_>>>12),_=p+(E^j&(b^E))+w[13]+2850285829&4294967295,p=b+(_<<5&4294967295|_>>>27),_=j+(b^E&(p^b))+w[2]+4243563512&4294967295,j=p+(_<<9&4294967295|_>>>23),_=E+(p^b&(j^p))+w[7]+1735328473&4294967295,E=j+(_<<14&4294967295|_>>>18),_=b+(j^p&(E^j))+w[12]+2368359562&4294967295,b=E+(_<<20&4294967295|_>>>12),_=p+(b^E^j)+w[5]+4294588738&4294967295,p=b+(_<<4&4294967295|_>>>28),_=j+(p^b^E)+w[8]+2272392833&4294967295,j=p+(_<<11&4294967295|_>>>21),_=E+(j^p^b)+w[11]+1839030562&4294967295,E=j+(_<<16&4294967295|_>>>16),_=b+(E^j^p)+w[14]+4259657740&4294967295,b=E+(_<<23&4294967295|_>>>9),_=p+(b^E^j)+w[1]+2763975236&4294967295,p=b+(_<<4&4294967295|_>>>28),_=j+(p^b^E)+w[4]+1272893353&4294967295,j=p+(_<<11&4294967295|_>>>21),_=E+(j^p^b)+w[7]+4139469664&4294967295,E=j+(_<<16&4294967295|_>>>16),_=b+(E^j^p)+w[10]+3200236656&4294967295,b=E+(_<<23&4294967295|_>>>9),_=p+(b^E^j)+w[13]+681279174&4294967295,p=b+(_<<4&4294967295|_>>>28),_=j+(p^b^E)+w[0]+3936430074&4294967295,j=p+(_<<11&4294967295|_>>>21),_=E+(j^p^b)+w[3]+3572445317&4294967295,E=j+(_<<16&4294967295|_>>>16),_=b+(E^j^p)+w[6]+76029189&4294967295,b=E+(_<<23&4294967295|_>>>9),_=p+(b^E^j)+w[9]+3654602809&4294967295,p=b+(_<<4&4294967295|_>>>28),_=j+(p^b^E)+w[12]+3873151461&4294967295,j=p+(_<<11&4294967295|_>>>21),_=E+(j^p^b)+w[15]+530742520&4294967295,E=j+(_<<16&4294967295|_>>>16),_=b+(E^j^p)+w[2]+3299628645&4294967295,b=E+(_<<23&4294967295|_>>>9),_=p+(E^(b|~j))+w[0]+4096336452&4294967295,p=b+(_<<6&4294967295|_>>>26),_=j+(b^(p|~E))+w[7]+1126891415&4294967295,j=p+(_<<10&4294967295|_>>>22),_=E+(p^(j|~b))+w[14]+2878612391&4294967295,E=j+(_<<15&4294967295|_>>>17),_=b+(j^(E|~p))+w[5]+4237533241&4294967295,b=E+(_<<21&4294967295|_>>>11),_=p+(E^(b|~j))+w[12]+1700485571&4294967295,p=b+(_<<6&4294967295|_>>>26),_=j+(b^(p|~E))+w[3]+2399980690&4294967295,j=p+(_<<10&4294967295|_>>>22),_=E+(p^(j|~b))+w[10]+4293915773&4294967295,E=j+(_<<15&4294967295|_>>>17),_=b+(j^(E|~p))+w[1]+2240044497&4294967295,b=E+(_<<21&4294967295|_>>>11),_=p+(E^(b|~j))+w[8]+1873313359&4294967295,p=b+(_<<6&4294967295|_>>>26),_=j+(b^(p|~E))+w[15]+4264355552&4294967295,j=p+(_<<10&4294967295|_>>>22),_=E+(p^(j|~b))+w[6]+2734768916&4294967295,E=j+(_<<15&4294967295|_>>>17),_=b+(j^(E|~p))+w[13]+1309151649&4294967295,b=E+(_<<21&4294967295|_>>>11),_=p+(E^(b|~j))+w[4]+4149444226&4294967295,p=b+(_<<6&4294967295|_>>>26),_=j+(b^(p|~E))+w[11]+3174756917&4294967295,j=p+(_<<10&4294967295|_>>>22),_=E+(p^(j|~b))+w[2]+718787259&4294967295,E=j+(_<<15&4294967295|_>>>17),_=b+(j^(E|~p))+w[9]+3951481745&4294967295,v.g[0]=v.g[0]+p&4294967295,v.g[1]=v.g[1]+(E+(_<<21&4294967295|_>>>11))&4294967295,v.g[2]=v.g[2]+E&4294967295,v.g[3]=v.g[3]+j&4294967295}n.prototype.u=function(v,p){p===void 0&&(p=v.length);for(var b=p-this.blockSize,w=this.B,E=this.h,j=0;j<p;){if(E==0)for(;j<=b;)i(this,v,j),j+=this.blockSize;if(typeof v=="string"){for(;j<p;)if(w[E++]=v.charCodeAt(j++),E==this.blockSize){i(this,w),E=0;break}}else for(;j<p;)if(w[E++]=v[j++],E==this.blockSize){i(this,w),E=0;break}}this.h=E,this.o+=p},n.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var p=1;p<v.length-8;++p)v[p]=0;var b=8*this.o;for(p=v.length-8;p<v.length;++p)v[p]=b&255,b/=256;for(this.u(v),v=Array(16),p=b=0;4>p;++p)for(var w=0;32>w;w+=8)v[b++]=this.g[p]>>>w&255;return v};function a(v,p){var b=c;return Object.prototype.hasOwnProperty.call(b,v)?b[v]:b[v]=p(v)}function l(v,p){this.h=p;for(var b=[],w=!0,E=v.length-1;0<=E;E--){var j=v[E]|0;w&&j==p||(b[E]=j,w=!1)}this.g=b}var c={};function d(v){return-128<=v&&128>v?a(v,function(p){return new l([p|0],0>p?-1:0)}):new l([v|0],0>v?-1:0)}function m(v){if(isNaN(v)||!isFinite(v))return g;if(0>v)return N(m(-v));for(var p=[],b=1,w=0;v>=b;w++)p[w]=v/b|0,b*=4294967296;return new l(p,0)}function f(v,p){if(v.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(v.charAt(0)=="-")return N(f(v.substring(1),p));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=m(Math.pow(p,8)),w=g,E=0;E<v.length;E+=8){var j=Math.min(8,v.length-E),_=parseInt(v.substring(E,E+j),p);8>j?(j=m(Math.pow(p,j)),w=w.j(j).add(m(_))):(w=w.j(b),w=w.add(m(_)))}return w}var g=d(0),y=d(1),T=d(16777216);s=l.prototype,s.m=function(){if(C(this))return-N(this).m();for(var v=0,p=1,b=0;b<this.g.length;b++){var w=this.i(b);v+=(0<=w?w:4294967296+w)*p,p*=4294967296}return v},s.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(k(this))return"0";if(C(this))return"-"+N(this).toString(v);for(var p=m(Math.pow(v,6)),b=this,w="";;){var E=O(b,p).g;b=A(b,E.j(p));var j=((0<b.g.length?b.g[0]:b.h)>>>0).toString(v);if(b=E,k(b))return j+w;for(;6>j.length;)j="0"+j;w=j+w}},s.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function k(v){if(v.h!=0)return!1;for(var p=0;p<v.g.length;p++)if(v.g[p]!=0)return!1;return!0}function C(v){return v.h==-1}s.l=function(v){return v=A(this,v),C(v)?-1:k(v)?0:1};function N(v){for(var p=v.g.length,b=[],w=0;w<p;w++)b[w]=~v.g[w];return new l(b,~v.h).add(y)}s.abs=function(){return C(this)?N(this):this},s.add=function(v){for(var p=Math.max(this.g.length,v.g.length),b=[],w=0,E=0;E<=p;E++){var j=w+(this.i(E)&65535)+(v.i(E)&65535),_=(j>>>16)+(this.i(E)>>>16)+(v.i(E)>>>16);w=_>>>16,j&=65535,_&=65535,b[E]=_<<16|j}return new l(b,b[b.length-1]&-2147483648?-1:0)};function A(v,p){return v.add(N(p))}s.j=function(v){if(k(this)||k(v))return g;if(C(this))return C(v)?N(this).j(N(v)):N(N(this).j(v));if(C(v))return N(this.j(N(v)));if(0>this.l(T)&&0>v.l(T))return m(this.m()*v.m());for(var p=this.g.length+v.g.length,b=[],w=0;w<2*p;w++)b[w]=0;for(w=0;w<this.g.length;w++)for(var E=0;E<v.g.length;E++){var j=this.i(w)>>>16,_=this.i(w)&65535,Ke=v.i(E)>>>16,ot=v.i(E)&65535;b[2*w+2*E]+=_*ot,I(b,2*w+2*E),b[2*w+2*E+1]+=j*ot,I(b,2*w+2*E+1),b[2*w+2*E+1]+=_*Ke,I(b,2*w+2*E+1),b[2*w+2*E+2]+=j*Ke,I(b,2*w+2*E+2)}for(w=0;w<p;w++)b[w]=b[2*w+1]<<16|b[2*w];for(w=p;w<2*p;w++)b[w]=0;return new l(b,0)};function I(v,p){for(;(v[p]&65535)!=v[p];)v[p+1]+=v[p]>>>16,v[p]&=65535,p++}function S(v,p){this.g=v,this.h=p}function O(v,p){if(k(p))throw Error("division by zero");if(k(v))return new S(g,g);if(C(v))return p=O(N(v),p),new S(N(p.g),N(p.h));if(C(p))return p=O(v,N(p)),new S(N(p.g),p.h);if(30<v.g.length){if(C(v)||C(p))throw Error("slowDivide_ only works with positive integers.");for(var b=y,w=p;0>=w.l(v);)b=P(b),w=P(w);var E=L(b,1),j=L(w,1);for(w=L(w,2),b=L(b,2);!k(w);){var _=j.add(w);0>=_.l(v)&&(E=E.add(b),j=_),w=L(w,1),b=L(b,1)}return p=A(v,E.j(p)),new S(E,p)}for(E=g;0<=v.l(p);){for(b=Math.max(1,Math.floor(v.m()/p.m())),w=Math.ceil(Math.log(b)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),j=m(b),_=j.j(p);C(_)||0<_.l(v);)b-=w,j=m(b),_=j.j(p);k(j)&&(j=y),E=E.add(j),v=A(v,_)}return new S(E,v)}s.A=function(v){return O(this,v).h},s.and=function(v){for(var p=Math.max(this.g.length,v.g.length),b=[],w=0;w<p;w++)b[w]=this.i(w)&v.i(w);return new l(b,this.h&v.h)},s.or=function(v){for(var p=Math.max(this.g.length,v.g.length),b=[],w=0;w<p;w++)b[w]=this.i(w)|v.i(w);return new l(b,this.h|v.h)},s.xor=function(v){for(var p=Math.max(this.g.length,v.g.length),b=[],w=0;w<p;w++)b[w]=this.i(w)^v.i(w);return new l(b,this.h^v.h)};function P(v){for(var p=v.g.length+1,b=[],w=0;w<p;w++)b[w]=v.i(w)<<1|v.i(w-1)>>>31;return new l(b,v.h)}function L(v,p){var b=p>>5;p%=32;for(var w=v.g.length-b,E=[],j=0;j<w;j++)E[j]=0<p?v.i(j+b)>>>p|v.i(j+b+1)<<32-p:v.i(j+b);return new l(E,v.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,dh=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=m,l.fromString=f,Gt=l}).apply(typeof tu<"u"?tu:typeof self<"u"?self:typeof window<"u"?window:{});var kr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hh,Tn,mh,Hr,Ya,fh,ph,gh;(function(){var s,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,h){return o==Array.prototype||o==Object.prototype||(o[u]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof kr=="object"&&kr];for(var u=0;u<o.length;++u){var h=o[u];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var n=t(this);function i(o,u){if(u)e:{var h=n;o=o.split(".");for(var x=0;x<o.length-1;x++){var R=o[x];if(!(R in h))break e;h=h[R]}o=o[o.length-1],x=h[o],u=u(x),u!=x&&u!=null&&e(h,o,{configurable:!0,writable:!0,value:u})}}function a(o,u){o instanceof String&&(o+="");var h=0,x=!1,R={next:function(){if(!x&&h<o.length){var V=h++;return{value:u(V,o[V]),done:!1}}return x=!0,{done:!0,value:void 0}}};return R[Symbol.iterator]=function(){return R},R}i("Array.prototype.values",function(o){return o||function(){return a(this,function(u,h){return h})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function d(o){var u=typeof o;return u=u!="object"?u:o?Array.isArray(o)?"array":u:"null",u=="array"||u=="object"&&typeof o.length=="number"}function m(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function f(o,u,h){return o.call.apply(o.bind,arguments)}function g(o,u,h){if(!o)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var R=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(R,x),o.apply(u,R)}}return function(){return o.apply(u,arguments)}}function y(o,u,h){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:g,y.apply(null,arguments)}function T(o,u){var h=Array.prototype.slice.call(arguments,1);return function(){var x=h.slice();return x.push.apply(x,arguments),o.apply(this,x)}}function k(o,u){function h(){}h.prototype=u.prototype,o.aa=u.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(x,R,V){for(var B=Array(arguments.length-2),le=2;le<arguments.length;le++)B[le-2]=arguments[le];return u.prototype[R].apply(x,B)}}function C(o){const u=o.length;if(0<u){const h=Array(u);for(let x=0;x<u;x++)h[x]=o[x];return h}return[]}function N(o,u){for(let h=1;h<arguments.length;h++){const x=arguments[h];if(d(x)){const R=o.length||0,V=x.length||0;o.length=R+V;for(let B=0;B<V;B++)o[R+B]=x[B]}else o.push(x)}}class A{constructor(u,h){this.i=u,this.j=h,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function I(o){return/^[\s\xa0]*$/.test(o)}function S(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function O(o){return O[" "](o),o}O[" "]=function(){};var P=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function L(o,u,h){for(const x in o)u.call(h,o[x],x,o)}function v(o,u){for(const h in o)u.call(void 0,o[h],h,o)}function p(o){const u={};for(const h in o)u[h]=o[h];return u}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(o,u){let h,x;for(let R=1;R<arguments.length;R++){x=arguments[R];for(h in x)o[h]=x[h];for(let V=0;V<b.length;V++)h=b[V],Object.prototype.hasOwnProperty.call(x,h)&&(o[h]=x[h])}}function E(o){var u=1;o=o.split(":");const h=[];for(;0<u&&o.length;)h.push(o.shift()),u--;return o.length&&h.push(o.join(":")),h}function j(o){c.setTimeout(()=>{throw o},0)}function _(){var o=xe;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class Ke{constructor(){this.h=this.g=null}add(u,h){const x=ot.get();x.set(u,h),this.h?this.h.next=x:this.g=x,this.h=x}}var ot=new A(()=>new Rs,o=>o.reset());class Rs{constructor(){this.next=this.g=this.h=null}set(u,h){this.h=u,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let F,ne=!1,xe=new Ke,ye=()=>{const o=c.Promise.resolve(void 0);F=()=>{o.then(st)}};var st=()=>{for(var o;o=_();){try{o.h.call(o.g)}catch(h){j(h)}var u=ot;u.j(o),100>u.h&&(u.h++,o.next=u.g,u.g=o)}ne=!1};function Ze(){this.s=this.s,this.C=this.C}Ze.prototype.s=!1,Ze.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ze.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Te(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}Te.prototype.h=function(){this.defaultPrevented=!0};var te=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const h=()=>{};c.addEventListener("test",h,u),c.removeEventListener("test",h,u)}catch{}return o}();function Ge(o,u){if(Te.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,x=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget){if(P){e:{try{O(u.nodeName);var R=!0;break e}catch{}R=!1}R||(u=null)}}else h=="mouseover"?u=o.fromElement:h=="mouseout"&&(u=o.toElement);this.relatedTarget=u,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:Hi[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Ge.aa.h.call(this)}}k(Ge,Te);var Hi={2:"touch",3:"pen",4:"mouse"};Ge.prototype.h=function(){Ge.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Cs="closure_listenable_"+(1e6*Math.random()|0),Gi=0;function hf(o,u,h,x,R){this.listener=o,this.proxy=null,this.src=u,this.type=h,this.capture=!!x,this.ha=R,this.key=++Gi,this.da=this.fa=!1}function hr(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function mr(o){this.src=o,this.g={},this.h=0}mr.prototype.add=function(o,u,h,x,R){var V=o.toString();o=this.g[V],o||(o=this.g[V]=[],this.h++);var B=Ki(o,u,x,R);return-1<B?(u=o[B],h||(u.fa=!1)):(u=new hf(u,this.src,V,!!x,R),u.fa=h,o.push(u)),u};function Wi(o,u){var h=u.type;if(h in o.g){var x=o.g[h],R=Array.prototype.indexOf.call(x,u,void 0),V;(V=0<=R)&&Array.prototype.splice.call(x,R,1),V&&(hr(u),o.g[h].length==0&&(delete o.g[h],o.h--))}}function Ki(o,u,h,x){for(var R=0;R<o.length;++R){var V=o[R];if(!V.da&&V.listener==u&&V.capture==!!h&&V.ha==x)return R}return-1}var Qi="closure_lm_"+(1e6*Math.random()|0),Xi={};function pl(o,u,h,x,R){if(Array.isArray(u)){for(var V=0;V<u.length;V++)pl(o,u[V],h,x,R);return null}return h=yl(h),o&&o[Cs]?o.K(u,h,m(x)?!!x.capture:!1,R):mf(o,u,h,!1,x,R)}function mf(o,u,h,x,R,V){if(!u)throw Error("Invalid event type");var B=m(R)?!!R.capture:!!R,le=Yi(o);if(le||(o[Qi]=le=new mr(o)),h=le.add(u,h,x,B,V),h.proxy)return h;if(x=ff(),h.proxy=x,x.src=o,x.listener=h,o.addEventListener)te||(R=B),R===void 0&&(R=!1),o.addEventListener(u.toString(),x,R);else if(o.attachEvent)o.attachEvent(xl(u.toString()),x);else if(o.addListener&&o.removeListener)o.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return h}function ff(){function o(h){return u.call(o.src,o.listener,h)}const u=pf;return o}function gl(o,u,h,x,R){if(Array.isArray(u))for(var V=0;V<u.length;V++)gl(o,u[V],h,x,R);else x=m(x)?!!x.capture:!!x,h=yl(h),o&&o[Cs]?(o=o.i,u=String(u).toString(),u in o.g&&(V=o.g[u],h=Ki(V,h,x,R),-1<h&&(hr(V[h]),Array.prototype.splice.call(V,h,1),V.length==0&&(delete o.g[u],o.h--)))):o&&(o=Yi(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Ki(u,h,x,R)),(h=-1<o?u[o]:null)&&Ji(h))}function Ji(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Cs])Wi(u.i,o);else{var h=o.type,x=o.proxy;u.removeEventListener?u.removeEventListener(h,x,o.capture):u.detachEvent?u.detachEvent(xl(h),x):u.addListener&&u.removeListener&&u.removeListener(x),(h=Yi(u))?(Wi(h,o),h.h==0&&(h.src=null,u[Qi]=null)):hr(o)}}}function xl(o){return o in Xi?Xi[o]:Xi[o]="on"+o}function pf(o,u){if(o.da)o=!0;else{u=new Ge(u,this);var h=o.listener,x=o.ha||o.src;o.fa&&Ji(o),o=h.call(x,u)}return o}function Yi(o){return o=o[Qi],o instanceof mr?o:null}var Zi="__closure_events_fn_"+(1e9*Math.random()>>>0);function yl(o){return typeof o=="function"?o:(o[Zi]||(o[Zi]=function(u){return o.handleEvent(u)}),o[Zi])}function Pe(){Ze.call(this),this.i=new mr(this),this.M=this,this.F=null}k(Pe,Ze),Pe.prototype[Cs]=!0,Pe.prototype.removeEventListener=function(o,u,h,x){gl(this,o,u,h,x)};function qe(o,u){var h,x=o.F;if(x)for(h=[];x;x=x.F)h.push(x);if(o=o.M,x=u.type||u,typeof u=="string")u=new Te(u,o);else if(u instanceof Te)u.target=u.target||o;else{var R=u;u=new Te(x,o),w(u,R)}if(R=!0,h)for(var V=h.length-1;0<=V;V--){var B=u.g=h[V];R=fr(B,x,!0,u)&&R}if(B=u.g=o,R=fr(B,x,!0,u)&&R,R=fr(B,x,!1,u)&&R,h)for(V=0;V<h.length;V++)B=u.g=h[V],R=fr(B,x,!1,u)&&R}Pe.prototype.N=function(){if(Pe.aa.N.call(this),this.i){var o=this.i,u;for(u in o.g){for(var h=o.g[u],x=0;x<h.length;x++)hr(h[x]);delete o.g[u],o.h--}}this.F=null},Pe.prototype.K=function(o,u,h,x){return this.i.add(String(o),u,!1,h,x)},Pe.prototype.L=function(o,u,h,x){return this.i.add(String(o),u,!0,h,x)};function fr(o,u,h,x){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();for(var R=!0,V=0;V<u.length;++V){var B=u[V];if(B&&!B.da&&B.capture==h){var le=B.listener,Ie=B.ha||B.src;B.fa&&Wi(o.i,B),R=le.call(Ie,x)!==!1&&R}}return R&&!x.defaultPrevented}function bl(o,u,h){if(typeof o=="function")h&&(o=y(o,h));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:c.setTimeout(o,u||0)}function vl(o){o.g=bl(()=>{o.g=null,o.i&&(o.i=!1,vl(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class gf extends Ze{constructor(u,h){super(),this.m=u,this.l=h,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:vl(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ln(o){Ze.call(this),this.h=o,this.g={}}k(ln,Ze);var _l=[];function wl(o){L(o.g,function(u,h){this.g.hasOwnProperty(h)&&Ji(u)},o),o.g={}}ln.prototype.N=function(){ln.aa.N.call(this),wl(this)},ln.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ea=c.JSON.stringify,xf=c.JSON.parse,yf=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function ta(){}ta.prototype.h=null;function Nl(o){return o.h||(o.h=o.i())}function El(){}var cn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function sa(){Te.call(this,"d")}k(sa,Te);function na(){Te.call(this,"c")}k(na,Te);var as={},Tl=null;function pr(){return Tl=Tl||new Pe}as.La="serverreachability";function jl(o){Te.call(this,as.La,o)}k(jl,Te);function un(o){const u=pr();qe(u,new jl(u))}as.STAT_EVENT="statevent";function Il(o,u){Te.call(this,as.STAT_EVENT,o),this.stat=u}k(Il,Te);function ze(o){const u=pr();qe(u,new Il(u,o))}as.Ma="timingevent";function Al(o,u){Te.call(this,as.Ma,o),this.size=u}k(Al,Te);function dn(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},u)}function hn(){this.g=!0}hn.prototype.xa=function(){this.g=!1};function bf(o,u,h,x,R,V){o.info(function(){if(o.g)if(V)for(var B="",le=V.split("&"),Ie=0;Ie<le.length;Ie++){var ie=le[Ie].split("=");if(1<ie.length){var De=ie[0];ie=ie[1];var Oe=De.split("_");B=2<=Oe.length&&Oe[1]=="type"?B+(De+"="+ie+"&"):B+(De+"=redacted&")}}else B=null;else B=V;return"XMLHTTP REQ ("+x+") [attempt "+R+"]: "+u+`
`+h+`
`+B})}function vf(o,u,h,x,R,V,B){o.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+R+"]: "+u+`
`+h+`
`+V+" "+B})}function ks(o,u,h,x){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+wf(o,h)+(x?" "+x:"")})}function _f(o,u){o.info(function(){return"TIMEOUT: "+u})}hn.prototype.info=function(){};function wf(o,u){if(!o.g)return u;if(!u)return null;try{var h=JSON.parse(u);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var x=h[o];if(!(2>x.length)){var R=x[1];if(Array.isArray(R)&&!(1>R.length)){var V=R[0];if(V!="noop"&&V!="stop"&&V!="close")for(var B=1;B<R.length;B++)R[B]=""}}}}return ea(h)}catch{return u}}var gr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Sl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ra;function xr(){}k(xr,ta),xr.prototype.g=function(){return new XMLHttpRequest},xr.prototype.i=function(){return{}},ra=new xr;function Dt(o,u,h,x){this.j=o,this.i=u,this.l=h,this.R=x||1,this.U=new ln(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Rl}function Rl(){this.i=null,this.g="",this.h=!1}var Cl={},ia={};function aa(o,u,h){o.L=1,o.v=_r(wt(u)),o.m=h,o.P=!0,kl(o,null)}function kl(o,u){o.F=Date.now(),yr(o),o.A=wt(o.v);var h=o.A,x=o.R;Array.isArray(x)||(x=[String(x)]),Gl(h.i,"t",x),o.C=0,h=o.j.J,o.h=new Rl,o.g=uc(o.j,h?u:null,!o.m),0<o.O&&(o.M=new gf(y(o.Y,o,o.g),o.O)),u=o.U,h=o.g,x=o.ca;var R="readystatechange";Array.isArray(R)||(R&&(_l[0]=R.toString()),R=_l);for(var V=0;V<R.length;V++){var B=pl(h,R[V],x||u.handleEvent,!1,u.h||u);if(!B)break;u.g[B.key]=B}u=o.H?p(o.H):{},o.m?(o.u||(o.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,u)):(o.u="GET",o.g.ea(o.A,o.u,null,u)),un(),bf(o.i,o.u,o.A,o.l,o.R,o.m)}Dt.prototype.ca=function(o){o=o.target;const u=this.M;u&&Nt(o)==3?u.j():this.Y(o)},Dt.prototype.Y=function(o){try{if(o==this.g)e:{const Oe=Nt(this.g);var u=this.g.Ba();const Os=this.g.Z();if(!(3>Oe)&&(Oe!=3||this.g&&(this.h.h||this.g.oa()||Zl(this.g)))){this.J||Oe!=4||u==7||(u==8||0>=Os?un(3):un(2)),oa(this);var h=this.g.Z();this.X=h;t:if(Pl(this)){var x=Zl(this.g);o="";var R=x.length,V=Nt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){os(this),mn(this);var B="";break t}this.h.i=new c.TextDecoder}for(u=0;u<R;u++)this.h.h=!0,o+=this.h.i.decode(x[u],{stream:!(V&&u==R-1)});x.length=0,this.h.g+=o,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=h==200,vf(this.i,this.u,this.A,this.l,this.R,Oe,h),this.o){if(this.T&&!this.K){t:{if(this.g){var le,Ie=this.g;if((le=Ie.g?Ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(le)){var ie=le;break t}}ie=null}if(h=ie)ks(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,la(this,h);else{this.o=!1,this.s=3,ze(12),os(this),mn(this);break e}}if(this.P){h=!0;let nt;for(;!this.J&&this.C<B.length;)if(nt=Nf(this,B),nt==ia){Oe==4&&(this.s=4,ze(14),h=!1),ks(this.i,this.l,null,"[Incomplete Response]");break}else if(nt==Cl){this.s=4,ze(15),ks(this.i,this.l,B,"[Invalid Chunk]"),h=!1;break}else ks(this.i,this.l,nt,null),la(this,nt);if(Pl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Oe!=4||B.length!=0||this.h.h||(this.s=1,ze(16),h=!1),this.o=this.o&&h,!h)ks(this.i,this.l,B,"[Invalid Chunked Response]"),os(this),mn(this);else if(0<B.length&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.ba&&!De.M&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),fa(De),De.M=!0,ze(11))}}else ks(this.i,this.l,B,null),la(this,B);Oe==4&&os(this),this.o&&!this.J&&(Oe==4?ac(this.j,this):(this.o=!1,yr(this)))}else Ff(this.g),h==400&&0<B.indexOf("Unknown SID")?(this.s=3,ze(12)):(this.s=0,ze(13)),os(this),mn(this)}}}catch{}finally{}};function Pl(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Nf(o,u){var h=o.C,x=u.indexOf(`
`,h);return x==-1?ia:(h=Number(u.substring(h,x)),isNaN(h)?Cl:(x+=1,x+h>u.length?ia:(u=u.slice(x,x+h),o.C=x+h,u)))}Dt.prototype.cancel=function(){this.J=!0,os(this)};function yr(o){o.S=Date.now()+o.I,Dl(o,o.I)}function Dl(o,u){if(o.B!=null)throw Error("WatchDog timer not null");o.B=dn(y(o.ba,o),u)}function oa(o){o.B&&(c.clearTimeout(o.B),o.B=null)}Dt.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(_f(this.i,this.A),this.L!=2&&(un(),ze(17)),os(this),this.s=2,mn(this)):Dl(this,this.S-o)};function mn(o){o.j.G==0||o.J||ac(o.j,o)}function os(o){oa(o);var u=o.M;u&&typeof u.ma=="function"&&u.ma(),o.M=null,wl(o.U),o.g&&(u=o.g,o.g=null,u.abort(),u.ma())}function la(o,u){try{var h=o.j;if(h.G!=0&&(h.g==o||ca(h.h,o))){if(!o.K&&ca(h.h,o)&&h.G==3){try{var x=h.Da.g.parse(u)}catch{x=null}if(Array.isArray(x)&&x.length==3){var R=x;if(R[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)Ir(h),Tr(h);else break e;ma(h),ze(18)}}else h.za=R[1],0<h.za-h.T&&37500>R[2]&&h.F&&h.v==0&&!h.C&&(h.C=dn(y(h.Za,h),6e3));if(1>=Ll(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else cs(h,11)}else if((o.K||h.g==o)&&Ir(h),!I(u))for(R=h.Da.g.parse(u),u=0;u<R.length;u++){let ie=R[u];if(h.T=ie[0],ie=ie[1],h.G==2)if(ie[0]=="c"){h.K=ie[1],h.ia=ie[2];const De=ie[3];De!=null&&(h.la=De,h.j.info("VER="+h.la));const Oe=ie[4];Oe!=null&&(h.Aa=Oe,h.j.info("SVER="+h.Aa));const Os=ie[5];Os!=null&&typeof Os=="number"&&0<Os&&(x=1.5*Os,h.L=x,h.j.info("backChannelRequestTimeoutMs_="+x)),x=h;const nt=o.g;if(nt){const Sr=nt.g?nt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sr){var V=x.h;V.g||Sr.indexOf("spdy")==-1&&Sr.indexOf("quic")==-1&&Sr.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(ua(V,V.h),V.h=null))}if(x.D){const pa=nt.g?nt.g.getResponseHeader("X-HTTP-Session-Id"):null;pa&&(x.ya=pa,ue(x.I,x.D,pa))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),x=h;var B=o;if(x.qa=cc(x,x.J?x.ia:null,x.W),B.K){Ml(x.h,B);var le=B,Ie=x.L;Ie&&(le.I=Ie),le.B&&(oa(le),yr(le)),x.g=B}else rc(x);0<h.i.length&&jr(h)}else ie[0]!="stop"&&ie[0]!="close"||cs(h,7);else h.G==3&&(ie[0]=="stop"||ie[0]=="close"?ie[0]=="stop"?cs(h,7):ha(h):ie[0]!="noop"&&h.l&&h.l.ta(ie),h.v=0)}}un(4)}catch{}}var Ef=class{constructor(o,u){this.g=o,this.map=u}};function Ol(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Vl(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Ll(o){return o.h?1:o.g?o.g.size:0}function ca(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function ua(o,u){o.g?o.g.add(u):o.h=u}function Ml(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Ol.prototype.cancel=function(){if(this.i=Ul(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Ul(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const h of o.g.values())u=u.concat(h.D);return u}return C(o.i)}function Tf(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(d(o)){for(var u=[],h=o.length,x=0;x<h;x++)u.push(o[x]);return u}u=[],h=0;for(x in o)u[h++]=o[x];return u}function jf(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(d(o)||typeof o=="string"){var u=[];o=o.length;for(var h=0;h<o;h++)u.push(h);return u}u=[],h=0;for(const x in o)u[h++]=x;return u}}}function Fl(o,u){if(o.forEach&&typeof o.forEach=="function")o.forEach(u,void 0);else if(d(o)||typeof o=="string")Array.prototype.forEach.call(o,u,void 0);else for(var h=jf(o),x=Tf(o),R=x.length,V=0;V<R;V++)u.call(void 0,x[V],h&&h[V],o)}var Bl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function If(o,u){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var x=o[h].indexOf("="),R=null;if(0<=x){var V=o[h].substring(0,x);R=o[h].substring(x+1)}else V=o[h];u(V,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function ls(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof ls){this.h=o.h,br(this,o.j),this.o=o.o,this.g=o.g,vr(this,o.s),this.l=o.l;var u=o.i,h=new gn;h.i=u.i,u.g&&(h.g=new Map(u.g),h.h=u.h),ql(this,h),this.m=o.m}else o&&(u=String(o).match(Bl))?(this.h=!1,br(this,u[1]||"",!0),this.o=fn(u[2]||""),this.g=fn(u[3]||"",!0),vr(this,u[4]),this.l=fn(u[5]||"",!0),ql(this,u[6]||"",!0),this.m=fn(u[7]||"")):(this.h=!1,this.i=new gn(null,this.h))}ls.prototype.toString=function(){var o=[],u=this.j;u&&o.push(pn(u,zl,!0),":");var h=this.g;return(h||u=="file")&&(o.push("//"),(u=this.o)&&o.push(pn(u,zl,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(pn(h,h.charAt(0)=="/"?Rf:Sf,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",pn(h,kf)),o.join("")};function wt(o){return new ls(o)}function br(o,u,h){o.j=h?fn(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function vr(o,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);o.s=u}else o.s=null}function ql(o,u,h){u instanceof gn?(o.i=u,Pf(o.i,o.h)):(h||(u=pn(u,Cf)),o.i=new gn(u,o.h))}function ue(o,u,h){o.i.set(u,h)}function _r(o){return ue(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function fn(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function pn(o,u,h){return typeof o=="string"?(o=encodeURI(o).replace(u,Af),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Af(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var zl=/[#\/\?@]/g,Sf=/[#\?:]/g,Rf=/[#\?]/g,Cf=/[#\?@]/g,kf=/#/g;function gn(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function Ot(o){o.g||(o.g=new Map,o.h=0,o.i&&If(o.i,function(u,h){o.add(decodeURIComponent(u.replace(/\+/g," ")),h)}))}s=gn.prototype,s.add=function(o,u){Ot(this),this.i=null,o=Ps(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(u),this.h+=1,this};function $l(o,u){Ot(o),u=Ps(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Hl(o,u){return Ot(o),u=Ps(o,u),o.g.has(u)}s.forEach=function(o,u){Ot(this),this.g.forEach(function(h,x){h.forEach(function(R){o.call(u,R,x,this)},this)},this)},s.na=function(){Ot(this);const o=Array.from(this.g.values()),u=Array.from(this.g.keys()),h=[];for(let x=0;x<u.length;x++){const R=o[x];for(let V=0;V<R.length;V++)h.push(u[x])}return h},s.V=function(o){Ot(this);let u=[];if(typeof o=="string")Hl(this,o)&&(u=u.concat(this.g.get(Ps(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)u=u.concat(o[h])}return u},s.set=function(o,u){return Ot(this),this.i=null,o=Ps(this,o),Hl(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},s.get=function(o,u){return o?(o=this.V(o),0<o.length?String(o[0]):u):u};function Gl(o,u,h){$l(o,u),0<h.length&&(o.i=null,o.g.set(Ps(o,u),C(h)),o.h+=h.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(var h=0;h<u.length;h++){var x=u[h];const V=encodeURIComponent(String(x)),B=this.V(x);for(x=0;x<B.length;x++){var R=V;B[x]!==""&&(R+="="+encodeURIComponent(String(B[x]))),o.push(R)}}return this.i=o.join("&")};function Ps(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function Pf(o,u){u&&!o.j&&(Ot(o),o.i=null,o.g.forEach(function(h,x){var R=x.toLowerCase();x!=R&&($l(this,x),Gl(this,R,h))},o)),o.j=u}function Df(o,u){const h=new hn;if(c.Image){const x=new Image;x.onload=T(Vt,h,"TestLoadImage: loaded",!0,u,x),x.onerror=T(Vt,h,"TestLoadImage: error",!1,u,x),x.onabort=T(Vt,h,"TestLoadImage: abort",!1,u,x),x.ontimeout=T(Vt,h,"TestLoadImage: timeout",!1,u,x),c.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=o}else u(!1)}function Of(o,u){const h=new hn,x=new AbortController,R=setTimeout(()=>{x.abort(),Vt(h,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:x.signal}).then(V=>{clearTimeout(R),V.ok?Vt(h,"TestPingServer: ok",!0,u):Vt(h,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(R),Vt(h,"TestPingServer: error",!1,u)})}function Vt(o,u,h,x,R){try{R&&(R.onload=null,R.onerror=null,R.onabort=null,R.ontimeout=null),x(h)}catch{}}function Vf(){this.g=new yf}function Lf(o,u,h){const x=h||"";try{Fl(o,function(R,V){let B=R;m(R)&&(B=ea(R)),u.push(x+V+"="+encodeURIComponent(B))})}catch(R){throw u.push(x+"type="+encodeURIComponent("_badmap")),R}}function wr(o){this.l=o.Ub||null,this.j=o.eb||!1}k(wr,ta),wr.prototype.g=function(){return new Nr(this.l,this.j)},wr.prototype.i=function(o){return function(){return o}}({});function Nr(o,u){Pe.call(this),this.D=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(Nr,Pe),s=Nr.prototype,s.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=u,this.readyState=1,yn(this)},s.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(u.body=o),(this.D||c).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xn(this)),this.readyState=0},s.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,yn(this)),this.g&&(this.readyState=3,yn(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Wl(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Wl(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}s.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?xn(this):yn(this),this.readyState==3&&Wl(this)}},s.Ra=function(o){this.g&&(this.response=this.responseText=o,xn(this))},s.Qa=function(o){this.g&&(this.response=o,xn(this))},s.ga=function(){this.g&&xn(this)};function xn(o){o.readyState=4,o.l=null,o.j=null,o.v=null,yn(o)}s.setRequestHeader=function(o,u){this.u.append(o,u)},s.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var h=u.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=u.next();return o.join(`\r
`)};function yn(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Nr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Kl(o){let u="";return L(o,function(h,x){u+=x,u+=":",u+=h,u+=`\r
`}),u}function da(o,u,h){e:{for(x in h){var x=!1;break e}x=!0}x||(h=Kl(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):ue(o,u,h))}function fe(o){Pe.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(fe,Pe);var Mf=/^https?$/i,Uf=["POST","PUT"];s=fe.prototype,s.Ha=function(o){this.J=o},s.ea=function(o,u,h,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ra.g(),this.v=this.o?Nl(this.o):Nl(ra),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(V){Ql(this,V);return}if(o=h||"",h=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var R in x)h.set(R,x[R]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const V of x.keys())h.set(V,x.get(V));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(h.keys()).find(V=>V.toLowerCase()=="content-type"),R=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Uf,u,void 0))||x||R||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,B]of h)this.g.setRequestHeader(V,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Yl(this),this.u=!0,this.g.send(o),this.u=!1}catch(V){Ql(this,V)}};function Ql(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.m=5,Xl(o),Er(o)}function Xl(o){o.A||(o.A=!0,qe(o,"complete"),qe(o,"error"))}s.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,qe(this,"complete"),qe(this,"abort"),Er(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Er(this,!0)),fe.aa.N.call(this)},s.Ea=function(){this.s||(this.B||this.u||this.j?Jl(this):this.bb())},s.bb=function(){Jl(this)};function Jl(o){if(o.h&&typeof l<"u"&&(!o.v[1]||Nt(o)!=4||o.Z()!=2)){if(o.u&&Nt(o)==4)bl(o.Ea,0,o);else if(qe(o,"readystatechange"),Nt(o)==4){o.h=!1;try{const B=o.Z();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var h;if(!(h=u)){var x;if(x=B===0){var R=String(o.D).match(Bl)[1]||null;!R&&c.self&&c.self.location&&(R=c.self.location.protocol.slice(0,-1)),x=!Mf.test(R?R.toLowerCase():"")}h=x}if(h)qe(o,"complete"),qe(o,"success");else{o.m=6;try{var V=2<Nt(o)?o.g.statusText:""}catch{V=""}o.l=V+" ["+o.Z()+"]",Xl(o)}}finally{Er(o)}}}}function Er(o,u){if(o.g){Yl(o);const h=o.g,x=o.v[0]?()=>{}:null;o.g=null,o.v=null,u||qe(o,"ready");try{h.onreadystatechange=x}catch{}}}function Yl(o){o.I&&(c.clearTimeout(o.I),o.I=null)}s.isActive=function(){return!!this.g};function Nt(o){return o.g?o.g.readyState:0}s.Z=function(){try{return 2<Nt(this)?this.g.status:-1}catch{return-1}},s.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.Oa=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),xf(u)}};function Zl(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Ff(o){const u={};o=(o.g&&2<=Nt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<o.length;x++){if(I(o[x]))continue;var h=E(o[x]);const R=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();const V=u[R]||[];u[R]=V,V.push(h)}v(u,function(x){return x.join(", ")})}s.Ba=function(){return this.m},s.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function bn(o,u,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||u}function ec(o){this.Aa=0,this.i=[],this.j=new hn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=bn("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=bn("baseRetryDelayMs",5e3,o),this.cb=bn("retryDelaySeedMs",1e4,o),this.Wa=bn("forwardChannelMaxRetries",2,o),this.wa=bn("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Ol(o&&o.concurrentRequestLimit),this.Da=new Vf,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}s=ec.prototype,s.la=8,s.G=1,s.connect=function(o,u,h,x){ze(0),this.W=o,this.H=u||{},h&&x!==void 0&&(this.H.OSID=h,this.H.OAID=x),this.F=this.X,this.I=cc(this,null,this.W),jr(this)};function ha(o){if(tc(o),o.G==3){var u=o.U++,h=wt(o.I);if(ue(h,"SID",o.K),ue(h,"RID",u),ue(h,"TYPE","terminate"),vn(o,h),u=new Dt(o,o.j,u),u.L=2,u.v=_r(wt(h)),h=!1,c.navigator&&c.navigator.sendBeacon)try{h=c.navigator.sendBeacon(u.v.toString(),"")}catch{}!h&&c.Image&&(new Image().src=u.v,h=!0),h||(u.g=uc(u.j,null),u.g.ea(u.v)),u.F=Date.now(),yr(u)}lc(o)}function Tr(o){o.g&&(fa(o),o.g.cancel(),o.g=null)}function tc(o){Tr(o),o.u&&(c.clearTimeout(o.u),o.u=null),Ir(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function jr(o){if(!Vl(o.h)&&!o.s){o.s=!0;var u=o.Ga;F||ye(),ne||(F(),ne=!0),xe.add(u,o),o.B=0}}function Bf(o,u){return Ll(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=u.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=dn(y(o.Ga,o,u),oc(o,o.B)),o.B++,!0)}s.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const R=new Dt(this,this.j,o);let V=this.o;if(this.S&&(V?(V=p(V),w(V,this.S)):V=this.S),this.m!==null||this.O||(R.H=V,V=null),this.P)e:{for(var u=0,h=0;h<this.i.length;h++){t:{var x=this.i[h];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(u+=x,4096<u){u=h;break e}if(u===4096||h===this.i.length-1){u=h+1;break e}}u=1e3}else u=1e3;u=nc(this,R,u),h=wt(this.I),ue(h,"RID",o),ue(h,"CVER",22),this.D&&ue(h,"X-HTTP-Session-Id",this.D),vn(this,h),V&&(this.O?u="headers="+encodeURIComponent(String(Kl(V)))+"&"+u:this.m&&da(h,this.m,V)),ua(this.h,R),this.Ua&&ue(h,"TYPE","init"),this.P?(ue(h,"$req",u),ue(h,"SID","null"),R.T=!0,aa(R,h,null)):aa(R,h,u),this.G=2}}else this.G==3&&(o?sc(this,o):this.i.length==0||Vl(this.h)||sc(this))};function sc(o,u){var h;u?h=u.l:h=o.U++;const x=wt(o.I);ue(x,"SID",o.K),ue(x,"RID",h),ue(x,"AID",o.T),vn(o,x),o.m&&o.o&&da(x,o.m,o.o),h=new Dt(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),u&&(o.i=u.D.concat(o.i)),u=nc(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),ua(o.h,h),aa(h,x,u)}function vn(o,u){o.H&&L(o.H,function(h,x){ue(u,x,h)}),o.l&&Fl({},function(h,x){ue(u,x,h)})}function nc(o,u,h){h=Math.min(o.i.length,h);var x=o.l?y(o.l.Na,o.l,o):null;e:{var R=o.i;let V=-1;for(;;){const B=["count="+h];V==-1?0<h?(V=R[0].g,B.push("ofs="+V)):V=0:B.push("ofs="+V);let le=!0;for(let Ie=0;Ie<h;Ie++){let ie=R[Ie].g;const De=R[Ie].map;if(ie-=V,0>ie)V=Math.max(0,R[Ie].g-100),le=!1;else try{Lf(De,B,"req"+ie+"_")}catch{x&&x(De)}}if(le){x=B.join("&");break e}}}return o=o.i.splice(0,h),u.D=o,x}function rc(o){if(!o.g&&!o.u){o.Y=1;var u=o.Fa;F||ye(),ne||(F(),ne=!0),xe.add(u,o),o.v=0}}function ma(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=dn(y(o.Fa,o),oc(o,o.v)),o.v++,!0)}s.Fa=function(){if(this.u=null,ic(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=dn(y(this.ab,this),o)}},s.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ze(10),Tr(this),ic(this))};function fa(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function ic(o){o.g=new Dt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var u=wt(o.qa);ue(u,"RID","rpc"),ue(u,"SID",o.K),ue(u,"AID",o.T),ue(u,"CI",o.F?"0":"1"),!o.F&&o.ja&&ue(u,"TO",o.ja),ue(u,"TYPE","xmlhttp"),vn(o,u),o.m&&o.o&&da(u,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=_r(wt(u)),h.m=null,h.P=!0,kl(h,o)}s.Za=function(){this.C!=null&&(this.C=null,Tr(this),ma(this),ze(19))};function Ir(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function ac(o,u){var h=null;if(o.g==u){Ir(o),fa(o),o.g=null;var x=2}else if(ca(o.h,u))h=u.D,Ml(o.h,u),x=1;else return;if(o.G!=0){if(u.o)if(x==1){h=u.m?u.m.length:0,u=Date.now()-u.F;var R=o.B;x=pr(),qe(x,new Al(x,h)),jr(o)}else rc(o);else if(R=u.s,R==3||R==0&&0<u.X||!(x==1&&Bf(o,u)||x==2&&ma(o)))switch(h&&0<h.length&&(u=o.h,u.i=u.i.concat(h)),R){case 1:cs(o,5);break;case 4:cs(o,10);break;case 3:cs(o,6);break;default:cs(o,2)}}}function oc(o,u){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*u}function cs(o,u){if(o.j.info("Error code "+u),u==2){var h=y(o.fb,o),x=o.Xa;const R=!x;x=new ls(x||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||br(x,"https"),_r(x),R?Df(x.toString(),h):Of(x.toString(),h)}else ze(2);o.G=0,o.l&&o.l.sa(u),lc(o),tc(o)}s.fb=function(o){o?(this.j.info("Successfully pinged google.com"),ze(2)):(this.j.info("Failed to ping google.com"),ze(1))};function lc(o){if(o.G=0,o.ka=[],o.l){const u=Ul(o.h);(u.length!=0||o.i.length!=0)&&(N(o.ka,u),N(o.ka,o.i),o.h.i.length=0,C(o.i),o.i.length=0),o.l.ra()}}function cc(o,u,h){var x=h instanceof ls?wt(h):new ls(h);if(x.g!="")u&&(x.g=u+"."+x.g),vr(x,x.s);else{var R=c.location;x=R.protocol,u=u?u+"."+R.hostname:R.hostname,R=+R.port;var V=new ls(null);x&&br(V,x),u&&(V.g=u),R&&vr(V,R),h&&(V.l=h),x=V}return h=o.D,u=o.ya,h&&u&&ue(x,h,u),ue(x,"VER",o.la),vn(o,x),x}function uc(o,u,h){if(u&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Ca&&!o.pa?new fe(new wr({eb:h})):new fe(o.pa),u.Ha(o.J),u}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function dc(){}s=dc.prototype,s.ua=function(){},s.ta=function(){},s.sa=function(){},s.ra=function(){},s.isActive=function(){return!0},s.Na=function(){};function Ar(){}Ar.prototype.g=function(o,u){return new Qe(o,u)};function Qe(o,u){Pe.call(this),this.g=new ec(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(o?o["X-WebChannel-Client-Profile"]=u.va:o={"X-WebChannel-Client-Profile":u.va}),this.g.S=o,(o=u&&u.Sb)&&!I(o)&&(this.g.m=o),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!I(u)&&(this.g.D=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new Ds(this)}k(Qe,Pe),Qe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Qe.prototype.close=function(){ha(this.g)},Qe.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=ea(o),o=h);u.i.push(new Ef(u.Ya++,o)),u.G==3&&jr(u)},Qe.prototype.N=function(){this.g.l=null,delete this.j,ha(this.g),delete this.g,Qe.aa.N.call(this)};function hc(o){sa.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const h in u){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}k(hc,sa);function mc(){na.call(this),this.status=1}k(mc,na);function Ds(o){this.g=o}k(Ds,dc),Ds.prototype.ua=function(){qe(this.g,"a")},Ds.prototype.ta=function(o){qe(this.g,new hc(o))},Ds.prototype.sa=function(o){qe(this.g,new mc)},Ds.prototype.ra=function(){qe(this.g,"b")},Ar.prototype.createWebChannel=Ar.prototype.g,Qe.prototype.send=Qe.prototype.o,Qe.prototype.open=Qe.prototype.m,Qe.prototype.close=Qe.prototype.close,gh=function(){return new Ar},ph=function(){return pr()},fh=as,Ya={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},gr.NO_ERROR=0,gr.TIMEOUT=8,gr.HTTP_ERROR=6,Hr=gr,Sl.COMPLETE="complete",mh=Sl,El.EventType=cn,cn.OPEN="a",cn.CLOSE="b",cn.ERROR="c",cn.MESSAGE="d",Pe.prototype.listen=Pe.prototype.K,Tn=El,fe.prototype.listenOnce=fe.prototype.L,fe.prototype.getLastError=fe.prototype.Ka,fe.prototype.getLastErrorCode=fe.prototype.Ba,fe.prototype.getStatus=fe.prototype.Z,fe.prototype.getResponseJson=fe.prototype.Oa,fe.prototype.getResponseText=fe.prototype.oa,fe.prototype.send=fe.prototype.ea,fe.prototype.setWithCredentials=fe.prototype.Ha,hh=fe}).apply(typeof kr<"u"?kr:typeof self<"u"?self:typeof window<"u"?window:{});const su="@firebase/firestore",nu="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Le.UNAUTHENTICATED=new Le(null),Le.GOOGLE_CREDENTIALS=new Le("google-credentials-uid"),Le.FIRST_PARTY=new Le("first-party-uid"),Le.MOCK_USER=new Le("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nn="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _s=new No("@firebase/firestore");function Vs(){return _s.logLevel}function q(s,...e){if(_s.logLevel<=Y.DEBUG){const t=e.map(Do);_s.debug(`Firestore (${nn}): ${s}`,...t)}}function kt(s,...e){if(_s.logLevel<=Y.ERROR){const t=e.map(Do);_s.error(`Firestore (${nn}): ${s}`,...t)}}function Xs(s,...e){if(_s.logLevel<=Y.WARN){const t=e.map(Do);_s.warn(`Firestore (${nn}): ${s}`,...t)}}function Do(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K(s,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,xh(s,n,t)}function xh(s,e,t){let n=`FIRESTORE (${nn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw kt(n),new Error(n)}function oe(s,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,s||xh(e,i,n)}function X(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $ extends _t{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ib{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Le.UNAUTHENTICATED))}shutdown(){}}class ab{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ob{constructor(e){this.t=e,this.currentUser=Le.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){oe(this.o===void 0,42304);let n=this.i;const i=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let a=new Wt;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Wt,e.enqueueRetryable(()=>i(this.currentUser))};const l=()=>{const d=a;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},c=d=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(d=>c(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Wt)}},0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(oe(typeof n.accessToken=="string",31837,{l:n}),new yh(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return oe(e===null||typeof e=="string",2055,{h:e}),new Le(e)}}class lb{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Le.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class cb{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new lb(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Le.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ru{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ub{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Je(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){oe(this.o===void 0,3512);const n=a=>{a.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,q("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ru(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(oe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ru(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function db(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<s;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=db(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<t&&(n+=e.charAt(i[a]%62))}return n}}function Z(s,e){return s<e?-1:s>e?1:0}function Za(s,e){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++){const i=s.charAt(n),a=e.charAt(n);if(i!==a)return Ta(i)===Ta(a)?Z(i,a):Ta(i)?1:-1}return Z(s.length,e.length)}const hb=55296,mb=57343;function Ta(s){const e=s.charCodeAt(0);return e>=hb&&e<=mb}function Js(s,e,t){return s.length===e.length&&s.every((n,i)=>t(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iu="__name__";class lt{constructor(e,t,n){t===void 0?t=0:t>e.length&&K(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&K(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return lt.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof lt?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const a=lt.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return Z(e.length,t.length)}static compareSegments(e,t){const n=lt.isNumericId(e),i=lt.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?lt.extractNumericId(e).compare(lt.extractNumericId(t)):Za(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Gt.fromString(e.substring(4,e.length-2))}}class de extends lt{construct(e,t,n){return new de(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new $(U.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new de(t)}static emptyPath(){return new de([])}}const fb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Se extends lt{construct(e,t,n){return new Se(e,t,n)}static isValidIdentifier(e){return fb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Se.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===iu}static keyField(){return new Se([iu])}static fromServerFormat(e){const t=[];let n="",i=0;const a=()=>{if(n.length===0)throw new $(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let l=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new $(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new $(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,i+=2}else c==="`"?(l=!l,i++):c!=="."||l?(n+=c,i++):(a(),i++)}if(a(),l)throw new $(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Se(t)}static emptyPath(){return new Se([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.path=e}static fromPath(e){return new H(de.fromString(e))}static fromName(e){return new H(de.fromString(e).popFirst(5))}static empty(){return new H(de.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&de.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return de.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new H(new de(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(s,e,t){if(!t)throw new $(U.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function pb(s,e,t,n){if(e===!0&&n===!0)throw new $(U.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function au(s){if(!H.isDocumentKey(s))throw new $(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function ou(s){if(H.isDocumentKey(s))throw new $(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function vh(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Vo(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":K(12329,{type:typeof s})}function Hn(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new $(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Vo(s);throw new $(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _e(s,e){const t={typeString:s};return e&&(t.value=e),t}function or(s,e){if(!vh(s))throw new $(U.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in s)){t=`JSON missing required field: '${n}'`;break}const l=s[n];if(i&&typeof l!==i){t=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${n}' field to equal '${a.value}'`;break}}if(t)throw new $(U.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu=-62135596800,cu=1e6;class he{static now(){return he.fromMillis(Date.now())}static fromDate(e){return he.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*cu);return new he(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new $(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new $(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<lu)throw new $(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cu}_compareTo(e){return this.seconds===e.seconds?Z(this.nanoseconds,e.nanoseconds):Z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:he._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(or(e,he._jsonSchema))return new he(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-lu;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}he._jsonSchemaVersion="firestore/timestamp/1.0",he._jsonSchema={type:_e("string",he._jsonSchemaVersion),seconds:_e("number"),nanoseconds:_e("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{static fromTimestamp(e){return new Q(e)}static min(){return new Q(new he(0,0))}static max(){return new Q(new he(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn=-1;function gb(s,e){const t=s.toTimestamp().seconds,n=s.toTimestamp().nanoseconds+1,i=Q.fromTimestamp(n===1e9?new he(t+1,0):new he(t,n));return new Jt(i,H.empty(),e)}function xb(s){return new Jt(s.readTime,s.key,Gn)}class Jt{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Jt(Q.min(),H.empty(),Gn)}static max(){return new Jt(Q.max(),H.empty(),Gn)}}function yb(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=H.comparator(s.documentKey,e.documentKey),t!==0?t:Z(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rn(s){if(s.code!==U.FAILED_PRECONDITION||s.message!==bb)throw s;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&K(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new M((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof M?t:M.resolve(t)}catch(t){return M.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):M.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):M.reject(t)}static resolve(e){return new M((t,n)=>{t(e)})}static reject(e){return new M((t,n)=>{n(e)})}static waitFor(e){return new M((t,n)=>{let i=0,a=0,l=!1;e.forEach(c=>{++i,c.next(()=>{++a,l&&a===i&&t()},d=>n(d))}),l=!0,a===i&&t()})}static or(e){let t=M.resolve(!1);for(const n of e)t=t.next(i=>i?M.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,a)=>{n.push(t.call(this,i,a))}),this.waitFor(n)}static mapArray(e,t){return new M((n,i)=>{const a=e.length,l=new Array(a);let c=0;for(let d=0;d<a;d++){const m=d;t(e[m]).next(f=>{l[m]=f,++c,c===a&&n(l)},f=>i(f))}})}static doWhile(e,t){return new M((n,i)=>{const a=()=>{e()===!0?t().next(()=>{a()},i):n()};a()})}}function _b(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function an(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ri.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lo=-1;function Ci(s){return s==null}function ai(s){return s===0&&1/s==-1/0}function wb(s){return typeof s=="number"&&Number.isInteger(s)&&!ai(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h="";function Nb(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=uu(e)),e=Eb(s.get(t),e);return uu(e)}function Eb(s,e){let t=e;const n=s.length;for(let i=0;i<n;i++){const a=s.charAt(i);switch(a){case"\0":t+="";break;case _h:t+="";break;default:t+=a}}return t}function uu(s){return s+_h+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function js(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function wh(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e,t){this.comparator=e,this.root=t||Ae.EMPTY}insert(e,t){return new me(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ae.BLACK,null,null))}remove(e){return new me(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ae.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pr(this.root,e,this.comparator,!0)}}class Pr{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ae{constructor(e,t,n,i,a){this.key=e,this.value=t,this.color=n??Ae.RED,this.left=i??Ae.EMPTY,this.right=a??Ae.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,a){return new Ae(e??this.key,t??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,n),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ae.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ae.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ae.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ae.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw K(43730,{key:this.key,value:this.value});if(this.right.isRed())throw K(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw K(27949);return e+(this.isRed()?0:1)}}Ae.EMPTY=null,Ae.RED=!0,Ae.BLACK=!1;Ae.EMPTY=new class{constructor(){this.size=0}get key(){throw K(57766)}get value(){throw K(16141)}get color(){throw K(16727)}get left(){throw K(29726)}get right(){throw K(36894)}copy(e,t,n,i,a){return this}insert(e,t,n){return new Ae(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.comparator=e,this.data=new me(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new hu(this.data.getIterator())}getIteratorFrom(e){return new hu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Ee)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ee(this.comparator);return t.data=e,t}}class hu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.fields=e,e.sort(Se.comparator)}static empty(){return new it([])}unionWith(e){let t=new Ee(Se.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new it(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Js(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Nh("Invalid base64 string: "+a):a}}(e);return new ke(t)}static fromUint8Array(e){const t=function(i){let a="";for(let l=0;l<i.length;++l)a+=String.fromCharCode(i[l]);return a}(e);return new ke(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ke.EMPTY_BYTE_STRING=new ke("");const Tb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yt(s){if(oe(!!s,39018),typeof s=="string"){let e=0;const t=Tb.exec(s);if(oe(!!t,46558,{timestamp:s}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(s);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:be(s.seconds),nanos:be(s.nanos)}}function be(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Zt(s){return typeof s=="string"?ke.fromBase64String(s):ke.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh="server_timestamp",Th="__type__",jh="__previous_value__",Ih="__local_write_time__";function Mo(s){return(s?.mapValue?.fields||{})[Th]?.stringValue===Eh}function ki(s){const e=s.mapValue.fields[jh];return Mo(e)?ki(e):e}function Wn(s){const e=Yt(s.mapValue.fields[Ih].timestampValue);return new he(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,t,n,i,a,l,c,d,m,f){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=m,this.isUsingEmulator=f}}const oi="(default)";class Kn{constructor(e,t){this.projectId=e,this.database=t||oi}static empty(){return new Kn("","")}get isDefaultDatabase(){return this.database===oi}isEqual(e){return e instanceof Kn&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah="__type__",Ib="__max__",Dr={mapValue:{}},Sh="__vector__",li="value";function es(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Mo(s)?4:Sb(s)?9007199254740991:Ab(s)?10:11:K(28295,{value:s})}function bt(s,e){if(s===e)return!0;const t=es(s);if(t!==es(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Wn(s).isEqual(Wn(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const l=Yt(i.timestampValue),c=Yt(a.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos}(s,e);case 5:return s.stringValue===e.stringValue;case 6:return function(i,a){return Zt(i.bytesValue).isEqual(Zt(a.bytesValue))}(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return function(i,a){return be(i.geoPointValue.latitude)===be(a.geoPointValue.latitude)&&be(i.geoPointValue.longitude)===be(a.geoPointValue.longitude)}(s,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return be(i.integerValue)===be(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const l=be(i.doubleValue),c=be(a.doubleValue);return l===c?ai(l)===ai(c):isNaN(l)&&isNaN(c)}return!1}(s,e);case 9:return Js(s.arrayValue.values||[],e.arrayValue.values||[],bt);case 10:case 11:return function(i,a){const l=i.mapValue.fields||{},c=a.mapValue.fields||{};if(du(l)!==du(c))return!1;for(const d in l)if(l.hasOwnProperty(d)&&(c[d]===void 0||!bt(l[d],c[d])))return!1;return!0}(s,e);default:return K(52216,{left:s})}}function Qn(s,e){return(s.values||[]).find(t=>bt(t,e))!==void 0}function Ys(s,e){if(s===e)return 0;const t=es(s),n=es(e);if(t!==n)return Z(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Z(s.booleanValue,e.booleanValue);case 2:return function(a,l){const c=be(a.integerValue||a.doubleValue),d=be(l.integerValue||l.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1}(s,e);case 3:return mu(s.timestampValue,e.timestampValue);case 4:return mu(Wn(s),Wn(e));case 5:return Za(s.stringValue,e.stringValue);case 6:return function(a,l){const c=Zt(a),d=Zt(l);return c.compareTo(d)}(s.bytesValue,e.bytesValue);case 7:return function(a,l){const c=a.split("/"),d=l.split("/");for(let m=0;m<c.length&&m<d.length;m++){const f=Z(c[m],d[m]);if(f!==0)return f}return Z(c.length,d.length)}(s.referenceValue,e.referenceValue);case 8:return function(a,l){const c=Z(be(a.latitude),be(l.latitude));return c!==0?c:Z(be(a.longitude),be(l.longitude))}(s.geoPointValue,e.geoPointValue);case 9:return fu(s.arrayValue,e.arrayValue);case 10:return function(a,l){const c=a.fields||{},d=l.fields||{},m=c[li]?.arrayValue,f=d[li]?.arrayValue,g=Z(m?.values?.length||0,f?.values?.length||0);return g!==0?g:fu(m,f)}(s.mapValue,e.mapValue);case 11:return function(a,l){if(a===Dr.mapValue&&l===Dr.mapValue)return 0;if(a===Dr.mapValue)return 1;if(l===Dr.mapValue)return-1;const c=a.fields||{},d=Object.keys(c),m=l.fields||{},f=Object.keys(m);d.sort(),f.sort();for(let g=0;g<d.length&&g<f.length;++g){const y=Za(d[g],f[g]);if(y!==0)return y;const T=Ys(c[d[g]],m[f[g]]);if(T!==0)return T}return Z(d.length,f.length)}(s.mapValue,e.mapValue);default:throw K(23264,{he:t})}}function mu(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Z(s,e);const t=Yt(s),n=Yt(e),i=Z(t.seconds,n.seconds);return i!==0?i:Z(t.nanos,n.nanos)}function fu(s,e){const t=s.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const a=Ys(t[i],n[i]);if(a)return a}return Z(t.length,n.length)}function Zs(s){return eo(s)}function eo(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(t){const n=Yt(t);return`time(${n.seconds},${n.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?function(t){return Zt(t).toBase64()}(s.bytesValue):"referenceValue"in s?function(t){return H.fromName(t).toString()}(s.referenceValue):"geoPointValue"in s?function(t){return`geo(${t.latitude},${t.longitude})`}(s.geoPointValue):"arrayValue"in s?function(t){let n="[",i=!0;for(const a of t.values||[])i?i=!1:n+=",",n+=eo(a);return n+"]"}(s.arrayValue):"mapValue"in s?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const l of n)a?a=!1:i+=",",i+=`${l}:${eo(t.fields[l])}`;return i+"}"}(s.mapValue):K(61005,{value:s})}function Gr(s){switch(es(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ki(s);return e?16+Gr(e):16;case 5:return 2*s.stringValue.length;case 6:return Zt(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+Gr(a),0)}(s.arrayValue);case 10:case 11:return function(n){let i=0;return js(n.fields,(a,l)=>{i+=a.length+Gr(l)}),i}(s.mapValue);default:throw K(13486,{value:s})}}function to(s){return!!s&&"integerValue"in s}function Uo(s){return!!s&&"arrayValue"in s}function pu(s){return!!s&&"nullValue"in s}function gu(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Wr(s){return!!s&&"mapValue"in s}function Ab(s){return(s?.mapValue?.fields||{})[Ah]?.stringValue===Sh}function kn(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return js(s.mapValue.fields,(t,n)=>e.mapValue.fields[t]=kn(n)),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=kn(s.arrayValue.values[t]);return e}return{...s}}function Sb(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===Ib}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.value=e}static empty(){return new et({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Wr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=kn(t)}setAll(e){let t=Se.emptyPath(),n={},i=[];e.forEach((l,c)=>{if(!t.isImmediateParentOf(c)){const d=this.getFieldsMap(t);this.applyChanges(d,n,i),n={},i=[],t=c.popLast()}l?n[c.lastSegment()]=kn(l):i.push(c.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,n,i)}delete(e){const t=this.field(e.popLast());Wr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return bt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Wr(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){js(t,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new et(kn(this.value))}}function Rh(s){const e=[];return js(s.fields,(t,n)=>{const i=new Se([t]);if(Wr(n)){const a=Rh(n.mapValue).fields;if(a.length===0)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new it(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,t,n,i,a,l,c){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=a,this.data=l,this.documentState=c}static newInvalidDocument(e){return new Ue(e,0,Q.min(),Q.min(),Q.min(),et.empty(),0)}static newFoundDocument(e,t,n,i){return new Ue(e,1,t,Q.min(),n,i,0)}static newNoDocument(e,t){return new Ue(e,2,t,Q.min(),Q.min(),et.empty(),0)}static newUnknownDocument(e,t){return new Ue(e,3,t,Q.min(),Q.min(),et.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=et.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=et.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ue&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ue(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,t){this.position=e,this.inclusive=t}}function xu(s,e,t){let n=0;for(let i=0;i<s.position.length;i++){const a=e[i],l=s.position[i];if(a.field.isKeyField()?n=H.comparator(H.fromName(l.referenceValue),t.key):n=Ys(l,t.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function yu(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!bt(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,t="asc"){this.field=e,this.dir=t}}function Rb(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{}class Ne extends Ch{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new kb(e,t,n):t==="array-contains"?new Ob(e,n):t==="in"?new Vb(e,n):t==="not-in"?new Lb(e,n):t==="array-contains-any"?new Mb(e,n):new Ne(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Pb(e,n):new Db(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ys(t,this.value)):t!==null&&es(this.value)===es(t)&&this.matchesComparison(Ys(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return K(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vt extends Ch{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new vt(e,t)}matches(e){return kh(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function kh(s){return s.op==="and"}function Ph(s){return Cb(s)&&kh(s)}function Cb(s){for(const e of s.filters)if(e instanceof vt)return!1;return!0}function so(s){if(s instanceof Ne)return s.field.canonicalString()+s.op.toString()+Zs(s.value);if(Ph(s))return s.filters.map(e=>so(e)).join(",");{const e=s.filters.map(t=>so(t)).join(",");return`${s.op}(${e})`}}function Dh(s,e){return s instanceof Ne?function(n,i){return i instanceof Ne&&n.op===i.op&&n.field.isEqual(i.field)&&bt(n.value,i.value)}(s,e):s instanceof vt?function(n,i){return i instanceof vt&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,l,c)=>a&&Dh(l,i.filters[c]),!0):!1}(s,e):void K(19439)}function Oh(s){return s instanceof Ne?function(t){return`${t.field.canonicalString()} ${t.op} ${Zs(t.value)}`}(s):s instanceof vt?function(t){return t.op.toString()+" {"+t.getFilters().map(Oh).join(" ,")+"}"}(s):"Filter"}class kb extends Ne{constructor(e,t,n){super(e,t,n),this.key=H.fromName(n.referenceValue)}matches(e){const t=H.comparator(e.key,this.key);return this.matchesComparison(t)}}class Pb extends Ne{constructor(e,t){super(e,"in",t),this.keys=Vh("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Db extends Ne{constructor(e,t){super(e,"not-in",t),this.keys=Vh("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Vh(s,e){return(e.arrayValue?.values||[]).map(t=>H.fromName(t.referenceValue))}class Ob extends Ne{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Uo(t)&&Qn(t.arrayValue,this.value)}}class Vb extends Ne{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Qn(this.value.arrayValue,t)}}class Lb extends Ne{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Qn(this.value.arrayValue,t)}}class Mb extends Ne{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Uo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Qn(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,t=null,n=[],i=[],a=null,l=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=l,this.endAt=c,this.Te=null}}function bu(s,e=null,t=[],n=[],i=null,a=null,l=null){return new Ub(s,e,t,n,i,a,l)}function Fo(s){const e=X(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>so(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Ci(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Zs(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Zs(n)).join(",")),e.Te=t}return e.Te}function Bo(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!Rb(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!Dh(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!yu(s.startAt,e.startAt)&&yu(s.endAt,e.endAt)}function no(s){return H.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e,t=null,n=[],i=[],a=null,l="F",c=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=l,this.startAt=c,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Fb(s,e,t,n,i,a,l,c){return new Pi(s,e,t,n,i,a,l,c)}function Lh(s){return new Pi(s)}function vu(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function Bb(s){return s.collectionGroup!==null}function Pn(s){const e=X(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new Ee(Se.comparator);return l.filters.forEach(d=>{d.getFlattenedFilters().forEach(m=>{m.isInequality()&&(c=c.add(m.field))})}),c})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new ui(a,n))}),t.has(Se.keyField().canonicalString())||e.Ie.push(new ui(Se.keyField(),n))}return e.Ie}function ft(s){const e=X(s);return e.Ee||(e.Ee=qb(e,Pn(s))),e.Ee}function qb(s,e){if(s.limitType==="F")return bu(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new ui(i.field,a)});const t=s.endAt?new ci(s.endAt.position,s.endAt.inclusive):null,n=s.startAt?new ci(s.startAt.position,s.startAt.inclusive):null;return bu(s.path,s.collectionGroup,e,s.filters,s.limit,t,n)}}function ro(s,e,t){return new Pi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function Di(s,e){return Bo(ft(s),ft(e))&&s.limitType===e.limitType}function Mh(s){return`${Fo(ft(s))}|lt:${s.limitType}`}function Ls(s){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>Oh(i)).join(", ")}]`),Ci(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Zs(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Zs(i)).join(",")),`Target(${n})`}(ft(s))}; limitType=${s.limitType})`}function Oi(s,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):H.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(s,e)&&function(n,i){for(const a of Pn(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(s,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(s,e)&&function(n,i){return!(n.startAt&&!function(l,c,d){const m=xu(l,c,d);return l.inclusive?m<=0:m<0}(n.startAt,Pn(n),i)||n.endAt&&!function(l,c,d){const m=xu(l,c,d);return l.inclusive?m>=0:m>0}(n.endAt,Pn(n),i))}(s,e)}function zb(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function Uh(s){return(e,t)=>{let n=!1;for(const i of Pn(s)){const a=$b(i,e,t);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function $b(s,e,t){const n=s.field.isKeyField()?H.comparator(e.key,t.key):function(a,l,c){const d=l.data.field(a),m=c.data.field(a);return d!==null&&m!==null?Ys(d,m):K(42886)}(s.field,e,t);switch(s.dir){case"asc":return n;case"desc":return-1*n;default:return K(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){js(this.inner,(t,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return wh(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb=new me(H.comparator);function Pt(){return Hb}const Fh=new me(H.comparator);function jn(...s){let e=Fh;for(const t of s)e=e.insert(t.key,t);return e}function Bh(s){let e=Fh;return s.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function hs(){return Dn()}function qh(){return Dn()}function Dn(){return new Is(s=>s.toString(),(s,e)=>s.isEqual(e))}const Gb=new me(H.comparator),Wb=new Ee(H.comparator);function ee(...s){let e=Wb;for(const t of s)e=e.add(t);return e}const Kb=new Ee(Z);function Qb(){return Kb}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ai(e)?"-0":e}}function zh(s){return{integerValue:""+s}}function Xb(s,e){return wb(e)?zh(e):qo(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(){this._=void 0}}function Jb(s,e,t){return s instanceof di?function(i,a){const l={fields:{[Th]:{stringValue:Eh},[Ih]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Mo(a)&&(a=ki(a)),a&&(l.fields[jh]=a),{mapValue:l}}(t,e):s instanceof Xn?Hh(s,e):s instanceof Jn?Gh(s,e):function(i,a){const l=$h(i,a),c=_u(l)+_u(i.Ae);return to(l)&&to(i.Ae)?zh(c):qo(i.serializer,c)}(s,e)}function Yb(s,e,t){return s instanceof Xn?Hh(s,e):s instanceof Jn?Gh(s,e):t}function $h(s,e){return s instanceof hi?function(n){return to(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class di extends Vi{}class Xn extends Vi{constructor(e){super(),this.elements=e}}function Hh(s,e){const t=Wh(e);for(const n of s.elements)t.some(i=>bt(i,n))||t.push(n);return{arrayValue:{values:t}}}class Jn extends Vi{constructor(e){super(),this.elements=e}}function Gh(s,e){let t=Wh(e);for(const n of s.elements)t=t.filter(i=>!bt(i,n));return{arrayValue:{values:t}}}class hi extends Vi{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function _u(s){return be(s.integerValue||s.doubleValue)}function Wh(s){return Uo(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}function Zb(s,e){return s.field.isEqual(e.field)&&function(n,i){return n instanceof Xn&&i instanceof Xn||n instanceof Jn&&i instanceof Jn?Js(n.elements,i.elements,bt):n instanceof hi&&i instanceof hi?bt(n.Ae,i.Ae):n instanceof di&&i instanceof di}(s.transform,e.transform)}class ev{constructor(e,t){this.version=e,this.transformResults=t}}class pt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new pt}static exists(e){return new pt(void 0,e)}static updateTime(e){return new pt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Kr(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Li{}function Kh(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new zo(s.key,pt.none()):new lr(s.key,s.data,pt.none());{const t=s.data,n=et.empty();let i=new Ee(Se.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?n.delete(a):n.set(a,l),i=i.add(a)}return new As(s.key,n,new it(i.toArray()),pt.none())}}function tv(s,e,t){s instanceof lr?function(i,a,l){const c=i.value.clone(),d=Nu(i.fieldTransforms,a,l.transformResults);c.setAll(d),a.convertToFoundDocument(l.version,c).setHasCommittedMutations()}(s,e,t):s instanceof As?function(i,a,l){if(!Kr(i.precondition,a))return void a.convertToUnknownDocument(l.version);const c=Nu(i.fieldTransforms,a,l.transformResults),d=a.data;d.setAll(Qh(i)),d.setAll(c),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()}(s,e,t):function(i,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,t)}function On(s,e,t,n){return s instanceof lr?function(a,l,c,d){if(!Kr(a.precondition,l))return c;const m=a.value.clone(),f=Eu(a.fieldTransforms,d,l);return m.setAll(f),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null}(s,e,t,n):s instanceof As?function(a,l,c,d){if(!Kr(a.precondition,l))return c;const m=Eu(a.fieldTransforms,d,l),f=l.data;return f.setAll(Qh(a)),f.setAll(m),l.convertToFoundDocument(l.version,f).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(g=>g.field))}(s,e,t,n):function(a,l,c){return Kr(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c}(s,e,t)}function sv(s,e){let t=null;for(const n of s.fieldTransforms){const i=e.data.field(n.field),a=$h(n.transform,i||null);a!=null&&(t===null&&(t=et.empty()),t.set(n.field,a))}return t||null}function wu(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Js(n,i,(a,l)=>Zb(a,l))}(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class lr extends Li{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class As extends Li{constructor(e,t,n,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Qh(s){const e=new Map;return s.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=s.data.field(t);e.set(t,n)}}),e}function Nu(s,e,t){const n=new Map;oe(s.length===t.length,32656,{Re:t.length,Ve:s.length});for(let i=0;i<t.length;i++){const a=s[i],l=a.transform,c=e.data.field(a.field);n.set(a.field,Yb(l,c,t[i]))}return n}function Eu(s,e,t){const n=new Map;for(const i of s){const a=i.transform,l=t.data.field(i.field);n.set(i.field,Jb(a,l,e))}return n}class zo extends Li{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nv extends Li{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&tv(a,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=On(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=On(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=qh();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let c=this.applyToLocalView(l,a.mutatedFields);c=t.has(i.key)?null:c;const d=Kh(l,c);d!==null&&n.set(i.key,d),l.isValidDocument()||l.convertToNoDocument(Q.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ee())}isEqual(e){return this.batchId===e.batchId&&Js(this.mutations,e.mutations,(t,n)=>wu(t,n))&&Js(this.baseMutations,e.baseMutations,(t,n)=>wu(t,n))}}class $o{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){oe(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return Gb}();const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,n[l].version);return new $o(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ve,se;function ov(s){switch(s){case U.OK:return K(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return K(15467,{code:s})}}function Xh(s){if(s===void 0)return kt("GRPC error has no .code"),U.UNKNOWN;switch(s){case ve.OK:return U.OK;case ve.CANCELLED:return U.CANCELLED;case ve.UNKNOWN:return U.UNKNOWN;case ve.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case ve.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case ve.INTERNAL:return U.INTERNAL;case ve.UNAVAILABLE:return U.UNAVAILABLE;case ve.UNAUTHENTICATED:return U.UNAUTHENTICATED;case ve.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case ve.NOT_FOUND:return U.NOT_FOUND;case ve.ALREADY_EXISTS:return U.ALREADY_EXISTS;case ve.PERMISSION_DENIED:return U.PERMISSION_DENIED;case ve.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case ve.ABORTED:return U.ABORTED;case ve.OUT_OF_RANGE:return U.OUT_OF_RANGE;case ve.UNIMPLEMENTED:return U.UNIMPLEMENTED;case ve.DATA_LOSS:return U.DATA_LOSS;default:return K(39323,{code:s})}}(se=ve||(ve={}))[se.OK=0]="OK",se[se.CANCELLED=1]="CANCELLED",se[se.UNKNOWN=2]="UNKNOWN",se[se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",se[se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",se[se.NOT_FOUND=5]="NOT_FOUND",se[se.ALREADY_EXISTS=6]="ALREADY_EXISTS",se[se.PERMISSION_DENIED=7]="PERMISSION_DENIED",se[se.UNAUTHENTICATED=16]="UNAUTHENTICATED",se[se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",se[se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",se[se.ABORTED=10]="ABORTED",se[se.OUT_OF_RANGE=11]="OUT_OF_RANGE",se[se.UNIMPLEMENTED=12]="UNIMPLEMENTED",se[se.INTERNAL=13]="INTERNAL",se[se.UNAVAILABLE=14]="UNAVAILABLE",se[se.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cv=new Gt([4294967295,4294967295],0);function Tu(s){const e=lv().encode(s),t=new dh;return t.update(e),new Uint8Array(t.digest())}function ju(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Gt([t,n],0),new Gt([i,a],0)]}class Ho{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new In(`Invalid padding: ${t}`);if(n<0)throw new In(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new In(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new In(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Gt.fromNumber(this.ge)}ye(e,t,n){let i=e.add(t.multiply(Gt.fromNumber(n)));return i.compare(cv)===1&&(i=new Gt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Tu(e),[n,i]=ju(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(n,i,a);if(!this.we(l))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new Ho(a,i,t);return n.forEach(c=>l.insert(c)),l}insert(e){if(this.ge===0)return;const t=Tu(e),[n,i]=ju(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(n,i,a);this.Se(l)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class In extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,t,n,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,cr.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Mi(Q.min(),i,new me(Z),Pt(),ee())}}class cr{constructor(e,t,n,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new cr(n,t,ee(),ee(),ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e,t,n,i){this.be=e,this.removedTargetIds=t,this.key=n,this.De=i}}class Jh{constructor(e,t){this.targetId=e,this.Ce=t}}class Yh{constructor(e,t,n=ke.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Iu{constructor(){this.ve=0,this.Fe=Au(),this.Me=ke.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ee(),t=ee(),n=ee();return this.Fe.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:K(38017,{changeType:a})}}),new cr(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Au()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,oe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class uv{constructor(e){this.Ge=e,this.ze=new Map,this.je=Pt(),this.Je=Or(),this.He=Or(),this.Ye=new me(Z)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:K(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((n,i)=>{this.rt(i)&&t(i)})}st(e){const t=e.targetId,n=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(no(a))if(n===0){const l=new H(a.path);this.et(t,l,Ue.newNoDocument(l,Q.min()))}else oe(n===1,20013,{expectedCount:n});else{const l=this._t(t);if(l!==n){const c=this.ut(e),d=c?this.ct(c,e,l):1;if(d!==0){this.it(t);const m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=t;let l,c;try{l=Zt(n).toUint8Array()}catch(d){if(d instanceof Nh)return Xs("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{c=new Ho(l,i,a)}catch(d){return Xs(d instanceof In?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return c.ge===0?null:c}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let i=0;return n.forEach(a=>{const l=this.Ge.ht(),c=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)}),i}Tt(e){const t=new Map;this.ze.forEach((a,l)=>{const c=this.ot(l);if(c){if(a.current&&no(c.target)){const d=new H(c.target.path);this.It(d).has(l)||this.Et(l,d)||this.et(l,d,Ue.newNoDocument(d,e))}a.Be&&(t.set(l,a.ke()),a.qe())}});let n=ee();this.He.forEach((a,l)=>{let c=!0;l.forEachWhile(d=>{const m=this.ot(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(a))}),this.je.forEach((a,l)=>l.setReadTime(e));const i=new Mi(e,t,this.Ye,this.je,n);return this.je=Pt(),this.Je=Or(),this.He=Or(),this.Ye=new me(Z),i}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Iu,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ee(Z),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ee(Z),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||q("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Iu),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Or(){return new me(H.comparator)}function Au(){return new me(H.comparator)}const dv={asc:"ASCENDING",desc:"DESCENDING"},hv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mv={and:"AND",or:"OR"};class fv{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function io(s,e){return s.useProto3Json||Ci(e)?e:{value:e}}function mi(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zh(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function pv(s,e){return mi(s,e.toTimestamp())}function gt(s){return oe(!!s,49232),Q.fromTimestamp(function(t){const n=Yt(t);return new he(n.seconds,n.nanos)}(s))}function Go(s,e){return ao(s,e).canonicalString()}function ao(s,e){const t=function(i){return new de(["projects",i.projectId,"databases",i.database])}(s).child("documents");return e===void 0?t:t.child(e)}function em(s){const e=de.fromString(s);return oe(im(e),10190,{key:e.toString()}),e}function oo(s,e){return Go(s.databaseId,e.path)}function ja(s,e){const t=em(e);if(t.get(1)!==s.databaseId.projectId)throw new $(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new $(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new H(sm(t))}function tm(s,e){return Go(s.databaseId,e)}function gv(s){const e=em(s);return e.length===4?de.emptyPath():sm(e)}function lo(s){return new de(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function sm(s){return oe(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Su(s,e,t){return{name:oo(s,e),fields:t.value.mapValue.fields}}function xv(s,e){let t;if("targetChange"in e){e.targetChange;const n=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:K(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(m,f){return m.useProto3Json?(oe(f===void 0||typeof f=="string",58123),ke.fromBase64String(f||"")):(oe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),ke.fromUint8Array(f||new Uint8Array))}(s,e.targetChange.resumeToken),l=e.targetChange.cause,c=l&&function(m){const f=m.code===void 0?U.UNKNOWN:Xh(m.code);return new $(f,m.message||"")}(l);t=new Yh(n,i,a,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=ja(s,n.document.name),a=gt(n.document.updateTime),l=n.document.createTime?gt(n.document.createTime):Q.min(),c=new et({mapValue:{fields:n.document.fields}}),d=Ue.newFoundDocument(i,a,l,c),m=n.targetIds||[],f=n.removedTargetIds||[];t=new Qr(m,f,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=ja(s,n.document),a=n.readTime?gt(n.readTime):Q.min(),l=Ue.newNoDocument(i,a),c=n.removedTargetIds||[];t=new Qr([],c,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=ja(s,n.document),a=n.removedTargetIds||[];t=new Qr([],a,i,null)}else{if(!("filter"in e))return K(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,l=new av(i,a),c=n.targetId;t=new Jh(c,l)}}return t}function yv(s,e){let t;if(e instanceof lr)t={update:Su(s,e.key,e.value)};else if(e instanceof zo)t={delete:oo(s,e.key)};else if(e instanceof As)t={update:Su(s,e.key,e.data),updateMask:Iv(e.fieldMask)};else{if(!(e instanceof nv))return K(16599,{Vt:e.type});t={verify:oo(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(a,l){const c=l.transform;if(c instanceof di)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Xn)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Jn)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof hi)return{fieldPath:l.field.canonicalString(),increment:c.Ae};throw K(20930,{transform:l.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:pv(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:K(27497)}(s,e.precondition)),t}function bv(s,e){return s&&s.length>0?(oe(e!==void 0,14353),s.map(t=>function(i,a){let l=i.updateTime?gt(i.updateTime):gt(a);return l.isEqual(Q.min())&&(l=gt(a)),new ev(l,i.transformResults||[])}(t,e))):[]}function vv(s,e){return{documents:[tm(s,e.path)]}}function _v(s,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=tm(s,i);const a=function(m){if(m.length!==0)return rm(vt.create(m,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const l=function(m){if(m.length!==0)return m.map(f=>function(y){return{field:Ms(y.field),direction:Ev(y.dir)}}(f))}(e.orderBy);l&&(t.structuredQuery.orderBy=l);const c=io(s,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:t,parent:i}}function wv(s){let e=gv(s.parent);const t=s.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){oe(n===1,65062);const f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let a=[];t.where&&(a=function(g){const y=nm(g);return y instanceof vt&&Ph(y)?y.getFilters():[y]}(t.where));let l=[];t.orderBy&&(l=function(g){return g.map(y=>function(k){return new ui(Us(k.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(y))}(t.orderBy));let c=null;t.limit&&(c=function(g){let y;return y=typeof g=="object"?g.value:g,Ci(y)?null:y}(t.limit));let d=null;t.startAt&&(d=function(g){const y=!!g.before,T=g.values||[];return new ci(T,y)}(t.startAt));let m=null;return t.endAt&&(m=function(g){const y=!g.before,T=g.values||[];return new ci(T,y)}(t.endAt)),Fb(e,i,l,a,c,"F",d,m)}function Nv(s,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return K(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function nm(s){return s.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Us(t.unaryFilter.field);return Ne.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Us(t.unaryFilter.field);return Ne.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Us(t.unaryFilter.field);return Ne.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Us(t.unaryFilter.field);return Ne.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return K(61313);default:return K(60726)}}(s):s.fieldFilter!==void 0?function(t){return Ne.create(Us(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return K(58110);default:return K(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(s):s.compositeFilter!==void 0?function(t){return vt.create(t.compositeFilter.filters.map(n=>nm(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return K(1026)}}(t.compositeFilter.op))}(s):K(30097,{filter:s})}function Ev(s){return dv[s]}function Tv(s){return hv[s]}function jv(s){return mv[s]}function Ms(s){return{fieldPath:s.canonicalString()}}function Us(s){return Se.fromServerFormat(s.fieldPath)}function rm(s){return s instanceof Ne?function(t){if(t.op==="=="){if(gu(t.value))return{unaryFilter:{field:Ms(t.field),op:"IS_NAN"}};if(pu(t.value))return{unaryFilter:{field:Ms(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(gu(t.value))return{unaryFilter:{field:Ms(t.field),op:"IS_NOT_NAN"}};if(pu(t.value))return{unaryFilter:{field:Ms(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ms(t.field),op:Tv(t.op),value:t.value}}}(s):s instanceof vt?function(t){const n=t.getFilters().map(i=>rm(i));return n.length===1?n[0]:{compositeFilter:{op:jv(t.op),filters:n}}}(s):K(54877,{filter:s})}function Iv(s){const e=[];return s.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function im(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e,t,n,i,a=Q.min(),l=Q.min(),c=ke.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=c,this.expectedCount=d}withSequenceNumber(e){return new zt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zt(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e){this.yt=e}}function Sv(s){const e=wv({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?ro(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(){this.Cn=new Cv}addToCollectionParentIndex(e,t){return this.Cn.add(t),M.resolve()}getCollectionParents(e,t){return M.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return M.resolve()}deleteFieldIndex(e,t){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,t){return M.resolve()}getDocumentsMatchingTarget(e,t){return M.resolve(null)}getIndexType(e,t){return M.resolve(0)}getFieldIndexes(e,t){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,t){return M.resolve(Jt.min())}getMinOffsetFromCollectionGroup(e,t){return M.resolve(Jt.min())}updateCollectionGroup(e,t,n){return M.resolve()}updateIndexEntries(e,t){return M.resolve()}}class Cv{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new Ee(de.comparator),a=!i.has(n);return this.index[t]=i.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Ee(de.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},am=41943040;class We{static withCacheSize(e){return new We(e,We.DEFAULT_COLLECTION_PERCENTILE,We.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */We.DEFAULT_COLLECTION_PERCENTILE=10,We.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,We.DEFAULT=new We(am,We.DEFAULT_COLLECTION_PERCENTILE,We.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),We.DISABLED=new We(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new en(0)}static cr(){return new en(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cu="LruGarbageCollector",kv=1048576;function ku([s,e],[t,n]){const i=Z(s,t);return i===0?Z(e,n):i}class Pv{constructor(e){this.Ir=e,this.buffer=new Ee(ku),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();ku(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Dv{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){q(Cu,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){an(t)?q(Cu,"Ignoring IndexedDB error during garbage collection: ",t):await rn(t)}await this.Vr(3e5)})}}class Ov{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return M.resolve(Ri.ce);const n=new Pv(t);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(Ru)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ru):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,i,a,l,c,d,m;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,l=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(n=g,c=Date.now(),this.removeTargets(e,n,t))).next(g=>(a=g,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(g=>(m=Date.now(),Vs()<=Y.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-f}ms
	Determined least recently used ${i} in `+(c-l)+`ms
	Removed ${a} targets in `+(d-c)+`ms
	Removed ${g} documents in `+(m-d)+`ms
Total Duration: ${m-f}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:g})))}}function Vv(s,e){return new Ov(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(){this.changes=new Is(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ue.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?M.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&On(n.mutation,i,it.empty(),he.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,ee()).next(()=>n))}getLocalViewOfDocuments(e,t,n=ee()){const i=hs();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(a=>{let l=jn();return a.forEach((c,d)=>{l=l.insert(c,d.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const n=hs();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,ee()))}populateOverlays(e,t,n){const i=[];return n.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,c)=>{t.set(l,c)})})}computeViews(e,t,n,i){let a=Pt();const l=Dn(),c=function(){return Dn()}();return t.forEach((d,m)=>{const f=n.get(m.key);i.has(m.key)&&(f===void 0||f.mutation instanceof As)?a=a.insert(m.key,m):f!==void 0?(l.set(m.key,f.mutation.getFieldMask()),On(f.mutation,m,f.mutation.getFieldMask(),he.now())):l.set(m.key,it.empty())}),this.recalculateAndSaveOverlays(e,a).next(d=>(d.forEach((m,f)=>l.set(m,f)),t.forEach((m,f)=>c.set(m,new Mv(f,l.get(m)??null))),c))}recalculateAndSaveOverlays(e,t){const n=Dn();let i=new me((l,c)=>l-c),a=ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const c of l)c.keys().forEach(d=>{const m=t.get(d);if(m===null)return;let f=n.get(d)||it.empty();f=c.applyToLocalView(m,f),n.set(d,f);const g=(i.get(c.batchId)||ee()).add(d);i=i.insert(c.batchId,g)})}).next(()=>{const l=[],c=i.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),m=d.key,f=d.value,g=qh();f.forEach(y=>{if(!a.has(y)){const T=Kh(t.get(y),n.get(y));T!==null&&g.set(y,T),a=a.add(y)}}),l.push(this.documentOverlayCache.saveOverlays(e,m,g))}return M.waitFor(l)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(l){return H.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Bb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-a.size):M.resolve(hs());let c=Gn,d=a;return l.next(m=>M.forEach(m,(f,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),a.get(f)?M.resolve():this.remoteDocumentCache.getEntry(e,f).next(y=>{d=d.insert(f,y)}))).next(()=>this.populateOverlays(e,m,a)).next(()=>this.computeViews(e,d,m,ee())).next(f=>({batchId:c,changes:Bh(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new H(t)).next(n=>{let i=jn();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const a=t.collectionGroup;let l=jn();return this.indexManager.getCollectionParents(e,a).next(c=>M.forEach(c,d=>{const m=function(g,y){return new Pi(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(t,d.child(a));return this.getDocumentsMatchingCollectionQuery(e,m,n,i).next(f=>{f.forEach((g,y)=>{l=l.insert(g,y)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,t,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,i))).next(l=>{a.forEach((d,m)=>{const f=m.getKey();l.get(f)===null&&(l=l.insert(f,Ue.newInvalidDocument(f)))});let c=jn();return l.forEach((d,m)=>{const f=a.get(d);f!==void 0&&On(f.mutation,m,it.empty(),he.now()),Oi(t,m)&&(c=c.insert(d,m))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return M.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:gt(i.createTime)}}(t)),M.resolve()}getNamedQuery(e,t){return M.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(i){return{name:i.name,query:Sv(i.bundledQuery),readTime:gt(i.readTime)}}(t)),M.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(){this.overlays=new me(H.comparator),this.qr=new Map}getOverlay(e,t){return M.resolve(this.overlays.get(t))}getOverlays(e,t){const n=hs();return M.forEach(t,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,a)=>{this.St(e,t,a)}),M.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),M.resolve()}getOverlaysForCollection(e,t,n){const i=hs(),a=t.length+1,l=new H(t.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const d=c.getNext().value,m=d.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===a&&d.largestBatchId>n&&i.set(d.getKey(),d)}return M.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let a=new me((m,f)=>m-f);const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>n){let f=a.get(m.largestBatchId);f===null&&(f=hs(),a=a.insert(m.largestBatchId,f)),f.set(m.getKey(),m)}}const c=hs(),d=a.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((m,f)=>c.set(m,f)),!(c.size()>=i)););return M.resolve(c)}St(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new iv(t,n));let a=this.qr.get(t);a===void 0&&(a=ee(),this.qr.set(t,a)),this.qr.set(t,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(){this.sessionToken=ke.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,M.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(){this.Qr=new Ee(je.$r),this.Ur=new Ee(je.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new je(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new je(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){const t=new H(new de([])),n=new je(t,e),i=new je(t,e+1),a=[];return this.Ur.forEachInRange([n,i],l=>{this.Gr(l),a.push(l.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new H(new de([])),n=new je(t,e),i=new je(t,e+1);let a=ee();return this.Ur.forEachInRange([n,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new je(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class je{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return H.comparator(e.key,t.key)||Z(e.Yr,t.Yr)}static Kr(e,t){return Z(e.Yr,t.Yr)||H.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ee(je.$r)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new rv(a,t,n,i);this.mutationQueue.push(l);for(const c of i)this.Zr=this.Zr.add(new je(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return M.resolve(l)}lookupMutationBatch(e,t){return M.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.ei(n),a=i<0?0:i;return M.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?Lo:this.tr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new je(t,0),i=new je(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],l=>{const c=this.Xr(l.Yr);a.push(c)}),M.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ee(Z);return t.forEach(i=>{const a=new je(i,0),l=new je(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],c=>{n=n.add(c.Yr)})}),M.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let a=n;H.isDocumentKey(a)||(a=a.child(""));const l=new je(new H(a),0);let c=new Ee(Z);return this.Zr.forEachWhile(d=>{const m=d.key.path;return!!n.isPrefixOf(m)&&(m.length===i&&(c=c.add(d.Yr)),!0)},l),M.resolve(this.ti(c))}ti(e){const t=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){oe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return M.forEach(t.mutations,i=>{const a=new je(i.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new je(t,0),i=this.Zr.firstAfterOrEqual(n);return M.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e){this.ri=e,this.docs=function(){return new me(H.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),a=i?i.size:0,l=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return M.resolve(n?n.document.mutableCopy():Ue.newInvalidDocument(t))}getEntries(e,t){let n=Pt();return t.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Ue.newInvalidDocument(i))}),M.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let a=Pt();const l=t.path,c=new H(l.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:m,value:{document:f}}=d.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||yb(xb(f),n)<=0||(i.has(f.key)||Oi(t,f))&&(a=a.insert(f.key,f.mutableCopy()))}return M.resolve(a)}getAllFromCollectionGroup(e,t,n,i){K(9500)}ii(e,t){return M.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Hv(this)}getSize(e){return M.resolve(this.size)}}class Hv extends Lv{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),M.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(e){this.persistence=e,this.si=new Is(t=>Fo(t),Bo),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.oi=0,this._i=new Wo,this.targetCount=0,this.ai=en.ur()}forEachTarget(e,t){return this.si.forEach((n,i)=>t(i)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),M.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new en(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,M.resolve()}updateTargetData(e,t){return this.Pr(t),M.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,t,n){let i=0;const a=[];return this.si.forEach((l,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),M.waitFor(a).next(()=>i)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return M.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),M.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),M.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),M.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return M.resolve(n)}containsKey(e,t){return M.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ri(0),this.li=!1,this.li=!0,this.hi=new qv,this.referenceDelegate=e(this),this.Pi=new Gv(this),this.indexManager=new Rv,this.remoteDocumentCache=function(i){return new $v(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new Av(t),this.Ii=new Fv(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Bv,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new zv(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){q("MemoryPersistence","Starting transaction:",e);const i=new Wv(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ai(e,t){return M.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Wv extends vb{constructor(e){super(),this.currentSequenceNumber=e}}class Ko{constructor(e){this.persistence=e,this.Ri=new Wo,this.Vi=null}static mi(e){return new Ko(e)}get fi(){if(this.Vi)return this.Vi;throw K(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),M.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),M.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),M.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.fi,n=>{const i=H.fromPath(n);return this.gi(e,i).next(a=>{a||t.removeEntry(i,Q.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return M.or([()=>M.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class fi{constructor(e,t){this.persistence=e,this.pi=new Is(n=>Nb(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=Vv(this,t)}static mi(e,t){return new fi(e,t)}Ei(){}di(e){return M.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}pr(e,t){return M.forEach(this.pi,(n,i)=>this.br(e,n,i).next(a=>a?M.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,l=>this.br(e,l,t).next(c=>{c||(n++,a.removeEntry(l,Q.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),M.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),M.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Gr(e.data.value)),t}br(e,t,n){return M.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return M.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=i}static As(e,t){let n=ee(),i=ee();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Qo(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Tg()?8:_b(Be())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,i){const a={result:null};return this.ys(e,t).next(l=>{a.result=l}).next(()=>{if(!a.result)return this.ws(e,t,i,n).next(l=>{a.result=l})}).next(()=>{if(a.result)return;const l=new Kv;return this.Ss(e,t,l).next(c=>{if(a.result=c,this.Vs)return this.bs(e,t,l,c.size)})}).next(()=>a.result)}bs(e,t,n,i){return n.documentReadCount<this.fs?(Vs()<=Y.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",Ls(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),M.resolve()):(Vs()<=Y.DEBUG&&q("QueryEngine","Query:",Ls(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Vs()<=Y.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",Ls(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ft(t))):M.resolve())}ys(e,t){if(vu(t))return M.resolve(null);let n=ft(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=ro(t,null,"F"),n=ft(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const l=ee(...a);return this.ps.getDocuments(e,l).next(c=>this.indexManager.getMinOffset(e,n).next(d=>{const m=this.Ds(t,c);return this.Cs(t,m,l,d.readTime)?this.ys(e,ro(t,null,"F")):this.vs(e,m,t,d)}))})))}ws(e,t,n,i){return vu(t)||i.isEqual(Q.min())?M.resolve(null):this.ps.getDocuments(e,n).next(a=>{const l=this.Ds(t,a);return this.Cs(t,l,n,i)?M.resolve(null):(Vs()<=Y.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ls(t)),this.vs(e,l,t,gb(i,Gn)).next(c=>c))})}Ds(e,t){let n=new Ee(Uh(e));return t.forEach((i,a)=>{Oi(e,a)&&(n=n.add(a))}),n}Cs(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,n){return Vs()<=Y.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",Ls(t)),this.ps.getDocumentsMatchingQuery(e,t,Jt.min(),n)}vs(e,t,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo="LocalStore",Xv=3e8;class Jv{constructor(e,t,n,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new me(Z),this.xs=new Is(a=>Fo(a),Bo),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Uv(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function Yv(s,e,t,n){return new Jv(s,e,t,n)}async function lm(s,e){const t=X(s);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(a=>{const l=[],c=[];let d=ee();for(const m of i){l.push(m.batchId);for(const f of m.mutations)d=d.add(f.key)}for(const m of a){c.push(m.batchId);for(const f of m.mutations)d=d.add(f.key)}return t.localDocuments.getDocuments(n,d).next(m=>({Ls:m,removedBatchIds:l,addedBatchIds:c}))})})}function Zv(s,e){const t=X(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return function(c,d,m,f){const g=m.batch,y=g.keys();let T=M.resolve();return y.forEach(k=>{T=T.next(()=>f.getEntry(d,k)).next(C=>{const N=m.docVersions.get(k);oe(N!==null,48541),C.version.compareTo(N)<0&&(g.applyToRemoteDocument(C,m),C.isValidDocument()&&(C.setReadTime(m.commitVersion),f.addEntry(C)))})}),T.next(()=>c.mutationQueue.removeMutationBatch(d,g))}(t,n,e,a).next(()=>a.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let d=ee();for(let m=0;m<c.mutationResults.length;++m)c.mutationResults[m].transformResults.length>0&&(d=d.add(c.batch.mutations[m].key));return d}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function cm(s){const e=X(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function e_(s,e){const t=X(s),n=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach((f,g)=>{const y=i.get(g);if(!y)return;c.push(t.Pi.removeMatchingKeys(a,f.removedDocuments,g).next(()=>t.Pi.addMatchingKeys(a,f.addedDocuments,g)));let T=y.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(g)!==null?T=T.withResumeToken(ke.EMPTY_BYTE_STRING,Q.min()).withLastLimboFreeSnapshotVersion(Q.min()):f.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(f.resumeToken,n)),i=i.insert(g,T),function(C,N,A){return C.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=Xv?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(y,T,f)&&c.push(t.Pi.updateTargetData(a,T))});let d=Pt(),m=ee();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,f))}),c.push(t_(a,l,e.documentUpdates).next(f=>{d=f.ks,m=f.qs})),!n.isEqual(Q.min())){const f=t.Pi.getLastRemoteSnapshotVersion(a).next(g=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));c.push(f)}return M.waitFor(c).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,d,m)).next(()=>d)}).then(a=>(t.Ms=i,a))}function t_(s,e,t){let n=ee(),i=ee();return t.forEach(a=>n=n.add(a)),e.getEntries(s,n).next(a=>{let l=Pt();return t.forEach((c,d)=>{const m=a.get(c);d.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(c)),d.isNoDocument()&&d.version.isEqual(Q.min())?(e.removeEntry(c,d.readTime),l=l.insert(c,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(d),l=l.insert(c,d)):q(Xo,"Ignoring outdated watch update for ",c,". Current version:",m.version," Watch version:",d.version)}),{ks:l,qs:i}})}function s_(s,e){const t=X(s);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Lo),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function n_(s,e){const t=X(s);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Pi.getTargetData(n,e).next(a=>a?(i=a,M.resolve(i)):t.Pi.allocateTargetId(n).next(l=>(i=new zt(e,l,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n})}async function co(s,e,t){const n=X(s),i=n.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",a,l=>n.persistence.referenceDelegate.removeTarget(l,i))}catch(l){if(!an(l))throw l;q(Xo,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Pu(s,e,t){const n=X(s);let i=Q.min(),a=ee();return n.persistence.runTransaction("Execute query","readwrite",l=>function(d,m,f){const g=X(d),y=g.xs.get(f);return y!==void 0?M.resolve(g.Ms.get(y)):g.Pi.getTargetData(m,f)}(n,l,ft(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,c.targetId).next(d=>{a=d})}).next(()=>n.Fs.getDocumentsMatchingQuery(l,e,t?i:Q.min(),t?a:ee())).next(c=>(r_(n,zb(e),c),{documents:c,Qs:a})))}function r_(s,e,t){let n=s.Os.get(e)||Q.min();t.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),s.Os.set(e,n)}class Du{constructor(){this.activeTargetIds=Qb()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class i_{constructor(){this.Mo=new Du,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Du,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ou="ConnectivityMonitor";class Vu{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){q(Ou,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){q(Ou,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vr=null;function uo(){return Vr===null?Vr=function(){return 268435456+Math.round(2147483648*Math.random())}():Vr++,"0x"+Vr.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ia="RestConnection",o_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class l_{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===oi?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,t,n,i,a){const l=uo(),c=this.zo(e,t.toUriEncodedString());q(Ia,`Sending RPC '${e}' ${l}:`,c,n);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,i,a);const{host:m}=new URL(c),f=ns(m);return this.Jo(e,c,d,n,f).then(g=>(q(Ia,`Received RPC '${e}' ${l}: `,g),g),g=>{throw Xs(Ia,`RPC '${e}' ${l} failed with error: `,g,"url: ",c,"request:",n),g})}Ho(e,t,n,i,a,l){return this.Go(e,t,n,i,a)}jo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+nn}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}zo(e,t){const n=o_[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ve="WebChannelConnection";class u_ extends l_{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,i,a){const l=uo();return new Promise((c,d)=>{const m=new hh;m.setWithCredentials(!0),m.listenOnce(mh.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case Hr.NO_ERROR:const g=m.getResponseJson();q(Ve,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(g)),c(g);break;case Hr.TIMEOUT:q(Ve,`RPC '${e}' ${l} timed out`),d(new $(U.DEADLINE_EXCEEDED,"Request time out"));break;case Hr.HTTP_ERROR:const y=m.getStatus();if(q(Ve,`RPC '${e}' ${l} failed with status:`,y,"response text:",m.getResponseText()),y>0){let T=m.getResponseJson();Array.isArray(T)&&(T=T[0]);const k=T?.error;if(k&&k.status&&k.message){const C=function(A){const I=A.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(I)>=0?I:U.UNKNOWN}(k.status);d(new $(C,k.message))}else d(new $(U.UNKNOWN,"Server responded with status "+m.getStatus()))}else d(new $(U.UNAVAILABLE,"Connection failed."));break;default:K(9055,{l_:e,streamId:l,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{q(Ve,`RPC '${e}' ${l} completed.`)}});const f=JSON.stringify(i);q(Ve,`RPC '${e}' ${l} sending request:`,i),m.send(t,"POST",f,n,15)})}T_(e,t,n){const i=uo(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=gh(),c=ph(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const f=a.join("");q(Ve,`Creating RPC '${e}' stream ${i}: ${f}`,d);const g=l.createWebChannel(f,d);this.I_(g);let y=!1,T=!1;const k=new c_({Yo:N=>{T?q(Ve,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(y||(q(Ve,`Opening RPC '${e}' stream ${i} transport.`),g.open(),y=!0),q(Ve,`RPC '${e}' stream ${i} sending:`,N),g.send(N))},Zo:()=>g.close()}),C=(N,A,I)=>{N.listen(A,S=>{try{I(S)}catch(O){setTimeout(()=>{throw O},0)}})};return C(g,Tn.EventType.OPEN,()=>{T||(q(Ve,`RPC '${e}' stream ${i} transport opened.`),k.o_())}),C(g,Tn.EventType.CLOSE,()=>{T||(T=!0,q(Ve,`RPC '${e}' stream ${i} transport closed`),k.a_(),this.E_(g))}),C(g,Tn.EventType.ERROR,N=>{T||(T=!0,Xs(Ve,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),k.a_(new $(U.UNAVAILABLE,"The operation could not be completed")))}),C(g,Tn.EventType.MESSAGE,N=>{if(!T){const A=N.data[0];oe(!!A,16349);const I=A,S=I?.error||I[0]?.error;if(S){q(Ve,`RPC '${e}' stream ${i} received error:`,S);const O=S.status;let P=function(p){const b=ve[p];if(b!==void 0)return Xh(b)}(O),L=S.message;P===void 0&&(P=U.INTERNAL,L="Unknown error status: "+O+" with message "+S.message),T=!0,k.a_(new $(P,L)),g.close()}else q(Ve,`RPC '${e}' stream ${i} received:`,A),k.u_(A)}}),C(c,fh.STAT_EVENT,N=>{N.stat===Ya.PROXY?q(Ve,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Ya.NOPROXY&&q(Ve,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{k.__()},0),k}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Aa(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ui(s){return new fv(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,t,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-n);i>0&&q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lu="PersistentStream";class dm{constructor(e,t,n,i,a,l,c,d){this.Mi=e,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new um(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===U.RESOURCE_EXHAUSTED?(kt(t.toString()),kt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===t&&this.G_(n,i)},n=>{e(()=>{const i=new $(U.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return q(Lu,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(q(Lu,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class d_ extends dm{constructor(e,t,n,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=xv(this.serializer,e),n=function(a){if(!("targetChange"in a))return Q.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Q.min():l.readTime?gt(l.readTime):Q.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=lo(this.serializer),t.addTarget=function(a,l){let c;const d=l.target;if(c=no(d)?{documents:vv(a,d)}:{query:_v(a,d).ft},c.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){c.resumeToken=Zh(a,l.resumeToken);const m=io(a,l.expectedCount);m!==null&&(c.expectedCount=m)}else if(l.snapshotVersion.compareTo(Q.min())>0){c.readTime=mi(a,l.snapshotVersion.toTimestamp());const m=io(a,l.expectedCount);m!==null&&(c.expectedCount=m)}return c}(this.serializer,e);const n=Nv(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=lo(this.serializer),t.removeTarget=e,this.q_(t)}}class h_ extends dm{constructor(e,t,n,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=bv(e.writeResults,e.commitTime),n=gt(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=lo(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>yv(this.serializer,n))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{}class f_ extends m_{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new $(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Go(e,ao(t,n),i,a,l)).catch(a=>{throw a.name==="FirebaseError"?(a.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new $(U.UNKNOWN,a.toString())})}Ho(e,t,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,c])=>this.connection.Ho(e,ao(t,n),i,l,c,a)).catch(l=>{throw l.name==="FirebaseError"?(l.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new $(U.UNKNOWN,l.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class p_{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(kt(t),this.aa=!1):q("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws="RemoteStore";class g_{constructor(e,t,n,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(l=>{n.enqueueAndForget(async()=>{Ss(this)&&(q(ws,"Restarting streams for network reachability change."),await async function(d){const m=X(d);m.Ea.add(4),await ur(m),m.Ra.set("Unknown"),m.Ea.delete(4),await Fi(m)}(this))})}),this.Ra=new p_(n,i)}}async function Fi(s){if(Ss(s))for(const e of s.da)await e(!0)}async function ur(s){for(const e of s.da)await e(!1)}function hm(s,e){const t=X(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),el(t)?Zo(t):on(t).O_()&&Yo(t,e))}function Jo(s,e){const t=X(s),n=on(t);t.Ia.delete(e),n.O_()&&mm(t,e),t.Ia.size===0&&(n.O_()?n.L_():Ss(t)&&t.Ra.set("Unknown"))}function Yo(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Q.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}on(s).Y_(e)}function mm(s,e){s.Va.Ue(e),on(s).Z_(e)}function Zo(s){s.Va=new uv({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),on(s).start(),s.Ra.ua()}function el(s){return Ss(s)&&!on(s).x_()&&s.Ia.size>0}function Ss(s){return X(s).Ea.size===0}function fm(s){s.Va=void 0}async function x_(s){s.Ra.set("Online")}async function y_(s){s.Ia.forEach((e,t)=>{Yo(s,e)})}async function b_(s,e){fm(s),el(s)?(s.Ra.ha(e),Zo(s)):s.Ra.set("Unknown")}async function v_(s,e,t){if(s.Ra.set("Online"),e instanceof Yh&&e.state===2&&e.cause)try{await async function(i,a){const l=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,l),i.Ia.delete(c),i.Va.removeTarget(c))}(s,e)}catch(n){q(ws,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await pi(s,n)}else if(e instanceof Qr?s.Va.Ze(e):e instanceof Jh?s.Va.st(e):s.Va.tt(e),!t.isEqual(Q.min()))try{const n=await cm(s.localStore);t.compareTo(n)>=0&&await function(a,l){const c=a.Va.Tt(l);return c.targetChanges.forEach((d,m)=>{if(d.resumeToken.approximateByteSize()>0){const f=a.Ia.get(m);f&&a.Ia.set(m,f.withResumeToken(d.resumeToken,l))}}),c.targetMismatches.forEach((d,m)=>{const f=a.Ia.get(d);if(!f)return;a.Ia.set(d,f.withResumeToken(ke.EMPTY_BYTE_STRING,f.snapshotVersion)),mm(a,d);const g=new zt(f.target,d,m,f.sequenceNumber);Yo(a,g)}),a.remoteSyncer.applyRemoteEvent(c)}(s,t)}catch(n){q(ws,"Failed to raise snapshot:",n),await pi(s,n)}}async function pi(s,e,t){if(!an(e))throw e;s.Ea.add(1),await ur(s),s.Ra.set("Offline"),t||(t=()=>cm(s.localStore)),s.asyncQueue.enqueueRetryable(async()=>{q(ws,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await Fi(s)})}function pm(s,e){return e().catch(t=>pi(s,t,e))}async function Bi(s){const e=X(s),t=ts(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Lo;for(;__(e);)try{const i=await s_(e.localStore,n);if(i===null){e.Ta.length===0&&t.L_();break}n=i.batchId,w_(e,i)}catch(i){await pi(e,i)}gm(e)&&xm(e)}function __(s){return Ss(s)&&s.Ta.length<10}function w_(s,e){s.Ta.push(e);const t=ts(s);t.O_()&&t.X_&&t.ea(e.mutations)}function gm(s){return Ss(s)&&!ts(s).x_()&&s.Ta.length>0}function xm(s){ts(s).start()}async function N_(s){ts(s).ra()}async function E_(s){const e=ts(s);for(const t of s.Ta)e.ea(t.mutations)}async function T_(s,e,t){const n=s.Ta.shift(),i=$o.from(n,e,t);await pm(s,()=>s.remoteSyncer.applySuccessfulWrite(i)),await Bi(s)}async function j_(s,e){e&&ts(s).X_&&await async function(n,i){if(function(l){return ov(l)&&l!==U.ABORTED}(i.code)){const a=n.Ta.shift();ts(n).B_(),await pm(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Bi(n)}}(s,e),gm(s)&&xm(s)}async function Mu(s,e){const t=X(s);t.asyncQueue.verifyOperationInProgress(),q(ws,"RemoteStore received new credentials");const n=Ss(t);t.Ea.add(3),await ur(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Fi(t)}async function I_(s,e){const t=X(s);e?(t.Ea.delete(2),await Fi(t)):e||(t.Ea.add(2),await ur(t),t.Ra.set("Unknown"))}function on(s){return s.ma||(s.ma=function(t,n,i){const a=X(t);return a.sa(),new d_(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(s.datastore,s.asyncQueue,{Xo:x_.bind(null,s),t_:y_.bind(null,s),r_:b_.bind(null,s),H_:v_.bind(null,s)}),s.da.push(async e=>{e?(s.ma.B_(),el(s)?Zo(s):s.Ra.set("Unknown")):(await s.ma.stop(),fm(s))})),s.ma}function ts(s){return s.fa||(s.fa=function(t,n,i){const a=X(t);return a.sa(),new h_(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:N_.bind(null,s),r_:j_.bind(null,s),ta:E_.bind(null,s),na:T_.bind(null,s)}),s.da.push(async e=>{e?(s.fa.B_(),await Bi(s)):(await s.fa.stop(),s.Ta.length>0&&(q(ws,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))})),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,t,n,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new Wt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,a){const l=Date.now()+n,c=new tl(e,t,l,i,a);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sl(s,e){if(kt("AsyncQueue",`${e}: ${s}`),an(s))return new $(U.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{static emptySet(e){return new Hs(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||H.comparator(t.key,n.key):(t,n)=>H.comparator(t.key,n.key),this.keyedMap=jn(),this.sortedSet=new me(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Hs)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Hs;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(){this.ga=new me(H.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):K(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class tn{constructor(e,t,n,i,a,l,c,d,m){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=c,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,t,n,i,a){const l=[];return t.forEach(c=>{l.push({type:0,doc:c})}),new tn(e,t,Hs.emptySet(t),l,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Di(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class S_{constructor(){this.queries=Fu(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const i=X(t),a=i.queries;i.queries=Fu(),a.forEach((l,c)=>{for(const d of c.Sa)d.onError(n)})})(this,new $(U.ABORTED,"Firestore shutting down"))}}function Fu(){return new Is(s=>Mh(s),Di)}async function R_(s,e){const t=X(s);let n=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(n=2):(a=new A_,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(l){const c=sl(l,`Initialization of query '${Ls(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&nl(t)}async function C_(s,e){const t=X(s),n=e.query;let i=3;const a=t.queries.get(n);if(a){const l=a.Sa.indexOf(e);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function k_(s,e){const t=X(s);let n=!1;for(const i of e){const a=i.query,l=t.queries.get(a);if(l){for(const c of l.Sa)c.Fa(i)&&(n=!0);l.wa=i}}n&&nl(t)}function P_(s,e,t){const n=X(s),i=n.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);n.queries.delete(e)}function nl(s){s.Ca.forEach(e=>{e.next()})}var ho,Bu;(Bu=ho||(ho={})).Ma="default",Bu.Cache="cache";class D_{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new tn(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=tn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ho.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e){this.key=e}}class bm{constructor(e){this.key=e}}class O_{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ee(),this.mutatedKeys=ee(),this.eu=Uh(e),this.tu=new Hs(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Uu,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,c=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,m=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,g)=>{const y=i.get(f),T=Oi(this.query,g)?g:null,k=!!y&&this.mutatedKeys.has(y.key),C=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let N=!1;y&&T?y.data.isEqual(T.data)?k!==C&&(n.track({type:3,doc:T}),N=!0):this.su(y,T)||(n.track({type:2,doc:T}),N=!0,(d&&this.eu(T,d)>0||m&&this.eu(T,m)<0)&&(c=!0)):!y&&T?(n.track({type:0,doc:T}),N=!0):y&&!T&&(n.track({type:1,doc:y}),N=!0,(d||m)&&(c=!0)),N&&(T?(l=l.add(T),a=C?a.add(f):a.delete(f)):(l=l.delete(f),a=a.delete(f)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const f=this.query.limitType==="F"?l.last():l.first();l=l.delete(f.key),a=a.delete(f.key),n.track({type:1,doc:f})}return{tu:l,iu:n,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort((f,g)=>function(T,k){const C=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return K(20277,{Rt:N})}};return C(T)-C(k)}(f.type,g.type)||this.eu(f.doc,g.doc)),this.ou(n),i=i??!1;const c=t&&!i?this._u():[],d=this.Xa.size===0&&this.current&&!i?1:0,m=d!==this.Za;return this.Za=d,l.length!==0||m?{snapshot:new tn(this.query,e.tu,a,l,e.mutatedKeys,d===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Uu,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ee(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const t=[];return e.forEach(n=>{this.Xa.has(n)||t.push(new bm(n))}),this.Xa.forEach(n=>{e.has(n)||t.push(new ym(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=ee();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return tn.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const rl="SyncEngine";class V_{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class L_{constructor(e){this.key=e,this.hu=!1}}class M_{constructor(e,t,n,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Is(c=>Mh(c),Di),this.Iu=new Map,this.Eu=new Set,this.du=new me(H.comparator),this.Au=new Map,this.Ru=new Wo,this.Vu={},this.mu=new Map,this.fu=en.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function U_(s,e,t=!0){const n=Tm(s);let i;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await vm(n,e,t,!0),i}async function F_(s,e){const t=Tm(s);await vm(t,e,!0,!1)}async function vm(s,e,t,n){const i=await n_(s.localStore,ft(e)),a=i.targetId,l=s.sharedClientState.addLocalQueryTarget(a,t);let c;return n&&(c=await B_(s,e,a,l==="current",i.resumeToken)),s.isPrimaryClient&&t&&hm(s.remoteStore,i),c}async function B_(s,e,t,n,i){s.pu=(g,y,T)=>async function(C,N,A,I){let S=N.view.ru(A);S.Cs&&(S=await Pu(C.localStore,N.query,!1).then(({documents:v})=>N.view.ru(v,S)));const O=I&&I.targetChanges.get(N.targetId),P=I&&I.targetMismatches.get(N.targetId)!=null,L=N.view.applyChanges(S,C.isPrimaryClient,O,P);return zu(C,N.targetId,L.au),L.snapshot}(s,g,y,T);const a=await Pu(s.localStore,e,!0),l=new O_(e,a.Qs),c=l.ru(a.documents),d=cr.createSynthesizedTargetChangeForCurrentChange(t,n&&s.onlineState!=="Offline",i),m=l.applyChanges(c,s.isPrimaryClient,d);zu(s,t,m.au);const f=new V_(e,t,l);return s.Tu.set(e,f),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),m.snapshot}async function q_(s,e,t){const n=X(s),i=n.Tu.get(e),a=n.Iu.get(i.targetId);if(a.length>1)return n.Iu.set(i.targetId,a.filter(l=>!Di(l,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await co(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&Jo(n.remoteStore,i.targetId),mo(n,i.targetId)}).catch(rn)):(mo(n,i.targetId),await co(n.localStore,i.targetId,!0))}async function z_(s,e){const t=X(s),n=t.Tu.get(e),i=t.Iu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Jo(t.remoteStore,n.targetId))}async function $_(s,e,t){const n=J_(s);try{const i=await function(l,c){const d=X(l),m=he.now(),f=c.reduce((T,k)=>T.add(k.key),ee());let g,y;return d.persistence.runTransaction("Locally write mutations","readwrite",T=>{let k=Pt(),C=ee();return d.Ns.getEntries(T,f).next(N=>{k=N,k.forEach((A,I)=>{I.isValidDocument()||(C=C.add(A))})}).next(()=>d.localDocuments.getOverlayedDocuments(T,k)).next(N=>{g=N;const A=[];for(const I of c){const S=sv(I,g.get(I.key).overlayedDocument);S!=null&&A.push(new As(I.key,S,Rh(S.value.mapValue),pt.exists(!0)))}return d.mutationQueue.addMutationBatch(T,m,A,c)}).next(N=>{y=N;const A=N.applyToLocalDocumentSet(g,C);return d.documentOverlayCache.saveOverlays(T,N.batchId,A)})}).then(()=>({batchId:y.batchId,changes:Bh(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(l,c,d){let m=l.Vu[l.currentUser.toKey()];m||(m=new me(Z)),m=m.insert(c,d),l.Vu[l.currentUser.toKey()]=m}(n,i.batchId,t),await dr(n,i.changes),await Bi(n.remoteStore)}catch(i){const a=sl(i,"Failed to persist write");t.reject(a)}}async function _m(s,e){const t=X(s);try{const n=await e_(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.Au.get(a);l&&(oe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?oe(l.hu,14607):i.removedDocuments.size>0&&(oe(l.hu,42227),l.hu=!1))}),await dr(t,n,e)}catch(n){await rn(n)}}function qu(s,e,t){const n=X(s);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Tu.forEach((a,l)=>{const c=l.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(l,c){const d=X(l);d.onlineState=c;let m=!1;d.queries.forEach((f,g)=>{for(const y of g.Sa)y.va(c)&&(m=!0)}),m&&nl(d)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function H_(s,e,t){const n=X(s);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Au.get(e),a=i&&i.key;if(a){let l=new me(H.comparator);l=l.insert(a,Ue.newNoDocument(a,Q.min()));const c=ee().add(a),d=new Mi(Q.min(),new Map,new me(Z),l,c);await _m(n,d),n.du=n.du.remove(a),n.Au.delete(e),il(n)}else await co(n.localStore,e,!1).then(()=>mo(n,e,t)).catch(rn)}async function G_(s,e){const t=X(s),n=e.batch.batchId;try{const i=await Zv(t.localStore,e);Nm(t,n,null),wm(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await dr(t,i)}catch(i){await rn(i)}}async function W_(s,e,t){const n=X(s);try{const i=await function(l,c){const d=X(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let f;return d.mutationQueue.lookupMutationBatch(m,c).next(g=>(oe(g!==null,37113),f=g.keys(),d.mutationQueue.removeMutationBatch(m,g))).next(()=>d.mutationQueue.performConsistencyCheck(m)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(m,f,c)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,f)).next(()=>d.localDocuments.getDocuments(m,f))})}(n.localStore,e);Nm(n,e,t),wm(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await dr(n,i)}catch(i){await rn(i)}}function wm(s,e){(s.mu.get(e)||[]).forEach(t=>{t.resolve()}),s.mu.delete(e)}function Nm(s,e,t){const n=X(s);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function mo(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const n of s.Iu.get(e))s.Tu.delete(n),t&&s.Pu.yu(n,t);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach(n=>{s.Ru.containsKey(n)||Em(s,n)})}function Em(s,e){s.Eu.delete(e.path.canonicalString());const t=s.du.get(e);t!==null&&(Jo(s.remoteStore,t),s.du=s.du.remove(e),s.Au.delete(t),il(s))}function zu(s,e,t){for(const n of t)n instanceof ym?(s.Ru.addReference(n.key,e),K_(s,n)):n instanceof bm?(q(rl,"Document no longer in limbo: "+n.key),s.Ru.removeReference(n.key,e),s.Ru.containsKey(n.key)||Em(s,n.key)):K(19791,{wu:n})}function K_(s,e){const t=e.key,n=t.path.canonicalString();s.du.get(t)||s.Eu.has(n)||(q(rl,"New document in limbo: "+t),s.Eu.add(n),il(s))}function il(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new H(de.fromString(e)),n=s.fu.next();s.Au.set(n,new L_(t)),s.du=s.du.insert(t,n),hm(s.remoteStore,new zt(ft(Lh(t.path)),n,"TargetPurposeLimboResolution",Ri.ce))}}async function dr(s,e,t){const n=X(s),i=[],a=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach((c,d)=>{l.push(n.pu(d,e,t).then(m=>{if((m||t)&&n.isPrimaryClient){const f=m?!m.fromCache:t?.targetChanges.get(d.targetId)?.current;n.sharedClientState.updateQueryState(d.targetId,f?"current":"not-current")}if(m){i.push(m);const f=Qo.As(d.targetId,m);a.push(f)}}))}),await Promise.all(l),n.Pu.H_(i),await async function(d,m){const f=X(d);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>M.forEach(m,y=>M.forEach(y.Es,T=>f.persistence.referenceDelegate.addReference(g,y.targetId,T)).next(()=>M.forEach(y.ds,T=>f.persistence.referenceDelegate.removeReference(g,y.targetId,T)))))}catch(g){if(!an(g))throw g;q(Xo,"Failed to update sequence numbers: "+g)}for(const g of m){const y=g.targetId;if(!g.fromCache){const T=f.Ms.get(y),k=T.snapshotVersion,C=T.withLastLimboFreeSnapshotVersion(k);f.Ms=f.Ms.insert(y,C)}}}(n.localStore,a))}async function Q_(s,e){const t=X(s);if(!t.currentUser.isEqual(e)){q(rl,"User change. New user:",e.toKey());const n=await lm(t.localStore,e);t.currentUser=e,function(a,l){a.mu.forEach(c=>{c.forEach(d=>{d.reject(new $(U.CANCELLED,l))})}),a.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await dr(t,n.Ls)}}function X_(s,e){const t=X(s),n=t.Au.get(e);if(n&&n.hu)return ee().add(n.key);{let i=ee();const a=t.Iu.get(e);if(!a)return i;for(const l of a){const c=t.Tu.get(l);i=i.unionWith(c.view.nu)}return i}}function Tm(s){const e=X(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=_m.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=X_.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=H_.bind(null,e),e.Pu.H_=k_.bind(null,e.eventManager),e.Pu.yu=P_.bind(null,e.eventManager),e}function J_(s){const e=X(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=G_.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=W_.bind(null,e),e}class gi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ui(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Yv(this.persistence,new Qv,e.initialUser,this.serializer)}Cu(e){return new om(Ko.mi,this.serializer)}Du(e){return new i_}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gi.provider={build:()=>new gi};class Y_ extends gi{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){oe(this.persistence.referenceDelegate instanceof fi,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Dv(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?We.withCacheSize(this.cacheSizeBytes):We.DEFAULT;return new om(n=>fi.mi(n,t),this.serializer)}}class fo{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>qu(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Q_.bind(null,this.syncEngine),await I_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new S_}()}createDatastore(e){const t=Ui(e.databaseInfo.databaseId),n=function(a){return new u_(a)}(e.databaseInfo);return function(a,l,c,d){return new f_(a,l,c,d)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,a,l,c){return new g_(n,i,a,l,c)}(this.localStore,this.datastore,e.asyncQueue,t=>qu(this.syncEngine,t,0),function(){return Vu.v()?new Vu:new a_}())}createSyncEngine(e,t){return function(i,a,l,c,d,m,f){const g=new M_(i,a,l,c,d,m);return f&&(g.gu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(t){const n=X(t);q(ws,"RemoteStore shutting down."),n.Ea.add(5),await ur(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}fo.provider={build:()=>new fo};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):kt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="FirestoreClient";class ew{constructor(e,t,n,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Le.UNAUTHENTICATED,this.clientId=Oo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async l=>{q(ss,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(n,l=>(q(ss,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=sl(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Sa(s,e){s.asyncQueue.verifyOperationInProgress(),q(ss,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let n=t.initialUser;s.setCredentialChangeListener(async i=>{n.isEqual(i)||(await lm(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>s.terminate()),s._offlineComponents=e}async function $u(s,e){s.asyncQueue.verifyOperationInProgress();const t=await tw(s);q(ss,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener(n=>Mu(e.remoteStore,n)),s.setAppCheckTokenChangeListener((n,i)=>Mu(e.remoteStore,i)),s._onlineComponents=e}async function tw(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){q(ss,"Using user provided OfflineComponentProvider");try{await Sa(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Xs("Error using user provided cache. Falling back to memory cache: "+t),await Sa(s,new gi)}}else q(ss,"Using default OfflineComponentProvider"),await Sa(s,new Y_(void 0));return s._offlineComponents}async function jm(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(q(ss,"Using user provided OnlineComponentProvider"),await $u(s,s._uninitializedComponentsProvider._online)):(q(ss,"Using default OnlineComponentProvider"),await $u(s,new fo))),s._onlineComponents}function sw(s){return jm(s).then(e=>e.syncEngine)}async function nw(s){const e=await jm(s),t=e.eventManager;return t.onListen=U_.bind(null,e.syncEngine),t.onUnlisten=q_.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=F_.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=z_.bind(null,e.syncEngine),t}function rw(s,e,t={}){const n=new Wt;return s.asyncQueue.enqueueAndForget(async()=>function(a,l,c,d,m){const f=new Z_({next:y=>{f.Nu(),l.enqueueAndForget(()=>C_(a,g)),y.fromCache&&d.source==="server"?m.reject(new $(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(y)},error:y=>m.reject(y)}),g=new D_(c,f,{includeMetadataChanges:!0,qa:!0});return R_(a,g)}(await nw(s),s.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hu=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Am="firestore.googleapis.com",Gu=!0;class Wu{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new $(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Am,this.ssl=Gu}else this.host=e.host,this.ssl=e.ssl??Gu;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=am;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<kv)throw new $(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Im(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new $(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new $(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new $(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qi{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Wu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Wu(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new ib;switch(n.type){case"firstParty":return new cb(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=Hu.get(t);n&&(q("ComponentProvider","Removing Datastore"),Hu.delete(t),n.terminate())}(this),Promise.resolve()}}function iw(s,e,t,n={}){s=Hn(s,qi);const i=ns(e),a=s._getSettings(),l={...a,emulatorOptions:s._getEmulatorOptions()},c=`${e}:${t}`;i&&(_o(`https://${c}`),wo("Firestore",!0)),a.host!==Am&&a.host!==c&&Xs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...a,host:c,ssl:i,emulatorOptions:n};if(!xs(d,l)&&(s._setSettings(d),n.mockUserToken)){let m,f;if(typeof n.mockUserToken=="string")m=n.mockUserToken,f=Le.MOCK_USER;else{m=Td(n.mockUserToken,s._app?.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new $(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Le(g)}s._authCredentials=new ab(new yh(m,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new zi(this.firestore,e,this._query)}}class Re{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Re(this.firestore,e,this._key)}toJSON(){return{type:Re._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(or(t,Re._jsonSchema))return new Re(e,n||null,new H(de.fromString(t.referencePath)))}}Re._jsonSchemaVersion="firestore/documentReference/1.0",Re._jsonSchema={type:_e("string",Re._jsonSchemaVersion),referencePath:_e("string")};class Kt extends zi{constructor(e,t,n){super(e,t,Lh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Re(this.firestore,null,new H(e))}withConverter(e){return new Kt(this.firestore,e,this._path)}}function Ku(s,e,...t){if(s=Ce(s),bh("collection","path",e),s instanceof qi){const n=de.fromString(e,...t);return ou(n),new Kt(s,null,n)}{if(!(s instanceof Re||s instanceof Kt))throw new $(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(de.fromString(e,...t));return ou(n),new Kt(s.firestore,null,n)}}function Sm(s,e,...t){if(s=Ce(s),arguments.length===1&&(e=Oo.newId()),bh("doc","path",e),s instanceof qi){const n=de.fromString(e,...t);return au(n),new Re(s,null,new H(n))}{if(!(s instanceof Re||s instanceof Kt))throw new $(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(de.fromString(e,...t));return au(n),new Re(s.firestore,s instanceof Kt?s.converter:null,new H(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu="AsyncQueue";class Xu{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new um(this,"async_queue_retry"),this._c=()=>{const n=Aa();n&&q(Qu,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Aa();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Aa();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Wt;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!an(e))throw e;q(Qu,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,kt("INTERNAL UNHANDLED ERROR: ",Ju(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=tl.createAndSchedule(this,e,t,n,a=>this.hc(a));return this.tc.push(i),i}uc(){this.nc&&K(47125,{Pc:Ju(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Ju(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class $i extends qi{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Xu,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xu(e),this._firestoreClient=void 0,await e}}}function aw(s,e){const t=typeof s=="object"?s:To(),n=typeof s=="string"?s:oi,i=ji(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=wd("firestore");a&&iw(i,...a)}return i}function Rm(s){if(s._terminated)throw new $(U.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||ow(s),s._firestoreClient}function ow(s){const e=s._freezeSettings(),t=function(i,a,l,c){return new jb(i,a,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Im(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(s._databaseId,s._app?.options.appId||"",s._persistenceKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new ew(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}}(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tt(ke.fromBase64String(e))}catch(t){throw new $(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new tt(ke.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:tt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(or(e,tt._jsonSchema))return tt.fromBase64String(e.bytes)}}tt._jsonSchemaVersion="firestore/bytes/1.0",tt._jsonSchema={type:_e("string",tt._jsonSchemaVersion),bytes:_e("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new $(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Se(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new $(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new $(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Z(this._lat,e._lat)||Z(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:xt._jsonSchemaVersion}}static fromJSON(e){if(or(e,xt._jsonSchema))return new xt(e.latitude,e.longitude)}}xt._jsonSchemaVersion="firestore/geoPoint/1.0",xt._jsonSchema={type:_e("string",xt._jsonSchemaVersion),latitude:_e("number"),longitude:_e("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:yt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(or(e,yt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new yt(e.vectorValues);throw new $(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}yt._jsonSchemaVersion="firestore/vectorValue/1.0",yt._jsonSchema={type:_e("string",yt._jsonSchemaVersion),vectorValues:_e("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lw=/^__.*__$/;class cw{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new As(e,this.data,this.fieldMask,t,this.fieldTransforms):new lr(e,this.data,t,this.fieldTransforms)}}function km(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw K(40011,{Ac:s})}}class ol{constructor(e,t,n,i,a,l){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ol({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return xi(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(km(this.Ac)&&lw.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class uw{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Ui(e)}Cc(e,t,n,i=!1){return new ol({Ac:e,methodName:t,Dc:n,path:Se.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function dw(s){const e=s._freezeSettings(),t=Ui(s._databaseId);return new uw(s._databaseId,!!e.ignoreUndefinedProperties,t)}function hw(s,e,t,n,i,a={}){const l=s.Cc(a.merge||a.mergeFields?2:0,e,t,i);Vm("Data must be an object, but it was:",l,n);const c=Dm(n,l);let d,m;if(a.merge)d=new it(l.fieldMask),m=l.fieldTransforms;else if(a.mergeFields){const f=[];for(const g of a.mergeFields){const y=mw(e,g,t);if(!l.contains(y))throw new $(U.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);pw(f,y)||f.push(y)}d=new it(f),m=l.fieldTransforms.filter(g=>d.covers(g.field))}else d=null,m=l.fieldTransforms;return new cw(new et(c),d,m)}function Pm(s,e){if(Om(s=Ce(s)))return Vm("Unsupported field value:",e,s),Dm(s,e);if(s instanceof Cm)return function(n,i){if(!km(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const a=[];let l=0;for(const c of n){let d=Pm(c,i.wc(l));d==null&&(d={nullValue:"NULL_VALUE"}),a.push(d),l++}return{arrayValue:{values:a}}}(s,e)}return function(n,i){if((n=Ce(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Xb(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=he.fromDate(n);return{timestampValue:mi(i.serializer,a)}}if(n instanceof he){const a=new he(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:mi(i.serializer,a)}}if(n instanceof xt)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof tt)return{bytesValue:Zh(i.serializer,n._byteString)};if(n instanceof Re){const a=i.databaseId,l=n.firestore._databaseId;if(!l.isEqual(a))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Go(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof yt)return function(l,c){return{mapValue:{fields:{[Ah]:{stringValue:Sh},[li]:{arrayValue:{values:l.toArray().map(m=>{if(typeof m!="number")throw c.Sc("VectorValues must only contain numeric values.");return qo(c.serializer,m)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Vo(n)}`)}(s,e)}function Dm(s,e){const t={};return wh(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):js(s,(n,i)=>{const a=Pm(i,e.mc(n));a!=null&&(t[n]=a)}),{mapValue:{fields:t}}}function Om(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof he||s instanceof xt||s instanceof tt||s instanceof Re||s instanceof Cm||s instanceof yt)}function Vm(s,e,t){if(!Om(t)||!vh(t)){const n=Vo(t);throw n==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+n)}}function mw(s,e,t){if((e=Ce(e))instanceof al)return e._internalPath;if(typeof e=="string")return Lm(s,e);throw xi("Field path arguments must be of type string or ",s,!1,void 0,t)}const fw=new RegExp("[~\\*/\\[\\]]");function Lm(s,e,t){if(e.search(fw)>=0)throw xi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new al(...e.split("."))._internalPath}catch{throw xi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function xi(s,e,t,n,i){const a=n&&!n.isEmpty(),l=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let d="";return(a||l)&&(d+=" (found",a&&(d+=` in field ${n}`),l&&(d+=` in document ${i}`),d+=")"),new $(U.INVALID_ARGUMENT,c+s+d)}function pw(s,e){return s.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e,t,n,i,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Re(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new gw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Um("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class gw extends Mm{data(){return super.data()}}function Um(s,e){return typeof e=="string"?Lm(s,e):e instanceof al?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xw(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new $(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class yw{convertValue(e,t="none"){switch(es(e)){case 0:return null;case 1:return e.booleanValue;case 2:return be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Zt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw K(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return js(e,(i,a)=>{n[i]=this.convertValue(a,t)}),n}convertVectorValue(e){const t=e.fields?.[li].arrayValue?.values?.map(n=>be(n.doubleValue));return new yt(t)}convertGeoPoint(e){return new xt(be(e.latitude),be(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ki(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Wn(e));default:return null}}convertTimestamp(e){const t=Yt(e);return new he(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=de.fromString(e);oe(im(n),9688,{name:e});const i=new Kn(n.get(1),n.get(3)),a=new H(n.popFirst(5));return i.isEqual(t)||kt(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bw(s,e,t){let n;return n=s?s.toFirestore(e):e,n}class Lr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gs extends Mm{constructor(e,t,n,i,a,l){super(e,t,n,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Xr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Um("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new $(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Gs._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Gs._jsonSchemaVersion="firestore/documentSnapshot/1.0",Gs._jsonSchema={type:_e("string",Gs._jsonSchemaVersion),bundleSource:_e("string","DocumentSnapshot"),bundleName:_e("string"),bundle:_e("string")};class Xr extends Gs{data(e={}){return super.data(e)}}class Ws{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Lr(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Xr(this._firestore,this._userDataWriter,n.key,n,new Lr(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new $(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map(c=>{const d=new Xr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Lr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}})}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>a||c.type!==3).map(c=>{const d=new Xr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Lr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,f=-1;return c.type!==0&&(m=l.indexOf(c.doc.key),l=l.delete(c.doc.key)),c.type!==1&&(l=l.add(c.doc),f=l.indexOf(c.doc.key)),{type:vw(c.type),doc:d,oldIndex:m,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new $(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ws._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Oo.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(t.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function vw(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return K(61501,{type:s})}}Ws._jsonSchemaVersion="firestore/querySnapshot/1.0",Ws._jsonSchema={type:_e("string",Ws._jsonSchemaVersion),bundleSource:_e("string","QuerySnapshot"),bundleName:_e("string"),bundle:_e("string")};class _w extends yw{constructor(e){super(),this.firestore=e}convertBytes(e){return new tt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Re(this.firestore,null,t)}}function ww(s){s=Hn(s,zi);const e=Hn(s.firestore,$i),t=Rm(e),n=new _w(e);return xw(s._query),rw(t,s._query).then(i=>new Ws(e,n,s,i))}function Nw(s){return Fm(Hn(s.firestore,$i),[new zo(s._key,pt.none())])}function Ew(s,e){const t=Hn(s.firestore,$i),n=Sm(s),i=bw(s.converter,e);return Fm(t,[hw(dw(s.firestore),"addDoc",n._key,i,s.converter!==null,{}).toMutation(n._key,pt.exists(!1))]).then(()=>n)}function Fm(s,e){return function(n,i){const a=new Wt;return n.asyncQueue.enqueueAndForget(async()=>$_(await sw(n),i,a)),a.promise}(Rm(s),e)}(function(e,t=!0){(function(i){nn=i})(Es),ys(new Xt("firestore",(n,{instanceIdentifier:i,options:a})=>{const l=n.getProvider("app").getImmediate(),c=new $i(new ob(n.getProvider("auth-internal")),new ub(l,n.getProvider("app-check-internal")),function(m,f){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new $(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kn(m.options.projectId,f)}(l,i),l);return a={useFetchStreams:t,...a},c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),dt(su,nu,e),dt(su,nu,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bm="firebasestorage.googleapis.com",qm="storageBucket",Tw=2*60*1e3,jw=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge extends _t{constructor(e,t,n=0){super(Ra(e),`Firebase Storage: ${t} (${Ra(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ge.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ra(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var pe;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(pe||(pe={}));function Ra(s){return"storage/"+s}function ll(){const s="An unknown error occurred, please check the error payload for server response.";return new ge(pe.UNKNOWN,s)}function Iw(s){return new ge(pe.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function Aw(s){return new ge(pe.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Sw(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ge(pe.UNAUTHENTICATED,s)}function Rw(){return new ge(pe.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Cw(s){return new ge(pe.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function kw(){return new ge(pe.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Pw(){return new ge(pe.CANCELED,"User canceled the upload/download.")}function Dw(s){return new ge(pe.INVALID_URL,"Invalid URL '"+s+"'.")}function Ow(s){return new ge(pe.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function Vw(){return new ge(pe.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+qm+"' property when initializing the app?")}function Lw(){return new ge(pe.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Mw(){return new ge(pe.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Uw(s){return new ge(pe.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function po(s){return new ge(pe.INVALID_ARGUMENT,s)}function zm(){return new ge(pe.APP_DELETED,"The Firebase app was deleted.")}function Fw(s){return new ge(pe.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Vn(s,e){return new ge(pe.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function wn(s){throw new ge(pe.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Ye.makeFromUrl(e,t)}catch{return new Ye(e,"")}if(n.path==="")return n;throw Ow(e)}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(O){O.path.charAt(O.path.length-1)==="/"&&(O.path_=O.path_.slice(0,-1))}const l="(/(.*))?$",c=new RegExp("^gs://"+i+l,"i"),d={bucket:1,path:3};function m(O){O.path_=decodeURIComponent(O.path)}const f="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",T=new RegExp(`^https?://${g}/${f}/b/${i}/o${y}`,"i"),k={bucket:1,path:3},C=t===Bm?"(?:storage.googleapis.com|storage.cloud.google.com)":t,N="([^?#]*)",A=new RegExp(`^https?://${C}/${i}/${N}`,"i"),S=[{regex:c,indices:d,postModify:a},{regex:T,indices:k,postModify:m},{regex:A,indices:{bucket:1,path:2},postModify:m}];for(let O=0;O<S.length;O++){const P=S[O],L=P.regex.exec(e);if(L){const v=L[P.indices.bucket];let p=L[P.indices.path];p||(p=""),n=new Ye(v,p),P.postModify(n);break}}if(n==null)throw Dw(e);return n}}class Bw{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qw(s,e,t){let n=1,i=null,a=null,l=!1,c=0;function d(){return c===2}let m=!1;function f(...N){m||(m=!0,e.apply(null,N))}function g(N){i=setTimeout(()=>{i=null,s(T,d())},N)}function y(){a&&clearTimeout(a)}function T(N,...A){if(m){y();return}if(N){y(),f.call(null,N,...A);return}if(d()||l){y(),f.call(null,N,...A);return}n<64&&(n*=2);let S;c===1?(c=2,S=0):S=(n+Math.random())*1e3,g(S)}let k=!1;function C(N){k||(k=!0,y(),!m&&(i!==null?(N||(c=2),clearTimeout(i),g(0)):N||(c=1)))}return g(0),a=setTimeout(()=>{l=!0,C(!0)},t),C}function zw(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(s){return s!==void 0}function Hw(s){return typeof s=="object"&&!Array.isArray(s)}function cl(s){return typeof s=="string"||s instanceof String}function Yu(s){return ul()&&s instanceof Blob}function ul(){return typeof Blob<"u"}function Zu(s,e,t,n){if(n<e)throw po(`Invalid value for '${s}'. Expected ${e} or greater.`);if(n>t)throw po(`Invalid value for '${s}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dl(s,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${s}`}function $m(s){const e=encodeURIComponent;let t="?";for(const n in s)if(s.hasOwnProperty(n)){const i=e(n)+"="+e(s[n]);t=t+i+"&"}return t=t.slice(0,-1),t}var ps;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(ps||(ps={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gw(s,e){const t=s>=500&&s<600,i=[408,429].indexOf(s)!==-1,a=e.indexOf(s)!==-1;return t||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e,t,n,i,a,l,c,d,m,f,g,y=!0,T=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=c,this.errorCallback_=d,this.timeout_=m,this.progressCallback_=f,this.connectionFactory_=g,this.retry=y,this.isUsingEmulator=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((k,C)=>{this.resolve_=k,this.reject_=C,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new Mr(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const l=c=>{const d=c.loaded,m=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,m)};this.progressCallback_!==null&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const c=a.getErrorCode()===ps.NO_ERROR,d=a.getStatus();if(!c||Gw(d,this.additionalRetryCodes_)&&this.retry){const f=a.getErrorCode()===ps.ABORT;n(!1,new Mr(!1,null,f));return}const m=this.successCodes_.indexOf(d)!==-1;n(!0,new Mr(m,a))})},t=(n,i)=>{const a=this.resolve_,l=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const d=this.callback_(c,c.getResponse());$w(d)?a(d):a()}catch(d){l(d)}else if(c!==null){const d=ll();d.serverResponse=c.getErrorText(),this.errorCallback_?l(this.errorCallback_(c,d)):l(d)}else if(i.canceled){const d=this.appDelete_?zm():Pw();l(d)}else{const d=kw();l(d)}};this.canceled_?t(!1,new Mr(!1,null,!0)):this.backoffId_=qw(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&zw(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Mr{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function Kw(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function Qw(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Xw(s,e){e&&(s["X-Firebase-GMPID"]=e)}function Jw(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function Yw(s,e,t,n,i,a,l=!0,c=!1){const d=$m(s.urlParams),m=s.url+d,f=Object.assign({},s.headers);return Xw(f,e),Kw(f,t),Qw(f,a),Jw(f,n),new Ww(m,s.method,f,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,i,l,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function eN(...s){const e=Zw();if(e!==void 0){const t=new e;for(let n=0;n<s.length;n++)t.append(s[n]);return t.getBlob()}else{if(ul())return new Blob(s);throw new ge(pe.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function tN(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sN(s){if(typeof atob>"u")throw Uw("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ca{constructor(e,t){this.data=e,this.contentType=t||null}}function nN(s,e){switch(s){case ct.RAW:return new Ca(Hm(e));case ct.BASE64:case ct.BASE64URL:return new Ca(Gm(s,e));case ct.DATA_URL:return new Ca(iN(e),aN(e))}throw ll()}function Hm(s){const e=[];for(let t=0;t<s.length;t++){let n=s.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const a=n,l=s.charCodeAt(++t);n=65536|(a&1023)<<10|l&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function rN(s){let e;try{e=decodeURIComponent(s)}catch{throw Vn(ct.DATA_URL,"Malformed data URL.")}return Hm(e)}function Gm(s,e){switch(s){case ct.BASE64:{const i=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(i||a)throw Vn(s,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case ct.BASE64URL:{const i=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(i||a)throw Vn(s,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=sN(e)}catch(i){throw i.message.includes("polyfill")?i:Vn(s,"Invalid character found")}const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}class Wm{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Vn(ct.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=oN(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function iN(s){const e=new Wm(s);return e.base64?Gm(ct.BASE64,e.rest):rN(e.rest)}function aN(s){return new Wm(s).contentType}function oN(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e,t){let n=0,i="";Yu(e)?(this.data_=e,n=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(Yu(this.data_)){const n=this.data_,i=tN(n,e,t);return i===null?null:new qt(i)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new qt(n,!0)}}static getBlob(...e){if(ul()){const t=e.map(n=>n instanceof qt?n.data_:n);return new qt(eN.apply(null,t))}else{const t=e.map(l=>cl(l)?nN(ct.RAW,l).data:l.data_);let n=0;t.forEach(l=>{n+=l.byteLength});const i=new Uint8Array(n);let a=0;return t.forEach(l=>{for(let c=0;c<l.length;c++)i[a++]=l[c]}),new qt(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Km(s){let e;try{e=JSON.parse(s)}catch{return null}return Hw(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lN(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function cN(s,e){const t=e.split("/").filter(n=>n.length>0).join("/");return s.length===0?t:s+"/"+t}function Qm(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(s,e){return e}class $e{constructor(e,t,n,i){this.server=e,this.local=t||e,this.writable=!!n,this.xform=i||uN}}let Ur=null;function dN(s){return!cl(s)||s.length<2?s:Qm(s)}function Xm(){if(Ur)return Ur;const s=[];s.push(new $e("bucket")),s.push(new $e("generation")),s.push(new $e("metageneration")),s.push(new $e("name","fullPath",!0));function e(a,l){return dN(l)}const t=new $e("name");t.xform=e,s.push(t);function n(a,l){return l!==void 0?Number(l):l}const i=new $e("size");return i.xform=n,s.push(i),s.push(new $e("timeCreated")),s.push(new $e("updated")),s.push(new $e("md5Hash",null,!0)),s.push(new $e("cacheControl",null,!0)),s.push(new $e("contentDisposition",null,!0)),s.push(new $e("contentEncoding",null,!0)),s.push(new $e("contentLanguage",null,!0)),s.push(new $e("contentType",null,!0)),s.push(new $e("metadata","customMetadata",!0)),Ur=s,Ur}function hN(s,e){function t(){const n=s.bucket,i=s.fullPath,a=new Ye(n,i);return e._makeStorageReference(a)}Object.defineProperty(s,"ref",{get:t})}function mN(s,e,t){const n={};n.type="file";const i=t.length;for(let a=0;a<i;a++){const l=t[a];n[l.local]=l.xform(n,e[l.server])}return hN(n,s),n}function Jm(s,e,t){const n=Km(e);return n===null?null:mN(s,n,t)}function fN(s,e,t,n){const i=Km(e);if(i===null||!cl(i.downloadTokens))return null;const a=i.downloadTokens;if(a.length===0)return null;const l=encodeURIComponent;return a.split(",").map(m=>{const f=s.bucket,g=s.fullPath,y="/b/"+l(f)+"/o/"+l(g),T=dl(y,t,n),k=$m({alt:"media",token:m});return T+k})[0]}function pN(s,e){const t={},n=e.length;for(let i=0;i<n;i++){const a=e[i];a.writable&&(t[a.server]=s[a.local])}return JSON.stringify(t)}class Ym{constructor(e,t,n,i){this.url=e,this.method=t,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zm(s){if(!s)throw ll()}function gN(s,e){function t(n,i){const a=Jm(s,i,e);return Zm(a!==null),a}return t}function xN(s,e){function t(n,i){const a=Jm(s,i,e);return Zm(a!==null),fN(a,i,s.host,s._protocol)}return t}function ef(s){function e(t,n){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=Rw():i=Sw():t.getStatus()===402?i=Aw(s.bucket):t.getStatus()===403?i=Cw(s.path):i=n,i.status=t.getStatus(),i.serverResponse=n.serverResponse,i}return e}function yN(s){const e=ef(s);function t(n,i){let a=e(n,i);return n.getStatus()===404&&(a=Iw(s.path)),a.serverResponse=i.serverResponse,a}return t}function bN(s,e,t){const n=e.fullServerUrl(),i=dl(n,s.host,s._protocol),a="GET",l=s.maxOperationRetryTime,c=new Ym(i,a,xN(s,t),l);return c.errorHandler=yN(e),c}function vN(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function _N(s,e,t){const n=Object.assign({},t);return n.fullPath=s.path,n.size=e.size(),n.contentType||(n.contentType=vN(null,e)),n}function wN(s,e,t,n,i){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function c(){let S="";for(let O=0;O<2;O++)S=S+Math.random().toString().slice(2);return S}const d=c();l["Content-Type"]="multipart/related; boundary="+d;const m=_N(e,n,i),f=pN(m,t),g="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+f+`\r
--`+d+`\r
Content-Type: `+m.contentType+`\r
\r
`,y=`\r
--`+d+"--",T=qt.getBlob(g,n,y);if(T===null)throw Lw();const k={name:m.fullPath},C=dl(a,s.host,s._protocol),N="POST",A=s.maxUploadRetryTime,I=new Ym(C,N,gN(s,t),A);return I.urlParams=k,I.headers=l,I.body=T.uploadData(),I.errorHandler=ef(e),I}class NN{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ps.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ps.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ps.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,i,a){if(this.sent_)throw wn("cannot .send() more than once");if(ns(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),a!==void 0)for(const l in a)a.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,a[l].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw wn("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw wn("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw wn("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw wn("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class EN extends NN{initXhr(){this.xhr_.responseType="text"}}function tf(){return new EN}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,t){this._service=e,t instanceof Ye?this._location=t:this._location=Ye.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ns(e,t)}get root(){const e=new Ye(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Qm(this._location.path)}get storage(){return this._service}get parent(){const e=lN(this._location.path);if(e===null)return null;const t=new Ye(this._location.bucket,e);return new Ns(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Fw(e)}}function TN(s,e,t){s._throwIfRoot("uploadBytes");const n=wN(s.storage,s._location,Xm(),new qt(e,!0),t);return s.storage.makeRequestWithTokens(n,tf).then(i=>({metadata:i,ref:s}))}function jN(s){s._throwIfRoot("getDownloadURL");const e=bN(s.storage,s._location,Xm());return s.storage.makeRequestWithTokens(e,tf).then(t=>{if(t===null)throw Mw();return t})}function IN(s,e){const t=cN(s._location.path,e),n=new Ye(s._location.bucket,t);return new Ns(s.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(s){return/^[A-Za-z]+:\/\//.test(s)}function SN(s,e){return new Ns(s,e)}function sf(s,e){if(s instanceof hl){const t=s;if(t._bucket==null)throw Vw();const n=new Ns(t,t._bucket);return e!=null?sf(n,e):n}else return e!==void 0?IN(s,e):s}function RN(s,e){if(e&&AN(e)){if(s instanceof hl)return SN(s,e);throw po("To use ref(service, url), the first argument must be a Storage instance.")}else return sf(s,e)}function ed(s,e){const t=e?.[qm];return t==null?null:Ye.makeFromBucketSpec(t,s)}function CN(s,e,t,n={}){s.host=`${e}:${t}`;const i=ns(e);i&&(_o(`https://${s.host}/b`),wo("Storage",!0)),s._isUsingEmulator=!0,s._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(s._overrideAuthToken=typeof a=="string"?a:Td(a,s.app.options.projectId))}class hl{constructor(e,t,n,i,a,l=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=l,this._bucket=null,this._host=Bm,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Tw,this._maxUploadRetryTime=jw,this._requests=new Set,i!=null?this._bucket=Ye.makeFromBucketSpec(i,this._host):this._bucket=ed(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ye.makeFromBucketSpec(this._url,e):this._bucket=ed(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Zu("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Zu("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Je(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ns(this,e)}_makeRequest(e,t,n,i,a=!0){if(this._deleted)return new Bw(zm());{const l=Yw(e,this._appId,n,i,t,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const td="@firebase/storage",sd="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf="storage";function rf(s,e,t){return s=Ce(s),TN(s,e,t)}function af(s){return s=Ce(s),jN(s)}function of(s,e){return s=Ce(s),RN(s,e)}function kN(s=To(),e){s=Ce(s);const n=ji(s,nf).getImmediate({identifier:e}),i=wd("storage");return i&&PN(n,...i),n}function PN(s,e,t,n={}){CN(s,e,t,n)}function DN(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),n=s.getProvider("auth-internal"),i=s.getProvider("app-check-internal");return new hl(t,n,i,e,Es)}function ON(){ys(new Xt(nf,DN,"PUBLIC").setMultipleInstances(!0)),dt(td,sd,""),dt(td,sd,"esm2020")}ON();const lf={apiKey:"AIzaSyCtpOMtw3GR5yZhokfVox8eP9Ldo5srLrE",authDomain:"mypictures-9dc8b.firebaseapp.com",projectId:"mypictures-9dc8b",storageBucket:"mypictures-9dc8b.firebasestorage.app",messagingSenderId:"722783244073",appId:"1:722783244073:web:e29da99ccd0602e2b3b138"},ml=kc().length===0?Ad(lf):kc()[0],Fr=nb(ml),ka=aw(ml),fl=kN(ml);console.log("Firebase Storage configuré:",fl);console.log("Storage bucket:",lf.storageBucket);function VN({isOpen:s,onClose:e,onBoatAdded:t}){if(console.log("🔍 AddBoat render - isOpen:",s),!s)return console.log("🔍 AddBoat: Modal fermé, pas de rendu"),null;const[n,i]=D.useState({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",localisation:"",description:"",equipements:[]}),[a,l]=D.useState(null),[c,d]=D.useState(null),[m,f]=D.useState(!1),[g,y]=D.useState(""),[T,k]=D.useState(""),C=["Climatisation","Wifi","Cuisine équipée","Salle de bain","Pont solarium","GPS","Radio VHF","Gilets de sauvetage","Équipement de pêche","Panneaux solaires"],N=O=>{const{name:P,value:L,type:v,checked:p}=O.target;i(v==="checkbox"?p?b=>({...b,equipements:[...b.equipements,L]}):b=>({...b,equipements:b.equipements.filter(w=>w!==L)}):b=>({...b,[P]:L}))},A=O=>{const P=O.target.files[0];if(P){l(P);const L=new FileReader;L.onload=v=>{d(v.target.result)},L.readAsDataURL(P)}},I=async O=>{O.preventDefault(),f(!0),y("");try{let P="";if(a){console.log("🔄 Upload de l'image vers Firebase Storage...");const p=of(fl,`boats/${Date.now()}_${a.name}`),b=await rf(p,a);P=await af(b.ref),console.log("✅ Image uploadée:",P)}const L=localStorage.getItem("token");if(!L)throw new Error("Vous devez être connecté pour ajouter un bateau");console.log("🔄 Ajout du bateau dans MongoDB...");const v=await ce(ae.BOATS,{method:"POST",headers:Me(L),body:JSON.stringify({nom:n.nom,type:n.type,longueur:Number(n.longueur),prix_jour:Number(n.prix_jour),capacite:Number(n.capacite),image:P,destination:n.localisation,description:n.description,equipements:n.equipements})});console.log("✅ Bateau ajouté avec succès:",v),k("Bateau ajouté avec succès !"),i({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",localisation:"",description:"",equipements:[]}),l(null),d(null),t&&t(v.data||v),setTimeout(()=>{e(),k("")},2e3)}catch(P){console.error("❌ Erreur lors de l'ajout du bateau:",P),console.error("❌ Détails de l'erreur:",{message:P.message,stack:P.stack,formData:n}),y("Erreur lors de l'ajout du bateau: "+P.message)}finally{f(!1)}},S=()=>{i({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",localisation:"",description:"",equipements:[]}),l(null),d(null),y(""),k(""),e()};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[r.jsx(Et,{className:"h-6 w-6 text-blue-600"}),"Ajouter un bateau"]}),r.jsx("button",{onClick:S,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:r.jsx(It,{className:"h-6 w-6 text-gray-500"})})]}),r.jsxs("form",{onSubmit:I,className:"p-6 space-y-6",children:[g&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:g}),T&&r.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:T}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du bateau *"}),r.jsx("input",{type:"text",name:"nom",value:n.nom,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ex: Le Grand Bleu",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type *"}),r.jsxs("select",{name:"type",value:n.type,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[r.jsx("option",{value:"voilier",children:"Voilier"}),r.jsx("option",{value:"yacht",children:"Yacht"}),r.jsx("option",{value:"catamaran",children:"Catamaran"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[r.jsx(Et,{className:"h-4 w-4"}),"Longueur (m) *"]}),r.jsx("input",{type:"number",name:"longueur",value:n.longueur,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"12.5",min:"2",max:"100",step:"0.1",required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[r.jsx(Et,{className:"h-4 w-4"}),"Prix/jour (€) *"]}),r.jsx("input",{type:"number",name:"prix_jour",value:n.prix_jour,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"150",min:"1",required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[r.jsx(Et,{className:"h-4 w-4"}),"Capacité *"]}),r.jsx("input",{type:"number",name:"capacite",value:n.capacite,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"8",min:"1",max:"50",required:!0})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[r.jsx(ms,{className:"h-4 w-4"}),"Image *"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:A,className:"hidden",id:"image-upload"}),r.jsxs("div",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[r.jsx(ms,{className:"h-4 w-4"}),"Choisir une image"]})]}),a&&r.jsxs("span",{className:"text-sm text-green-600 flex items-center gap-1",children:[r.jsx(ms,{className:"h-4 w-4"}),a.name]})]}),c&&r.jsxs("div",{className:"mt-3",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Aperçu de l'image :"}),r.jsxs("div",{className:"relative inline-block",children:[r.jsx("img",{src:c,alt:"Aperçu",className:"w-32 h-32 object-cover rounded-lg border shadow-sm"}),r.jsx("button",{type:"button",onClick:()=>{l(null),d(null),i(O=>({...O,image:""}))},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors text-xs",title:"Supprimer l'image",children:"×"})]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[r.jsx(Et,{className:"h-4 w-4"}),"Destination *"]}),r.jsxs("select",{name:"localisation",value:n.localisation,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[r.jsx("option",{value:"",children:"Choisir une destination"}),r.jsx("option",{value:"saint-malo",children:"Saint-Malo"}),r.jsx("option",{value:"les-glenan",children:"Les Glénan"}),r.jsx("option",{value:"crozon",children:"Crozon"}),r.jsx("option",{value:"la-rochelle",children:"La Rochelle"}),r.jsx("option",{value:"marseille",children:"Marseille"}),r.jsx("option",{value:"cannes",children:"Cannes"}),r.jsx("option",{value:"ajaccio",children:"Ajaccio"}),r.jsx("option",{value:"barcelone",children:"Barcelone"}),r.jsx("option",{value:"palma",children:"Palma de Majorque"}),r.jsx("option",{value:"athenes",children:"Athènes"}),r.jsx("option",{value:"venise",children:"Venise"}),r.jsx("option",{value:"amsterdam",children:"Amsterdam"}),r.jsx("option",{value:"split",children:"Split"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),r.jsx("textarea",{name:"description",value:n.description,onChange:N,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description détaillée du bateau..."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Équipements disponibles"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:C.map(O=>r.jsxs("label",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"checkbox",value:O,checked:n.equipements.includes(O),onChange:N,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"text-sm text-gray-700",children:O})]},O))})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:S,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),r.jsx("button",{type:"submit",disabled:m,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:m?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Ajout en cours..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Et,{className:"h-4 w-4"}),"Ajouter le bateau"]})})]})]})]})})}function LN({isOpen:s,onClose:e,onBoatUpdated:t,boatData:n}){const[i,a]=D.useState({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:[]}),[l,c]=D.useState(null),[d,m]=D.useState(null),[f,g]=D.useState(!1),[y,T]=D.useState(!1),[k,C]=D.useState(""),[N,A]=D.useState(""),I=["Climatisation","Wifi","Cuisine équipée","Salle de bain","Pont solarium","GPS","Radio VHF","Gilets de sauvetage","Équipement de pêche","Panneaux solaires"];D.useEffect(()=>{n&&s&&(a({nom:n.nom||"",type:n.type||"voilier",longueur:n.longueur||"",prix_jour:n.prix_jour||"",capacite:n.capacite||"",image:n.image||"",destination:n.destination||"",description:n.description||"",equipements:n.equipements||[]}),n.image&&m(n.image),c(null),g(!1))},[n,s]);const S=v=>{const{name:p,value:b,type:w,checked:E}=v.target;a(w==="checkbox"?E?j=>({...j,equipements:[...j.equipements,b]}):j=>({...j,equipements:j.equipements.filter(_=>_!==b)}):j=>({...j,[p]:b}))},O=v=>{const p=v.target.files[0];if(p){c(p),g(!0);const b=new FileReader;b.onload=w=>{m(w.target.result)},b.readAsDataURL(p)}},P=async v=>{v.preventDefault(),T(!0),C(""),A("");try{if(!i.nom||!i.type||!i.longueur||!i.prix_jour||!i.capacite||!i.destination)throw new Error("Tous les champs obligatoires doivent être remplis");if(!i.destination)throw new Error("Veuillez sélectionner une destination");let p=i.image;if(f&&l){A("Upload de la nouvelle image en cours...");const E=of(fl,`boats/${Date.now()}_${l.name}`),j=await rf(E,l);p=await af(j.ref),A("Nouvelle image uploadée ! Modification du bateau...")}const b=localStorage.getItem("token");if(!b)throw new Error("Vous devez être connecté");console.log("🔄 Modification du bateau dans MongoDB...");const w=await ce(ae.BOAT_DETAIL(n._id),{method:"PUT",headers:Me(b),body:JSON.stringify({nom:i.nom,type:i.type,longueur:Number(i.longueur),prix_jour:Number(i.prix_jour),capacite:Number(i.capacite),image:p,destination:i.destination,description:i.description,equipements:i.equipements})});console.log("✅ Bateau modifié avec succès:",w),A("Bateau modifié avec succès !"),t&&t(w),setTimeout(()=>{e(),A("")},2e3)}catch(p){C(p.message)}finally{T(!1)}},L=()=>{c(null),m(null),g(!1),C(""),A(""),e()};return s?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[r.jsx(La,{className:"h-6 w-6 text-blue-600"}),"Modifier le bateau"]}),r.jsx("button",{onClick:L,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:r.jsx(It,{className:"h-6 w-6 text-gray-500"})})]}),r.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[k&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:k}),N&&r.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:N}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du bateau *"}),r.jsx("input",{type:"text",name:"nom",value:i.nom,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ex: Le Grand Bleu",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type *"}),r.jsxs("select",{name:"type",value:i.type,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[r.jsx("option",{value:"voilier",children:"Voilier"}),r.jsx("option",{value:"yacht",children:"Yacht"}),r.jsx("option",{value:"catamaran",children:"Catamaran"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[r.jsx(_i,{className:"h-4 w-4"}),"Longueur (m) *"]}),r.jsx("input",{type:"number",name:"longueur",value:i.longueur,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"12.5",min:"2",max:"100",step:"0.1",required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[r.jsx(xo,{className:"h-4 w-4"}),"Prix/jour (€) *"]}),r.jsx("input",{type:"number",name:"prix_jour",value:i.prix_jour,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"150",min:"1",required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[r.jsx(Qt,{className:"h-4 w-4"}),"Capacité *"]}),r.jsx("input",{type:"number",name:"capacite",value:i.capacite,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"8",min:"1",max:"50",required:!0})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[r.jsx(ms,{className:"h-4 w-4"}),"Image *"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:O,className:"hidden",id:"image-upload-edit"}),r.jsxs("div",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[r.jsx(ms,{className:"h-4 w-4"}),f?"Changer l'image":"Choisir une image"]})]}),l&&r.jsxs("span",{className:"text-sm text-green-600 flex items-center gap-1",children:[r.jsx(ms,{className:"h-4 w-4"}),l.name]})]}),d&&r.jsxs("div",{className:"mt-3",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:f?"Nouvelle image :":"Image actuelle :"}),r.jsxs("div",{className:"relative inline-block",children:[r.jsx("img",{src:d,alt:"Aperçu",className:"w-32 h-32 object-cover rounded-lg border shadow-sm"}),f&&r.jsx("button",{type:"button",onClick:()=>{c(null),g(!1),m(n.image||""),a(v=>({...v,image:n.image||""}))},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors text-xs",title:"Annuler le changement d'image",children:"×"})]})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[r.jsx(ut,{className:"h-4 w-4"}),"Destination *"]}),r.jsxs("select",{name:"destination",value:i.destination,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[r.jsx("option",{value:"",children:"Choisir une destination"}),r.jsx("option",{value:"saint-malo",children:"Saint-Malo"}),r.jsx("option",{value:"les-glenan",children:"Les Glénan"}),r.jsx("option",{value:"crozon",children:"Crozon"}),r.jsx("option",{value:"la-rochelle",children:"La Rochelle"}),r.jsx("option",{value:"marseille",children:"Marseille"}),r.jsx("option",{value:"cannes",children:"Cannes"}),r.jsx("option",{value:"ajaccio",children:"Ajaccio"}),r.jsx("option",{value:"barcelone",children:"Barcelone"}),r.jsx("option",{value:"palma",children:"Palma de Majorque"}),r.jsx("option",{value:"athenes",children:"Athènes"}),r.jsx("option",{value:"venise",children:"Venise"}),r.jsx("option",{value:"amsterdam",children:"Amsterdam"}),r.jsx("option",{value:"split",children:"Split"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),r.jsx("textarea",{name:"description",value:i.description,onChange:S,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description détaillée du bateau..."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Équipements disponibles"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:I.map(v=>r.jsxs("label",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"checkbox",value:v,checked:i.equipements.includes(v),onChange:S,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"text-sm text-gray-700",children:v})]},v))})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:L,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),r.jsx("button",{type:"submit",disabled:y,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:y?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Modification en cours..."]}):r.jsxs(r.Fragment,{children:[r.jsx(La,{className:"h-4 w-4"}),"Modifier le bateau"]})})]})]})]})}):null}function MN(){const s=vi(),[e,t]=D.useState([]),[n,i]=D.useState(!1),[a,l]=D.useState(!1),[c,d]=D.useState(null),[m,f]=D.useState(!0),[g,y]=D.useState("");D.useEffect(()=>{if(!localStorage.getItem("token")){console.log("🔍 Pas de token, redirection vers la connexion"),s("/login");return}T()},[s]);const T=async()=>{try{f(!0),y("");const P=localStorage.getItem("token");if(!P){y("Vous devez être connecté"),s("/login");return}console.log("🔄 Récupération des bateaux depuis MongoDB...");const L=await ce(ae.MY_BOATS,{headers:Me(P)});console.log("✅ Bateaux récupérés:",L),t(L||[])}catch(P){console.error("❌ Erreur lors de la récupération des bateaux:",P),y("Erreur lors de la récupération des bateaux: "+P.message)}finally{f(!1)}},k=async P=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer ce bateau ?"))try{const L=localStorage.getItem("token");console.log("🔄 Suppression du bateau depuis MongoDB..."),await ce(ae.BOAT_DETAIL(P),{method:"DELETE",headers:Me(L)}),console.log("✅ Bateau supprimé avec succès"),t(e.filter(v=>v._id!==P))}catch(L){console.error("❌ Erreur lors de la suppression:",L),alert("Erreur lors de la suppression: "+L.message)}},C=P=>{d(P),l(!0)},N=()=>{console.log("🔍 handleAdd appelé, ouverture du modal"),i(!0),console.log("🔍 showModal mis à true:",!0)},A=P=>{console.log("🔍 handleBoatAdded appelé avec:",P),t([...e,P])},I=P=>{console.log("🔍 handleBoatUpdated appelé avec:",P),t(e.map(L=>L._id===P._id?P:L))},S=()=>{console.log("🔍 handleModalClose appelé, fermeture du modal"),i(!1)},O=()=>{l(!1),d(null)};return m?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-24 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Chargement de vos bateaux..."})]})}):g?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-24 flex items-center justify-center",children:r.jsxs("div",{className:"text-center max-w-md mx-auto",children:[r.jsx(Fe,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Erreur de chargement"}),r.jsx("p",{className:"text-gray-600 mb-6",children:g}),r.jsxs("div",{className:"space-x-3",children:[r.jsx("button",{onClick:T,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"🔄 Réessayer"}),r.jsx("button",{onClick:()=>s("/login"),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"🔑 Se connecter"})]})]})}):r.jsxs("div",{className:"min-h-screen bg-gray-50 pt-24 flex flex-col items-center",children:[r.jsxs("div",{className:"w-full max-w-6xl bg-white rounded-2xl shadow-xl p-8",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8",children:[r.jsxs("h2",{className:"text-3xl font-bold text-blue-700 flex items-center gap-3",children:[r.jsx(Fe,{className:"h-8 w-8"}),"Gestion de mes bateaux"]}),r.jsxs("button",{onClick:N,className:"inline-flex items-center space-x-2 bg-orange-500 text-white px-6 py-3 rounded-full font-bold hover:bg-orange-600 transition-colors shadow-lg",children:[r.jsx(Ma,{className:"h-5 w-5"}),"Ajouter un bateau"]})]}),g&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:g}),e.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(Fe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun bateau trouvé"}),r.jsx("p",{className:"text-gray-500",children:"Commencez par ajouter votre premier bateau !"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(P=>r.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:[r.jsxs("div",{className:"h-48 bg-gray-200 rounded-t-xl flex items-center justify-center",children:[P.image?r.jsx("img",{src:P.image,alt:P.nom,className:"w-full h-full object-cover rounded-t-xl",onError:L=>{L.target.style.display="none",L.target.nextSibling.style.display="flex"}}):null,r.jsx("div",{className:"hidden items-center justify-center text-gray-400",children:r.jsx(Et,{className:"h-12 w-12"})})]}),r.jsxs("div",{className:"p-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:P.nom}),r.jsxs("div",{className:"space-y-2 mb-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[r.jsx(Fe,{className:"h-4 w-4"}),r.jsx("span",{className:"capitalize",children:P.type})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[r.jsx(_i,{className:"h-4 w-4"}),r.jsxs("span",{children:[P.longueur,"m"]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[r.jsx(Qt,{className:"h-4 w-4"}),r.jsxs("span",{children:[P.capacite," personnes"]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[r.jsx(xo,{className:"h-4 w-4"}),r.jsxs("span",{children:[P.prix_jour,"€/jour"]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[r.jsx(ut,{className:"h-4 w-4"}),r.jsx("span",{children:P.localisation})]})]}),P.description&&r.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:P.description}),P.equipements&&P.equipements.length>0&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"Équipements :"}),r.jsxs("div",{className:"flex flex-wrap gap-1",children:[P.equipements.slice(0,3).map((L,v)=>r.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:L},v)),P.equipements.length>3&&r.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",P.equipements.length-3]})]})]}),r.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-100",children:[r.jsxs("button",{onClick:()=>C(P),className:"flex items-center gap-2 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[r.jsx(La,{className:"h-4 w-4"}),"Modifier"]}),r.jsxs("button",{onClick:()=>k(P._id),className:"flex items-center gap-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[r.jsx(Yr,{className:"h-4 w-4"}),"Supprimer"]})]})]})]},P._id))})]}),r.jsx(VN,{isOpen:n,onClose:S,onBoatAdded:A}),r.jsx(LN,{isOpen:a,onClose:O,onBoatUpdated:I,boatData:c})]})}function UN(){const[s,e]=D.useState("overview"),[t,n]=D.useState([]),[i,a]=D.useState([]),[l,c]=D.useState(!0),[d,m]=D.useState(!1),[f,g]=D.useState(!1),[y,T]=D.useState(!1),[k,C]=D.useState(null),[N,A]=D.useState(null),[I,S]=D.useState({nom:"",prenom:"",email:"",tel:"",role:"client"}),[O,P]=D.useState({nom:"",prenom:"",email:"",tel:"",password:"",role:"client"}),[L,v]=D.useState({totalUsers:0,totalBoats:0,totalBookings:0,totalRevenue:0});D.useEffect(()=>{p()},[]);const p=async()=>{try{c(!0);const F=localStorage.getItem("token");if(!F){J.error("Token d'authentification manquant"),window.location.href="/connexion";return}console.log("🔄 Récupération des données du dashboard depuis MongoDB...");const ne=await ce(ae.DASHBOARD,{headers:Me(F)});let xe=[];try{console.log("🔄 Récupération des bateaux depuis MongoDB..."),xe=await ce(ae.BOATS,{headers:Me(F)})||[],console.log(`✅ ${xe.length} bateaux récupérés depuis MongoDB`)}catch(te){console.log("❌ Erreur API bateaux:",te.message)}let ye=[];try{console.log("🔄 Récupération des réservations depuis MongoDB..."),ye=(await ce(ae.BOOKINGS,{headers:Me(F)})).bookings||[],console.log(`✅ ${ye.length} réservations récupérées depuis MongoDB`)}catch(te){console.log("❌ Erreur API réservations:",te.message)}const st=xe.length,Ze=ye.length,Te=ye.reduce((te,Ge)=>{if(Ge.prix_jour&&Ge.dateDebut&&Ge.dateFin){const Hi=new Date(Ge.dateDebut),Cs=new Date(Ge.dateFin),Gi=Math.ceil((Cs-Hi)/(1e3*60*60*24));return te+Ge.prix_jour*Gi}else if(Ge.prix_total)return te+Ge.prix_total;return te},0);xe.length===0?console.log("Aucun bateau trouvé dans la base de données"):console.log("Bateaux récupérés:",xe.map(te=>({nom:te.nom,type:te.type,prix:te.prix_jour}))),ye.length===0&&console.log("Aucune réservation trouvée dans la base de données"),v({totalUsers:ne.stats.totalUsers,totalBoats:st,totalBookings:Ze,totalRevenue:Te}),n(ne.recentUsers.map(te=>({id:te._id,nom:te.nom,prenom:te.prenom,email:te.email,role:te.role,status:te.status||"actif",tel:te.tel||""}))),a(xe.map(te=>({id:te._id,nom:te.nom,type:te.type,longueur:te.longueur,capacite:te.capacite,prix:te.prix_jour,localisation:te.localisation,status:te.disponible?"disponible":"indisponible",image:te.image,createdAt:te.createdAt})))}catch(F){J.error("Erreur lors du chargement des données"),console.error(F)}finally{c(!1)}},b=()=>{localStorage.removeItem("token"),localStorage.removeItem("userNom"),localStorage.removeItem("userPrenom"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("userTel"),window.location.href="/connexion"},w=async F=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer cet utilisateur ?"))try{const ne=localStorage.getItem("token");if(!ne){J.error("Token d'authentification manquant"),window.location.href="/connexion";return}const xe=await ce(`${ae.USERS}/${F}`,{method:"DELETE",headers:Me(ne)});if(!xe.ok){const ye=await xe.json();throw new Error(ye.message||"Erreur lors de la suppression")}n(t.filter(ye=>ye.id!==F)),J.success("Utilisateur supprimé avec succès"),p()}catch(ne){J.error(ne.message||"Erreur lors de la suppression de l'utilisateur"),console.error(ne)}},E=F=>{A(F),g(!0)},j=F=>{C(F),S({nom:F.nom,prenom:F.prenom,email:F.email,tel:F.tel||"",role:F.role}),m(!0)},_=()=>{P({nom:"",prenom:"",email:"",tel:"",password:"",role:"client"}),T(!0)},Ke=async F=>{F.preventDefault();try{const ne=localStorage.getItem("token");if(!ne){J.error("Token d'authentification manquant"),window.location.href="/connexion";return}const xe=await ce(ae.REGISTER,{method:"POST",headers:Me(ne),body:JSON.stringify(O)});if(!xe.ok){const Ze=await xe.json();throw new Error(Ze.message||"Erreur lors de la création")}const ye=await xe.json(),st={id:ye.user.id,nom:ye.user.nom,prenom:ye.user.prenom,email:ye.user.email,tel:ye.user.tel,role:ye.user.role,status:"active"};n([st,...t]),J.success("Utilisateur créé avec succès"),T(!1),p()}catch(ne){J.error(ne.message||"Erreur lors de la création de l'utilisateur"),console.error(ne)}},ot=async F=>{F.preventDefault();try{const ne=localStorage.getItem("token");if(!ne){J.error("Token d'authentification manquant"),window.location.href="/connexion";return}const xe=await ce(`${ae.USERS}/${k.id}`,{method:"PUT",headers:Me(ne),body:JSON.stringify(I)});if(!xe.ok){const st=await xe.json();throw new Error(st.message||"Erreur lors de la modification")}const ye=await xe.json();n(t.map(st=>st.id===k.id?{...st,...ye.user}:st)),J.success("Utilisateur modifié avec succès"),m(!1),C(null),p()}catch(ne){J.error(ne.message||"Erreur lors de la modification de l'utilisateur"),console.error(ne)}},Rs=F=>{window.confirm("Êtes-vous sûr de vouloir supprimer ce bateau ?")&&(a(i.filter(ne=>ne.id!==F)),J.success("Bateau supprimé avec succès"))};return l?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement du tableau de bord..."})]})}):r.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[r.jsx(vo,{}),r.jsx("div",{className:"bg-white shadow-sm border-b",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"flex justify-between items-center py-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de Bord Admin"}),r.jsx("p",{className:"text-gray-600",children:"Gestion de la plateforme SailingLoc"})]}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsxs("button",{onClick:p,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Rafraîchir les données",children:[r.jsx(xa,{className:"h-5 w-5 mr-2"}),"Actualiser"]}),r.jsxs("button",{onClick:b,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[r.jsx(lp,{className:"h-5 w-5 mr-2"}),"Déconnexion"]})]})]})})}),r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[r.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:r.jsx(Qt,{className:"h-8 w-8 text-blue-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:L.totalUsers})]})]})}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:r.jsx(Bs,{className:"h-8 w-8 text-green-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Bateaux"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:L.totalBoats})]})]})}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:r.jsx(xa,{className:"h-8 w-8 text-purple-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Réservations"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:L.totalBookings})]})]})}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:r.jsx(xa,{className:"h-8 w-8 text-yellow-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Revenus"}),r.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[L.totalRevenue,"€"]})]})]})})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border mb-8",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"flex space-x-8 px-6",children:[r.jsx("button",{onClick:()=>e("overview"),className:`py-4 px-1 border-b-2 font-medium text-sm ${s==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Vue d'ensemble"}),r.jsx("button",{onClick:()=>e("users"),className:`py-4 px-1 border-b-2 font-medium text-sm ${s==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Utilisateurs"}),r.jsx("button",{onClick:()=>e("boats"),className:`py-4 px-1 border-b-2 font-medium text-sm ${s==="boats"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Bateaux"})]})}),r.jsxs("div",{className:"p-6",children:[s==="overview"&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activité récente"}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Utilisateurs récents"}),r.jsx("div",{className:"space-y-2",children:t.slice(0,3).map(F=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("span",{className:"text-sm text-gray-600",children:[F.prenom," ",F.nom," (",F.role,")"]}),r.jsx("span",{className:"text-xs text-gray-400",children:F.email})]},F.id))})]}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Bateaux disponibles"}),r.jsx("div",{className:"space-y-2",children:i.slice(0,3).map(F=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:F.nom}),r.jsxs("span",{className:"text-xs text-gray-400",children:[F.prix,"€/jour - ",F.type]})]},F.id))})]})]})]}),s==="users"&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestion des utilisateurs"}),r.jsxs("button",{onClick:_,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[r.jsx(Ma,{className:"h-4 w-4 mr-2"}),"Ajouter un utilisateur"]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilisateur"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rôle"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(F=>r.jsxs("tr",{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[F.prenom," ",F.nom]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:F.email})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${F.role==="admin"?"bg-red-100 text-red-800":F.role==="proprietaire"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:F.role})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${F.status==="actif"?"bg-green-100 text-green-800":F.status==="inactif"?"bg-red-100 text-red-800":F.status==="suspendu"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:F.status})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>E(F),className:"text-blue-600 hover:text-blue-900",title:"Voir les détails",children:r.jsx(Ks,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>j(F),className:"text-indigo-600 hover:text-indigo-900",title:"Modifier",children:r.jsx(wc,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>w(F.id),className:"text-red-600 hover:text-red-900",title:"Supprimer",children:r.jsx(Yr,{className:"h-4 w-4"})})]})})]},F.id))})]})})]}),s==="boats"&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestion des bateaux"}),r.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[r.jsx(Ma,{className:"h-4 w-4 mr-2"}),"Ajouter un bateau"]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bateau"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Longueur"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capacité"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prix/jour"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(F=>r.jsxs("tr",{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm font-medium text-gray-900",children:F.nom})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900 capitalize",children:F.type})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"text-sm text-gray-900",children:[F.longueur,"m"]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"text-sm text-gray-900",children:[F.capacite," pers."]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"text-sm text-gray-900",children:[F.prix,"€"]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${F.status==="disponible"?"bg-green-100 text-green-800":F.status==="loué"?"bg-blue-100 text-blue-800":F.status==="maintenance"?"bg-yellow-100 text-yellow-800":F.status==="réservé"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:F.status})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:r.jsx(Ks,{className:"h-4 w-4"})}),r.jsx("button",{className:"text-indigo-600 hover:text-indigo-900",children:r.jsx(wc,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>Rs(F.id),className:"text-red-600 hover:text-red-900",children:r.jsx(Yr,{className:"h-4 w-4"})})]})})]},F.id))})]})})]})]})]})]}),d&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[r.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Modifier l'utilisateur"}),r.jsx("button",{onClick:()=>{m(!1),C(null)},className:"text-gray-400 hover:text-gray-600",children:r.jsx(It,{className:"h-6 w-6"})})]}),r.jsxs("form",{onSubmit:ot,className:"p-6 space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prénom"}),r.jsx("input",{type:"text",value:I.prenom,onChange:F=>S({...I,prenom:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom"}),r.jsx("input",{type:"text",value:I.nom,onChange:F=>S({...I,nom:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),r.jsx("input",{type:"email",value:I.email,onChange:F=>S({...I,email:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Téléphone"}),r.jsx("input",{type:"tel",value:I.tel,onChange:F=>S({...I,tel:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0123456789"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rôle"}),r.jsxs("select",{value:I.role,onChange:F=>S({...I,role:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"client",children:"Client"}),r.jsx("option",{value:"proprietaire",children:"Propriétaire"}),r.jsx("option",{value:"admin",children:"Admin"})]})]}),r.jsxs("div",{className:"flex space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>{m(!1),C(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),r.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Modifier"})]})]})]})}),f&&N&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[r.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Détails de l'utilisateur"}),r.jsx("button",{onClick:()=>{g(!1),A(null)},className:"text-gray-400 hover:text-gray-600",children:r.jsx(It,{className:"h-6 w-6"})})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[r.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[N.prenom.charAt(0),N.nom.charAt(0)]})}),r.jsxs("div",{children:[r.jsxs("h4",{className:"text-xl font-semibold text-gray-900",children:[N.prenom," ",N.nom]}),r.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${N.role==="admin"?"bg-red-100 text-red-800":N.role==="proprietaire"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:N.role})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Prénom"}),r.jsx("span",{className:"text-sm text-gray-900",children:N.prenom})]}),r.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Nom"}),r.jsx("span",{className:"text-sm text-gray-900",children:N.nom})]}),r.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Email"}),r.jsx("span",{className:"text-sm text-gray-900",children:N.email})]}),r.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Téléphone"}),r.jsx("span",{className:"text-sm text-gray-900",children:N.tel||"Non renseigné"})]}),r.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Statut"}),r.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:N.status||"Actif"})]})]}),r.jsxs("div",{className:"flex space-x-3 pt-6",children:[r.jsx("button",{onClick:()=>{g(!1),A(null),j(N)},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Modifier"}),r.jsx("button",{onClick:()=>{g(!1),A(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Fermer"})]})]})]})}),y&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[r.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ajouter un utilisateur"}),r.jsx("button",{onClick:()=>{T(!1)},className:"text-gray-400 hover:text-gray-600",children:r.jsx(It,{className:"h-6 w-6"})})]}),r.jsxs("form",{onSubmit:Ke,className:"p-6 space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prénom *"}),r.jsx("input",{type:"text",value:O.prenom,onChange:F=>P({...O,prenom:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom *"}),r.jsx("input",{type:"text",value:O.nom,onChange:F=>P({...O,nom:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),r.jsx("input",{type:"email",value:O.email,onChange:F=>P({...O,email:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe *"}),r.jsx("input",{type:"password",value:O.password,onChange:F=>P({...O,password:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,minLength:"6"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Téléphone *"}),r.jsx("input",{type:"tel",value:O.tel,onChange:F=>P({...O,tel:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0123456789",pattern:"[0-9]{10}",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rôle *"}),r.jsxs("select",{value:O.role,onChange:F=>P({...O,role:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[r.jsx("option",{value:"client",children:"Client"}),r.jsx("option",{value:"proprietaire",children:"Propriétaire"}),r.jsx("option",{value:"admin",children:"Admin"})]})]}),r.jsxs("div",{className:"flex space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>{T(!1)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),r.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Créer"})]})]})]})})]})}function FN(){return r.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[r.jsx(Yn,{}),r.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-4xl",children:[r.jsxs("header",{className:"text-center mb-12",children:[r.jsx("h1",{className:"text-4xl font-bold text-blue-700 mb-4",children:"Politique de confidentialité"}),r.jsx("p",{className:"text-gray-600 text-lg",children:"Dernière mise à jour : 01/01/2025"})]}),r.jsxs("section",{className:"mb-10",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[r.jsx(cd,{className:"h-7 w-7 mr-3"}),"1. Introduction"]}),r.jsx("p",{className:"text-gray-700 leading-relaxed text-lg",children:"La présente politique de confidentialité a pour but d'expliquer comment SailingLoc collecte, utilise, protège et partage les données personnelles de ses utilisateurs conformément au Règlement Général sur la Protection des Données (RGPD)."})]}),r.jsxs("section",{className:"mb-10",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[r.jsx(Ks,{className:"h-7 w-7 mr-3"}),"2. Données collectées"]}),r.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Lors de l'utilisation de la plateforme SailingLoc, nous pouvons collecter les données suivantes :"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[r.jsx("li",{children:"Nom, prénom"}),r.jsx("li",{children:"Adresse e-mail"}),r.jsx("li",{children:"Numéro de téléphone"}),r.jsx("li",{children:"Adresse IP et données de navigation"})]}),r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[r.jsx("li",{children:"Données de géolocalisation (si autorisées)"}),r.jsx("li",{children:"Informations de paiement (via Stripe ou PayPal)"}),r.jsx("li",{children:"Historique des réservations"}),r.jsx("li",{children:"Préférences de navigation"})]})]})]}),r.jsxs("section",{className:"mb-10",children:[r.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"3. Finalités de la collecte"}),r.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Les données collectées ont pour objectif :"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[r.jsx("li",{children:"La création et la gestion du compte utilisateur"}),r.jsx("li",{children:"La mise en relation entre propriétaires et locataires"}),r.jsx("li",{children:"Le traitement des paiements"}),r.jsx("li",{children:"La gestion des réservations"})]}),r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[r.jsx("li",{children:"Le service client"}),r.jsx("li",{children:"L'envoi de notifications ou emails (rappels, suggestions, sécurité)"}),r.jsx("li",{children:"L'amélioration continue de nos services"}),r.jsx("li",{children:"La personnalisation de l'expérience utilisateur"})]})]})]}),r.jsxs("section",{className:"mb-10",children:[r.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"4. Consentement"}),r.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Le consentement est obtenu explicitement via :"}),r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[r.jsx("li",{children:"Case à cocher lors de la création de compte"}),r.jsx("li",{children:"Bandeau cookie au premier accès au site"}),r.jsx("li",{children:"Formulaires spécifiques pour la newsletter ou contact"}),r.jsx("li",{children:"Paramètres de confidentialité dans le profil utilisateur"})]})]}),r.jsxs("section",{className:"mb-10",children:[r.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"5. Cookies"}),r.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Le site utilise des cookies pour :"}),r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[r.jsx("li",{children:"Analyser la fréquentation (Google Analytics)"}),r.jsx("li",{children:"Optimiser les performances du site"}),r.jsx("li",{children:"Mémoriser vos préférences de navigation"}),r.jsx("li",{children:"Assurer la sécurité de votre session"})]}),r.jsx("p",{className:"text-gray-700 mt-4 text-lg",children:"Vous pouvez configurer les cookies à tout moment via notre bandeau de gestion (outil : Axeptio, Cookiebot...)"})]}),r.jsxs("section",{className:"mb-10",children:[r.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"6. Durée de conservation"}),r.jsx("p",{className:"text-gray-700 leading-relaxed text-lg",children:"Les données sont conservées pour une durée maximale de 3 ans après la dernière interaction. Les données liées aux paiements sont conservées selon les obligations fiscales et légales."})]}),r.jsxs("section",{className:"mb-10",children:[r.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"7. Vos droits"}),r.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Conformément au RGPD, vous disposez des droits suivants :"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[r.jsx("li",{children:"Droit d'accès à vos données"}),r.jsx("li",{children:"Droit de rectification"}),r.jsx("li",{children:`Droit à l'effacement ("droit à l'oubli")`}),r.jsx("li",{children:"Droit à la portabilité"})]}),r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[r.jsx("li",{children:"Droit d'opposition et de retrait du consentement"}),r.jsx("li",{children:"Droit à la limitation du traitement"}),r.jsx("li",{children:"Droit de réclamation auprès de la CNIL"}),r.jsx("li",{children:"Droit à la notification des violations"})]})]}),r.jsxs("p",{className:"text-gray-700 mt-4 text-lg",children:["Pour exercer vos droits, envoyez un e-mail à : ",r.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"sailinglocequipe@gmail.com"})]})]}),r.jsxs("section",{className:"mb-10",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[r.jsx(Va,{className:"h-7 w-7 mr-3"}),"8. Sécurité des données"]}),r.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"SailingLoc utilise les technologies suivantes pour assurer la sécurité des données :"}),r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[r.jsx("li",{children:"Hachage des mots de passe via bcryptjs"}),r.jsx("li",{children:"Token d'authentification sécurisés (JWT)"}),r.jsx("li",{children:"Certificat SSL (HTTPS)"}),r.jsx("li",{children:"Accès limité au personnel autorisé"}),r.jsx("li",{children:"Chiffrement des données sensibles"}),r.jsx("li",{children:"Audit de sécurité régulier"})]})]}),r.jsxs("section",{className:"mb-10",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[r.jsx(od,{className:"h-7 w-7 mr-3"}),"9. Hébergement"]}),r.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-4",children:"Vercel Inc."}),r.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Adresse :"})," 340 S Lemon Ave #4133, Walnut, CA 91789, États-Unis"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Site web :"})," ",r.jsx("a",{href:"https://vercel.com",target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"vercel.com"})]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Conformité :"})," RGPD, SOC 2 Type II, ISO 27001"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Sécurité :"})," Infrastructure cloud sécurisée avec chiffrement des données en transit et au repos"]})]})]}),r.jsxs("section",{className:"mb-10",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[r.jsx(Pa,{className:"h-7 w-7 mr-3"}),"10. Développement et maintenance"]}),r.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-4",children:"Agence Pandawan"}),r.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Dénomination sociale :"})," Pandawan"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Date de création :"})," 14/03/2014"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Siège social :"})," 25 Rue du Faubourg Saint-Antoine, 75011 Paris"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Statut juridique :"})," SAS"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Expertise :"})," Développement web, IA, UX design, référencement"]})]}),r.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:r.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed",children:[r.jsx("strong",{children:"Présentation :"})," Pandawan est une agence digitale internationale spécialisée dans la création de contenus digitaux de haute qualité, valorisant l'identité de ses clients à travers l'innovation et la créativité."]})})]}),r.jsxs("section",{className:"mb-10",children:[r.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"11. Modifications"}),r.jsx("p",{className:"text-gray-700 leading-relaxed text-lg",children:"Cette politique peut être modifiée à tout moment. Les utilisateurs seront informés des changements par notification sur le site ou par e-mail."})]}),r.jsxs("section",{className:"mb-10",children:[r.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[r.jsx(Qs,{className:"h-7 w-7 mr-3"}),"12. Contact"]}),r.jsxs("p",{className:"text-gray-700 leading-relaxed text-lg",children:["Pour toute question concernant cette politique de confidentialité ou pour exercer vos droits, contactez-nous à : ",r.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"sailinglocequipe@gmail.com"})]}),r.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:r.jsxs("p",{className:"text-gray-600 text-sm",children:[r.jsx("strong",{children:"Note :"})," Cette politique est conforme au RGPD et aux dernières recommandations de la CNIL. Pour plus d'informations sur vos droits, consultez le site de la ",r.jsx("a",{href:"https://www.cnil.fr",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline hover:text-blue-700 transition-colors",children:"CNIL"}),"."]})})]})]})})]})}var cf={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},nd=re.createContext&&re.createContext(cf),BN=["attr","size","title"];function qN(s,e){if(s==null)return{};var t=zN(s,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(t[n]=s[n])}return t}function zN(s,e){if(s==null)return{};var t={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(e.indexOf(n)>=0)continue;t[n]=s[n]}return t}function yi(){return yi=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},yi.apply(this,arguments)}function rd(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function bi(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rd(Object(t),!0).forEach(function(n){$N(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):rd(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function $N(s,e,t){return e=HN(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function HN(s){var e=GN(s,"string");return typeof e=="symbol"?e:e+""}function GN(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function uf(s){return s&&s.map((e,t)=>re.createElement(e.tag,bi({key:t},e.attr),uf(e.child)))}function df(s){return e=>re.createElement(WN,yi({attr:bi({},s.attr)},e),uf(s.child))}function WN(s){var e=t=>{var{attr:n,size:i,title:a}=s,l=qN(s,BN),c=i||t.size||"1em",d;return t.className&&(d=t.className),s.className&&(d=(d?d+" ":"")+s.className),re.createElement("svg",yi({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,l,{className:d,style:bi(bi({color:s.color||t.color},t.style),s.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),a&&re.createElement("title",null,a),s.children)};return nd!==void 0?re.createElement(nd.Consumer,null,t=>e(t)):e(cf)}function KN(s){return df({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(s)}function QN(s){return df({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(s)}function XN(){const[s,e]=D.useState({nom:localStorage.getItem("userNom")||"",prenom:localStorage.getItem("userPrenom")||"",email:localStorage.getItem("userEmail")||"",telephone:localStorage.getItem("userTel")||"",password:""}),[t,n]=D.useState(""),[i,a]=D.useState(!1),l=d=>{e({...s,[d.target.name]:d.target.value})},c=async d=>{d.preventDefault(),n("");try{const m=localStorage.getItem("userId"),f=await fetch("sailingloc-back-lilac.vercel.app/api/user/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:m,nom:s.nom,prenom:s.prenom,email:s.email,telephone:s.telephone,password:s.password})}),g=await f.json();if(!f.ok)throw new Error(g.message||"Erreur lors de la mise à jour");localStorage.setItem("userNom",g.user.nom),localStorage.setItem("userPrenom",g.user.prenom),localStorage.setItem("userEmail",g.user.email),localStorage.setItem("userTel",g.user.tel),J.success(r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),r.jsx("div",{children:r.jsx("strong",{style:{color:"#16a34a"},children:"Profil mis à jour avec succès !"})})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1}),n("")}catch(m){n(m.message)}};return r.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[r.jsx(Yn,{}),r.jsx(vo,{}),r.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md",children:[r.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-6 text-center",children:"Mon profil"}),r.jsxs("form",{onSubmit:c,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Nom"}),r.jsx("input",{type:"text",name:"nom",value:s.nom,onChange:l,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre nom"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Prénom"}),r.jsx("input",{type:"text",name:"prenom",value:s.prenom,onChange:l,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre prénom"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Email"}),r.jsx("input",{type:"email",name:"email",value:s.email,onChange:l,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre email"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Téléphone"}),r.jsx("input",{type:"tel",name:"telephone",value:s.telephone,onChange:l,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre téléphone"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Mot de passe"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:i?"text":"password",name:"password",value:s.password,onChange:l,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200 pr-12",placeholder:"Nouveau mot de passe (laisser vide pour ne pas changer)"}),r.jsx("span",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 cursor-pointer text-gray-500",onClick:()=>a(d=>!d),tabIndex:0,role:"button","aria-label":i?"Masquer le mot de passe":"Afficher le mot de passe",children:i?r.jsx(KN,{size:22}):r.jsx(QN,{size:22})})]})]}),r.jsx("button",{type:"submit",className:"w-full py-3 px-6 rounded-full font-bold text-lg bg-orange-500 text-white hover:bg-orange-600 transition-colors shadow-lg",children:"Enregistrer"}),t&&r.jsx("div",{className:"text-green-600 text-center mt-2",children:t})]})]})})]})}function JN(){return r.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[r.jsx(Yn,{}),r.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-2xl",children:[r.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-6 text-center",children:"Conditions Générales d’Utilisation (CGU) et de Vente (CGV)"}),r.jsx("p",{className:"mb-4 text-gray-700 text-center",children:"Dernière mise à jour : 01/04/2025"}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"1. Présentation de la plateforme"}),r.jsx("p",{className:"text-gray-700",children:"SailingLoc est une plateforme de mise en relation entre propriétaires de bateaux et particuliers souhaitant louer un voilier ou yacht en Europe. La société est basée à La Rochelle, sous le statut SAS (RCS La Rochelle B 923 456 789)."})]}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"2. Acceptation des CGU/CGV"}),r.jsx("p",{className:"text-gray-700",children:"En accédant ou en utilisant le site SailingLoc, tout utilisateur reconnaît avoir lu, compris et accepté les présentes CGU/CGV sans réserve."})]}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"3. Obligations des parties"}),r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 mb-2",children:[r.jsxs("li",{children:[r.jsx("strong",{children:"Propriétaires :"})," doivent fournir des informations exactes sur leur bateau (entretien, assurance, équipements)."]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Locataires :"})," s’engagent à utiliser les bateaux de manière responsable et à respecter les conditions de location."]}),r.jsxs("li",{children:[r.jsx("strong",{children:"SailingLoc :"})," s’assure de la conformité juridique des contrats et du respect du RGPD."]})]})]}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"4. Réservation et Paiement"}),r.jsx("p",{className:"text-gray-700",children:"Les réservations sont effectuées directement via la plateforme, avec paiement sécurisé via Stripe ou PayPal. Des frais de service peuvent s’appliquer."})]}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"5. Droit de rétractation et annulation"}),r.jsx("p",{className:"text-gray-700",children:"Les conditions d’annulation sont définies dans chaque annonce. SailingLoc permet l’annulation selon les délais spécifiés par le propriétaire."})]}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"6. Données personnelles"}),r.jsxs("p",{className:"text-gray-700",children:["Les données collectées (nom, email, numéro, localisation, etc.) sont utilisées dans le cadre de la mise en relation et sont traitées conformément au RGPD. Consultez notre "," ",r.jsx(z,{to:"/politique-confidentialite",className:"text-orange-500 underline",children:"politique de confidentialité"}),"."]})]}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"7. Responsabilité"}),r.jsx("p",{className:"text-gray-700",children:"SailingLoc décline toute responsabilité en cas de litige entre les utilisateurs. Toutefois, une équipe de modération peut intervenir en cas de signalement."})]}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"8. Modification des CGU/CGV"}),r.jsx("p",{className:"text-gray-700",children:"SailingLoc se réserve le droit de modifier les présentes conditions à tout moment. Les utilisateurs seront notifiés lors de la mise à jour."})]}),r.jsxs("section",{className:"mb-6",children:[r.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"9. Contact"}),r.jsxs("p",{className:"text-gray-700",children:["Pour toute question, vous pouvez contacter l’équipe via : ",r.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline",children:"sailinglocequipe@gmail.com"}),"."]})]})]})})]})}function YN(){return r.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[r.jsx(Yn,{}),r.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-4xl",children:[r.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-8 text-center",children:"Mentions légales"}),r.jsxs("section",{className:"mb-8",children:[r.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[r.jsx(Pa,{className:"h-6 w-6 mr-2"}),"1. Éditeur du site"]}),r.jsx("p",{className:"text-gray-700 mb-3",children:"Le site SailingLoc est édité par :"}),r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 mb-3 space-y-1",children:[r.jsx("li",{children:"SailingLoc SAS"}),r.jsx("li",{children:"Société par actions simplifiée au capital de [à compléter] €"}),r.jsx("li",{children:"RCS La Rochelle B 923 456 789"}),r.jsx("li",{children:"Siège social : 12 Rue du Port, 17000 La Rochelle, France"}),r.jsxs("li",{children:["Email : ",r.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"sailinglocequipe@gmail.com"})]}),r.jsx("li",{children:"Directeur de la publication : [Nom du responsable légal ou fondateur]"})]})]}),r.jsxs("section",{className:"mb-8",children:[r.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[r.jsx(od,{className:"h-6 w-6 mr-2"}),"2. Hébergement"]}),r.jsxs("ul",{className:"list-disc pl-6 text-gray-700 mb-3 space-y-1",children:[r.jsx("li",{children:"Le site est hébergé par :"}),r.jsx("li",{children:r.jsx("strong",{children:"Vercel Inc."})}),r.jsxs("li",{children:[r.jsx("strong",{children:"Adresse :"})," 340 S Lemon Ave #4133, Walnut, CA 91789, États-Unis"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Site web :"})," ",r.jsx("a",{href:"https://vercel.com",target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"vercel.com"})]}),r.jsx("li",{children:"Le prestataire assure un niveau de sécurité conforme aux exigences du RGPD."})]})]}),r.jsxs("section",{className:"mb-8",children:[r.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[r.jsx(Pa,{className:"h-6 w-6 mr-2"}),"3. Conception et développement"]}),r.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200",children:[r.jsx("h4",{className:"text-lg font-semibold text-blue-800 mb-4",children:"Agence Pandawan"}),r.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Dénomination sociale :"})," Pandawan"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Date de création :"})," 14/03/2014"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Siège social :"})," 25 Rue du Faubourg Saint-Antoine, 75011 Paris"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Statut juridique :"})," SAS"]})]}),r.jsxs("div",{className:"mt-4 p-4 bg-white rounded-lg border border-blue-100",children:[r.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed",children:[r.jsx("strong",{children:"Présentation :"})," Pandawan est une agence digitale internationale fondée en 2014, spécialisée dans le développement web, l'intelligence artificielle, le UX design et le référencement performant. Experte dans la création de contenus digitaux, tant pour le web que pour le mobile, l'agence poursuit son expansion dans plusieurs grandes villes à travers le monde."]}),r.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed mt-2",children:[r.jsx("strong",{children:"Son ambition :"})," offrir des services et produits de haute qualité, en valorisant l'identité de ses clients tout en y apportant une véritable valeur ajoutée à travers l'innovation et la créativité."]})]})]})]}),r.jsxs("section",{className:"mb-8",children:[r.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"4. Propriété intellectuelle"}),r.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["L'ensemble des éléments du site (textes, images, graphismes, logo, vidéos, base de données, etc.) est protégé par le Code de la propriété intellectuelle.",r.jsx("br",{}),"Toute reproduction, représentation, modification ou extraction, totale ou partielle, sans autorisation écrite de SailingLoc est interdite."]})]}),r.jsxs("section",{className:"mb-8",children:[r.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"5. Responsabilité"}),r.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["SailingLoc met tout en œuvre pour assurer l'exactitude des informations diffusées, mais ne saurait être tenue responsable des erreurs ou omissions.",r.jsx("br",{}),"SailingLoc décline toute responsabilité quant à l'utilisation du site ou aux dommages directs ou indirects pouvant en résulter."]})]}),r.jsxs("section",{className:"mb-8",children:[r.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"6. Données personnelles"}),r.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Pour consulter notre politique de confidentialité, veuillez vous rendre sur la page dédiée :",r.jsx("br",{}),r.jsx(z,{to:"/politique-confidentialite",className:"text-orange-500 underline hover:text-orange-600 transition-colors inline-flex items-center mt-2",children:r.jsx("span",{children:"👉 Politique de confidentialité"})})]})]}),r.jsxs("section",{className:"mb-8",children:[r.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"7. Cookies"}),r.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Lors de votre navigation, des cookies peuvent être déposés sur votre terminal. Vous pouvez à tout moment gérer vos préférences via notre bandeau dédié.",r.jsx("br",{}),"Pour plus d'informations, consultez notre ",r.jsx(z,{to:"/politique-confidentialite",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"politique de confidentialité"}),"."]})]}),r.jsxs("section",{className:"mb-8",children:[r.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[r.jsx(Qs,{className:"h-6 w-6 mr-2"}),"8. Contact"]}),r.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Pour toute question ou signalement, vous pouvez nous écrire à :",r.jsx("br",{}),r.jsxs("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors inline-flex items-center mt-2",children:[r.jsx(Qs,{className:"h-4 w-4 mr-1"}),r.jsx("span",{children:"📧 sailinglocequipe@gmail.com"})]})]})]})]})})]})}function ZN(){const{boatId:s}=ad(),e=vi(),[t,n]=D.useState(null),[i,a]=D.useState(!0),[l,c]=D.useState(!1),[d,m]=D.useState(!1),[f,g]=D.useState(""),[y,T]=D.useState({startDate:"",endDate:"",numberOfGuests:1,specialRequests:"",totalPrice:0});D.useEffect(()=>{s&&k()},[s]),D.useEffect(()=>{y.startDate&&y.endDate&&t&&C()},[y.startDate,y.endDate,y.numberOfGuests,t]);const k=async()=>{try{a(!0),console.log("🔄 Récupération des détails du bateau depuis MongoDB...");const I=await ce(ae.BOAT_DETAIL(s));console.log("✅ Détails du bateau récupérés:",I),n(I)}catch(I){console.error("❌ Erreur lors de la récupération des détails:",I),g("Bateau non trouvé: "+I.message)}finally{a(!1)}},C=()=>{if(!y.startDate||!y.endDate||!t)return;const I=new Date(y.startDate),S=new Date(y.endDate),O=Math.ceil((S-I)/(1e3*60*60*24));if(O>0){const P=O*t.prix_jour;T(L=>({...L,totalPrice:P}))}},N=(I,S)=>{T(O=>({...O,[I]:S}))},A=async I=>{if(I.preventDefault(),!y.startDate||!y.endDate){g("Veuillez sélectionner les dates de début et de fin");return}const S=new Date(y.startDate),O=new Date(y.endDate);if(S>=O){g("La date de fin doit être postérieure à la date de début");return}if(S<new Date){g("La date de début ne peut pas être dans le passé");return}try{c(!0),g("");const P=localStorage.getItem("token")||sessionStorage.getItem("token");if(!P){g("Vous devez être connecté pour effectuer une réservation");return}console.log("🔄 Création de la réservation dans MongoDB...");const L=await ce(ae.BOOKINGS,{method:"POST",headers:Me(P),body:JSON.stringify({boatId:s,startDate:y.startDate,endDate:y.endDate,numberOfGuests:y.numberOfGuests,specialRequests:y.specialRequests,totalPrice:y.totalPrice})});console.log("✅ Réservation créée avec succès:",L),m(!0),setTimeout(()=>{e("/mes-reservations")},3e3)}catch(P){console.error("❌ Erreur lors de la création de la réservation:",P),g("Erreur lors de la réservation: "+P.message)}finally{c(!1)}};return i?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Mn,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Chargement du bateau..."})]})}):f&&!t?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Fe,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:f}),r.jsx(z,{to:"/bateaux",className:"text-blue-600 hover:text-blue-700",children:"Retourner à la liste des bateaux"})]})}):d?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:r.jsxs("div",{className:"text-center max-w-md mx-auto",children:[r.jsx(Jr,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Réservation confirmée !"}),r.jsx("p",{className:"text-gray-600 mb-6",children:'Votre réservation a été créée avec succès ! Elle apparaîtra dans votre espace "Mes Réservations".'}),r.jsx("p",{className:"text-sm text-gray-500",children:'Redirection vers "Mes Réservations" dans quelques secondes...'})]})}):r.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[r.jsx("div",{className:"bg-white shadow-sm border-b",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[r.jsxs(z,{to:`/bateaux/${s}`,className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 mb-4",children:[r.jsx(go,{size:20}),r.jsx("span",{children:"Retour au bateau"})]}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Réserver ce bateau"})]})}),r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsx("div",{className:"lg:col-span-2",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Détails de la réservation"}),f&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6",children:f}),r.jsxs("form",{onSubmit:A,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de début"}),r.jsx("input",{type:"date",value:y.startDate,onChange:I=>N("startDate",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de fin"}),r.jsx("input",{type:"date",value:y.endDate,onChange:I=>N("endDate",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de personnes"}),r.jsx("select",{value:y.numberOfGuests,onChange:I=>N("numberOfGuests",parseInt(I.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[...Array(t.capacite)].map((I,S)=>r.jsxs("option",{value:S+1,children:[S+1," personne",S+1>1?"s":""]},S+1))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Demandes spéciales (optionnel)"}),r.jsx("textarea",{value:y.specialRequests,onChange:I=>N("specialRequests",I.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Équipements supplémentaires, préférences particulières..."})]}),r.jsx("button",{type:"submit",disabled:l,className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?r.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[r.jsx(Mn,{className:"h-5 w-5 animate-spin"}),r.jsx("span",{children:"Création de la réservation..."})]}):"Confirmer la réservation"})]})]})}),r.jsx("div",{className:"lg:col-span-1",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-24",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Résumé"}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("img",{src:t.image,alt:t.nom,className:"w-16 h-16 object-cover rounded-lg"}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-gray-900",children:t.nom}),r.jsx("p",{className:"text-sm text-gray-600 capitalize",children:t.type})]})]}),r.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(ut,{size:16}),r.jsx("span",{children:t.localisation})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Qt,{size:16}),r.jsxs("span",{children:["Capacité : ",t.capacite," personnes"]})]})]})]}),r.jsxs("div",{className:"space-y-3 mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Prix par jour"}),r.jsxs("span",{className:"font-medium",children:[t.prix_jour,"€"]})]}),y.startDate&&y.endDate&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Durée"}),r.jsxs("span",{className:"font-medium",children:[Math.ceil((new Date(y.endDate)-new Date(y.startDate))/(1e3*60*60*24))," jours"]})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Nombre de personnes"}),r.jsx("span",{className:"font-medium",children:y.numberOfGuests})]})]}),r.jsx("div",{className:"border-t pt-3",children:r.jsxs("div",{className:"flex items-center justify-between font-semibold",children:[r.jsx("span",{children:"Total"}),r.jsxs("span",{className:"text-lg text-blue-600",children:[y.totalPrice,"€"]})]})})]}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[r.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Informations importantes"}),r.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[r.jsx("li",{children:"• Réservation sécurisée"}),r.jsx("li",{children:"• Annulation gratuite jusqu'à 24h avant"}),r.jsx("li",{children:"• Paiement sécurisé"}),r.jsx("li",{children:"• Support client 24/7"})]})]})]})})]})})]})}function e1(){const[s,e]=D.useState([]),[t,n]=D.useState(!0),[i,a]=D.useState(""),[l,c]=D.useState(!1),[d,m]=D.useState(null);D.useEffect(()=>{f()},[]);const f=async()=>{try{n(!0);const A=localStorage.getItem("token")||sessionStorage.getItem("token");if(!A){a("Vous devez être connecté pour voir vos réservations"),n(!1);return}console.log("🔄 Récupération des réservations depuis MongoDB...");const I=await ce(ae.MY_BOOKINGS,{headers:Me(A)});console.log("✅ Réservations récupérées:",I),e(I.data||[])}catch(A){console.error("❌ Erreur lors de la récupération des réservations:",A),a("Erreur lors de la récupération des réservations: "+A.message)}finally{n(!1)}},g=A=>{switch(A){case"completed":return{icon:r.jsx(Jr,{size:20,className:"text-green-600"}),label:"Terminée",color:"bg-green-100 text-green-800 border-green-200"};case"confirmed":return{icon:r.jsx(ds,{size:20,className:"text-blue-600"}),label:"Confirmée",color:"bg-blue-100 text-blue-800 border-blue-200"};case"pending":return{icon:r.jsx(ds,{size:20,className:"text-yellow-600"}),label:"En attente",color:"bg-yellow-100 text-yellow-800 border-yellow-200"};case"cancelled":return{icon:r.jsx(mp,{size:20,className:"text-red-600"}),label:"Annulée",color:"bg-red-100 text-red-800 border-red-200"};default:return{icon:r.jsx(xc,{size:20,className:"text-gray-600"}),label:A,color:"bg-gray-100 text-gray-800 border-gray-200"}}},y=A=>new Date(A).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),T=(A,I)=>{const S=new Date(A),O=new Date(I);return Math.ceil((O-S)/(1e3*60*60*24))},k=A=>{m(A),c(!0)},C=A=>{c(!1),m(null)},N=()=>{c(!1),m(null)};return t?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Mn,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Chargement de vos réservations..."})]})}):i?r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:r.jsxs("div",{className:"text-center max-w-md mx-auto",children:[r.jsx(xc,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Erreur"}),r.jsx("p",{className:"text-gray-600 mb-6",children:i}),r.jsx(z,{to:"/connexion",className:"inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})]})}):r.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[r.jsx("div",{className:"bg-white shadow-sm border-b",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mes Réservations"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Gérez et suivez toutes vos réservations de bateaux"})]}),r.jsx(z,{to:"/bateaux",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Réserver un bateau"})]})})}),r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.length===0?r.jsxs("div",{className:"text-center py-16",children:[r.jsx(Fe,{className:"h-24 w-24 text-gray-300 mx-auto mb-6"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Aucune réservation pour le moment"}),r.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:"Vous n'avez pas encore de réservations. Commencez par explorer nos bateaux disponibles et réservez votre première sortie en mer !"}),r.jsx(z,{to:"/bateaux",className:"inline-block bg-orange-500 text-white px-8 py-4 rounded-lg text-lg font-medium hover:bg-orange-600 transition-colors",children:"Découvrir nos bateaux"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(Ln,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.length})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:r.jsx(Jr,{className:"h-6 w-6 text-green-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Terminées"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(A=>A.status==="completed").length})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(ds,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Confirmées"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(A=>A.status==="confirmed").length})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:r.jsx(ds,{className:"h-6 w-6 text-yellow-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En attente"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(A=>A.status==="pending").length})]})]})})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Toutes vos réservations"}),s.map(A=>{const I=g(A.status),S=T(A.startDate,A.endDate);return r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:r.jsx("div",{className:"p-6",children:r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:A.boatId?.nom||"Bateau"}),r.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${I.color}`,children:[I.icon,r.jsx("span",{className:"ml-1",children:I.label})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Ln,{className:"h-4 w-4 text-gray-400"}),r.jsxs("span",{className:"text-gray-600",children:["Du ",y(A.startDate)," au ",y(A.endDate)]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(ds,{className:"h-4 w-4 text-gray-400"}),r.jsxs("span",{className:"text-gray-600",children:[S," jour",S>1?"s":""]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Qt,{className:"h-4 w-4 text-gray-400"}),r.jsxs("span",{className:"text-gray-600",children:[A.numberOfGuests," personne",A.numberOfGuests>1?"s":""]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(xo,{className:"h-4 w-4 text-gray-400"}),r.jsxs("span",{className:"text-gray-600 font-medium",children:[A.totalPrice,"€"]})]})]}),A.specialRequests&&r.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Demandes spéciales :"})," ",A.specialRequests]})})]}),r.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[r.jsx(z,{to:`/bateaux/${A.boatId?._id||A.boatId}`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Voir le bateau"}),A.status==="completed"&&r.jsx("button",{onClick:()=>k(A),className:"text-green-600 hover:text-green-700 text-sm font-medium",children:"Laisser un avis"})]})]})})},A._id)})]})]})}),d&&r.jsx(ud,{isOpen:l,onClose:N,onReviewAdded:C,boatData:d.boatId,bookingId:d._id})]})}function t1(){const{pathname:s}=id();return D.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[s]),null}function s1(){const[s,e]=D.useState(null),[t,n]=D.useState(""),[i,a]=D.useState(""),[l,c]=D.useState([]),[d,m]=D.useState({nom:"",type:"voilier",prix:"",capacite:""}),[f,g]=D.useState(null),[y,T]=D.useState(null),[k,C]=D.useState("");D.useEffect(()=>{const L=Fr.onAuthStateChanged(v=>{e(v),v&&N()});return()=>L()},[]);const N=async()=>{try{const v=(await ww(Ku(ka,"boats"))).docs.map(p=>({id:p.id,...p.data()}));c(v)}catch(L){C(`Erreur lors de la récupération: ${L.message}`)}},A=async L=>{try{L?(await z0(Fr,t,i),C("Connexion réussie !")):(await q0(Fr,t,i),C("Compte créé avec succès !")),n(""),a("")}catch(v){C(`Erreur: ${v.message}`)}},I=async()=>{try{await G0(Fr),C("Déconnexion réussie !")}catch(L){C(`Erreur lors de la déconnexion: ${L.message}`)}},S=async L=>{if(L.preventDefault(),!s){C("Vous devez être connecté pour ajouter un bateau");return}try{const v={...d,prix:parseFloat(d.prix),capacite:parseInt(d.capacite),userId:s.uid,createdAt:new Date,imageName:f?f.name:null,imagePreview:y||null};await Ew(Ku(ka,"boats"),v),C("Bateau ajouté avec succès !"),m({nom:"",type:"voilier",prix:"",capacite:""}),g(null),T(null),N()}catch(v){C(`Erreur lors de l'ajout: ${v.message}`)}},O=L=>{const v=L.target.files[0];if(v){g(v);const p=new FileReader;p.onload=b=>{T(b.target.result)},p.readAsDataURL(v)}},P=async L=>{try{await Nw(Sm(ka,"boats",L)),C("Bateau supprimé avec succès !"),N()}catch(v){C(`Erreur lors de la suppression: ${v.message}`)}};return r.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[r.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Test Firebase - Nouvelle Configuration"}),r.jsxs("div",{className:"mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2 text-orange-800",children:"🗄️ Test API MongoDB"}),r.jsx("p",{className:"text-orange-700 mb-3",children:"Testez la connexion à votre API backend MongoDB pour récupérer les données des bateaux et avis."}),r.jsx(z,{to:"/api-test",className:"inline-block bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition-colors",children:"🧪 Tester l'API MongoDB"})]}),r.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold mb-3 text-blue-800",children:"🔐 Authentication"}),s?r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("p",{className:"text-blue-800",children:[r.jsx("strong",{children:"Connecté :"})," ",s.email]}),r.jsxs("p",{className:"text-sm text-blue-600",children:["UID: ",s.uid]})]}),r.jsx("button",{onClick:I,className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors",children:"Se déconnecter"})]}):r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:L=>n(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("input",{type:"password",placeholder:"Mot de passe",value:i,onChange:L=>a(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>A(!1),className:"flex-1 bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition-colors",children:"Créer un compte"}),r.jsx("button",{onClick:()=>A(!0),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 transition-colors",children:"Se connecter"})]})]})]}),r.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold mb-3 text-green-800",children:"🗄️ Firestore Database"}),s?r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:S,className:"space-y-4 mb-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[r.jsx("input",{type:"text",placeholder:"Nom du bateau",value:d.nom,onChange:L=>m({...d,nom:L.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),r.jsxs("select",{value:d.type,onChange:L=>m({...d,type:L.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[r.jsx("option",{value:"voilier",children:"Voilier"}),r.jsx("option",{value:"yacht",children:"Yacht"}),r.jsx("option",{value:"catamaran",children:"Catamaran"})]}),r.jsx("input",{type:"number",placeholder:"Prix/jour",value:d.prix,onChange:L=>m({...d,prix:L.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),r.jsx("input",{type:"number",placeholder:"Capacité",value:d.capacite,onChange:L=>m({...d,capacite:L.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:O,className:"hidden",id:"image-upload"}),r.jsx("div",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"📷 Ajouter une image"})]}),f&&r.jsxs("span",{className:"text-sm text-green-600",children:["✓ ",f.name]})]}),y&&r.jsxs("div",{className:"mt-3",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Aperçu de l'image :"}),r.jsx("img",{src:y,alt:"Aperçu",className:"w-32 h-32 object-cover rounded-lg border"})]})]}),r.jsx("button",{type:"submit",className:"w-full bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition-colors",children:"Ajouter le bateau"})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"font-medium mb-2",children:["Bateaux enregistrés (",l.length,")"]}),l.length===0?r.jsx("p",{className:"text-gray-500 text-center py-4",children:"Aucun bateau trouvé"}):r.jsx("div",{className:"space-y-2",children:l.map(L=>r.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border",children:[r.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[L.imagePreview&&r.jsx("img",{src:L.imagePreview,alt:L.nom,className:"w-16 h-16 object-cover rounded-lg border"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:L.nom}),r.jsxs("div",{className:"text-sm text-gray-600",children:[L.type," • ",L.prix,"€/jour • ",L.capacite," personnes"]}),L.imageName&&r.jsxs("div",{className:"text-xs text-blue-600",children:["📷 ",L.imageName]})]})]}),r.jsx("button",{onClick:()=>P(L.id),className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors",children:"Supprimer"})]},L.id))})]})]}):r.jsx("p",{className:"text-green-700",children:"Connectez-vous pour gérer les bateaux"})]}),k&&r.jsx("div",{className:"mt-4 p-3 bg-blue-100 border border-blue-300 rounded-md",children:r.jsx("p",{className:"text-sm text-blue-800",children:k})}),r.jsxs("div",{className:"mt-6 text-xs text-gray-500",children:[r.jsx("p",{children:"✅ Firebase configuré avec le projet : mypictures-9dc8b"}),r.jsx("p",{children:"🔐 Authentication et Firestore activés"})]})]})}function n1(){const[s,e]=D.useState("Vérification..."),[t,n]=D.useState(0),[i,a]=D.useState(0),[l,c]=D.useState("");D.useEffect(()=>{d()},[]);const d=async()=>{try{e("🔄 Test de connexion à l'API MongoDB..."),console.log("🧪 Test 1: Récupération des bateaux...");const g=await ce(ae.BOATS);n(g.length||0),console.log(`✅ ${g.length||0} bateaux trouvés`),console.log("🧪 Test 2: Récupération des avis...");const y=await ce(ae.FIVE_STAR_REVIEWS);a(y.data?.length||0),console.log(`✅ ${y.data?.length||0} avis trouvés`),console.log("🧪 Test 3: Test de l'API de réservation...");try{const T=localStorage.getItem("token");if(T){const k=await ce(ae.BOOKINGS,{headers:Me(T)});console.log("✅ API de réservation accessible:",k)}else console.log("⚠️ Pas de token, test de réservation ignoré")}catch(T){console.log("⚠️ API de réservation non accessible:",T.message)}console.log("🧪 Test 4: Test de l'API d'ajout de bateaux...");try{const T=localStorage.getItem("token");if(T){const k=await ce(ae.BOATS,{method:"GET",headers:Me(T)});console.log("✅ API d'ajout de bateaux accessible:",k)}else console.log("⚠️ Pas de token, test d'ajout de bateaux ignoré")}catch(T){console.log("⚠️ API d'ajout de bateaux non accessible:",T.message)}e(`✅ API MongoDB accessible - ${g.length||0} bateaux, ${y.data?.length||0} avis`),c("")}catch(g){console.error("❌ Erreur de connexion API:",g),e(`❌ Erreur de connexion: ${g.message}`),c(g.message)}},m=()=>{d()},f=async()=>{try{e("🧪 Test d'ajout de bateau...");const g=localStorage.getItem("token");if(!g){c("Vous devez être connecté pour tester l'ajout de bateau");return}const y={nom:"Bateau Test",type:"voilier",longueur:10,prix_jour:100,capacite:4,image:"https://via.placeholder.com/300x200?text=Test",destination:"saint-malo",description:"Bateau de test",equipements:["GPS","Radio VHF"]};console.log("🧪 Test d'ajout de bateau avec:",y);const T=await ce(ae.BOATS,{method:"POST",headers:Me(g),body:JSON.stringify(y)});console.log("✅ Test d'ajout réussi:",T),e("✅ Test d'ajout de bateau réussi !"),c("")}catch(g){console.error("❌ Test d'ajout échoué:",g),e("❌ Test d'ajout de bateau échoué"),c("Erreur lors du test: "+g.message)}};return r.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[r.jsx("h2",{className:"text-2xl font-bold mb-6",children:"🧪 Test de Connexion API MongoDB"}),r.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-800",children:"Statut de l'API"}),r.jsx("p",{className:"text-blue-700",children:s}),l&&r.jsx("div",{className:"mt-3 p-3 bg-red-100 border border-red-300 rounded",children:r.jsxs("p",{className:"text-red-800 text-sm",children:[r.jsx("strong",{children:"Erreur:"})," ",l]})}),r.jsxs("div",{className:"mt-3 space-x-3",children:[r.jsx("button",{onClick:m,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"🔄 Réessayer"}),r.jsx("button",{onClick:f,className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors",children:"🧪 Tester Ajout Bateau"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2 text-green-800",children:"📊 Bateaux"}),r.jsx("p",{className:"text-3xl font-bold text-green-600",children:t}),r.jsx("p",{className:"text-green-700 text-sm",children:"bateaux trouvés dans MongoDB"})]}),r.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2 text-purple-800",children:"⭐ Avis"}),r.jsx("p",{className:"text-3xl font-bold text-purple-600",children:i}),r.jsx("p",{className:"text-purple-700 text-sm",children:"avis 5 étoiles trouvés"})]})]}),r.jsxs("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-800",children:"🔧 Informations techniques"}),r.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"URL de base:"})," ",ae.BOATS.replace("/api/boats","")]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Endpoint bateaux:"})," ",ae.BOATS]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Endpoint avis:"})," ",ae.FIVE_STAR_REVIEWS]})]})]})]})}function r1(){return r.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:r.jsx("div",{className:"container mx-auto px-4",children:r.jsx(n1,{})})})}function i1(){return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-50 pt-20",children:r.jsx("section",{className:"relative py-20",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"relative inline-block",children:[r.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-2xl",children:r.jsx(Fe,{className:"h-16 w-16 text-white"})}),r.jsx("div",{className:"absolute -top-2 -right-2 w-12 h-12 bg-red-500 rounded-full flex items-center justify-center shadow-lg",children:r.jsx("span",{className:"text-white font-bold text-xl",children:"!"})})]}),r.jsx("h1",{className:"text-8xl md:text-9xl font-bold text-blue-600 mb-4 tracking-wider",children:"404"}),r.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-6",children:"Page introuvable"}),r.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed",children:"Oups ! Il semble que vous ayez navigué vers des eaux inconnues. Cette page n'existe pas ou a été déplacée."})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-12 border border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-6",children:[r.jsx(bc,{className:"h-8 w-8 text-blue-500"}),r.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Navigation perdue"})]}),r.jsx("p",{className:"text-gray-600 text-lg mb-6",children:"Ne vous inquiétez pas, même les meilleurs navigateurs peuvent se perdre ! Utilisez la boussole ci-dessous pour retrouver votre route."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[r.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[r.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"🌊"}),r.jsx("div",{className:"text-sm text-gray-600",children:"Océans explorés"}),r.jsx("div",{className:"text-2xl font-bold text-blue-800",children:"7"})]}),r.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[r.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"⚓"}),r.jsx("div",{className:"text-sm text-gray-600",children:"Ports visités"}),r.jsx("div",{className:"text-2xl font-bold text-green-800",children:"42"})]}),r.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[r.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:"🧭"}),r.jsx("div",{className:"text-sm text-gray-600",children:"Direction trouvée"}),r.jsx("div",{className:"text-2xl font-bold text-orange-800",children:"100%"})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-12",children:[r.jsxs(z,{to:"/",className:"inline-flex items-center space-x-3 bg-blue-600 text-white px-8 py-4 rounded-full font-bold text-lg hover:bg-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg",children:[r.jsx(rp,{size:24}),r.jsx("span",{children:"Retour à l'accueil"})]}),r.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center space-x-3 border-2 border-blue-600 text-blue-600 px-8 py-4 rounded-full font-bold text-lg hover:bg-blue-50 transition-all duration-300 transform hover:scale-105",children:[r.jsx(go,{size:24}),r.jsx("span",{children:"Page précédente"})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:[r.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Destinations populaires"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs(z,{to:"/bateaux",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[r.jsx(Bs,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),r.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"Nos bateaux"})]}),r.jsxs(z,{to:"/a-propos",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[r.jsx(Fe,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),r.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"À propos"})]}),r.jsxs(z,{to:"/contact",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[r.jsx(bc,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),r.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"Contact"})]}),r.jsxs(z,{to:"/inscription",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[r.jsx(Bs,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),r.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"S'inscrire"})]})]})]}),r.jsxs("div",{className:"mt-12 text-center",children:[r.jsxs("p",{className:"text-lg text-gray-600 mb-4",children:["💡 ",r.jsx("strong",{children:"Conseil de navigateur :"}),"Gardez toujours un œil sur votre boussole !"]}),r.jsxs("div",{className:"flex items-center justify-center space-x-2 text-blue-600",children:[r.jsx(Bs,{className:"h-5 w-5"}),r.jsx("span",{className:"font-medium",children:"SailingLoc - Votre boussole vers l'aventure"})]})]})]})})})}function a1(){return r.jsxs($f,{children:[r.jsx(t1,{}),r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(Yn,{}),r.jsx("main",{children:r.jsxs(Hf,{children:[r.jsx(we,{path:"/",element:r.jsx(yp,{})}),r.jsx(we,{path:"/bateaux",element:r.jsx(bp,{})}),r.jsx(we,{path:"/bateaux/:id",element:r.jsx(Ep,{})}),r.jsx(we,{path:"/reservation/:boatId",element:r.jsx(ZN,{})}),r.jsx(we,{path:"/mes-reservations",element:r.jsx(e1,{})}),r.jsx(we,{path:"/a-propos",element:r.jsx(_p,{})}),r.jsx(we,{path:"/contact",element:r.jsx(wp,{})}),r.jsx(we,{path:"/connexion",element:r.jsx(ig,{})}),r.jsx(we,{path:"/inscription",element:r.jsx(ag,{})}),r.jsx(we,{path:"/favoris",element:r.jsx(og,{})}),r.jsx(we,{path:"/gestion-bateaux",element:r.jsx(MN,{})}),r.jsx(we,{path:"/admin",element:r.jsx(UN,{})}),r.jsx(we,{path:"/politique-confidentialite",element:r.jsx(FN,{})}),r.jsx(we,{path:"/profil",element:r.jsx(XN,{})}),r.jsx(we,{path:"/cgu-cgv",element:r.jsx(JN,{})}),r.jsx(we,{path:"/mentions-legales",element:r.jsx(YN,{})}),r.jsx(we,{path:"/firebase-test",element:r.jsx(s1,{})}),r.jsx(we,{path:"/api-test",element:r.jsx(r1,{})}),r.jsx(we,{path:"*",element:r.jsx(i1,{})})]})}),r.jsx(gp,{})]})]})}Qf.createRoot(document.getElementById("root")).render(r.jsx(D.StrictMode,{children:r.jsx(a1,{})}));
