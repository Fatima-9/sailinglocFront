import{r as Xp,a as Yp}from"./vendor-DavUf6mE.js";import{r as S,u as tl,L as G,R as fe,a as vd,b as es,c as Jp,B as Zp,d as ef,e as Ee}from"./router-DONNKEte.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var so={exports:{}},pn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rc;function tf(){if(Rc)return pn;Rc=1;var r=Xp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(c,u,h){var p,g={},y=null,w=null;h!==void 0&&(y=""+h),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(w=u.ref);for(p in u)n.call(u,p)&&!a.hasOwnProperty(p)&&(g[p]=u[p]);if(c&&c.defaultProps)for(p in u=c.defaultProps,u)g[p]===void 0&&(g[p]=u[p]);return{$$typeof:e,type:c,key:y,ref:w,props:g,_owner:i.current}}return pn.Fragment=t,pn.jsx=l,pn.jsxs=l,pn}var Pc;function sf(){return Pc||(Pc=1,so.exports=tf()),so.exports}var s=sf(),Ei={},Dc;function rf(){if(Dc)return Ei;Dc=1;var r=Yp();return Ei.createRoot=r.createRoot,Ei.hydrateRoot=r.hydrateRoot,Ei}var nf=rf();/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var af={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const of=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),J=(r,e)=>{const t=S.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:c="",children:u,...h},p)=>S.createElement("svg",{ref:p,...af,width:i,height:i,stroke:n,strokeWidth:l?Number(a)*24/Number(i):a,className:["lucide",`lucide-${of(r)}`,c].join(" "),...h},[...e.map(([g,y])=>S.createElement(g,y)),...Array.isArray(u)?u:[u]]));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=J("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=J("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=J("Anchor",[["path",{d:"M12 22V8",key:"qkxhtm"}],["path",{d:"M5 12H2a10 10 0 0 0 20 0h-3",key:"1hv3nh"}],["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=J("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=J("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=J("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=J("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=J("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=J("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=J("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=J("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=J("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=J("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=J("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=J("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=J("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=J("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=J("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=J("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=J("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=J("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const df=J("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=J("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=J("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mf=J("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=J("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=J("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gf=J("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=J("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=J("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=J("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=J("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=J("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=J("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=J("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=J("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jd=J("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=J("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=J("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=J("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=J("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=J("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=J("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=J("Ship",[["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"iegodh"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-9-4-9 4c0 2.9.94 5.34 2.81 7.76",key:"fp8vka"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M12 10v4",key:"1kjpxc"}],["path",{d:"M12 2v3",key:"qbqxhf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=J("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=J("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=J("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=J("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=J("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=J("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=J("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=J("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=J("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=J("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=J("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),jf="/assets/Logo-DwvqwfSC.png";function Br(){const[r,e]=S.useState(!1),t=tl(),[n,i]=S.useState(!1),a=[{name:"Accueil",path:"/"},{name:"Bateaux",path:"/bateaux"},{name:"À propos",path:"/a-propos"},{name:"Contact",path:"/contact"}],l=g=>t.pathname===g,c=typeof window<"u"?localStorage.getItem("userPrenom"):null,u=typeof window<"u"?localStorage.getItem("userRole"):null,h=()=>{localStorage.removeItem("token"),localStorage.removeItem("userNom"),localStorage.removeItem("userPrenom"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("userTel"),window.location.href="/connexion"},p=()=>{window.scrollTo({top:0,behavior:"smooth"})};return s.jsx("header",{className:"bg-white shadow-sm fixed w-full top-0 z-50 border-b border-gray-100",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsx(G,{to:"/",className:"flex items-center space-x-2",children:s.jsx("img",{src:jf,alt:"Logo SailingLoc",className:"h-9 w-auto"})}),s.jsx("nav",{className:"hidden md:flex space-x-8",children:a.map(g=>s.jsx(G,{to:g.path,onClick:p,className:`px-3 py-2 text-sm font-medium transition-colors ${l(g.path)?"text-blue-600 border-b-2 border-blue-600":"text-gray-700 hover:text-blue-600"}`,children:g.name},g.name))}),s.jsx("div",{className:"hidden md:flex items-center space-x-4",children:c?s.jsxs(s.Fragment,{children:[s.jsx(G,{to:"/favoris",className:"text-blue-600 hover:text-blue-800 px-4 py-2 text-sm font-medium transition-colors flex items-center",children:s.jsx(An,{className:"h-5 w-5"})}),u==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsx(G,{to:"/gestion-bateaux",className:"text-blue-600 hover:text-blue-800 px-4 py-2 text-sm font-medium transition-colors flex items-center",children:"Gestion bateaux"}),s.jsx(G,{to:"/gestion-reservations",className:"text-blue-600 hover:text-blue-800 px-4 py-2 text-sm font-medium transition-colors flex items-center",children:"Gestion réservations"})]}),u==="admin"&&s.jsx(G,{to:"/admin",className:"bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors shadow-sm flex items-center",children:"Dashboard Admin"}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>i(g=>!g),className:"bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-medium hover:bg-blue-700 transition-colors shadow-sm flex items-center justify-center focus:outline-none",children:s.jsx(gs,{className:"h-5 w-5"})}),n&&s.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-4 z-50 border border-gray-100",children:[s.jsxs("div",{className:"px-4 py-2 text-gray-700 text-sm mb-2",children:["Bienvenue ",s.jsx("span",{className:"font-bold text-blue-700",children:c})]}),u!=="proprietaire"&&u!=="admin"&&s.jsx(G,{to:"/mes-reservations",onClick:()=>i(!1),className:"block w-full text-left px-4 py-2 text-blue-600 hover:bg-blue-50 text-sm font-medium",children:"Mes Réservations"}),s.jsxs(G,{to:"/profil",onClick:()=>i(!1),className:"w-full text-left px-4 py-2 text-blue-600 hover:bg-blue-50 text-sm font-medium flex items-center gap-2 border-t border-gray-100 mt-2",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6l4 2"})}),"Settings"]}),s.jsx("button",{onClick:h,className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 text-sm font-medium border-t border-gray-100 mt-2",children:"Déconnexion"})]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{to:"/connexion",className:"text-gray-700 hover:text-blue-600 px-4 py-2 text-sm font-medium transition-colors",onClick:p,children:"Connexion"}),s.jsx(G,{to:"/inscription",className:"bg-orange-500 text-white px-6 py-2 rounded-full text-sm font-medium hover:bg-orange-600 transition-colors shadow-sm",onClick:p,children:"Inscription"})]})}),s.jsx("button",{className:"md:hidden p-2",onClick:()=>e(!r),children:r?s.jsx(ke,{size:24}):s.jsx(yf,{size:24})})]}),r&&s.jsx("div",{className:"md:hidden border-t border-gray-100",children:s.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 bg-white",children:[a.map(g=>s.jsx(G,{to:g.path,className:`block px-3 py-2 text-base font-medium ${l(g.path)?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,onClick:()=>{e(!1),p()},children:g.name},g.name)),s.jsx("div",{className:"mt-4 space-y-2",children:c?s.jsxs(s.Fragment,{children:[u==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsx(G,{to:"/gestion-bateaux",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),p()},children:"Gestion bateaux"}),s.jsx(G,{to:"/gestion-reservations",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),p()},children:"Gestion réservations"})]}),u==="admin"&&s.jsx(G,{to:"/admin",className:"block w-full text-center bg-red-600 text-white px-3 py-2 rounded-lg text-base font-medium hover:bg-red-700 transition-colors",onClick:()=>{e(!1),p()},children:"Dashboard Admin"}),s.jsx(G,{to:"/favoris",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),p()},children:s.jsx(An,{className:"h-5 w-5"})}),u!=="proprietaire"&&u!=="admin"&&s.jsx(G,{to:"/mes-reservations",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),p()},children:"Mes Réservations"}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>i(g=>!g),className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",children:s.jsx(gs,{className:"h-5 w-5"})}),n&&s.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-4 z-50 border border-gray-100",children:[s.jsxs("div",{className:"px-4 py-2 text-gray-700 text-sm mb-2",children:["Bienvenue ",s.jsx("span",{className:"font-bold text-blue-700",children:c})]}),s.jsx("button",{onClick:h,className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 text-sm font-medium",children:"Déconnexion"})]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{to:"/connexion",className:"block w-full text-center border border-orange-500 text-orange-500 px-3 py-2 rounded-full text-base font-medium hover:bg-orange-50 transition-colors",onClick:()=>{e(!1),p()},children:"Connexion"}),s.jsx(G,{to:"/inscription",className:"block w-full text-center bg-orange-500 text-white px-3 py-2 rounded-full text-base font-medium hover:bg-orange-600 transition-colors",onClick:()=>{e(!1),p()},children:"Inscription"})]})})]})})]})})}function Id(){const[r,e]=S.useState("");typeof window<"u"&&localStorage.getItem("userPrenom");const t=typeof window<"u"?localStorage.getItem("userRole"):null,n=i=>{i.preventDefault(),console.log("Newsletter signup:",r),e(""),alert("Inscription réussie !")};return s.jsx("footer",{className:"bg-blue-900 text-white",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold mb-6",children:"MODE DE PAIEMENT"}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-white rounded flex items-center justify-center",children:s.jsx(wd,{className:"h-5 w-5 text-blue-900"})}),s.jsx("span",{children:"Carte bancaire"})]})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold mb-6",children:"PLAN DU SITE"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide",children:"Pages principales"}),s.jsx(G,{to:"/",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Accueil"}),s.jsx(G,{to:"/bateaux",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Catalogue des bateaux"}),s.jsx(G,{to:"/a-propos",className:"block hover:text-blue-300 transition-colors text-sm",children:"• À propos de SailingLoc"}),s.jsx(G,{to:"/contact",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Contact et support"})]}),s.jsxs("div",{className:"space-y-2 pt-3",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide",children:"Espace utilisateur"}),s.jsx(G,{to:"/connexion",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Connexion"}),s.jsx(G,{to:"/inscription",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Inscription"}),s.jsx(G,{to:"/profil",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Mon profil"}),t!=="proprietaire"&&s.jsx(G,{to:"/mes-reservations",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Mes réservations"}),s.jsx(G,{to:"/favoris",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Mes favoris"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold mb-6",children:" "}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2 pt-3",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide",children:"Gestion des bateaux"}),s.jsx(G,{to:"/gestion-bateaux",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Gérer mes bateaux"}),s.jsx(G,{to:"/gestion-reservations",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Gérer mes réservations"}),s.jsx(G,{to:"/ajouter-bateau",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Ajouter un bateau"})]}),s.jsxs("div",{className:"space-y-2 pt-3",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide",children:"Administration"}),s.jsx(G,{to:"/admin",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Tableau de bord admin"})]}),s.jsxs("div",{className:"space-y-2 pt-3",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide",children:"Légal"}),s.jsx(G,{to:"/mentions-legales",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Mentions légales"}),s.jsx(G,{to:"/politique-confidentialite",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Politique de confidentialité"}),s.jsx(G,{to:"/cgu-cgv",className:"block hover:text-blue-300 transition-colors text-sm",children:"• CGU / CGV"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold mb-6",children:"SUIVEZ-NOUS"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("a",{href:"https://www.facebook.com/profile.php?id=61579074677515",target:"_blank",rel:"noopener noreferrer","aria-label":"SailingLoc sur Facebook",className:"w-10 h-10 bg-blue-800 rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors",title:"Facebook",children:s.jsx(uf,{className:"h-5 w-5"})}),s.jsx("a",{href:"https://www.instagram.com/salingloc/",target:"_blank",rel:"noopener noreferrer","aria-label":"SailingLoc sur Instagram",className:"w-10 h-10 bg-blue-800 rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors",title:"Instagram",children:s.jsx(pf,{className:"h-5 w-5"})}),s.jsx("a",{href:"#",className:"w-10 h-10 bg-blue-800 rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors",title:"YouTube",children:s.jsx(_f,{className:"h-5 w-5"})}),s.jsx("a",{href:"https://www.linkedin.com/in/sailingloc-equipe-0a1a5937a/",target:"_blank",rel:"noopener noreferrer","aria-label":"SailingLoc sur LinkedIn",className:"w-10 h-10 bg-blue-800 rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors",title:"LinkedIn",children:s.jsx(ff,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"pt-4",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide mb-3",children:"Newsletter"}),s.jsxs("form",{onSubmit:n,className:"space-y-3",children:[s.jsx("input",{type:"email",value:r,onChange:i=>e(i.target.value),placeholder:"Votre email",className:"w-full px-3 py-2 bg-blue-800 border border-blue-700 rounded-lg text-white placeholder-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),s.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm font-medium",children:"S'abonner"})]})]})]})]})]}),s.jsxs("div",{className:"border-t border-blue-800 mt-12 pt-8 text-center",children:[s.jsxs("p",{className:"text-blue-300 text-sm",children:["© 2025 SailingLoc. Tous droits réservés. |",s.jsx(G,{to:"/mentions-legales",className:"hover:text-white transition-colors ml-2",children:"Mentions légales"})," ","|",s.jsx(G,{to:"/politique-confidentialite",className:"hover:text-white transition-colors ml-2",children:"Politique de confidentialité"})]}),s.jsx("p",{className:"text-blue-400 text-xs mt-2",children:"SailingLoc - Location de bateaux à La Rochelle et en Europe"})]})]})})}function Cn({rating:r,maxRating:e=5,size:t=16,interactive:n=!1,onRatingChange:i}){const a=Array.from({length:e},(l,c)=>{const u=c+1,h=u<=r,p=u-.5<=r&&r<u;return s.jsx("button",{type:"button",onClick:()=>n&&i&&i(u),className:`${n?"cursor-pointer hover:scale-110":"cursor-default"} transition-transform`,disabled:!n,children:s.jsx(rl,{size:t,className:`${h||p?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},c)});return s.jsx("div",{className:"flex items-center space-x-1",children:a})}function Sd(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=Sd(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Ks(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=Sd(r))&&(n&&(n+=" "),n+=e);return n}function Nf(r){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}Nf(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var zn=r=>typeof r=="number"&&!isNaN(r),Ys=r=>typeof r=="string",Qt=r=>typeof r=="function",Ef=r=>Ys(r)||zn(r),No=r=>Ys(r)||Qt(r)?r:null,Tf=(r,e)=>r===!1||zn(r)&&r>0?r:e,Eo=r=>S.isValidElement(r)||Ys(r)||Qt(r)||zn(r);function If(r,e,t=300){let{scrollHeight:n,style:i}=r;requestAnimationFrame(()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${t}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(e,t)})})}function Sf({enter:r,exit:e,appendPosition:t=!1,collapse:n=!0,collapseDuration:i=300}){return function({children:a,position:l,preventExitTransition:c,done:u,nodeRef:h,isIn:p,playToast:g}){let y=t?`${r}--${l}`:r,w=t?`${e}--${l}`:e,C=S.useRef(0);return S.useLayoutEffect(()=>{let _=h.current,N=y.split(" "),R=k=>{k.target===h.current&&(g(),_.removeEventListener("animationend",R),_.removeEventListener("animationcancel",R),C.current===0&&k.type!=="animationcancel"&&_.classList.remove(...N))};_.classList.add(...N),_.addEventListener("animationend",R),_.addEventListener("animationcancel",R)},[]),S.useEffect(()=>{let _=h.current,N=()=>{_.removeEventListener("animationend",N),n?If(_,u,i):u()};p||(c?N():(C.current=1,_.className+=` ${w}`,_.addEventListener("animationend",N)))},[p]),fe.createElement(fe.Fragment,null,a)}}function Mc(r,e){return{content:Ad(r.content,r.props),containerId:r.props.containerId,id:r.props.toastId,theme:r.props.theme,type:r.props.type,data:r.props.data||{},isLoading:r.props.isLoading,icon:r.props.icon,reason:r.removalReason,status:e}}function Ad(r,e,t=!1){return S.isValidElement(r)&&!Ys(r.type)?S.cloneElement(r,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):Qt(r)?r({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):r}function Af({closeToast:r,theme:e,ariaLabel:t="close"}){return fe.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:n=>{n.stopPropagation(),r(!0)},"aria-label":t},fe.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},fe.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function Cf({delay:r,isRunning:e,closeToast:t,type:n="default",hide:i,className:a,controlledProgress:l,progress:c,rtl:u,isIn:h,theme:p}){let g=i||l&&c===0,y={animationDuration:`${r}ms`,animationPlayState:e?"running":"paused"};l&&(y.transform=`scaleX(${c})`);let w=Ks("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${p}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":u}),C=Qt(a)?a({rtl:u,type:n,defaultClassName:w}):Ks(w,a),_={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{h&&t()}};return fe.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":g},fe.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${p} Toastify__progress-bar--${n}`}),fe.createElement("div",{role:"progressbar","aria-hidden":g?"true":"false","aria-label":"notification timer",className:C,style:y,..._}))}var kf=1,Cd=()=>`${kf++}`;function Rf(r,e,t){let n=1,i=0,a=[],l=[],c=e,u=new Map,h=new Set,p=k=>(h.add(k),()=>h.delete(k)),g=()=>{l=Array.from(u.values()),h.forEach(k=>k())},y=({containerId:k,toastId:D,updateId:P})=>{let B=k?k!==r:r!==1,L=u.has(D)&&P==null;return B||L},w=(k,D)=>{u.forEach(P=>{var B;(D==null||D===P.props.toastId)&&((B=P.toggle)==null||B.call(P,k))})},C=k=>{var D,P;(P=(D=k.props)==null?void 0:D.onClose)==null||P.call(D,k.removalReason),k.isActive=!1},_=k=>{if(k==null)u.forEach(C);else{let D=u.get(k);D&&C(D)}g()},N=()=>{i-=a.length,a=[]},R=k=>{var D,P;let{toastId:B,updateId:L}=k.props,E=L==null;k.staleId&&u.delete(k.staleId),k.isActive=!0,u.set(B,k),g(),t(Mc(k,E?"added":"updated")),E&&((P=(D=k.props).onOpen)==null||P.call(D))};return{id:r,props:c,observe:p,toggle:w,removeToast:_,toasts:u,clearQueue:N,buildToast:(k,D)=>{if(y(D))return;let{toastId:P,updateId:B,data:L,staleId:E,delay:f}=D,v=B==null;v&&i++;let T={...c,style:c.toastStyle,key:n++,...Object.fromEntries(Object.entries(D).filter(([j,b])=>b!=null)),toastId:P,updateId:B,data:L,isIn:!1,className:No(D.className||c.toastClassName),progressClassName:No(D.progressClassName||c.progressClassName),autoClose:D.isLoading?!1:Tf(D.autoClose,c.autoClose),closeToast(j){u.get(P).removalReason=j,_(P)},deleteToast(){let j=u.get(P);if(j!=null){if(t(Mc(j,"removed")),u.delete(P),i--,i<0&&(i=0),a.length>0){R(a.shift());return}g()}}};T.closeButton=c.closeButton,D.closeButton===!1||Eo(D.closeButton)?T.closeButton=D.closeButton:D.closeButton===!0&&(T.closeButton=Eo(c.closeButton)?c.closeButton:!0);let A={content:k,props:T,staleId:E};c.limit&&c.limit>0&&i>c.limit&&v?a.push(A):zn(f)?setTimeout(()=>{R(A)},f):R(A)},setProps(k){c=k},setToggle:(k,D)=>{let P=u.get(k);P&&(P.toggle=D)},isToastActive:k=>{var D;return(D=u.get(k))==null?void 0:D.isActive},getSnapshot:()=>l}}var st=new Map,kn=[],To=new Set,Pf=r=>To.forEach(e=>e(r)),kd=()=>st.size>0;function Df(){kn.forEach(r=>Pd(r.content,r.options)),kn=[]}var Of=(r,{containerId:e})=>{var t;return(t=st.get(e||1))==null?void 0:t.toasts.get(r)};function Rd(r,e){var t;if(e)return!!((t=st.get(e))!=null&&t.isToastActive(r));let n=!1;return st.forEach(i=>{i.isToastActive(r)&&(n=!0)}),n}function Lf(r){if(!kd()){kn=kn.filter(e=>r!=null&&e.options.toastId!==r);return}if(r==null||Ef(r))st.forEach(e=>{e.removeToast(r)});else if(r&&("containerId"in r||"id"in r)){let e=st.get(r.containerId);e?e.removeToast(r.id):st.forEach(t=>{t.removeToast(r.id)})}}var Vf=(r={})=>{st.forEach(e=>{e.props.limit&&(!r.containerId||e.id===r.containerId)&&e.clearQueue()})};function Pd(r,e){Eo(r)&&(kd()||kn.push({content:r,options:e}),st.forEach(t=>{t.buildToast(r,e)}))}function Mf(r){var e;(e=st.get(r.containerId||1))==null||e.setToggle(r.id,r.fn)}function Dd(r,e){st.forEach(t=>{(e==null||!(e!=null&&e.containerId)||e?.containerId===t.id)&&t.toggle(r,e?.id)})}function Ff(r){let e=r.containerId||1;return{subscribe(t){let n=Rf(e,r,Pf);st.set(e,n);let i=n.observe(t);return Df(),()=>{i(),st.delete(e)}},setProps(t){var n;(n=st.get(e))==null||n.setProps(t)},getSnapshot(){var t;return(t=st.get(e))==null?void 0:t.getSnapshot()}}}function Uf(r){return To.add(r),()=>{To.delete(r)}}function Bf(r){return r&&(Ys(r.toastId)||zn(r.toastId))?r.toastId:Cd()}function $n(r,e){return Pd(r,e),e.toastId}function va(r,e){return{...e,type:e&&e.type||r,toastId:Bf(e)}}function wa(r){return(e,t)=>$n(e,va(r,t))}function W(r,e){return $n(r,va("default",e))}W.loading=(r,e)=>$n(r,va("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function qf(r,{pending:e,error:t,success:n},i){let a;e&&(a=Ys(e)?W.loading(e,i):W.loading(e.render,{...i,...e}));let l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(h,p,g)=>{if(p==null){W.dismiss(a);return}let y={type:h,...l,...i,data:g},w=Ys(p)?{render:p}:p;return a?W.update(a,{...y,...w}):W(w.render,{...y,...w}),g},u=Qt(r)?r():r;return u.then(h=>c("success",n,h)).catch(h=>c("error",t,h)),u}W.promise=qf;W.success=wa("success");W.info=wa("info");W.error=wa("error");W.warning=wa("warning");W.warn=W.warning;W.dark=(r,e)=>$n(r,va("default",{theme:"dark",...e}));function zf(r){Lf(r)}W.dismiss=zf;W.clearWaitingQueue=Vf;W.isActive=Rd;W.update=(r,e={})=>{let t=Of(r,e);if(t){let{props:n,content:i}=t,a={delay:100,...n,...e,toastId:e.toastId||r,updateId:Cd()};a.toastId!==r&&(a.staleId=r);let l=a.render||i;delete a.render,$n(l,a)}};W.done=r=>{W.update(r,{progress:1})};W.onChange=Uf;W.play=r=>Dd(!0,r);W.pause=r=>Dd(!1,r);function $f(r){var e;let{subscribe:t,getSnapshot:n,setProps:i}=S.useRef(Ff(r)).current;i(r);let a=(e=S.useSyncExternalStore(t,n,n))==null?void 0:e.slice();function l(c){if(!a)return[];let u=new Map;return r.newestOnTop&&a.reverse(),a.forEach(h=>{let{position:p}=h.props;u.has(p)||u.set(p,[]),u.get(p).push(h)}),Array.from(u,h=>c(h[0],h[1]))}return{getToastToRender:l,isToastActive:Rd,count:a?.length}}function Hf(r){let[e,t]=S.useState(!1),[n,i]=S.useState(!1),a=S.useRef(null),l=S.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:c,pauseOnHover:u,closeToast:h,onClick:p,closeOnClick:g}=r;Mf({id:r.toastId,containerId:r.containerId,fn:t}),S.useEffect(()=>{if(r.pauseOnFocusLoss)return y(),()=>{w()}},[r.pauseOnFocusLoss]);function y(){document.hasFocus()||R(),window.addEventListener("focus",N),window.addEventListener("blur",R)}function w(){window.removeEventListener("focus",N),window.removeEventListener("blur",R)}function C(E){if(r.draggable===!0||r.draggable===E.pointerType){k();let f=a.current;l.canCloseOnClick=!0,l.canDrag=!0,f.style.transition="none",r.draggableDirection==="x"?(l.start=E.clientX,l.removalDistance=f.offsetWidth*(r.draggablePercent/100)):(l.start=E.clientY,l.removalDistance=f.offsetHeight*(r.draggablePercent===80?r.draggablePercent*1.5:r.draggablePercent)/100)}}function _(E){let{top:f,bottom:v,left:T,right:A}=a.current.getBoundingClientRect();E.nativeEvent.type!=="touchend"&&r.pauseOnHover&&E.clientX>=T&&E.clientX<=A&&E.clientY>=f&&E.clientY<=v?R():N()}function N(){t(!0)}function R(){t(!1)}function k(){l.didMove=!1,document.addEventListener("pointermove",P),document.addEventListener("pointerup",B)}function D(){document.removeEventListener("pointermove",P),document.removeEventListener("pointerup",B)}function P(E){let f=a.current;if(l.canDrag&&f){l.didMove=!0,e&&R(),r.draggableDirection==="x"?l.delta=E.clientX-l.start:l.delta=E.clientY-l.start,l.start!==E.clientX&&(l.canCloseOnClick=!1);let v=r.draggableDirection==="x"?`${l.delta}px, var(--y)`:`0, calc(${l.delta}px + var(--y))`;f.style.transform=`translate3d(${v},0)`,f.style.opacity=`${1-Math.abs(l.delta/l.removalDistance)}`}}function B(){D();let E=a.current;if(l.canDrag&&l.didMove&&E){if(l.canDrag=!1,Math.abs(l.delta)>l.removalDistance){i(!0),r.closeToast(!0),r.collapseAll();return}E.style.transition="transform 0.2s, opacity 0.2s",E.style.removeProperty("transform"),E.style.removeProperty("opacity")}}let L={onPointerDown:C,onPointerUp:_};return c&&u&&(L.onMouseEnter=R,r.stacked||(L.onMouseLeave=N)),g&&(L.onClick=E=>{p&&p(E),l.canCloseOnClick&&h(!0)}),{playToast:N,pauseToast:R,isRunning:e,preventExitTransition:n,toastRef:a,eventHandlers:L}}var Gf=typeof window<"u"?S.useLayoutEffect:S.useEffect,_a=({theme:r,type:e,isLoading:t,...n})=>fe.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:r==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...n});function Wf(r){return fe.createElement(_a,{...r},fe.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function Kf(r){return fe.createElement(_a,{...r},fe.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Qf(r){return fe.createElement(_a,{...r},fe.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Xf(r){return fe.createElement(_a,{...r},fe.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Yf(){return fe.createElement("div",{className:"Toastify__spinner"})}var Io={info:Kf,warning:Wf,success:Qf,error:Xf,spinner:Yf},Jf=r=>r in Io;function Zf({theme:r,type:e,isLoading:t,icon:n}){let i=null,a={theme:r,type:e};return n===!1||(Qt(n)?i=n({...a,isLoading:t}):S.isValidElement(n)?i=S.cloneElement(n,a):t?i=Io.spinner():Jf(e)&&(i=Io[e](a))),i}var eg=r=>{let{isRunning:e,preventExitTransition:t,toastRef:n,eventHandlers:i,playToast:a}=Hf(r),{closeButton:l,children:c,autoClose:u,onClick:h,type:p,hideProgressBar:g,closeToast:y,transition:w,position:C,className:_,style:N,progressClassName:R,updateId:k,role:D,progress:P,rtl:B,toastId:L,deleteToast:E,isIn:f,isLoading:v,closeOnClick:T,theme:A,ariaLabel:j}=r,b=Ks("Toastify__toast",`Toastify__toast-theme--${A}`,`Toastify__toast--${p}`,{"Toastify__toast--rtl":B},{"Toastify__toast--close-on-click":T}),M=Qt(_)?_({rtl:B,position:C,type:p,defaultClassName:b}):Ks(b,_),Q=Zf(r),re=!!P||!u,X={closeToast:y,type:p,theme:A},ee=null;return l===!1||(Qt(l)?ee=l(X):S.isValidElement(l)?ee=S.cloneElement(l,X):ee=Af(X)),fe.createElement(w,{isIn:f,done:E,position:C,preventExitTransition:t,nodeRef:n,playToast:a},fe.createElement("div",{id:L,tabIndex:0,onClick:h,"data-in":f,className:M,...i,style:N,ref:n,...f&&{role:D,"aria-label":j}},Q!=null&&fe.createElement("div",{className:Ks("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!v})},Q),Ad(c,r,!e),ee,!r.customProgressBar&&fe.createElement(Cf,{...k&&!re?{key:`p-${k}`}:{},rtl:B,theme:A,delay:u,isRunning:e,isIn:f,closeToast:y,hide:g,type:p,className:R,controlledProgress:re,progress:P||0})))},tg=(r,e=!1)=>({enter:`Toastify--animate Toastify__${r}-enter`,exit:`Toastify--animate Toastify__${r}-exit`,appendPosition:e}),sg=Sf(tg("bounce",!0)),rg={position:"top-right",transition:sg,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:r=>r.altKey&&r.code==="KeyT"};function ja(r){let e={...rg,...r},t=r.stacked,[n,i]=S.useState(!0),a=S.useRef(null),{getToastToRender:l,isToastActive:c,count:u}=$f(e),{className:h,style:p,rtl:g,containerId:y,hotKeys:w}=e;function C(N){let R=Ks("Toastify__toast-container",`Toastify__toast-container--${N}`,{"Toastify__toast-container--rtl":g});return Qt(h)?h({position:N,rtl:g,defaultClassName:R}):Ks(R,No(h))}function _(){t&&(i(!0),W.play())}return Gf(()=>{var N;if(t){let R=a.current.querySelectorAll('[data-in="true"]'),k=12,D=(N=e.position)==null?void 0:N.includes("top"),P=0,B=0;Array.from(R).reverse().forEach((L,E)=>{let f=L;f.classList.add("Toastify__toast--stacked"),E>0&&(f.dataset.collapsed=`${n}`),f.dataset.pos||(f.dataset.pos=D?"top":"bot");let v=P*(n?.2:1)+(n?0:k*E);f.style.setProperty("--y",`${D?v:v*-1}px`),f.style.setProperty("--g",`${k}`),f.style.setProperty("--s",`${1-(n?B:0)}`),P+=f.offsetHeight,B+=.025})}},[n,u,t]),S.useEffect(()=>{function N(R){var k;let D=a.current;w(R)&&((k=D.querySelector('[tabIndex="0"]'))==null||k.focus(),i(!1),W.pause()),R.key==="Escape"&&(document.activeElement===D||D!=null&&D.contains(document.activeElement))&&(i(!0),W.play())}return document.addEventListener("keydown",N),()=>{document.removeEventListener("keydown",N)}},[w]),fe.createElement("section",{ref:a,className:"Toastify",id:y,onMouseEnter:()=>{t&&(i(!1),W.pause())},onMouseLeave:_,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},l((N,R)=>{let k=R.length?{...p}:{...p,pointerEvents:"none"};return fe.createElement("div",{tabIndex:-1,className:C(N),"data-stacked":t,style:k,key:`c-${N}`},R.map(({content:D,props:P})=>fe.createElement(eg,{...P,stacked:t,collapseAll:_,isIn:c(P.toastId,P.containerId),key:`t-${P.key}`},D)))}))}function So({boatId:r,className:e=""}){const[t,n]=S.useState(!1),[i,a]=S.useState(!1);S.useEffect(()=>{l()},[r]);const l=async()=>{try{const u=localStorage.getItem("token")||sessionStorage.getItem("token");if(!u)return;const h=await fetch(`http://localhost:3001/api/favorites/check/${r}`,{headers:{Authorization:`Bearer ${u}`}});if(h.ok){const p=await h.json();n(p.isFavorite)}}catch(u){console.error("Erreur vérification favori:",u)}},c=async()=>{try{a(!0);const u=localStorage.getItem("token")||sessionStorage.getItem("token");if(!u){W.error("Vous devez être connecté pour ajouter des favoris");return}if(t)if((await fetch(`http://localhost:3001/api/favorites/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${u}`}})).ok)n(!1),W.success("Bateau retiré des favoris");else throw new Error("Erreur lors de la suppression");else{const h=await fetch("http://localhost:3001/api/favorites",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify({boatId:r})});if(h.ok)n(!0),W.success("Bateau ajouté aux favoris !");else{const p=await h.json();throw new Error(p.message||"Erreur lors de l'ajout")}}}catch(u){W.error(u.message||"Erreur lors de la gestion des favoris")}finally{a(!1)}};return s.jsx("button",{onClick:c,disabled:i,className:`absolute top-4 right-4 p-2 rounded-full transition-all duration-200 hover:scale-110 ${t?"bg-red-500 text-white shadow-lg":"bg-white/90 text-gray-600 hover:bg-white"} ${e}`,title:t?"Retirer des favoris":"Ajouter aux favoris",children:s.jsx(An,{size:20,className:`transition-all duration-200 ${t?"fill-current":""}`})})}function Na({boat:r,viewMode:e="grid"}){return e==="list"?s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-center space-x-6",children:[s.jsxs("div",{className:"flex-shrink-0 relative",children:[s.jsx("img",{src:r.image,alt:r.nom,className:"w-32 h-24 object-cover rounded-lg"}),s.jsx(So,{boatId:r._id,className:"top-2 right-2"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:r.nom}),s.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[s.jsx(Cn,{rating:r.rating||0,size:16}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",r.reviews||0,")"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-4 mb-3 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Gt,{size:16}),s.jsx("span",{className:"capitalize",children:r.destination})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(sl,{size:16}),s.jsxs("span",{children:[r.longueur,"m"]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Xs,{size:16}),s.jsxs("span",{children:[r.capacite," pers."]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Gt,{size:16}),s.jsx("span",{children:r.destination})]})]}),r.description&&s.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-3",children:r.description})]}),s.jsxs("div",{className:"flex-shrink-0 text-right",children:[s.jsxs("div",{className:"text-2xl font-bold text-blue-600 mb-3",children:[r.prix_jour,"€",s.jsx("span",{className:"text-base font-normal text-gray-600",children:"/jour"})]}),s.jsx(G,{to:`/bateaux/${r._id}`,className:"bg-orange-500 text-white px-6 py-2 rounded-full text-sm font-medium hover:bg-orange-600 transition-colors shadow-sm",children:"Réserver"})]})]})}):s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:r.image,alt:r.nom,className:"w-full h-56 object-cover"}),s.jsx("div",{className:"absolute top-4 left-4 bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:r.type}),s.jsx(So,{boatId:r._id})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 leading-tight",children:r.nom}),s.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[s.jsx(Cn,{rating:r.rating||0,size:16}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",r.reviews||0,")"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-4 mb-4 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Gt,{size:16}),s.jsx("span",{className:"capitalize",children:r.destination})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Xs,{size:16}),s.jsxs("span",{children:[r.capacite," pers."]})]})]}),r.description&&s.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4",children:r.description}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[r.prix_jour,"€",s.jsx("span",{className:"text-base font-normal text-gray-600",children:"/jour"})]}),s.jsx(G,{to:`/bateaux/${r._id}`,className:"bg-orange-500 text-white px-6 py-2 rounded-full text-sm font-medium hover:bg-orange-600 transition-colors shadow-sm",children:"Réserver"})]})]})]})}function ng({boats:r,onReset:e,searchFilters:t}){const[n,i]=S.useState("nom"),[a,l]=S.useState("asc"),[c,u]=S.useState(!1),[h,p]=S.useState(!1);fe.useEffect(()=>{p(!0)},[]);const g=[...r].sort((N,R)=>{let k,D;switch(n){case"prix_jour":k=N.prix_jour,D=R.prix_jour;break;case"longueur":k=N.longueur,D=R.longueur;break;case"capacite":k=N.capacite,D=R.capacite;break;case"nom":default:k=N.nom.toLowerCase(),D=R.nom.toLowerCase();break}return a==="asc"?k>D?1:-1:k<D?1:-1}),y=N=>{n===N?l(a==="asc"?"desc":"asc"):(i(N),l("asc"))},w=N=>n!==N?null:a==="asc"?s.jsx(cf,{size:16}):s.jsx(lf,{size:16}),C=(N,R)=>{if(!R)return"";switch(N){case"destination":return R.charAt(0).toUpperCase()+R.slice(1).replace("-"," ");case"type":return R.charAt(0).toUpperCase()+R.slice(1);case"dateDebut":case"dateFin":return new Date(R).toLocaleDateString("fr-FR");default:return R}},_=Object.entries(t).filter(([N,R])=>R);return s.jsx("section",{id:"search-results",className:`py-20 bg-white scroll-mt-20 transition-all duration-700 ease-out ${h?"opacity-100 translate-y-0":"opacity-0 translate-y-8"}`,ref:N=>{N&&(N.scrollIntoView=R=>{const P=N.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:P,behavior:R?.behavior||"smooth"})})},children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-2 h-12 bg-gradient-to-b from-blue-500 to-blue-600 rounded-full"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Résultats de votre recherche"}),s.jsxs("p",{className:"text-xl text-gray-600",children:[r.length," bateau",r.length>1?"x":""," trouvé",r.length>1?"s":""," pour vos critères"]})]})]}),s.jsxs("button",{onClick:e,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2",children:[s.jsx(ke,{size:20}),s.jsx("span",{children:"Réinitialiser"})]})]}),_.length>0&&s.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200 animate-pulse",children:[s.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-3",children:"Filtres actifs :"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(([N,R])=>s.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:[N==="destination"?"📍":N==="type"?"🚢":N.includes("date")?"📅":"🔍",C(N,R)]},N))})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8 p-4 bg-gray-50 rounded-lg",children:[s.jsxs("button",{onClick:()=>u(!c),className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(jo,{size:16}),s.jsx("span",{children:"Filtres avancés"})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Trier par :"}),s.jsx("div",{className:"flex gap-2",children:[{key:"nom",label:"Nom"},{key:"prix_jour",label:"Prix"},{key:"longueur",label:"Longueur"},{key:"capacite",label:"Capacité"}].map(({key:N,label:R})=>s.jsxs("button",{onClick:()=>y(N),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1 ${n===N?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:[R,w(N)]},N))})]})]}),c&&s.jsxs("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filtres avancés"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix maximum par jour"}),s.jsx("input",{type:"number",placeholder:"€",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longueur minimum"}),s.jsx("input",{type:"number",placeholder:"mètres",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacité minimum"}),s.jsx("input",{type:"number",placeholder:"personnes",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),g.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:g.map(N=>s.jsx(Na,{boat:N},N._id))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx(jo,{size:64})}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun résultat"}),s.jsx("p",{className:"text-gray-500",children:"Essayez de modifier vos critères de recherche"})]})]})})}const ot="https://sailingloc-back-lilac.vercel.app",nt={LOGIN:`${ot}/api/auth/login`,REGISTER:`${ot}/api/auth/register`,DASHBOARD:`${ot}/api/auth/dashboard`,USERS:`${ot}/api/auth/users`,BOATS:`${ot}/api/boats`,BOAT_DETAIL:r=>`${ot}/api/boats/${r}`,MY_BOATS:`${ot}/api/boats/my-boats`,BOOKINGS:`${ot}/api/bookings`,MY_BOOKINGS:`${ot}/api/bookings/my-bookings`,REVIEWS:`${ot}/api/reviews`,BOAT_REVIEWS:r=>`${ot}/api/reviews/boat/${r}`,FIVE_STAR_REVIEWS:`${ot}/api/reviews/five-stars`,CONTACT:`${ot}/api/contact`},Li=r=>({"Content-Type":"application/json",Authorization:r?`Bearer ${r}`:""}),bt=async(r,e={})=>{try{const t=await fetch(r,{...e,headers:{"Content-Type":"application/json",...e.headers}});if(!t.ok){const n=await t.json().catch(()=>({}));throw new Error(n.message||`Erreur HTTP: ${t.status}`)}return await t.json()}catch(t){throw console.error("Erreur API:",t),t}},ig=new URL("/assets/Yacht-charter-M-Y-ELTON_9-DZQi4yIW.jpg",import.meta.url).href;function ag(){const[r,e]=S.useState([]),[t,n]=S.useState([]),[i,a]=S.useState(!0),[l,c]=S.useState(""),[u,h]=S.useState([]),[p,g]=S.useState(!0),[y,w]=S.useState({destination:"",dateDebut:"",dateFin:"",type:""}),[C,_]=S.useState(!1);S.useEffect(()=>{N(),P()},[]);const N=async()=>{try{a(!0),console.log("🔄 Récupération des bateaux depuis l'API MongoDB...");const f=await bt(nt.BOATS);console.log(`✅ ${f.length||0} bateaux récupérés depuis MongoDB`),e(f),n(f)}catch(f){c("Erreur lors de la récupération des bateaux: "+f.message),console.error("❌ Erreur lors de la récupération des bateaux:",f)}finally{a(!1)}},R=async()=>{try{_(!0);let f=r.filter(v=>y.destination&&v.destination!==y.destination||y.type&&v.type!==y.type?!1:(y.dateDebut&&y.dateFin,!0));n(f),_(!1),f.length>0?setTimeout(()=>{const v=document.getElementById("search-results");v&&v.scrollIntoView?v.scrollIntoView({behavior:"smooth"}):v?.scrollIntoView({behavior:"smooth",block:"start"})},300):alert("Aucun bateau trouvé pour vos critères de recherche. Essayez de modifier vos filtres.")}catch(f){console.error("Erreur lors de la recherche:",f),_(!1)}},k=(f,v)=>{w(T=>({...T,[f]:v}))},D=()=>{w({destination:"",dateDebut:"",dateFin:"",type:""}),n([])},P=async()=>{try{g(!0),console.log("🔄 Récupération des avis 5 étoiles depuis MongoDB...");const f=await bt(`${nt.FIVE_STAR_REVIEWS}?limit=3`);console.log("✅ Données avis 5 étoiles reçues depuis MongoDB:",f),f.data&&f.data.length>0?(console.log(`📝 ${f.data.length} avis 5 étoiles trouvés dans MongoDB`),h(f.data)):(console.log("⚠️ Aucun avis 5 étoiles trouvé dans MongoDB"),h([]))}catch(f){console.error("💥 Erreur réseau lors de la récupération des avis 5 étoiles:",f),h([])}finally{g(!1)}},B=r.slice(0,6),L=!!localStorage.getItem("userId"),E=[{id:1,name:"Saint-Malo",image:"https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=800",description:"La cité corsaire et ses îles sauvages"},{id:2,name:"Les Glénan",image:"https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=800",description:"Archipel breton aux eaux turquoise"},{id:3,name:"Marseille",image:"https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=800",description:"Calanques et îles du Frioul"}];return s.jsxs("div",{className:"min-h-screen",children:[s.jsxs("section",{className:"relative h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700",children:[s.jsx("img",{src:ig,alt:"","aria-hidden":"true",className:"absolute inset-0 w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/60 via-black/40 to-black/20 pointer-events-none"}),s.jsx("div",{className:"relative z-10 flex items-center justify-center h-full px-4",children:s.jsxs("div",{className:"text-center text-white max-w-4xl",children:[s.jsxs("h1",{className:"text-6xl md:text-8xl font-bold mb-8 tracking-wider",children:["SAILINGLOC",s.jsx("span",{className:"text-orange-500",children:"."})]}),s.jsx("p",{className:"text-xl md:text-2xl mb-12 font-light max-w-3xl mx-auto leading-relaxed",children:"Découvrez les plus beaux bateaux pour vos aventures en mer"}),s.jsx("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl p-6 max-w-5xl mx-auto shadow-2xl",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Gt,{className:"h-4 w-4 text-gray-500"}),s.jsx("label",{className:"text-sm font-semibold text-gray-700 whitespace-nowrap",children:"Destination"})]}),s.jsxs("select",{className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700 mt-2",value:y.destination,onChange:f=>k("destination",f.target.value),children:[s.jsx("option",{value:"",children:"Destination"}),s.jsx("option",{value:"saint-malo",children:"Saint-Malo"}),s.jsx("option",{value:"les-glenan",children:"Les Glénan"}),s.jsx("option",{value:"crozon",children:"Crozon"}),s.jsx("option",{value:"la-rochelle",children:"La Rochelle"}),s.jsx("option",{value:"marseille",children:"Marseille"}),s.jsx("option",{value:"cannes",children:"Cannes"}),s.jsx("option",{value:"ajaccio",children:"Ajaccio"}),s.jsx("option",{value:"barcelone",children:"Barcelone"}),s.jsx("option",{value:"palma",children:"Palma de Majorque"}),s.jsx("option",{value:"athenes",children:"Athènes"}),s.jsx("option",{value:"venise",children:"Venise"}),s.jsx("option",{value:"amsterdam",children:"Amsterdam"}),s.jsx("option",{value:"split",children:"Split"})]})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(rt,{className:"h-4 w-4 text-gray-500"}),s.jsx("label",{className:"text-sm font-semibold text-gray-700 whitespace-nowrap",children:"Date de début"})]}),s.jsx("input",{type:"date",placeholder:"Date de début",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700 mt-2",value:y.dateDebut,onChange:f=>k("dateDebut",f.target.value)})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(rt,{className:"h-4 w-4 text-gray-500"}),s.jsx("label",{className:"text-sm font-semibold text-gray-700 whitespace-nowrap",children:"Date de fin"})]}),s.jsx("input",{type:"date",placeholder:"Date de fin",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700 mt-2",value:y.dateFin,onChange:f=>k("dateFin",f.target.value)})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx($e,{className:"h-4 w-4 text-gray-500"}),s.jsx("label",{className:"text-sm font-semibold text-gray-700 whitespace-nowrap",children:"Type de bateau"})]}),s.jsxs("select",{className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700 mt-2 min-w-[140px]",value:y.type,onChange:f=>k("type",f.target.value),children:[s.jsx("option",{value:"",children:"Type"}),s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"})]})]}),s.jsx("div",{className:"flex items-end",children:s.jsx("button",{onClick:R,disabled:C,className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:C?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Recherche..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Vc,{size:20}),s.jsx("span",{children:"Rechercher"})]})})})]})})]})})]}),s.jsx("section",{className:"py-20 bg-gray-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Nos bateaux vedettes"}),s.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Découvrez notre sélection de bateaux les plus populaires pour vos escapades en mer"})]}),i?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement des bateaux..."})]}):l?s.jsxs("div",{className:"text-center py-12",children:[s.jsx($e,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Erreur de chargement"}),s.jsx("p",{className:"text-gray-500",children:l})]}):B.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx($e,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun bateau disponible"}),s.jsx("p",{className:"text-gray-500",children:"Revenez bientôt pour découvrir nos bateaux !"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:B.map(f=>s.jsx(Na,{boat:f},f._id))}),r.length>6&&s.jsx("div",{className:"text-center mt-12",children:s.jsxs(G,{to:"/bateaux",className:"inline-flex items-center space-x-2 bg-blue-600 text-white px-8 py-3 rounded-full font-medium hover:bg-blue-700 transition-colors",children:[s.jsx("span",{children:"Voir tous les bateaux"}),s.jsx(Oc,{size:20})]})})]})}),t.length>0&&s.jsx(ng,{boats:t,onReset:D,searchFilters:y}),s.jsx("section",{className:"py-20 bg-gradient-to-br from-blue-50 to-white",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsxs("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:["Ce que disent nos"," ",s.jsx("span",{className:"text-blue-600",children:"navigateurs"})]}),s.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Découvrez les expériences exceptionnelles de nos clients les plus satisfaits"})]}),p?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement des avis 5 étoiles depuis la table reviews..."})]}):u.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx($e,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun avis 5 étoiles disponible"}),s.jsx("p",{className:"text-gray-500",children:"Revenez bientôt pour découvrir les avis exceptionnels de nos navigateurs !"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:u.map(f=>s.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-8 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 relative overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-semibold text-lg",children:f.userId?.nom?.charAt(0)||"U"})}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold text-gray-900",children:[f.userId?.nom," ",f.userId?.prenom]}),s.jsx("p",{className:"text-sm text-gray-500",children:f.boatId?.nom||"Bateau"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"flex items-center space-x-1 mb-2",children:[...Array(5)].map((v,T)=>s.jsx(rl,{size:20,className:"text-yellow-400 fill-current"},T))}),s.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Excellent"})]})]}),s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Er,{className:"h-6 w-6 text-blue-500 mt-1 flex-shrink-0"}),s.jsxs("blockquote",{className:"text-gray-700 leading-relaxed italic text-lg",children:['"',f.comment,'"']})]})}),s.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 pt-4 border-t border-gray-100",children:[s.jsx("span",{children:new Date(f.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}),f.boatId?.type&&s.jsx("span",{className:"capitalize bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs font-medium",children:f.boatId.type})]})]},f._id))}),u.length>6&&s.jsx("div",{className:"text-center mt-12",children:s.jsxs(G,{to:"/avis",className:"inline-flex items-center space-x-2 bg-blue-600 text-white px-8 py-3 rounded-full font-medium hover:bg-blue-700 transition-colors",children:[s.jsx("span",{children:"Voir tous les avis"}),s.jsx(Oc,{size:20})]})})]})}),s.jsx("section",{className:"py-20 bg-gray-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsx("div",{className:"text-center mb-16",children:s.jsxs("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:["Cap sur les ",s.jsx("span",{className:"text-blue-600",children:"destinations"})," ","les plus prisées par nos navigateurs !"]})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:E.map(f=>s.jsx("div",{className:"relative group cursor-pointer",children:s.jsxs("div",{className:"relative overflow-hidden rounded-2xl shadow-xl",children:[s.jsx("img",{src:f.image,alt:f.name,className:"w-full h-80 object-cover group-hover:scale-105 transition-transform duration-500"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),s.jsxs("div",{className:"absolute bottom-8 left-8 text-white",children:[s.jsx("h3",{className:"text-2xl font-bold mb-2",children:f.name}),s.jsx("p",{className:"text-lg opacity-90",children:f.description})]})]})},f.id))})]})}),s.jsx("section",{className:"py-20 bg-blue-600",children:s.jsxs("div",{className:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8",children:[s.jsx("h2",{className:"text-4xl font-bold text-white mb-6",children:"Prêt à vivre l'aventure ?"}),s.jsx("p",{className:"text-xl text-blue-100 mb-8",children:"Rejoignez SailingLoc et commencez à explorer les mers du monde"}),s.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:L?s.jsxs(G,{to:"/bateaux",className:"inline-flex items-center space-x-2 bg-white text-blue-600 px-8 py-3 rounded-full font-medium hover:bg-gray-50 transition-colors",children:[s.jsx(Vc,{size:20}),s.jsx("span",{children:"Rechercher un bateau"})]}):s.jsxs(s.Fragment,{children:[s.jsxs(G,{to:"/inscription",className:"inline-flex items-center space-x-2 bg-white text-blue-600 px-8 py-3 rounded-full font-medium hover:bg-gray-50 transition-colors",children:[s.jsx(wf,{size:20}),s.jsx("span",{children:"S'inscrire"})]}),s.jsx(G,{to:"/connexion",className:"inline-flex items-center space-x-2 border-2 border-white text-white px-8 py-3 rounded-full font-medium hover:bg-white hover:text-blue-600 transition-colors",children:s.jsx("span",{children:"Se connecter"})})]})})]})})]})}function og(){const[r,e]=S.useState([]),[t,n]=S.useState([]),[i,a]=S.useState(!0),[l,c]=S.useState(""),[u,h]=S.useState({type:"",priceRange:"",capacity:""}),[p,g]=S.useState("grid");S.useEffect(()=>{y()},[]);const y=async()=>{try{a(!0),console.log("🔄 Récupération des bateaux depuis l'API MongoDB...");const _=await bt(nt.BOATS);console.log(`✅ ${_.length||0} bateaux récupérés depuis MongoDB`),e(_),n(_)}catch(_){c("Erreur lors de la récupération des bateaux: "+_.message),console.error("❌ Erreur lors de la récupération des bateaux:",_)}finally{a(!1)}},w=(_,N)=>{const R={...u,[_]:N};h(R);let k=r;if(R.type&&(k=k.filter(D=>D.type.toLowerCase().includes(R.type.toLowerCase()))),R.priceRange){const[D,P]=R.priceRange.split("-").map(Number);k=k.filter(B=>B.prix_jour>=D&&(P?B.prix_jour<=P:!0))}R.capacity&&(k=k.filter(D=>D.capacite>=parseInt(R.capacity))),n(k)},C=()=>{h({type:"",priceRange:"",capacity:""}),n(r)};return i?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement des bateaux..."})]})}):l?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx($e,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Erreur de chargement"}),s.jsx("p",{className:"text-gray-500",children:l})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[s.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-4 sm:mb-0",children:"Nos bateaux"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[t.length," bateau",t.length>1?"x":""," trouvé",t.length>1?"s":""]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>g("grid"),className:`p-2 rounded-md ${p==="grid"?"bg-blue-100 text-blue-600":"text-gray-400"}`,children:s.jsx(df,{size:20})}),s.jsx("button",{onClick:()=>g("list"),className:`p-2 rounded-md ${p==="list"?"bg-blue-100 text-blue-600":"text-gray-400"}`,children:s.jsx(gf,{size:20})})]})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsx("div",{className:"lg:w-1/4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[s.jsx(jo,{size:20}),s.jsx("span",{children:"Filtres"})]}),s.jsx("button",{onClick:C,className:"text-sm text-blue-600 hover:text-blue-700",children:"Effacer"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de bateau"}),s.jsxs("select",{value:u.type,onChange:_=>w("type",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tous les types"}),s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fourchette de prix"}),s.jsxs("select",{value:u.priceRange,onChange:_=>w("priceRange",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tous les prix"}),s.jsx("option",{value:"0-100",children:"0€ - 100€"}),s.jsx("option",{value:"100-200",children:"100€ - 200€"}),s.jsx("option",{value:"200-300",children:"200€ - 300€"}),s.jsx("option",{value:"300-500",children:"300€ - 500€"}),s.jsx("option",{value:"500-1000",children:"500€+"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacité minimale"}),s.jsxs("select",{value:u.capacity,onChange:_=>w("capacity",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Toutes capacités"}),s.jsx("option",{value:"2",children:"2+ personnes"}),s.jsx("option",{value:"4",children:"4+ personnes"}),s.jsx("option",{value:"6",children:"6+ personnes"}),s.jsx("option",{value:"8",children:"8+ personnes"}),s.jsx("option",{value:"10",children:"10+ personnes"})]})]})]})]})}),s.jsx("div",{className:"lg:w-3/4",children:t.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx($e,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun bateau trouvé"}),s.jsx("p",{className:"text-gray-500",children:"Essayez de modifier vos filtres ou revenez plus tard."})]}):s.jsx("div",{className:p==="grid"?"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6":"space-y-4",children:t.map(_=>s.jsx(Na,{boat:_,viewMode:p},_._id))})})]})})]})}const lg="/assets/apropos-Dvd8oeAQ.png";function cg(){const r=[{icon:$e,title:"Large choix de bateaux",description:"Une sélection rigoureuse de bateaux entretenus et vérifiés pour votre sécurité et votre confort."},{icon:yt,title:"Réservation facile et rapide",description:"Réservez en quelques clics avec notre système de réservation en ligne simple et intuitif."},{icon:Ed,title:"Paiements sécurisés et service fiable",description:"Transactions 100% sécurisées et équipe disponible 7j/7 pour vous accompagner."}];return s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsxs("section",{className:"relative py-24 bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),s.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-8",children:"À propos"}),s.jsx("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto leading-relaxed",children:"Une question ? Écrivez-nous, nous vous répondons rapidement !"})]})]}),s.jsx("section",{className:"py-20 bg-white",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsx("div",{children:s.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl",children:[s.jsx("h2",{className:"text-3xl font-bold mb-6",children:"À PROPOS"}),s.jsxs("p",{style:{fontSize:"1.1rem",color:"var(--color-gray-800)",marginBottom:"1.5rem"},children:["SailingLoc est une start-up innovante fondée par M. Voisin, spécialisée dans la mise en relation pour la location de voiliers et de yachts. Basée à La Rochelle (Charente-Maritime), SailingLoc propose une plateforme collaborative, sécurisée et centrée sur l’expérience utilisateur.",s.jsx("br",{}),s.jsx("br",{}),"Notre service s’adresse aussi bien aux passionnés de navigation qu’aux vacanciers occasionnels, en facilitant la location de bateaux auprès de particuliers ou de professionnels partout en Europe. Que ce soit pour une sortie en mer, une croisière en famille, entre amis ou en couple, SailingLoc vous invite à vivre des aventures maritimes authentiques et inoubliables."]}),s.jsx("h2",{className:"text-orange-500 text-[1.3rem] mb-4 font-bold",children:"Informations légales"}),s.jsxs("ul",{style:{fontSize:"1.08rem",color:"var(--color-gray-800)",listStyle:"none",padding:0,lineHeight:1.8},children:[s.jsxs("li",{children:[s.jsx("b",{children:"Dénomination sociale"})," : SailingLoc"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Date de création"})," : 15/03/2024"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Siège social"})," : 12 Quai Louis Durand, 17000 La Rochelle"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Statut juridique"})," : Société par Actions Simplifiée (SAS)"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Capital social"})," : 15 000 €"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Numéro RCS"})," : LA ROCHELLE B 923 456 789"]}),s.jsxs("li",{children:[s.jsx("b",{children:"SIREN"})," : 923 456 789"]}),s.jsxs("li",{children:[s.jsx("b",{children:"SIRET"})," : 923 456 789 00014"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Code APE/NAF"})," : 7990Z – Services de réservation et activités connexes"]}),s.jsxs("li",{children:[s.jsx("b",{children:"TVA intracommunautaire"})," : FR42923456789"]})]})]})}),s.jsx("div",{className:"relative",children:s.jsx("img",{src:lg,alt:"À propos SailingLoc",className:"rounded-2xl shadow-2xl w-full"})})]})})}),s.jsx("section",{className:"py-16 bg-gray-50",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:s.jsxs("p",{className:"text-lg text-gray-700 leading-relaxed",children:["Notre ",s.jsx("strong",{children:"mission"})," est de rendre la navigation ",s.jsx("strong",{children:"accessible"}),", ",s.jsx("strong",{children:"simple"})," et ",s.jsx("strong",{children:"sécurisée"})," pour tous les passionnés de mer."]})})}),s.jsx("section",{className:"py-20 bg-white",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsx("div",{className:"text-center mb-16",children:s.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"Nos trois piliers"})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:r.map((e,t)=>s.jsxs("div",{className:"text-center group",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-blue-100 rounded-full mb-6 group-hover:bg-blue-600 transition-colors",children:s.jsx(e.icon,{className:"h-10 w-10 text-blue-600 group-hover:text-white transition-colors"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:e.title}),s.jsx("p",{className:"text-gray-600 leading-relaxed",children:e.description})]},t))})]})}),s.jsx("section",{className:"py-20 bg-gradient-to-r from-blue-600 to-blue-800",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsx("h2",{className:"text-4xl font-bold text-white mb-6",children:"Prêt à naviguer avec nous ?"}),s.jsx("p",{className:"text-xl text-blue-100 mb-10 max-w-2xl mx-auto",children:"Découvrez notre sélection de bateaux et réservez votre prochaine aventure"}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[s.jsx(G,{to:"/bateaux",className:"bg-white text-blue-600 px-8 py-4 rounded-full font-medium hover:bg-gray-100 transition-colors text-center",children:"Voir les bateaux"}),s.jsx(G,{to:"/contact",className:"bg-orange-500 text-white px-8 py-4 rounded-full font-medium hover:bg-orange-600 transition-colors text-center",children:"Nous contacter"})]})]})})]})}function ug(){const[r,e]=S.useState({nom:"",prenom:"",telephone:"",message:"",email:""}),[t,n]=S.useState({}),[i,a]=S.useState(!1),[l,c]=S.useState(!1),u=g=>{const{name:y,value:w}=g.target;e(C=>({...C,[y]:w})),t[y]&&n(C=>({...C,[y]:""}))},h=()=>{const g={};return r.nom.trim()||(g.nom="Le nom est requis"),r.prenom.trim()||(g.prenom="Le prénom est requis"),r.telephone.trim()||(g.telephone="Le téléphone est requis"),r.message.trim()||(g.message="Le message est requis"),n(g),Object.keys(g).length===0},p=async g=>{if(g.preventDefault(),!!h()){a(!0);try{const y=await fetch("http://localhost:3001/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nom:r.nom,prenom:r.prenom,telephone:r.telephone,message:r.message,email:r.email})}),w=await y.json();if(!y.ok)throw new Error(w.message||"Erreur lors de l'envoi du message.");c(!0),e({nom:"",prenom:"",telephone:"",message:"",email:""}),setTimeout(()=>{c(!1)},5e3)}catch(y){alert(y.message||"Erreur lors de l'envoi du message.")}finally{a(!1)}}};return s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[l&&s.jsx("div",{className:"fixed top-24 right-4 z-50 animate-slide-in-right",children:s.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-4 rounded-xl shadow-2xl flex items-center space-x-3 max-w-md border border-green-400",children:[s.jsx("div",{className:"animate-bounce-in",children:s.jsx(Rr,{className:"h-7 w-7 text-green-100 flex-shrink-0"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-bold text-lg",children:"Message envoyé ! 🎉"}),s.jsx("p",{className:"text-green-100 text-sm",children:"Nous vous répondrons dans les plus brefs délais."})]}),s.jsx("button",{onClick:()=>c(!1),className:"text-green-100 hover:text-white transition-colors duration-200 hover:bg-green-400 hover:bg-opacity-20 rounded-full p-1",children:s.jsx(ke,{className:"h-5 w-5"})})]})}),s.jsxs("section",{className:"relative py-24 bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),s.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-8",children:"Contact"}),s.jsx("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto leading-relaxed",children:"Nous simplifions la location de bateaux dans plus de 60 destinations, pour que vous puissiez profiter à tous vos besoins de navigation."})]})]}),s.jsx("section",{className:"py-20 bg-white",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[s.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:s.jsx(jd,{className:"h-8 w-8 text-blue-900"})}),s.jsx("h3",{className:"text-xl font-bold mb-4",children:"TÉLÉPHONE"}),s.jsx("p",{className:"text-blue-100 mb-2",children:"+33 2 99 40 78 90"}),s.jsx("p",{className:"text-sm text-blue-200",children:"Lun-Ven : 9h-18h"})]}),s.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:s.jsx(Dr,{className:"h-8 w-8 text-blue-900"})}),s.jsx("h3",{className:"text-xl font-bold mb-4",children:"INFORMATIONS"}),s.jsx("p",{className:"text-blue-100 mb-2",children:"sailinglocequipe@gmail.com"}),s.jsx("p",{className:"text-sm text-blue-200",children:"Réponse sous 24h"})]}),s.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:s.jsx(Gt,{className:"h-8 w-8 text-blue-900"})}),s.jsx("h3",{className:"text-xl font-bold mb-4",children:"ADRESSE"}),s.jsx("p",{className:"text-blue-100 mb-2",children:"12 Quai Louis Durand"}),s.jsx("p",{className:"text-sm text-blue-200",children:"17000 La Rochelle"})]}),s.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:s.jsx(yt,{className:"h-8 w-8 text-blue-900"})}),s.jsx("h3",{className:"text-xl font-bold mb-4",children:"HORAIRES"}),s.jsx("p",{className:"text-blue-100 mb-2",children:"Lun-Sam : 9h-18h"}),s.jsx("p",{className:"text-sm text-blue-200",children:"Fermé le dimanche"})]})]})})}),s.jsx("section",{className:"py-20 bg-gray-50",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 md:p-12",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Formulaire de contact"}),s.jsx("p",{className:"text-gray-600",children:"Remplissez le formulaire ci-dessous et nous vous répondrons rapidement"})]}),s.jsxs("form",{onSubmit:p,className:"space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"nom",className:"block text-sm font-bold text-gray-900 mb-3",children:"NOM"}),s.jsx("input",{type:"text",id:"nom",name:"nom",value:r.nom,onChange:u,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.nom?"border-red-500":"border-gray-200"}`,placeholder:"Votre nom"}),t.nom&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.nom})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"prenom",className:"block text-sm font-bold text-gray-900 mb-3",children:"PRÉNOM"}),s.jsx("input",{type:"text",id:"prenom",name:"prenom",value:r.prenom,onChange:u,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.prenom?"border-red-500":"border-gray-200"}`,placeholder:"Votre prénom"}),t.prenom&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.prenom})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-bold text-gray-900 mb-3",children:"EMAIL"}),s.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:u,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.email?"border-red-500":"border-gray-200"}`,placeholder:"Votre email"}),t.email&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.email})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"telephone",className:"block text-sm font-bold text-gray-900 mb-3",children:"TÉLÉPHONE"}),s.jsx("input",{type:"tel",id:"telephone",name:"telephone",value:r.telephone,onChange:u,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.telephone?"border-red-500":"border-gray-200"}`,placeholder:"Votre numéro de téléphone"}),t.telephone&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.telephone})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"message",className:"block text-sm font-bold text-gray-900 mb-3",children:"MESSAGE"}),s.jsx("textarea",{id:"message",name:"message",value:r.message,onChange:u,rows:6,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.message?"border-red-500":"border-gray-200"}`,placeholder:"Votre message..."}),t.message&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.message})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{type:"submit",disabled:i,className:`inline-flex items-center space-x-3 px-12 py-4 rounded-full font-bold text-lg transition-colors ${i?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white shadow-lg`,children:i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}),s.jsx("span",{children:"Envoi en cours..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Nd,{size:24}),s.jsx("span",{children:"ENVOYER"})]})})})]})]})})})]})}function dg({isOpen:r,onClose:e,onReviewAdded:t,boatData:n,bookingId:i}){const[a,l]=S.useState({rating:5,comment:""}),[c,u]=S.useState(!1),[h,p]=S.useState(""),[g,y]=S.useState(""),w=R=>{l(k=>({...k,rating:R}))},C=R=>{const{name:k,value:D}=R.target;l(P=>({...P,[k]:D}))},_=async R=>{R.preventDefault(),u(!0),p(""),y("");try{if(!a.comment.trim())throw new Error("Le commentaire est obligatoire");if(a.comment.trim().length<10)throw new Error("Le commentaire doit contenir au moins 10 caractères");if(a.comment.trim().length>1e3)throw new Error("Le commentaire ne peut pas dépasser 1000 caractères");const k=localStorage.getItem("token");if(!k)throw new Error("Vous devez être connecté");const D=await fetch("http://localhost:3001/api/reviews",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`},body:JSON.stringify({boatId:n._id,bookingId:i,rating:a.rating,comment:a.comment.trim()})}),P=await D.json();if(!D.ok)throw new Error(P.message||"Erreur lors de l'ajout de l'avis");y("Avis ajouté avec succès !"),t&&t(P.data),setTimeout(()=>{e(),y("")},2e3)}catch(k){p(k.message)}finally{u(!1)}},N=()=>{l({rating:5,comment:"",images:[]}),p(""),y(""),e()};return r?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(Er,{className:"h-6 w-6 text-blue-600"}),"Laisser un avis"]}),s.jsx("button",{onClick:N,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx(ke,{className:"h-6 w-6 text-gray-500"})})]}),s.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[h&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:h}),g&&s.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:g}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h3",{className:"font-medium text-gray-900 mb-2",children:["Bateau : ",n?.nom]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Type : ",n?.type]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Note globale *"}),s.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(R=>s.jsx("button",{type:"button",onClick:()=>w(R),className:`p-1 transition-colors ${R<=a.rating?"text-yellow-400 hover:text-yellow-500":"text-gray-300 hover:text-gray-400"}`,children:s.jsx(rl,{className:"h-8 w-8 fill-current"})},R))}),s.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[a.rating===1&&"Très mauvais",a.rating===2&&"Mauvais",a.rating===3&&"Moyen",a.rating===4&&"Bon",a.rating===5&&"Excellent"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Votre avis *"}),s.jsx("textarea",{name:"comment",value:a.comment,onChange:C,rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Partagez votre expérience avec ce bateau... (minimum 10 caractères)",required:!0}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.comment.length,"/1000 caractères"]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:N,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:c?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Envoi en cours..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Nd,{className:"h-4 w-4"}),"Publier l'avis"]})})]})]})]})}):null}function hg({review:r,onHelpfulClick:e}){const t=i=>new Date(i).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),n=()=>{e&&e(r._id)};return s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:r.userId?.nom?.charAt(0)||"U"})}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-medium text-gray-900",children:[r.userId?.nom," ",r.userId?.prenom]}),s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[s.jsx(rt,{className:"h-4 w-4"}),s.jsx("span",{children:t(r.createdAt)})]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(Cn,{rating:r.rating,size:20}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[r.rating===1&&"Très mauvais",r.rating===2&&"Mauvais",r.rating===3&&"Moyen",r.rating===4&&"Bon",r.rating===5&&"Excellent"]})]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Er,{className:"h-5 w-5 text-gray-400 mt-0.5 flex-shrink-0"}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:r.comment})]})}),r.images&&r.images.length>0&&s.jsx("div",{className:"mb-4",children:s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:r.images.map((i,a)=>s.jsx("div",{className:"relative",children:s.jsx("img",{src:i,alt:`Image ${a+1}`,className:"w-full h-24 object-cover rounded-lg",onError:l=>{l.target.style.display="none"}})},a))})}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[s.jsx("div",{className:"flex items-center space-x-4",children:s.jsxs("button",{onClick:n,className:"flex items-center space-x-2 text-gray-600 hover:text-blue-600 transition-colors",children:[s.jsx(vf,{className:"h-4 w-4"}),s.jsxs("span",{className:"text-sm",children:["Utile (",r.helpful||0,")"]})]})}),r.bookingId&&s.jsx("div",{className:"text-xs text-gray-500",children:"Avis basé sur une réservation"})]})]})}function mg(){const{id:r}=vd(),[e,t]=S.useState(null),[n,i]=S.useState(!0),[a,l]=S.useState(""),[c,u]=S.useState([]),[h,p]=S.useState(!1),[g,y]=S.useState(0),[w,C]=S.useState(0);S.useEffect(()=>{_(),N()},[r]);const _=async()=>{try{i(!0);const B=await fetch(`http://localhost:3001/api/boats/${r}`);if(!B.ok)throw new Error("Bateau non trouvé");const L=await B.json();t(L)}catch(B){l(B.message)}finally{i(!1)}},N=async()=>{try{const B=await fetch(`http://localhost:3001/api/reviews/boat/${r}`);if(B.ok){const L=await B.json();u(L.data||[]),y(L.averageRating||0),C(L.total||0)}}catch(B){console.error("Erreur lors de la récupération des avis:",B)}},R=()=>{p(!0)},k=B=>{N(),p(!1)},D=()=>{p(!1)},P=async B=>{try{(await fetch(`http://localhost:3001/api/reviews/${B}/helpful`,{method:"PUT"})).ok&&N()}catch(L){console.error("Erreur lors du marquage utile:",L)}};return n?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Kt,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement du bateau..."})]})}):a||!e?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx($e,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:a||"Bateau non trouvé"}),s.jsx(G,{to:"/bateaux",className:"text-blue-600 hover:text-blue-700",children:"Retourner à la liste des bateaux"})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[s.jsxs(G,{to:"/bateaux",className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 mb-4",children:[s.jsx(ba,{size:20}),s.jsx("span",{children:"Retour aux bateaux"})]}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e.nom}),s.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Cn,{rating:e.rating||0}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",e.reviews||0," avis)"]})]}),s.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[s.jsx(Gt,{size:16}),s.jsx("span",{className:"capitalize",children:e.destination})]})]})]})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:e.image,alt:e.nom,className:"w-full h-96 object-cover rounded-lg shadow-lg"}),s.jsx("div",{className:"absolute top-4 left-4 bg-blue-600 text-white px-3 py-1 rounded-md font-medium",children:e.type}),s.jsx(So,{boatId:e._id})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Description"}),e.description?s.jsx("p",{className:"text-gray-600 mb-6",children:e.description}):s.jsx("p",{className:"text-gray-500 italic mb-6",children:"Aucune description disponible pour ce bateau."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Caractéristiques"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Xs,{size:16,className:"text-blue-600"}),s.jsxs("span",{children:["Capacité : ",e.capacite," personnes"]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(sl,{size:16,className:"text-blue-600"}),s.jsxs("span",{children:["Longueur : ",e.longueur,"m"]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Gt,{size:16,className:"text-blue-600"}),s.jsxs("span",{children:["Localisation : ",e.localisation]})]})]})]}),e.equipements&&e.equipements.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Équipements"}),s.jsx("div",{className:"space-y-2 text-sm",children:e.equipements.map((B,L)=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Wi,{size:16,className:"text-green-600"}),s.jsx("span",{children:B})]},L))})]})]})]})]}),s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-24",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[e.prix_jour,"€"]}),s.jsx("div",{className:"text-gray-600",children:"par jour"})]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Capacité"}),s.jsxs("span",{className:"font-medium",children:[e.capacite," personnes"]})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Type"}),s.jsx("span",{className:"font-medium capitalize",children:e.type})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Longueur"}),s.jsxs("span",{className:"font-medium",children:[e.longueur,"m"]})]})]}),s.jsx(G,{to:`/reservation/${r}`,className:"w-full bg-orange-500 text-white py-3 px-6 rounded-lg font-medium hover:bg-orange-600 transition-colors flex items-center justify-center",children:"Réserver ce bateau"}),s.jsx("div",{className:"text-center mt-4",children:s.jsx("p",{className:"text-xs text-gray-500",children:"Réservation sécurisée • Annulation gratuite"})})]})})]}),s.jsx("div",{className:"mt-8",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Er,{className:"h-6 w-6 text-blue-600"}),"Avis des clients"]}),s.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Cn,{rating:g,size:20}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",w," avis)"]})]}),g>0&&s.jsxs("span",{className:"text-sm text-gray-500",children:["Note moyenne : ",g.toFixed(1),"/5"]})]})]}),s.jsxs("button",{onClick:R,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[s.jsx(Er,{className:"h-4 w-4"}),"Laisser un avis"]})]}),s.jsx("div",{className:"space-y-4",children:c.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Er,{size:48,className:"mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"Aucun avis pour le moment"}),s.jsx("p",{className:"text-sm",children:"Soyez le premier à laisser un avis !"})]}):c.map(B=>s.jsx(hg,{review:B,onHelpfulClick:P},B._id))})]})})]}),s.jsx(dg,{isOpen:h,onClose:D,onReviewAdded:k,boatData:e})]})}const Od=({onCaptchaChange:r,isCorrect:e,setIsCorrect:t})=>{const[n,i]=S.useState(""),[a,l]=S.useState(""),[c,u]=S.useState(null),h=S.useRef(null),p=()=>{const C="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let _="";for(let N=0;N<6;N++)_+=C.charAt(Math.floor(Math.random()*C.length));return _},g=C=>{const _=h.current;if(!_)return;const N=_.getContext("2d"),R=_.width,k=_.height;N.clearRect(0,0,R,k);const D=N.createLinearGradient(0,0,R,k);D.addColorStop(0,"#f3f4f6"),D.addColorStop(1,"#e5e7eb"),N.fillStyle=D,N.fillRect(0,0,R,k);for(let L=0;L<100;L++)N.fillStyle=`rgba(${Math.random()*255}, ${Math.random()*255}, ${Math.random()*255}, 0.1)`,N.fillRect(Math.random()*R,Math.random()*k,1,1);for(let L=0;L<3;L++)N.strokeStyle=`rgba(${Math.random()*255}, ${Math.random()*255}, ${Math.random()*255}, 0.3)`,N.lineWidth=1,N.beginPath(),N.moveTo(Math.random()*R,Math.random()*k),N.lineTo(Math.random()*R,Math.random()*k),N.stroke();N.font="bold 32px Arial",N.textAlign="center",N.textBaseline="middle";let P=R/2,B=k/2;for(let L=0;L<C.length;L++){const E=C[L];N.fillStyle=`rgb(${Math.random()*100+50}, ${Math.random()*100+50}, ${Math.random()*100+50})`,N.save();const f=P+(L-C.length/2)*35+(Math.random()-.5)*10,v=B+(Math.random()-.5)*15,T=(Math.random()-.5)*.4;N.translate(f,v),N.rotate(T),N.fillText(E,0,0),N.restore()}for(let L=0;L<5;L++)N.fillStyle=`rgba(${Math.random()*255}, ${Math.random()*255}, ${Math.random()*255}, 0.1)`,N.beginPath(),N.arc(Math.random()*R,Math.random()*k,Math.random()*10+5,0,2*Math.PI),N.fill()},y=()=>{const C=p();i(C),l(""),t(!1),setTimeout(()=>{g(C)},100),r&&r({question:C,answer:C})},w=C=>{l(C);const _=C.toUpperCase()===n;t(_),r&&r({question:n,answer:n,userAnswer:C,isCorrect:_})};return S.useEffect(()=>{y()},[]),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Vérification de sécurité *"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 text-center",children:[s.jsx("canvas",{ref:h,width:300,height:80,className:"mx-auto border border-gray-200 rounded",style:{imageRendering:"pixelated"}}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Recopiez les lettres et chiffres affichés ci-dessus"})]})}),s.jsx("button",{type:"button",onClick:y,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"Nouveau CAPTCHA",children:s.jsx(bf,{className:"h-5 w-5"})})]}),s.jsx("input",{type:"text",value:a,onChange:C=>w(C.target.value),placeholder:"Tapez le code ci-dessus",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${a&&!e?"border-red-300 focus:ring-red-500":a&&e?"border-green-300 focus:ring-green-500":"border-gray-300"}`,required:!0,maxLength:6}),a&&s.jsx("div",{className:`text-sm ${e?"text-green-600":"text-red-600"}`,children:e?s.jsx("span",{className:"flex items-center gap-1",children:"✅ Code correct"}):s.jsx("span",{className:"flex items-center gap-1",children:"❌ Code incorrect, réessayez"})}),s.jsx("p",{className:"text-xs text-gray-500",children:"Recopiez le code affiché pour vérifier que vous êtes humain"})]})};function pg(){const[r,e]=S.useState({email:"",password:""}),[t,n]=S.useState(!1),[i,a]=S.useState({}),[l,c]=S.useState(!1),[u,h]=S.useState({}),[p,g]=S.useState(!1),y=es(),w=N=>{const{name:R,value:k}=N.target;e(D=>({...D,[R]:k})),i[R]&&a(D=>({...D,[R]:""}))},C=()=>{const N={};return r.email.trim()?/\S+@\S+\.\S+/.test(r.email)||(N.email="Format d'email invalide"):N.email="L'email est requis",r.password.trim()?r.password.length<6&&(N.password="Le mot de passe doit contenir au moins 6 caractères"):N.password="Le mot de passe est requis",p||(N.captcha="Veuillez résoudre le CAPTCHA correctement"),a(N),Object.keys(N).length===0},_=async N=>{if(N.preventDefault(),!!C()){c(!0);try{console.log("🔄 Connexion en cours...");const R=await bt(nt.LOGIN,{method:"POST",body:JSON.stringify({email:r.email,password:r.password,captchaQuestion:u.question,captchaAnswer:u.answer,userAnswer:u.userAnswer})});console.log("✅ Connexion réussie:",R),localStorage.setItem("token",R.token),localStorage.setItem("userPrenom",R.user.prenom),localStorage.setItem("userRole",R.user.role),localStorage.setItem("userId",R.user.id),localStorage.setItem("userNom",R.user.nom),localStorage.setItem("userEmail",R.user.email),localStorage.setItem("userTel",R.user.tel),W.success(s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),s.jsxs("div",{children:[s.jsx("strong",{style:{color:"#16a34a"},children:"Connexion réussie !"}),s.jsx("br",{}),"Bienvenue ",s.jsx("span",{style:{color:"#16a34a"},children:R.user.prenom})," 👋"]})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1});const k=R.user.role==="admin"?"/admin":"/";setTimeout(()=>y(k),3100)}catch(R){alert(R.message||"Erreur lors de la connexion.")}finally{c(!1)}}};return s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx(ja,{}),s.jsxs("section",{className:"relative py-16 bg-gradient-to-br from-blue-800 via-blue-900 to-blue-800",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),s.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center mb-6",children:[s.jsx(fs,{className:"h-12 w-12 text-white mr-4"}),s.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white tracking-wider",children:"SAILINGLOC"})]}),s.jsx("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto",children:"Connectez-vous pour accéder à votre espace personnel"})]})]}),s.jsx("section",{className:"py-16",children:s.jsx("div",{className:"max-w-md mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"CONNEXION"}),s.jsx("p",{className:"text-gray-600",children:"Accédez à votre compte SailingLoc"})]}),s.jsxs("form",{onSubmit:_,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"EMAIL"}),s.jsxs("div",{className:"relative",children:[s.jsx(Dr,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:w,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.email?"border-red-500":"border-gray-200"}`,placeholder:"votre@email.com"})]}),i.email&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.email})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"MOT DE PASSE"}),s.jsxs("div",{className:"relative",children:[s.jsx(Qi,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:t?"text":"password",id:"password",name:"password",value:r.password,onChange:w,className:`w-full pl-10 pr-12 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.password?"border-red-500":"border-gray-200"}`,placeholder:"Votre mot de passe"}),s.jsx("button",{type:"button",onClick:()=>n(!t),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:t?s.jsx(_o,{size:20}):s.jsx(Pr,{size:20})})]}),i.password&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.password})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Se souvenir de moi"})]}),s.jsx(G,{to:"/mot-de-passe-oublie",className:"text-sm text-blue-600 hover:text-blue-700",children:"Mot de passe oublié ?"})]}),s.jsx(Od,{onCaptchaChange:h,isCorrect:p,setIsCorrect:g}),i.captcha&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.captcha}),s.jsx("button",{type:"submit",disabled:l,className:`w-full py-3 px-6 rounded-full font-bold text-lg transition-colors ${l?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white shadow-lg`,children:l?s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),s.jsx("span",{children:"CONNEXION..."})]}):"SE CONNECTER"})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsxs("p",{className:"text-gray-600",children:["Pas encore de compte ?"," ",s.jsx(G,{to:"/inscription",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Créer un compte"})]})})]})})})]})}function fg(){const[r,e]=S.useState({prenom:"",nom:"",email:"",telephone:"",password:"",confirmPassword:"",acceptTerms:!1,userType:"client",isProfessionnel:!1,siret:"",siren:""}),[t,n]=S.useState(!1),[i,a]=S.useState(!1),[l,c]=S.useState({}),[u,h]=S.useState(!1),[p,g]=S.useState({}),[y,w]=S.useState(!1),C=es(),_=k=>{const{name:D,value:P,type:B,checked:L}=k.target;e(E=>({...E,[D]:B==="checkbox"?L:P})),l[D]&&c(E=>({...E,[D]:""}))},N=()=>{const k={};return r.prenom.trim()||(k.prenom="Le prénom est requis"),r.nom.trim()||(k.nom="Le nom est requis"),r.email.trim()?/\S+@\S+\.\S+/.test(r.email)||(k.email="Format d'email invalide"):k.email="L'email est requis",r.telephone.trim()||(k.telephone="Le téléphone est requis"),r.password.trim()?r.password.length<6&&(k.password="Le mot de passe doit contenir au moins 6 caractères"):k.password="Le mot de passe est requis",r.password!==r.confirmPassword&&(k.confirmPassword="Les mots de passe ne correspondent pas"),r.acceptTerms||(k.acceptTerms="Vous devez accepter les conditions d'utilisation"),r.userType==="proprietaire"&&r.isProfessionnel&&(r.siret.trim()?/^\d{14}$/.test(r.siret)||(k.siret="Le SIRET doit contenir exactement 14 chiffres"):k.siret="Le SIRET est requis pour les professionnels",r.siren.trim()?/^\d{9}$/.test(r.siren)||(k.siren="Le SIREN doit contenir exactement 9 chiffres"):k.siren="Le SIREN est requis pour les professionnels"),y||(k.captcha="Veuillez résoudre le CAPTCHA correctement"),c(k),Object.keys(k).length===0},R=async k=>{if(k.preventDefault(),!!N()){h(!0);try{await new Promise(P=>setTimeout(P,1e3)),console.log("🔄 Création de l'utilisateur dans MongoDB...");const D=await bt(nt.REGISTER,{method:"POST",body:JSON.stringify({nom:r.nom,prenom:r.prenom,email:r.email,password:r.password,tel:r.telephone.replace(/\D/g,""),role:r.userType,...r.userType==="proprietaire"&&{isProfessionnel:r.isProfessionnel,...r.isProfessionnel&&{siret:r.siret,siren:r.siren}},captchaQuestion:p.question,captchaAnswer:p.answer,userAnswer:p.userAnswer})});console.log("✅ Utilisateur créé avec succès:",D),localStorage.setItem("userNom",D.user.nom),W.success(s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),s.jsxs("div",{children:[s.jsx("strong",{style:{color:"#16a34a"},children:"Inscription réussie !"}),s.jsx("br",{}),"Bienvenue ",s.jsx("span",{style:{color:"#16a34a"},children:D.user.nom})," 👋"]})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1}),setTimeout(()=>C("/connexion"),3100)}catch(D){W.error(D.message||"Erreur lors de l'inscription.",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#fde6e6",color:"#991b1b",fontWeight:500,fontSize:18,border:"2px solid #991b1b"},icon:!1})}finally{h(!1)}}};return s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx(ja,{}),s.jsxs("section",{className:"relative py-16 bg-gradient-to-br from-blue-800 via-blue-900 to-blue-800",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),s.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center mb-6",children:[s.jsx(fs,{className:"h-12 w-12 text-white mr-4"}),s.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white tracking-wider",children:"SAILINGLOC"})]}),s.jsx("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto",children:"Rejoignez la communauté des passionnés de navigation"})]})]}),s.jsx("section",{className:"py-16",children:s.jsx("div",{className:"max-w-lg mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"INSCRIPTION"}),s.jsx("p",{className:"text-gray-600",children:"Créez votre compte SailingLoc"})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"TYPE DE COMPTE"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("label",{className:`flex items-center justify-center p-4 border-2 rounded-lg cursor-pointer transition-colors ${r.userType==="client"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"userType",value:"client",checked:r.userType==="client",onChange:_,className:"sr-only"}),s.jsxs("div",{className:"text-center",children:[s.jsx(gs,{className:"h-8 w-8 mx-auto mb-2"}),s.jsx("span",{className:"font-semibold",children:"CLIENT"}),s.jsx("p",{className:"text-xs mt-1",children:"Louer des bateaux"})]})]}),s.jsxs("label",{className:`flex items-center justify-center p-4 border-2 rounded-lg cursor-pointer transition-colors ${r.userType==="proprietaire"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"userType",value:"proprietaire",checked:r.userType==="proprietaire",onChange:_,className:"sr-only"}),s.jsxs("div",{className:"text-center",children:[s.jsx(fs,{className:"h-8 w-8 mx-auto mb-2"}),s.jsx("span",{className:"font-semibold",children:"PROPRIÉTAIRE"}),s.jsx("p",{className:"text-xs mt-1",children:"Mettre en location"})]})]})]})]}),r.userType==="proprietaire"&&s.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-6",children:[s.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center gap-2",children:[s.jsx(fs,{className:"h-5 w-5"}),"Statut du propriétaire"]}),s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"false",checked:r.isProfessionnel===!1,onChange:k=>e({...r,isProfessionnel:k.target.value==="true"}),className:"mr-3 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Particulier"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"true",checked:r.isProfessionnel===!0,onChange:k=>e({...r,isProfessionnel:k.target.value==="true"}),className:"mr-3 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Professionnel"})]})]}),r.isProfessionnel&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"border-t border-blue-300 pt-4 mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Informations professionnelles"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"siret",className:"block text-sm font-bold text-gray-900 mb-2",children:"SIRET *"}),s.jsx("input",{type:"text",id:"siret",name:"siret",value:r.siret,onChange:_,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.siret?"border-red-500":"border-gray-200"}`,placeholder:"12345678901234",maxLength:"14"}),l.siret&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.siret}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"14 chiffres sans espaces"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"siren",className:"block text-sm font-bold text-gray-900 mb-2",children:"SIREN *"}),s.jsx("input",{type:"text",id:"siren",name:"siren",value:r.siren,onChange:_,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.siren?"border-red-500":"border-gray-200"}`,placeholder:"123456789",maxLength:"9"}),l.siren&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.siren}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"9 chiffres sans espaces"})]})]})]})})]}),s.jsxs("form",{onSubmit:R,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"prenom",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"PRÉNOM"}),s.jsxs("div",{className:"relative",children:[s.jsx(gs,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"text",id:"prenom",name:"prenom",value:r.prenom,onChange:_,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.prenom?"border-red-500":"border-gray-200"}`,placeholder:"Prénom"})]}),l.prenom&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.prenom})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"nom",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"NOM"}),s.jsxs("div",{className:"relative",children:[s.jsx(gs,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"text",id:"nom",name:"nom",value:r.nom,onChange:_,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.nom?"border-red-500":"border-gray-200"}`,placeholder:"Nom"})]}),l.nom&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.nom})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"EMAIL"}),s.jsxs("div",{className:"relative",children:[s.jsx(Dr,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:_,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.email?"border-red-500":"border-gray-200"}`,placeholder:"votre@email.com"})]}),l.email&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.email})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"telephone",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"TÉLÉPHONE"}),s.jsxs("div",{className:"relative",children:[s.jsx(jd,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"tel",id:"telephone",name:"telephone",value:r.telephone,onChange:_,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.telephone?"border-red-500":"border-gray-200"}`,placeholder:"06 12 34 56 78"})]}),l.telephone&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.telephone})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"MOT DE PASSE"}),s.jsxs("div",{className:"relative",children:[s.jsx(Qi,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:t?"text":"password",id:"password",name:"password",value:r.password,onChange:_,className:`w-full pl-10 pr-12 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.password?"border-red-500":"border-gray-200"}`,placeholder:"Mot de passe"}),s.jsx("button",{type:"button",onClick:()=>n(!t),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:t?s.jsx(_o,{size:20}):s.jsx(Pr,{size:20})})]}),l.password&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.password})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"CONFIRMER LE MOT DE PASSE"}),s.jsxs("div",{className:"relative",children:[s.jsx(Qi,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:i?"text":"password",id:"confirmPassword",name:"confirmPassword",value:r.confirmPassword,onChange:_,className:`w-full pl-10 pr-12 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.confirmPassword?"border-red-500":"border-gray-200"}`,placeholder:"Confirmer le mot de passe"}),s.jsx("button",{type:"button",onClick:()=>a(!i),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:i?s.jsx(_o,{size:20}):s.jsx(Pr,{size:20})})]}),l.confirmPassword&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.confirmPassword})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-start space-x-3",children:[s.jsx("input",{type:"checkbox",name:"acceptTerms",checked:r.acceptTerms,onChange:_,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["J'accepte les"," ",s.jsx(G,{to:"/conditions",className:"text-blue-600 hover:text-blue-700",children:"conditions d'utilisation"})," ","et la"," ",s.jsx(G,{to:"/confidentialite",className:"text-blue-600 hover:text-blue-700",children:"politique de confidentialité"})]})]}),l.acceptTerms&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.acceptTerms})]}),s.jsx(Od,{onCaptchaChange:g,isCorrect:y,setIsCorrect:w}),l.captcha&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.captcha}),s.jsx("button",{type:"submit",disabled:u,className:`w-full py-3 px-6 rounded-full font-bold text-lg transition-colors ${u?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white shadow-lg`,children:u?s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),s.jsx("span",{children:"INSCRIPTION..."})]}):"CRÉER MON COMPTE"})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsxs("p",{className:"text-gray-600",children:["Déjà un compte ?"," ",s.jsx(G,{to:"/connexion",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Se connecter"})]})})]})})})]})}function gg(){const[r,e]=S.useState([]),[t,n]=S.useState(!0),[i,a]=S.useState("");S.useEffect(()=>{l()},[]);const l=async()=>{try{n(!0);const u=localStorage.getItem("token")||sessionStorage.getItem("token");if(!u){a("Vous devez être connecté pour voir vos favoris"),n(!1);return}const h=await fetch("http://localhost:3001/api/favorites",{headers:{Authorization:`Bearer ${u}`}});if(!h.ok)throw new Error("Erreur lors de la récupération des favoris");const p=await h.json();e(p.data||[])}catch(u){a(u.message)}finally{n(!1)}},c=async u=>{try{const h=localStorage.getItem("token")||sessionStorage.getItem("token");if((await fetch(`http://localhost:3001/api/favorites/${u}`,{method:"DELETE",headers:{Authorization:`Bearer ${h}`}})).ok)e(g=>g.filter(y=>y.boatId._id!==u)),W.success("Bateau retiré des favoris");else throw new Error("Erreur lors de la suppression")}catch(h){W.error(h.message||"Erreur lors de la suppression du favori")}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Kt,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement de vos favoris..."})]})}):i?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto",children:[s.jsx(Sn,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Erreur"}),s.jsx("p",{className:"text-gray-600 mb-6",children:i}),s.jsx(G,{to:"/connexion",className:"inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mes Favoris"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Retrouvez tous vos bateaux favoris"})]}),s.jsx(G,{to:"/bateaux",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Découvrir plus de bateaux"})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r.length===0?s.jsxs("div",{className:"text-center py-16",children:[s.jsx(An,{className:"h-24 w-24 text-gray-300 mx-auto mb-6"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Aucun bateau en favori pour le moment"}),s.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:"Vous n'avez pas encore ajouté de bateaux à vos favoris. Explorez notre catalogue et cliquez sur le cœur pour les ajouter !"}),s.jsx(G,{to:"/bateaux",className:"inline-block bg-orange-500 text-white px-8 py-4 rounded-lg text-lg font-medium hover:bg-orange-600 transition-colors",children:"Découvrir nos bateaux"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:s.jsx(An,{className:"h-6 w-6 text-red-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total des favoris"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]})]})})}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Vos bateaux favoris"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(u=>s.jsxs("div",{className:"relative",children:[s.jsx(Na,{boat:u.boatId}),s.jsx("button",{onClick:()=>c(u.boatId._id),className:"absolute top-4 right-4 p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors shadow-lg z-10",title:"Retirer des favoris",children:s.jsx(Ws,{size:16})})]},u._id))})]})]})})]})}const xg=()=>{};var Fc={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},yg=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=r[t++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=r[t++],l=r[t++],c=r[t++],u=((i&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const a=r[t++],l=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|l&63)}}return e.join("")},Vd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const a=r[i],l=i+1<r.length,c=l?r[i+1]:0,u=i+2<r.length,h=u?r[i+2]:0,p=a>>2,g=(a&3)<<4|c>>4;let y=(c&15)<<2|h>>6,w=h&63;u||(w=64,l||(y=64)),n.push(t[p],t[g],t[y],t[w])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(Ld(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):yg(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const a=t[r.charAt(i++)],c=i<r.length?t[r.charAt(i)]:0;++i;const h=i<r.length?t[r.charAt(i)]:64;++i;const g=i<r.length?t[r.charAt(i)]:64;if(++i,a==null||c==null||h==null||g==null)throw new bg;const y=a<<2|c>>4;if(n.push(y),h!==64){const w=c<<4&240|h>>2;if(n.push(w),g!==64){const C=h<<6&192|g;n.push(C)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class bg extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vg=function(r){const e=Ld(r);return Vd.encodeByteArray(e,!0)},Ji=function(r){return vg(r).replace(/\./g,"")},Md=function(r){try{return Vd.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wg(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _g=()=>wg().__FIREBASE_DEFAULTS__,jg=()=>{if(typeof process>"u"||typeof Fc>"u")return;const r=Fc.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},Ng=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&Md(r[1]);return e&&JSON.parse(e)},Ea=()=>{try{return xg()||_g()||jg()||Ng()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},Fd=r=>Ea()?.emulatorHosts?.[r],Ud=r=>{const e=Fd(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},Bd=()=>Ea()?.config,qd=r=>Ea()?.[`_${r}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function nl(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zd(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,a=r.sub||r.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...r};return[Ji(JSON.stringify(t)),Ji(JSON.stringify(l)),""].join(".")}const wn={};function Tg(){const r={prod:[],emulator:[]};for(const e of Object.keys(wn))wn[e]?r.emulator.push(e):r.prod.push(e);return r}function Ig(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let Uc=!1;function il(r,e){if(typeof window>"u"||typeof document>"u"||!As(window.location.host)||wn[r]===e||wn[r]||Uc)return;wn[r]=e;function t(y){return`__firebase__banner__${y}`}const n="__firebase__banner",a=Tg().prod.length>0;function l(){const y=document.getElementById(n);y&&y.remove()}function c(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,w){y.setAttribute("width","24"),y.setAttribute("id",w),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{Uc=!0,l()},y}function p(y,w){y.setAttribute("id",w),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function g(){const y=Ig(n),w=t("text"),C=document.getElementById(w)||document.createElement("span"),_=t("learnmore"),N=document.getElementById(_)||document.createElement("a"),R=t("preprendIcon"),k=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const D=y.element;c(D),p(N,_);const P=h();u(k,R),D.append(k,C,N,P),document.body.appendChild(D)}a?(C.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function et(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Sg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(et())}function Ag(){const r=Ea()?.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Cg(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kg(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function Rg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Pg(){const r=et();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function Dg(){return!Ag()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Og(){try{return typeof indexedDB=="object"}catch{return!1}}function Lg(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg="FirebaseError";class Lt extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=Vg,Object.setPrototypeOf(this,Lt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hn.prototype.create)}}class Hn{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],l=a?Mg(a,n):"Error",c=`${this.serviceName}: ${l} (${i}).`;return new Lt(i,c,n)}}function Mg(r,e){return r.replace(Fg,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Fg=/\{\$([^}]+)}/g;function Ug(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Js(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const a=r[i],l=e[i];if(Bc(a)&&Bc(l)){if(!Js(a,l))return!1}else if(a!==l)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function Bc(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gn(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function gn(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function xn(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function Bg(r,e){const t=new qg(r,e);return t.subscribe.bind(t)}class qg{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");zg(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=io),i.error===void 0&&(i.error=io),i.complete===void 0&&(i.complete=io);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function zg(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function io(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ge(r){return r&&r._delegate?r._delegate:r}class _s{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Eg;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Gg(e))try{this.getOrInitializeService({instanceIdentifier:zs})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=zs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=zs){return this.instances.has(e)}getOptions(e=zs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&l.resolve(i)}return i}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Hg(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=zs){return this.component?this.component.multipleInstances?e:zs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Hg(r){return r===zs?void 0:r}function Gg(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new $g(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ue;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(ue||(ue={}));const Kg={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},Qg=ue.INFO,Xg={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},Yg=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=Xg[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class al{constructor(e){this.name=e,this._logLevel=Qg,this._logHandler=Yg,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Kg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...e),this._logHandler(this,ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...e),this._logHandler(this,ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ue.INFO,...e),this._logHandler(this,ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ue.WARN,...e),this._logHandler(this,ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...e),this._logHandler(this,ue.ERROR,...e)}}const Jg=(r,e)=>e.some(t=>r instanceof t);let qc,zc;function Zg(){return qc||(qc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ex(){return zc||(zc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $d=new WeakMap,Ao=new WeakMap,Hd=new WeakMap,ao=new WeakMap,ol=new WeakMap;function tx(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",a),r.removeEventListener("error",l)},a=()=>{t(xs(r.result)),i()},l=()=>{n(r.error),i()};r.addEventListener("success",a),r.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&$d.set(t,r)}).catch(()=>{}),ol.set(e,r),e}function sx(r){if(Ao.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",a),r.removeEventListener("error",l),r.removeEventListener("abort",l)},a=()=>{t(),i()},l=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",a),r.addEventListener("error",l),r.addEventListener("abort",l)});Ao.set(r,e)}let Co={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Ao.get(r);if(e==="objectStoreNames")return r.objectStoreNames||Hd.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return xs(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function rx(r){Co=r(Co)}function nx(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(oo(this),e,...t);return Hd.set(n,e.sort?e.sort():[e]),xs(n)}:ex().includes(r)?function(...e){return r.apply(oo(this),e),xs($d.get(this))}:function(...e){return xs(r.apply(oo(this),e))}}function ix(r){return typeof r=="function"?nx(r):(r instanceof IDBTransaction&&sx(r),Jg(r,Zg())?new Proxy(r,Co):r)}function xs(r){if(r instanceof IDBRequest)return tx(r);if(ao.has(r))return ao.get(r);const e=ix(r);return e!==r&&(ao.set(r,e),ol.set(e,r)),e}const oo=r=>ol.get(r);function ax(r,e,{blocked:t,upgrade:n,blocking:i,terminated:a}={}){const l=indexedDB.open(r,e),c=xs(l);return n&&l.addEventListener("upgradeneeded",u=>{n(xs(l.result),u.oldVersion,u.newVersion,xs(l.transaction),u)}),t&&l.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const ox=["get","getKey","getAll","getAllKeys","count"],lx=["put","add","delete","clear"],lo=new Map;function $c(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(lo.get(e))return lo.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=lx.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||ox.includes(t)))return;const a=async function(l,...c){const u=this.transaction(l,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),i&&u.done]))[0]};return lo.set(e,a),a}rx(r=>({...r,get:(e,t,n)=>$c(e,t)||r.get(e,t,n),has:(e,t)=>!!$c(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ux(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function ux(r){return r.getComponent()?.type==="VERSION"}const ko="@firebase/app",Hc="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt=new al("@firebase/app"),dx="@firebase/app-compat",hx="@firebase/analytics-compat",mx="@firebase/analytics",px="@firebase/app-check-compat",fx="@firebase/app-check",gx="@firebase/auth",xx="@firebase/auth-compat",yx="@firebase/database",bx="@firebase/data-connect",vx="@firebase/database-compat",wx="@firebase/functions",_x="@firebase/functions-compat",jx="@firebase/installations",Nx="@firebase/installations-compat",Ex="@firebase/messaging",Tx="@firebase/messaging-compat",Ix="@firebase/performance",Sx="@firebase/performance-compat",Ax="@firebase/remote-config",Cx="@firebase/remote-config-compat",kx="@firebase/storage",Rx="@firebase/storage-compat",Px="@firebase/firestore",Dx="@firebase/ai",Ox="@firebase/firestore-compat",Lx="firebase",Vx="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro="[DEFAULT]",Mx={[ko]:"fire-core",[dx]:"fire-core-compat",[mx]:"fire-analytics",[hx]:"fire-analytics-compat",[fx]:"fire-app-check",[px]:"fire-app-check-compat",[gx]:"fire-auth",[xx]:"fire-auth-compat",[yx]:"fire-rtdb",[bx]:"fire-data-connect",[vx]:"fire-rtdb-compat",[wx]:"fire-fn",[_x]:"fire-fn-compat",[jx]:"fire-iid",[Nx]:"fire-iid-compat",[Ex]:"fire-fcm",[Tx]:"fire-fcm-compat",[Ix]:"fire-perf",[Sx]:"fire-perf-compat",[Ax]:"fire-rc",[Cx]:"fire-rc-compat",[kx]:"fire-gcs",[Rx]:"fire-gcs-compat",[Px]:"fire-fst",[Ox]:"fire-fst-compat",[Dx]:"fire-vertex","fire-js":"fire-js",[Lx]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new Map,Fx=new Map,Po=new Map;function Gc(r,e){try{r.container.addComponent(e)}catch(t){Xt.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Zs(r){const e=r.name;if(Po.has(e))return Xt.debug(`There were multiple attempts to register component ${e}.`),!1;Po.set(e,r);for(const t of Rn.values())Gc(t,r);for(const t of Fx.values())Gc(t,r);return!0}function Ta(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function lt(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ys=new Hn("app","Firebase",Ux);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new _s("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ys.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir=Vx;function Gd(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:Ro,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw ys.create("bad-app-name",{appName:String(i)});if(t||(t=Bd()),!t)throw ys.create("no-options");const a=Rn.get(i);if(a){if(Js(t,a.options)&&Js(n,a.config))return a;throw ys.create("duplicate-app",{appName:i})}const l=new Wg(i);for(const u of Po.values())l.addComponent(u);const c=new Bx(t,n,l);return Rn.set(i,c),c}function ll(r=Ro){const e=Rn.get(r);if(!e&&r===Ro&&Bd())return Gd();if(!e)throw ys.create("no-app",{appName:r});return e}function Wc(){return Array.from(Rn.values())}function Tt(r,e,t){let n=Mx[r]??r;t&&(n+=`-${t}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${n}" with version "${e}":`];i&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xt.warn(l.join(" "));return}Zs(new _s(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="firebase-heartbeat-database",zx=1,Pn="firebase-heartbeat-store";let co=null;function Wd(){return co||(co=ax(qx,zx,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Pn)}catch(t){console.warn(t)}}}}).catch(r=>{throw ys.create("idb-open",{originalErrorMessage:r.message})})),co}async function $x(r){try{const t=(await Wd()).transaction(Pn),n=await t.objectStore(Pn).get(Kd(r));return await t.done,n}catch(e){if(e instanceof Lt)Xt.warn(e.message);else{const t=ys.create("idb-get",{originalErrorMessage:e?.message});Xt.warn(t.message)}}}async function Kc(r,e){try{const n=(await Wd()).transaction(Pn,"readwrite");await n.objectStore(Pn).put(e,Kd(r)),await n.done}catch(t){if(t instanceof Lt)Xt.warn(t.message);else{const n=ys.create("idb-set",{originalErrorMessage:t?.message});Xt.warn(n.message)}}}function Kd(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hx=1024,Gx=30;class Wx{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Qx(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Qc();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>Gx){const i=Xx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Qc(),{heartbeatsToSend:t,unsentEntries:n}=Kx(this._heartbeatsCache.heartbeats),i=Ji(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Xt.warn(e),""}}}function Qc(){return new Date().toISOString().substring(0,10)}function Kx(r,e=Hx){const t=[];let n=r.slice();for(const i of r){const a=t.find(l=>l.agent===i.agent);if(a){if(a.dates.push(i.date),Xc(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Xc(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class Qx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Og()?Lg().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await $x(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Kc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Kc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Xc(r){return Ji(JSON.stringify({version:2,heartbeats:r})).length}function Xx(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(r){Zs(new _s("platform-logger",e=>new cx(e),"PRIVATE")),Zs(new _s("heartbeat",e=>new Wx(e),"PRIVATE")),Tt(ko,Hc,r),Tt(ko,Hc,"esm2020"),Tt("fire-js","")}Yx("");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd="firebasestorage.googleapis.com",Xd="storageBucket",Jx=2*60*1e3,Zx=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae extends Lt{constructor(e,t,n=0){super(uo(e),`Firebase Storage: ${t} (${uo(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ae.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return uo(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Se;(function(r){r.UNKNOWN="unknown",r.OBJECT_NOT_FOUND="object-not-found",r.BUCKET_NOT_FOUND="bucket-not-found",r.PROJECT_NOT_FOUND="project-not-found",r.QUOTA_EXCEEDED="quota-exceeded",r.UNAUTHENTICATED="unauthenticated",r.UNAUTHORIZED="unauthorized",r.UNAUTHORIZED_APP="unauthorized-app",r.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",r.INVALID_CHECKSUM="invalid-checksum",r.CANCELED="canceled",r.INVALID_EVENT_NAME="invalid-event-name",r.INVALID_URL="invalid-url",r.INVALID_DEFAULT_BUCKET="invalid-default-bucket",r.NO_DEFAULT_BUCKET="no-default-bucket",r.CANNOT_SLICE_BLOB="cannot-slice-blob",r.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",r.NO_DOWNLOAD_URL="no-download-url",r.INVALID_ARGUMENT="invalid-argument",r.INVALID_ARGUMENT_COUNT="invalid-argument-count",r.APP_DELETED="app-deleted",r.INVALID_ROOT_OPERATION="invalid-root-operation",r.INVALID_FORMAT="invalid-format",r.INTERNAL_ERROR="internal-error",r.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Se||(Se={}));function uo(r){return"storage/"+r}function cl(){const r="An unknown error occurred, please check the error payload for server response.";return new Ae(Se.UNKNOWN,r)}function e0(r){return new Ae(Se.OBJECT_NOT_FOUND,"Object '"+r+"' does not exist.")}function t0(r){return new Ae(Se.QUOTA_EXCEEDED,"Quota for bucket '"+r+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function s0(){const r="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ae(Se.UNAUTHENTICATED,r)}function r0(){return new Ae(Se.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function n0(r){return new Ae(Se.UNAUTHORIZED,"User does not have permission to access '"+r+"'.")}function i0(){return new Ae(Se.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function a0(){return new Ae(Se.CANCELED,"User canceled the upload/download.")}function o0(r){return new Ae(Se.INVALID_URL,"Invalid URL '"+r+"'.")}function l0(r){return new Ae(Se.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")}function c0(){return new Ae(Se.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Xd+"' property when initializing the app?")}function u0(){return new Ae(Se.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function d0(){return new Ae(Se.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function h0(r){return new Ae(Se.UNSUPPORTED_ENVIRONMENT,`${r} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Do(r){return new Ae(Se.INVALID_ARGUMENT,r)}function Yd(){return new Ae(Se.APP_DELETED,"The Firebase app was deleted.")}function m0(r){return new Ae(Se.INVALID_ROOT_OPERATION,"The operation '"+r+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function _n(r,e){return new Ae(Se.INVALID_FORMAT,"String does not match format '"+r+"': "+e)}function fn(r){throw new Ae(Se.INTERNAL_ERROR,"Internal error: "+r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=ct.makeFromUrl(e,t)}catch{return new ct(e,"")}if(n.path==="")return n;throw l0(e)}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const l="(/(.*))?$",c=new RegExp("^gs://"+i+l,"i"),u={bucket:1,path:3};function h(P){P.path_=decodeURIComponent(P.path)}const p="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",w=new RegExp(`^https?://${g}/${p}/b/${i}/o${y}`,"i"),C={bucket:1,path:3},_=t===Qd?"(?:storage.googleapis.com|storage.cloud.google.com)":t,N="([^?#]*)",R=new RegExp(`^https?://${_}/${i}/${N}`,"i"),D=[{regex:c,indices:u,postModify:a},{regex:w,indices:C,postModify:h},{regex:R,indices:{bucket:1,path:2},postModify:h}];for(let P=0;P<D.length;P++){const B=D[P],L=B.regex.exec(e);if(L){const E=L[B.indices.bucket];let f=L[B.indices.path];f||(f=""),n=new ct(E,f),B.postModify(n);break}}if(n==null)throw o0(e);return n}}class p0{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f0(r,e,t){let n=1,i=null,a=null,l=!1,c=0;function u(){return c===2}let h=!1;function p(...N){h||(h=!0,e.apply(null,N))}function g(N){i=setTimeout(()=>{i=null,r(w,u())},N)}function y(){a&&clearTimeout(a)}function w(N,...R){if(h){y();return}if(N){y(),p.call(null,N,...R);return}if(u()||l){y(),p.call(null,N,...R);return}n<64&&(n*=2);let D;c===1?(c=2,D=0):D=(n+Math.random())*1e3,g(D)}let C=!1;function _(N){C||(C=!0,y(),!h&&(i!==null?(N||(c=2),clearTimeout(i),g(0)):N||(c=1)))}return g(0),a=setTimeout(()=>{l=!0,_(!0)},t),_}function g0(r){r(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x0(r){return r!==void 0}function y0(r){return typeof r=="object"&&!Array.isArray(r)}function ul(r){return typeof r=="string"||r instanceof String}function Yc(r){return dl()&&r instanceof Blob}function dl(){return typeof Blob<"u"}function Jc(r,e,t,n){if(n<e)throw Do(`Invalid value for '${r}'. Expected ${e} or greater.`);if(n>t)throw Do(`Invalid value for '${r}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hl(r,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${r}`}function Jd(r){const e=encodeURIComponent;let t="?";for(const n in r)if(r.hasOwnProperty(n)){const i=e(n)+"="+e(r[n]);t=t+i+"&"}return t=t.slice(0,-1),t}var Qs;(function(r){r[r.NO_ERROR=0]="NO_ERROR",r[r.NETWORK_ERROR=1]="NETWORK_ERROR",r[r.ABORT=2]="ABORT"})(Qs||(Qs={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(r,e){const t=r>=500&&r<600,i=[408,429].indexOf(r)!==-1,a=e.indexOf(r)!==-1;return t||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e,t,n,i,a,l,c,u,h,p,g,y=!0,w=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=c,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=p,this.connectionFactory_=g,this.retry=y,this.isUsingEmulator=w,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,_)=>{this.resolve_=C,this.reject_=_,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new Ti(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const l=c=>{const u=c.loaded,h=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const c=a.getErrorCode()===Qs.NO_ERROR,u=a.getStatus();if(!c||b0(u,this.additionalRetryCodes_)&&this.retry){const p=a.getErrorCode()===Qs.ABORT;n(!1,new Ti(!1,null,p));return}const h=this.successCodes_.indexOf(u)!==-1;n(!0,new Ti(h,a))})},t=(n,i)=>{const a=this.resolve_,l=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(c,c.getResponse());x0(u)?a(u):a()}catch(u){l(u)}else if(c!==null){const u=cl();u.serverResponse=c.getErrorText(),this.errorCallback_?l(this.errorCallback_(c,u)):l(u)}else if(i.canceled){const u=this.appDelete_?Yd():a0();l(u)}else{const u=i0();l(u)}};this.canceled_?t(!1,new Ti(!1,null,!0)):this.backoffId_=f0(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&g0(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ti{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function w0(r,e){e!==null&&e.length>0&&(r.Authorization="Firebase "+e)}function _0(r,e){r["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function j0(r,e){e&&(r["X-Firebase-GMPID"]=e)}function N0(r,e){e!==null&&(r["X-Firebase-AppCheck"]=e)}function E0(r,e,t,n,i,a,l=!0,c=!1){const u=Jd(r.urlParams),h=r.url+u,p=Object.assign({},r.headers);return j0(p,e),w0(p,t),_0(p,a),N0(p,n),new v0(h,r.method,p,r.body,r.successCodes,r.additionalRetryCodes,r.handler,r.errorHandler,r.timeout,r.progressCallback,i,l,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function I0(...r){const e=T0();if(e!==void 0){const t=new e;for(let n=0;n<r.length;n++)t.append(r[n]);return t.getBlob()}else{if(dl())return new Blob(r);throw new Ae(Se.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function S0(r,e,t){return r.webkitSlice?r.webkitSlice(e,t):r.mozSlice?r.mozSlice(e,t):r.slice?r.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(r){if(typeof atob>"u")throw h0("base-64");return atob(r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Et={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class ho{constructor(e,t){this.data=e,this.contentType=t||null}}function C0(r,e){switch(r){case Et.RAW:return new ho(Zd(e));case Et.BASE64:case Et.BASE64URL:return new ho(eh(r,e));case Et.DATA_URL:return new ho(R0(e),P0(e))}throw cl()}function Zd(r){const e=[];for(let t=0;t<r.length;t++){let n=r.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<r.length-1&&(r.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const a=n,l=r.charCodeAt(++t);n=65536|(a&1023)<<10|l&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function k0(r){let e;try{e=decodeURIComponent(r)}catch{throw _n(Et.DATA_URL,"Malformed data URL.")}return Zd(e)}function eh(r,e){switch(r){case Et.BASE64:{const i=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(i||a)throw _n(r,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Et.BASE64URL:{const i=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(i||a)throw _n(r,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=A0(e)}catch(i){throw i.message.includes("polyfill")?i:_n(r,"Invalid character found")}const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}class th{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw _n(Et.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=D0(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function R0(r){const e=new th(r);return e.base64?eh(Et.BASE64,e.rest):k0(e.rest)}function P0(r){return new th(r).contentType}function D0(r,e){return r.length>=e.length?r.substring(r.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e,t){let n=0,i="";Yc(e)?(this.data_=e,n=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(Yc(this.data_)){const n=this.data_,i=S0(n,e,t);return i===null?null:new cs(i)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new cs(n,!0)}}static getBlob(...e){if(dl()){const t=e.map(n=>n instanceof cs?n.data_:n);return new cs(I0.apply(null,t))}else{const t=e.map(l=>ul(l)?C0(Et.RAW,l).data:l.data_);let n=0;t.forEach(l=>{n+=l.byteLength});const i=new Uint8Array(n);let a=0;return t.forEach(l=>{for(let c=0;c<l.length;c++)i[a++]=l[c]}),new cs(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(r){let e;try{e=JSON.parse(r)}catch{return null}return y0(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0(r){if(r.length===0)return null;const e=r.lastIndexOf("/");return e===-1?"":r.slice(0,e)}function L0(r,e){const t=e.split("/").filter(n=>n.length>0).join("/");return r.length===0?t:r+"/"+t}function rh(r){const e=r.lastIndexOf("/",r.length-2);return e===-1?r:r.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(r,e){return e}class tt{constructor(e,t,n,i){this.server=e,this.local=t||e,this.writable=!!n,this.xform=i||V0}}let Ii=null;function M0(r){return!ul(r)||r.length<2?r:rh(r)}function nh(){if(Ii)return Ii;const r=[];r.push(new tt("bucket")),r.push(new tt("generation")),r.push(new tt("metageneration")),r.push(new tt("name","fullPath",!0));function e(a,l){return M0(l)}const t=new tt("name");t.xform=e,r.push(t);function n(a,l){return l!==void 0?Number(l):l}const i=new tt("size");return i.xform=n,r.push(i),r.push(new tt("timeCreated")),r.push(new tt("updated")),r.push(new tt("md5Hash",null,!0)),r.push(new tt("cacheControl",null,!0)),r.push(new tt("contentDisposition",null,!0)),r.push(new tt("contentEncoding",null,!0)),r.push(new tt("contentLanguage",null,!0)),r.push(new tt("contentType",null,!0)),r.push(new tt("metadata","customMetadata",!0)),Ii=r,Ii}function F0(r,e){function t(){const n=r.bucket,i=r.fullPath,a=new ct(n,i);return e._makeStorageReference(a)}Object.defineProperty(r,"ref",{get:t})}function U0(r,e,t){const n={};n.type="file";const i=t.length;for(let a=0;a<i;a++){const l=t[a];n[l.local]=l.xform(n,e[l.server])}return F0(n,r),n}function ih(r,e,t){const n=sh(e);return n===null?null:U0(r,n,t)}function B0(r,e,t,n){const i=sh(e);if(i===null||!ul(i.downloadTokens))return null;const a=i.downloadTokens;if(a.length===0)return null;const l=encodeURIComponent;return a.split(",").map(h=>{const p=r.bucket,g=r.fullPath,y="/b/"+l(p)+"/o/"+l(g),w=hl(y,t,n),C=Jd({alt:"media",token:h});return w+C})[0]}function q0(r,e){const t={},n=e.length;for(let i=0;i<n;i++){const a=e[i];a.writable&&(t[a.server]=r[a.local])}return JSON.stringify(t)}class ah{constructor(e,t,n,i){this.url=e,this.method=t,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oh(r){if(!r)throw cl()}function z0(r,e){function t(n,i){const a=ih(r,i,e);return oh(a!==null),a}return t}function $0(r,e){function t(n,i){const a=ih(r,i,e);return oh(a!==null),B0(a,i,r.host,r._protocol)}return t}function lh(r){function e(t,n){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=r0():i=s0():t.getStatus()===402?i=t0(r.bucket):t.getStatus()===403?i=n0(r.path):i=n,i.status=t.getStatus(),i.serverResponse=n.serverResponse,i}return e}function H0(r){const e=lh(r);function t(n,i){let a=e(n,i);return n.getStatus()===404&&(a=e0(r.path)),a.serverResponse=i.serverResponse,a}return t}function G0(r,e,t){const n=e.fullServerUrl(),i=hl(n,r.host,r._protocol),a="GET",l=r.maxOperationRetryTime,c=new ah(i,a,$0(r,t),l);return c.errorHandler=H0(e),c}function W0(r,e){return r&&r.contentType||e&&e.type()||"application/octet-stream"}function K0(r,e,t){const n=Object.assign({},t);return n.fullPath=r.path,n.size=e.size(),n.contentType||(n.contentType=W0(null,e)),n}function Q0(r,e,t,n,i){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function c(){let D="";for(let P=0;P<2;P++)D=D+Math.random().toString().slice(2);return D}const u=c();l["Content-Type"]="multipart/related; boundary="+u;const h=K0(e,n,i),p=q0(h,t),g="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+u+`\r
Content-Type: `+h.contentType+`\r
\r
`,y=`\r
--`+u+"--",w=cs.getBlob(g,n,y);if(w===null)throw u0();const C={name:h.fullPath},_=hl(a,r.host,r._protocol),N="POST",R=r.maxUploadRetryTime,k=new ah(_,N,z0(r,t),R);return k.urlParams=C,k.headers=l,k.body=w.uploadData(),k.errorHandler=lh(e),k}class X0{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Qs.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Qs.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Qs.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,i,a){if(this.sent_)throw fn("cannot .send() more than once");if(As(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),a!==void 0)for(const l in a)a.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,a[l].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw fn("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw fn("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw fn("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw fn("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Y0 extends X0{initXhr(){this.xhr_.responseType="text"}}function ch(){return new Y0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e,t){this._service=e,t instanceof ct?this._location=t:this._location=ct.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new er(e,t)}get root(){const e=new ct(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return rh(this._location.path)}get storage(){return this._service}get parent(){const e=O0(this._location.path);if(e===null)return null;const t=new ct(this._location.bucket,e);return new er(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw m0(e)}}function J0(r,e,t){r._throwIfRoot("uploadBytes");const n=Q0(r.storage,r._location,nh(),new cs(e,!0),t);return r.storage.makeRequestWithTokens(n,ch).then(i=>({metadata:i,ref:r}))}function Z0(r){r._throwIfRoot("getDownloadURL");const e=G0(r.storage,r._location,nh());return r.storage.makeRequestWithTokens(e,ch).then(t=>{if(t===null)throw d0();return t})}function ey(r,e){const t=L0(r._location.path,e),n=new ct(r._location.bucket,t);return new er(r.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(r){return/^[A-Za-z]+:\/\//.test(r)}function sy(r,e){return new er(r,e)}function uh(r,e){if(r instanceof ml){const t=r;if(t._bucket==null)throw c0();const n=new er(t,t._bucket);return e!=null?uh(n,e):n}else return e!==void 0?ey(r,e):r}function ry(r,e){if(e&&ty(e)){if(r instanceof ml)return sy(r,e);throw Do("To use ref(service, url), the first argument must be a Storage instance.")}else return uh(r,e)}function Zc(r,e){const t=e?.[Xd];return t==null?null:ct.makeFromBucketSpec(t,r)}function ny(r,e,t,n={}){r.host=`${e}:${t}`;const i=As(e);i&&(nl(`https://${r.host}/b`),il("Storage",!0)),r._isUsingEmulator=!0,r._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(r._overrideAuthToken=typeof a=="string"?a:zd(a,r.app.options.projectId))}class ml{constructor(e,t,n,i,a,l=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=l,this._bucket=null,this._host=Qd,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Jx,this._maxUploadRetryTime=Zx,this._requests=new Set,i!=null?this._bucket=ct.makeFromBucketSpec(i,this._host):this._bucket=Zc(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ct.makeFromBucketSpec(this._url,e):this._bucket=Zc(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Jc("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Jc("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(lt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new er(this,e)}_makeRequest(e,t,n,i,a=!0){if(this._deleted)return new p0(Yd());{const l=E0(e,this._appId,n,i,t,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const eu="@firebase/storage",tu="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh="storage";function hh(r,e,t){return r=Ge(r),J0(r,e,t)}function mh(r){return r=Ge(r),Z0(r)}function ph(r,e){return r=Ge(r),ry(r,e)}function iy(r=ll(),e){r=Ge(r);const n=Ta(r,dh).getImmediate({identifier:e}),i=Ud("storage");return i&&ay(n,...i),n}function ay(r,e,t,n={}){ny(r,e,t,n)}function oy(r,{instanceIdentifier:e}){const t=r.getProvider("app").getImmediate(),n=r.getProvider("auth-internal"),i=r.getProvider("app-check-internal");return new ml(t,n,i,e,ir)}function ly(){Zs(new _s(dh,oy,"PUBLIC").setMultipleInstances(!0)),Tt(eu,tu,""),Tt(eu,tu,"esm2020")}ly();var cy="firebase",uy="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tt(cy,uy,"app");function fh(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dy=fh,gh=new Hn("auth","Firebase",fh());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=new al("@firebase/auth");function hy(r,...e){Zi.logLevel<=ue.WARN&&Zi.warn(`Auth (${ir}): ${r}`,...e)}function Vi(r,...e){Zi.logLevel<=ue.ERROR&&Zi.error(`Auth (${ir}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(r,...e){throw pl(r,...e)}function It(r,...e){return pl(r,...e)}function xh(r,e,t){const n={...dy(),[e]:t};return new Hn("auth","Firebase",n).create(e,{appName:r.name})}function Wt(r){return xh(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pl(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return gh.create(r,...e)}function te(r,e,...t){if(!r)throw pl(e,...t)}function $t(r){const e="INTERNAL ASSERTION FAILED: "+r;throw Vi(e),new Error(e)}function Yt(r,e){r||$t(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oo(){return typeof self<"u"&&self.location?.href||""}function my(){return su()==="http:"||su()==="https:"}function su(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(my()||kg()||"connection"in navigator)?navigator.onLine:!0}function fy(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e,t){this.shortDelay=e,this.longDelay=t,Yt(t>e,"Short delay should be less than long delay!"),this.isMobile=Sg()||Rg()}get(){return py()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fl(r,e){Yt(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$t("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$t("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$t("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],yy=new Wn(3e4,6e4);function Cs(r,e){return r.tenantId&&!e.tenantId?{...e,tenantId:r.tenantId}:e}async function ks(r,e,t,n,i={}){return bh(r,i,async()=>{let a={},l={};n&&(e==="GET"?l=n:a={body:JSON.stringify(n)});const c=Gn({key:r.config.apiKey,...l}).slice(1),u=await r._getAdditionalHeaders();u["Content-Type"]="application/json",r.languageCode&&(u["X-Firebase-Locale"]=r.languageCode);const h={method:e,headers:u,...a};return Cg()||(h.referrerPolicy="no-referrer"),r.emulatorConfig&&As(r.emulatorConfig.host)&&(h.credentials="include"),yh.fetch()(await vh(r,r.config.apiHost,t,c),h)})}async function bh(r,e,t){r._canInitEmulator=!1;const n={...gy,...e};try{const i=new vy(r),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Si(r,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const c=a.ok?l.errorMessage:l.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Si(r,"credential-already-in-use",l);if(u==="EMAIL_EXISTS")throw Si(r,"email-already-in-use",l);if(u==="USER_DISABLED")throw Si(r,"user-disabled",l);const p=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw xh(r,p,h);_t(r,p)}}catch(i){if(i instanceof Lt)throw i;_t(r,"network-request-failed",{message:String(i)})}}async function Kn(r,e,t,n,i={}){const a=await ks(r,e,t,n,i);return"mfaPendingCredential"in a&&_t(r,"multi-factor-auth-required",{_serverResponse:a}),a}async function vh(r,e,t,n){const i=`${e}${t}?${n}`,a=r,l=a.config.emulator?fl(r.config,i):`${r.config.apiScheme}://${i}`;return xy.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function by(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class vy{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(It(this.auth,"network-request-failed")),yy.get())})}}function Si(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=It(r,e,n);return i.customData._tokenResponse=t,i}function ru(r){return r!==void 0&&r.enterprise!==void 0}class wy{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return by(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function _y(r,e){return ks(r,"GET","/v2/recaptchaConfig",Cs(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jy(r,e){return ks(r,"POST","/v1/accounts:delete",e)}async function ea(r,e){return ks(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ny(r,e=!1){const t=Ge(r),n=await t.getIdToken(e),i=gl(n);te(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,l=a?.sign_in_provider;return{claims:i,token:n,authTime:jn(mo(i.auth_time)),issuedAtTime:jn(mo(i.iat)),expirationTime:jn(mo(i.exp)),signInProvider:l||null,signInSecondFactor:a?.sign_in_second_factor||null}}function mo(r){return Number(r)*1e3}function gl(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return Vi("JWT malformed, contained fewer than 3 sections"),null;try{const i=Md(t);return i?JSON.parse(i):(Vi("Failed to decode base64 JWT payload"),null)}catch(i){return Vi("Caught error parsing JWT payload as JSON",i?.toString()),null}}function nu(r){const e=gl(r);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dn(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Lt&&Ey(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function Ey({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=jn(this.lastLoginAt),this.creationTime=jn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ta(r){const e=r.auth,t=await r.getIdToken(),n=await Dn(r,ea(e,{idToken:t}));te(n?.users.length,e,"internal-error");const i=n.users[0];r._notifyReloadListener(i);const a=i.providerUserInfo?.length?wh(i.providerUserInfo):[],l=Sy(r.providerData,a),c=r.isAnonymous,u=!(r.email&&i.passwordHash)&&!l?.length,h=c?u:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Lo(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(r,p)}async function Iy(r){const e=Ge(r);await ta(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Sy(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function wh(r){return r.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ay(r,e){const t=await bh(r,{},async()=>{const n=Gn({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=r.config,l=await vh(r,i,"/v1/token",`key=${a}`),c=await r._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return r.emulatorConfig&&As(r.emulatorConfig.host)&&(u.credentials="include"),yh.fetch()(l,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Cy(r,e){return ks(r,"POST","/v2/accounts:revokeToken",Cs(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nu(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){te(e.length!==0,"internal-error");const t=nu(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:a}=await Ay(e,t);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:a}=t,l=new Tr;return n&&(te(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),i&&(te(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),a&&(te(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Tr,this.toJSON())}_performRefresh(){return $t("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(r,e){te(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class vt{constructor({uid:e,auth:t,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new Ty(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Lo(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Dn(this,this.stsTokenManager.getToken(this.auth,e));return te(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Ny(this,e)}reload(){return Iy(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new vt({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ta(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(lt(this.auth.app))return Promise.reject(Wt(this.auth));const e=await this.getIdToken();return await Dn(this,jy(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:g,emailVerified:y,isAnonymous:w,providerData:C,stsTokenManager:_}=t;te(g&&_,e,"internal-error");const N=Tr.fromJSON(this.name,_);te(typeof g=="string",e,"internal-error"),ls(n,e.name),ls(i,e.name),te(typeof y=="boolean",e,"internal-error"),te(typeof w=="boolean",e,"internal-error"),ls(a,e.name),ls(l,e.name),ls(c,e.name),ls(u,e.name),ls(h,e.name),ls(p,e.name);const R=new vt({uid:g,auth:e,email:i,emailVerified:y,displayName:n,isAnonymous:w,photoURL:l,phoneNumber:a,tenantId:c,stsTokenManager:N,createdAt:h,lastLoginAt:p});return C&&Array.isArray(C)&&(R.providerData=C.map(k=>({...k}))),u&&(R._redirectEventId=u),R}static async _fromIdTokenResponse(e,t,n=!1){const i=new Tr;i.updateFromServerResponse(t);const a=new vt({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ta(a),a}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];te(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?wh(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!a?.length,c=new Tr;c.updateFromIdToken(n);const u=new vt({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:l}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Lo(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iu=new Map;function Ht(r){Yt(r instanceof Function,"Expected a class definition");let e=iu.get(r);return e?(Yt(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,iu.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}_h.type="NONE";const au=_h;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(r,e,t){return`firebase:${r}:${e}:${t}`}class Ir{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=Mi(this.userKey,i.apiKey,a),this.fullPersistenceKey=Mi("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ea(this.auth,{idToken:e}).catch(()=>{});return t?vt._fromGetAccountInfoResponse(this.auth,t,e):null}return vt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ir(Ht(au),e,n);const i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let a=i[0]||Ht(au);const l=Mi(n,e.config.apiKey,e.name);let c=null;for(const h of t)try{const p=await h._get(l);if(p){let g;if(typeof p=="string"){const y=await ea(e,{idToken:p}).catch(()=>{});if(!y)break;g=await vt._fromGetAccountInfoResponse(e,y,p)}else g=vt._fromJSON(e,p);h!==a&&(c=g),a=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new Ir(a,e,n):(a=u[0],c&&await a._set(l,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==a)try{await h._remove(l)}catch{}})),new Ir(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Th(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(jh(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Sh(e))return"Blackberry";if(Ah(e))return"Webos";if(Nh(e))return"Safari";if((e.includes("chrome/")||Eh(e))&&!e.includes("edge/"))return"Chrome";if(Ih(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if(n?.length===2)return n[1]}return"Other"}function jh(r=et()){return/firefox\//i.test(r)}function Nh(r=et()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Eh(r=et()){return/crios\//i.test(r)}function Th(r=et()){return/iemobile/i.test(r)}function Ih(r=et()){return/android/i.test(r)}function Sh(r=et()){return/blackberry/i.test(r)}function Ah(r=et()){return/webos/i.test(r)}function xl(r=et()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function ky(r=et()){return xl(r)&&!!window.navigator?.standalone}function Ry(){return Pg()&&document.documentMode===10}function Ch(r=et()){return xl(r)||Ih(r)||Ah(r)||Sh(r)||/windows phone/i.test(r)||Th(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(r,e=[]){let t;switch(r){case"Browser":t=ou(et());break;case"Worker":t=`${ou(et())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ir}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=a=>new Promise((l,c)=>{try{const u=e(a);l(u)}catch(u){c(u)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dy(r,e={}){return ks(r,"GET","/v2/passwordPolicy",Cs(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy=6;class Ly{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Oy,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lu(this),this.idTokenSubscription=new lu(this),this.beforeStateQueue=new Py(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gh,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ht(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ir.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ea(this,{idToken:e}),n=await vt._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(lt(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,l=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===l)&&c?.user&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ta(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fy()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(lt(this.app))return Promise.reject(Wt(this));const t=e?Ge(e):null;return t&&te(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return lt(this.app)?Promise.reject(Wt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return lt(this.app)?Promise.reject(Wt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ht(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Dy(this),t=new Ly(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Hn("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await Cy(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ht(e)||this._popupRedirectResolver;te(t,this,"argument-error"),this.redirectPersistenceManager=await Ir.create(this,[Ht(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(c,this,"internal-error"),c.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,n,i);return()=>{l=!0,u()}}else{const u=e.addObserver(t);return()=>{l=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kh(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(lt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&hy(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ar(r){return Ge(r)}class lu{constructor(e){this.auth=e,this.observer=null,this.addObserver=Bg(t=>this.observer=t)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ia={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function My(r){Ia=r}function Rh(r){return Ia.loadJS(r)}function Fy(){return Ia.recaptchaEnterpriseScript}function Uy(){return Ia.gapiScript}function By(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class qy{constructor(){this.enterprise=new zy}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class zy{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const $y="recaptcha-enterprise",Ph="NO_RECAPTCHA";class Hy{constructor(e){this.type=$y,this.auth=ar(e)}async verify(e="verify",t=!1){async function n(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,c)=>{_y(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const h=new wy(u);return a.tenantId==null?a._agentRecaptchaConfig=h:a._tenantRecaptchaConfigs[a.tenantId]=h,l(h.siteKey)}}).catch(u=>{c(u)})})}function i(a,l,c){const u=window.grecaptcha;ru(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(h=>{l(h)}).catch(()=>{l(Ph)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new qy().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{n(this.auth).then(c=>{if(!t&&ru(window.grecaptcha))i(c,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let u=Fy();u.length!==0&&(u+=c),Rh(u).then(()=>{i(c,a,l)}).catch(h=>{l(h)})}}).catch(c=>{l(c)})})}}async function cu(r,e,t,n=!1,i=!1){const a=new Hy(r);let l;if(i)l=Ph;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Vo(r,e,t,n,i){if(r._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await cu(r,e,t,t==="getOobCode");return n(r,a)}else return n(r,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await cu(r,e,t,t==="getOobCode");return n(r,l)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(r,e){const t=Ta(r,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(Js(a,e??{}))return i;_t(i,"already-initialized")}return t.initialize({options:e})}function Wy(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(Ht);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}function Ky(r,e,t){const n=ar(r);te(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=Dh(e),{host:l,port:c}=Qy(e),u=c===null?"":`:${c}`,h={url:`${a}//${l}${u}/`},p=Object.freeze({host:l,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){te(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),te(Js(h,n.config.emulator)&&Js(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,As(l)?(nl(`${a}//${l}${u}`),il("Auth",!0)):Xy()}function Dh(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function Qy(r){const e=Dh(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:uu(n.substr(a.length+1))}}else{const[a,l]=n.split(":");return{host:a,port:uu(l)}}}function uu(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function Xy(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return $t("not implemented")}_getIdTokenResponse(e){return $t("not implemented")}_linkToIdToken(e,t){return $t("not implemented")}_getReauthenticationResolver(e){return $t("not implemented")}}async function Yy(r,e){return ks(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jy(r,e){return Kn(r,"POST","/v1/accounts:signInWithPassword",Cs(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zy(r,e){return Kn(r,"POST","/v1/accounts:signInWithEmailLink",Cs(r,e))}async function eb(r,e){return Kn(r,"POST","/v1/accounts:signInWithEmailLink",Cs(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On extends yl{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new On(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new On(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vo(e,t,"signInWithPassword",Jy);case"emailLink":return Zy(e,{email:this._email,oobCode:this._password});default:_t(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vo(e,n,"signUpPassword",Yy);case"emailLink":return eb(e,{idToken:t,email:this._email,oobCode:this._password});default:_t(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sr(r,e){return Kn(r,"POST","/v1/accounts:signInWithIdp",Cs(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="http://localhost";class tr extends yl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new tr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_t("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...a}=t;if(!n||!i)return null;const l=new tr(n,i);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Sr(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Sr(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Sr(e,t)}buildRequest(){const e={requestUri:tb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Gn(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function rb(r){const e=gn(xn(r)).link,t=e?gn(xn(e)).deep_link_id:null,n=gn(xn(r)).deep_link_id;return(n?gn(xn(n)).link:null)||n||t||e||r}class bl{constructor(e){const t=gn(xn(e)),n=t.apiKey??null,i=t.oobCode??null,a=sb(t.mode??null);te(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=rb(e);try{return new bl(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(){this.providerId=qr.PROVIDER_ID}static credential(e,t){return On._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=bl.parseLink(t);return te(n,"argument-error"),On._fromEmailAndCode(e,n.code,n.tenantId)}}qr.PROVIDER_ID="password";qr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";qr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn extends Oh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us extends Qn{constructor(){super("facebook.com")}static credential(e){return tr._fromParams({providerId:us.PROVIDER_ID,signInMethod:us.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return us.credentialFromTaggedObject(e)}static credentialFromError(e){return us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return us.credential(e.oauthAccessToken)}catch{return null}}}us.FACEBOOK_SIGN_IN_METHOD="facebook.com";us.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds extends Qn{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return tr._fromParams({providerId:ds.PROVIDER_ID,signInMethod:ds.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ds.credentialFromTaggedObject(e)}static credentialFromError(e){return ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return ds.credential(t,n)}catch{return null}}}ds.GOOGLE_SIGN_IN_METHOD="google.com";ds.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs extends Qn{constructor(){super("github.com")}static credential(e){return tr._fromParams({providerId:hs.PROVIDER_ID,signInMethod:hs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hs.credentialFromTaggedObject(e)}static credentialFromError(e){return hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hs.credential(e.oauthAccessToken)}catch{return null}}}hs.GITHUB_SIGN_IN_METHOD="github.com";hs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms extends Qn{constructor(){super("twitter.com")}static credential(e,t){return tr._fromParams({providerId:ms.PROVIDER_ID,signInMethod:ms.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ms.credentialFromTaggedObject(e)}static credentialFromError(e){return ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return ms.credential(t,n)}catch{return null}}}ms.TWITTER_SIGN_IN_METHOD="twitter.com";ms.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nb(r,e){return Kn(r,"POST","/v1/accounts:signUp",Cs(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const a=await vt._fromIdTokenResponse(e,n,i),l=du(n);return new sr({user:a,providerId:l,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=du(n);return new sr({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function du(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa extends Lt{constructor(e,t,n,i){super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,sa.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new sa(e,t,n,i)}}function Lh(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?sa._fromErrorAndOperation(r,a,e,n):a})}async function ib(r,e,t=!1){const n=await Dn(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return sr._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ab(r,e,t=!1){const{auth:n}=r;if(lt(n.app))return Promise.reject(Wt(n));const i="reauthenticate";try{const a=await Dn(r,Lh(n,i,e,r),t);te(a.idToken,n,"internal-error");const l=gl(a.idToken);te(l,n,"internal-error");const{sub:c}=l;return te(r.uid===c,n,"user-mismatch"),sr._forOperation(r,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&_t(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vh(r,e,t=!1){if(lt(r.app))return Promise.reject(Wt(r));const n="signIn",i=await Lh(r,n,e),a=await sr._fromIdTokenResponse(r,n,i);return t||await r._updateCurrentUser(a.user),a}async function ob(r,e){return Vh(ar(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mh(r){const e=ar(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function lb(r,e,t){if(lt(r.app))return Promise.reject(Wt(r));const n=ar(r),l=await Vo(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",nb).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Mh(r),u}),c=await sr._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(c.user),c}function cb(r,e,t){return lt(r.app)?Promise.reject(Wt(r)):ob(Ge(r),qr.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&Mh(r),n})}function ub(r,e,t,n){return Ge(r).onIdTokenChanged(e,t,n)}function db(r,e,t){return Ge(r).beforeAuthStateChanged(e,t)}function hb(r){return Ge(r).signOut()}const ra="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ra,"1"),this.storage.removeItem(ra),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb=1e3,pb=10;class Uh extends Fh{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ch(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,u)=>{this.notifyListeners(l,u)});return}const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(n);!t&&this.localCache[n]===l||this.notifyListeners(n,l)},a=this.storage.getItem(n);Ry()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,pb):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},mb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Uh.type="LOCAL";const fb=Uh;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh extends Fh{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Bh.type="SESSION";const qh=Bh;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gb(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const n=new Sa(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:a}=t.data,l=this.handlersMap[i];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(l).map(async h=>h(t.origin,a)),u=await gb(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Sa.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vl(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,l;return new Promise((c,u)=>{const h=vl("",20);i.port1.start();const p=setTimeout(()=>{u(new Error("unsupported_event"))},n);l={messageChannel:i,onMessage(g){const y=g;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(p),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(y.data.response);break;default:clearTimeout(p),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(){return window}function yb(r){St().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zh(){return typeof St().WorkerGlobalScope<"u"&&typeof St().importScripts=="function"}async function bb(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vb(){return navigator?.serviceWorker?.controller||null}function wb(){return zh()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h="firebaseLocalStorageDb",_b=1,na="firebaseLocalStorage",Hh="fbase_key";class Xn{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Aa(r,e){return r.transaction([na],e?"readwrite":"readonly").objectStore(na)}function jb(){const r=indexedDB.deleteDatabase($h);return new Xn(r).toPromise()}function Mo(){const r=indexedDB.open($h,_b);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(na,{keyPath:Hh})}catch(i){t(i)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(na)?e(n):(n.close(),await jb(),e(await Mo()))})})}async function hu(r,e,t){const n=Aa(r,!0).put({[Hh]:e,value:t});return new Xn(n).toPromise()}async function Nb(r,e){const t=Aa(r,!1).get(e),n=await new Xn(t).toPromise();return n===void 0?null:n.value}function mu(r,e){const t=Aa(r,!0).delete(e);return new Xn(t).toPromise()}const Eb=800,Tb=3;class Gh{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Mo(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>Tb)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zh()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Sa._getInstance(wb()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await bb(),!this.activeServiceWorker)return;this.sender=new xb(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mo();return await hu(e,ra,"1"),await mu(e,ra),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>hu(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>Nb(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>mu(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Aa(i,!1).getAll();return new Xn(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Eb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Gh.type="LOCAL";const Ib=Gh;new Wn(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sb(r,e){return e?Ht(e):(te(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl extends yl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Sr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Sr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Sr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ab(r){return Vh(r.auth,new wl(r),r.bypassAuthState)}function Cb(r){const{auth:e,user:t}=r;return te(t,e,"internal-error"),ab(t,new wl(r),r.bypassAuthState)}async function kb(r){const{auth:e,user:t}=r;return te(t,e,"internal-error"),ib(t,new wl(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,t,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:a,error:l,type:c}=e;if(l){this.reject(l);return}const u={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ab;case"linkViaPopup":case"linkViaRedirect":return kb;case"reauthViaPopup":case"reauthViaRedirect":return Cb;default:_t(this.auth,"internal-error")}}resolve(e){Yt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb=new Wn(2e3,1e4);class Nr extends Wh{constructor(e,t,n,i,a){super(e,t,i,a),this.provider=n,this.authWindow=null,this.pollId=null,Nr.currentPopupAction&&Nr.currentPopupAction.cancel(),Nr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return te(e,this.auth,"internal-error"),e}async onExecution(){Yt(this.filter.length===1,"Popup operations only handle one event");const e=vl();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(It(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(It(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Nr.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(It(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Rb.get())};e()}}Nr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pb="pendingRedirect",Fi=new Map;class Db extends Wh{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Fi.get(this.auth._key());if(!e){try{const n=await Ob(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Fi.set(this.auth._key(),e)}return this.bypassAuthState||Fi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Ob(r,e){const t=Mb(e),n=Vb(r);if(!await n._isAvailable())return!1;const i=await n._get(t)==="true";return await n._remove(t),i}function Lb(r,e){Fi.set(r._key(),e)}function Vb(r){return Ht(r._redirectPersistence)}function Mb(r){return Mi(Pb,r.config.apiKey,r.name)}async function Fb(r,e,t=!1){if(lt(r.app))return Promise.reject(Wt(r));const n=ar(r),i=Sb(n,e),l=await new Db(n,i,t).execute();return l&&!t&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub=10*60*1e3;class Bb{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qb(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Kh(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(It(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ub&&this.cachedEventUids.clear(),this.cachedEventUids.has(pu(e))}saveEventToCache(e){this.cachedEventUids.add(pu(e)),this.lastProcessedEventTime=Date.now()}}function pu(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function Kh({type:r,error:e}){return r==="unknown"&&e?.code==="auth/no-auth-event"}function qb(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Kh(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zb(r,e={}){return ks(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Hb=/^https?/;async function Gb(r){if(r.config.emulator)return;const{authorizedDomains:e}=await zb(r);for(const t of e)try{if(Wb(t))return}catch{}_t(r,"unauthorized-domain")}function Wb(r){const e=Oo(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const l=new URL(r);return l.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===n}if(!Hb.test(t))return!1;if($b.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb=new Wn(3e4,6e4);function fu(){const r=St().___jsl;if(r?.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function Qb(r){return new Promise((e,t)=>{function n(){fu(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fu(),t(It(r,"network-request-failed"))},timeout:Kb.get()})}if(St().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(St().gapi?.load)n();else{const i=By("iframefcb");return St()[i]=()=>{gapi.load?n():t(It(r,"network-request-failed"))},Rh(`${Uy()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw Ui=null,e})}let Ui=null;function Xb(r){return Ui=Ui||Qb(r),Ui}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb=new Wn(5e3,15e3),Jb="__/auth/iframe",Zb="emulator/auth/iframe",ev={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tv=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sv(r){const e=r.config;te(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?fl(e,Zb):`https://${r.config.authDomain}/${Jb}`,n={apiKey:e.apiKey,appName:r.name,v:ir},i=tv.get(r.config.apiHost);i&&(n.eid=i);const a=r._getFrameworks();return a.length&&(n.fw=a.join(",")),`${t}?${Gn(n).slice(1)}`}async function rv(r){const e=await Xb(r),t=St().gapi;return te(t,r,"internal-error"),e.open({where:document.body,url:sv(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ev,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const l=It(r,"network-request-failed"),c=St().setTimeout(()=>{a(l)},Yb.get());function u(){St().clearTimeout(c),i(n)}n.ping(u).then(u,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nv={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},iv=500,av=600,ov="_blank",lv="http://localhost";class gu{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function cv(r,e,t,n=iv,i=av){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...nv,width:n.toString(),height:i.toString(),top:a,left:l},h=et().toLowerCase();t&&(c=Eh(h)?ov:t),jh(h)&&(e=e||lv,u.scrollbars="yes");const p=Object.entries(u).reduce((y,[w,C])=>`${y}${w}=${C},`,"");if(ky(h)&&c!=="_self")return uv(e||"",c),new gu(null);const g=window.open(e||"",c,p);te(g,r,"popup-blocked");try{g.focus()}catch{}return new gu(g)}function uv(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv="__/auth/handler",hv="emulator/auth/handler",mv=encodeURIComponent("fac");async function xu(r,e,t,n,i,a){te(r.config.authDomain,r,"auth-domain-config-required"),te(r.config.apiKey,r,"invalid-api-key");const l={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:ir,eventId:i};if(e instanceof Oh){e.setDefaultLanguage(r.languageCode),l.providerId=e.providerId||"",Ug(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,g]of Object.entries({}))l[p]=g}if(e instanceof Qn){const p=e.getScopes().filter(g=>g!=="");p.length>0&&(l.scopes=p.join(","))}r.tenantId&&(l.tid=r.tenantId);const c=l;for(const p of Object.keys(c))c[p]===void 0&&delete c[p];const u=await r._getAppCheckToken(),h=u?`#${mv}=${encodeURIComponent(u)}`:"";return`${pv(r)}?${Gn(c).slice(1)}${h}`}function pv({config:r}){return r.emulator?fl(r,hv):`https://${r.authDomain}/${dv}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po="webStorageSupport";class fv{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qh,this._completeRedirectFn=Fb,this._overrideRedirectResult=Lb}async _openPopup(e,t,n,i){Yt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await xu(e,t,n,Oo(),i);return cv(e,a,vl())}async _openRedirect(e,t,n,i){await this._originValidation(e);const a=await xu(e,t,n,Oo(),i);return yb(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Yt(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await rv(e),n=new Bb(e);return t.register("authEvent",i=>(te(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(po,{type:po},i=>{const a=i?.[0]?.[po];a!==void 0&&t(!!a),_t(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Gb(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ch()||Nh()||xl()}}const gv=fv;var yu="@firebase/auth",bu="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bv(r){Zs(new _s("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=n.options;te(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:l,authDomain:c,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kh(r)},h=new Vy(n,i,a,u);return Wy(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Zs(new _s("auth-internal",e=>{const t=ar(e.getProvider("auth").getImmediate());return(n=>new xv(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Tt(yu,bu,yv(r)),Tt(yu,bu,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vv=5*60,wv=qd("authIdTokenMaxAge")||vv;let vu=null;const _v=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>wv)return;const i=t?.token;vu!==i&&(vu=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function jv(r=ll()){const e=Ta(r,"auth");if(e.isInitialized())return e.getImmediate();const t=Gy(r,{popupRedirectResolver:gv,persistence:[Ib,fb,qh]}),n=qd("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const l=_v(a.toString());db(t,l,()=>l(t.currentUser)),ub(t,c=>l(c))}}const i=Fd("auth");return i&&Ky(t,`http://${i}`),t}function Nv(){return document.getElementsByTagName("head")?.[0]??document}My({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const a=It("internal-error");a.customData=i,t(a)},n.type="text/javascript",n.charset="UTF-8",Nv().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bv("Browser");var wu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bs,Qh;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,f){function v(){}v.prototype=f.prototype,E.D=f.prototype,E.prototype=new v,E.prototype.constructor=E,E.C=function(T,A,j){for(var b=Array(arguments.length-2),M=2;M<arguments.length;M++)b[M-2]=arguments[M];return f.prototype[A].apply(T,b)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,f,v){v||(v=0);var T=Array(16);if(typeof f=="string")for(var A=0;16>A;++A)T[A]=f.charCodeAt(v++)|f.charCodeAt(v++)<<8|f.charCodeAt(v++)<<16|f.charCodeAt(v++)<<24;else for(A=0;16>A;++A)T[A]=f[v++]|f[v++]<<8|f[v++]<<16|f[v++]<<24;f=E.g[0],v=E.g[1],A=E.g[2];var j=E.g[3],b=f+(j^v&(A^j))+T[0]+3614090360&4294967295;f=v+(b<<7&4294967295|b>>>25),b=j+(A^f&(v^A))+T[1]+3905402710&4294967295,j=f+(b<<12&4294967295|b>>>20),b=A+(v^j&(f^v))+T[2]+606105819&4294967295,A=j+(b<<17&4294967295|b>>>15),b=v+(f^A&(j^f))+T[3]+3250441966&4294967295,v=A+(b<<22&4294967295|b>>>10),b=f+(j^v&(A^j))+T[4]+4118548399&4294967295,f=v+(b<<7&4294967295|b>>>25),b=j+(A^f&(v^A))+T[5]+1200080426&4294967295,j=f+(b<<12&4294967295|b>>>20),b=A+(v^j&(f^v))+T[6]+2821735955&4294967295,A=j+(b<<17&4294967295|b>>>15),b=v+(f^A&(j^f))+T[7]+4249261313&4294967295,v=A+(b<<22&4294967295|b>>>10),b=f+(j^v&(A^j))+T[8]+1770035416&4294967295,f=v+(b<<7&4294967295|b>>>25),b=j+(A^f&(v^A))+T[9]+2336552879&4294967295,j=f+(b<<12&4294967295|b>>>20),b=A+(v^j&(f^v))+T[10]+4294925233&4294967295,A=j+(b<<17&4294967295|b>>>15),b=v+(f^A&(j^f))+T[11]+2304563134&4294967295,v=A+(b<<22&4294967295|b>>>10),b=f+(j^v&(A^j))+T[12]+1804603682&4294967295,f=v+(b<<7&4294967295|b>>>25),b=j+(A^f&(v^A))+T[13]+4254626195&4294967295,j=f+(b<<12&4294967295|b>>>20),b=A+(v^j&(f^v))+T[14]+2792965006&4294967295,A=j+(b<<17&4294967295|b>>>15),b=v+(f^A&(j^f))+T[15]+1236535329&4294967295,v=A+(b<<22&4294967295|b>>>10),b=f+(A^j&(v^A))+T[1]+4129170786&4294967295,f=v+(b<<5&4294967295|b>>>27),b=j+(v^A&(f^v))+T[6]+3225465664&4294967295,j=f+(b<<9&4294967295|b>>>23),b=A+(f^v&(j^f))+T[11]+643717713&4294967295,A=j+(b<<14&4294967295|b>>>18),b=v+(j^f&(A^j))+T[0]+3921069994&4294967295,v=A+(b<<20&4294967295|b>>>12),b=f+(A^j&(v^A))+T[5]+3593408605&4294967295,f=v+(b<<5&4294967295|b>>>27),b=j+(v^A&(f^v))+T[10]+38016083&4294967295,j=f+(b<<9&4294967295|b>>>23),b=A+(f^v&(j^f))+T[15]+3634488961&4294967295,A=j+(b<<14&4294967295|b>>>18),b=v+(j^f&(A^j))+T[4]+3889429448&4294967295,v=A+(b<<20&4294967295|b>>>12),b=f+(A^j&(v^A))+T[9]+568446438&4294967295,f=v+(b<<5&4294967295|b>>>27),b=j+(v^A&(f^v))+T[14]+3275163606&4294967295,j=f+(b<<9&4294967295|b>>>23),b=A+(f^v&(j^f))+T[3]+4107603335&4294967295,A=j+(b<<14&4294967295|b>>>18),b=v+(j^f&(A^j))+T[8]+1163531501&4294967295,v=A+(b<<20&4294967295|b>>>12),b=f+(A^j&(v^A))+T[13]+2850285829&4294967295,f=v+(b<<5&4294967295|b>>>27),b=j+(v^A&(f^v))+T[2]+4243563512&4294967295,j=f+(b<<9&4294967295|b>>>23),b=A+(f^v&(j^f))+T[7]+1735328473&4294967295,A=j+(b<<14&4294967295|b>>>18),b=v+(j^f&(A^j))+T[12]+2368359562&4294967295,v=A+(b<<20&4294967295|b>>>12),b=f+(v^A^j)+T[5]+4294588738&4294967295,f=v+(b<<4&4294967295|b>>>28),b=j+(f^v^A)+T[8]+2272392833&4294967295,j=f+(b<<11&4294967295|b>>>21),b=A+(j^f^v)+T[11]+1839030562&4294967295,A=j+(b<<16&4294967295|b>>>16),b=v+(A^j^f)+T[14]+4259657740&4294967295,v=A+(b<<23&4294967295|b>>>9),b=f+(v^A^j)+T[1]+2763975236&4294967295,f=v+(b<<4&4294967295|b>>>28),b=j+(f^v^A)+T[4]+1272893353&4294967295,j=f+(b<<11&4294967295|b>>>21),b=A+(j^f^v)+T[7]+4139469664&4294967295,A=j+(b<<16&4294967295|b>>>16),b=v+(A^j^f)+T[10]+3200236656&4294967295,v=A+(b<<23&4294967295|b>>>9),b=f+(v^A^j)+T[13]+681279174&4294967295,f=v+(b<<4&4294967295|b>>>28),b=j+(f^v^A)+T[0]+3936430074&4294967295,j=f+(b<<11&4294967295|b>>>21),b=A+(j^f^v)+T[3]+3572445317&4294967295,A=j+(b<<16&4294967295|b>>>16),b=v+(A^j^f)+T[6]+76029189&4294967295,v=A+(b<<23&4294967295|b>>>9),b=f+(v^A^j)+T[9]+3654602809&4294967295,f=v+(b<<4&4294967295|b>>>28),b=j+(f^v^A)+T[12]+3873151461&4294967295,j=f+(b<<11&4294967295|b>>>21),b=A+(j^f^v)+T[15]+530742520&4294967295,A=j+(b<<16&4294967295|b>>>16),b=v+(A^j^f)+T[2]+3299628645&4294967295,v=A+(b<<23&4294967295|b>>>9),b=f+(A^(v|~j))+T[0]+4096336452&4294967295,f=v+(b<<6&4294967295|b>>>26),b=j+(v^(f|~A))+T[7]+1126891415&4294967295,j=f+(b<<10&4294967295|b>>>22),b=A+(f^(j|~v))+T[14]+2878612391&4294967295,A=j+(b<<15&4294967295|b>>>17),b=v+(j^(A|~f))+T[5]+4237533241&4294967295,v=A+(b<<21&4294967295|b>>>11),b=f+(A^(v|~j))+T[12]+1700485571&4294967295,f=v+(b<<6&4294967295|b>>>26),b=j+(v^(f|~A))+T[3]+2399980690&4294967295,j=f+(b<<10&4294967295|b>>>22),b=A+(f^(j|~v))+T[10]+4293915773&4294967295,A=j+(b<<15&4294967295|b>>>17),b=v+(j^(A|~f))+T[1]+2240044497&4294967295,v=A+(b<<21&4294967295|b>>>11),b=f+(A^(v|~j))+T[8]+1873313359&4294967295,f=v+(b<<6&4294967295|b>>>26),b=j+(v^(f|~A))+T[15]+4264355552&4294967295,j=f+(b<<10&4294967295|b>>>22),b=A+(f^(j|~v))+T[6]+2734768916&4294967295,A=j+(b<<15&4294967295|b>>>17),b=v+(j^(A|~f))+T[13]+1309151649&4294967295,v=A+(b<<21&4294967295|b>>>11),b=f+(A^(v|~j))+T[4]+4149444226&4294967295,f=v+(b<<6&4294967295|b>>>26),b=j+(v^(f|~A))+T[11]+3174756917&4294967295,j=f+(b<<10&4294967295|b>>>22),b=A+(f^(j|~v))+T[2]+718787259&4294967295,A=j+(b<<15&4294967295|b>>>17),b=v+(j^(A|~f))+T[9]+3951481745&4294967295,E.g[0]=E.g[0]+f&4294967295,E.g[1]=E.g[1]+(A+(b<<21&4294967295|b>>>11))&4294967295,E.g[2]=E.g[2]+A&4294967295,E.g[3]=E.g[3]+j&4294967295}n.prototype.u=function(E,f){f===void 0&&(f=E.length);for(var v=f-this.blockSize,T=this.B,A=this.h,j=0;j<f;){if(A==0)for(;j<=v;)i(this,E,j),j+=this.blockSize;if(typeof E=="string"){for(;j<f;)if(T[A++]=E.charCodeAt(j++),A==this.blockSize){i(this,T),A=0;break}}else for(;j<f;)if(T[A++]=E[j++],A==this.blockSize){i(this,T),A=0;break}}this.h=A,this.o+=f},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var f=1;f<E.length-8;++f)E[f]=0;var v=8*this.o;for(f=E.length-8;f<E.length;++f)E[f]=v&255,v/=256;for(this.u(E),E=Array(16),f=v=0;4>f;++f)for(var T=0;32>T;T+=8)E[v++]=this.g[f]>>>T&255;return E};function a(E,f){var v=c;return Object.prototype.hasOwnProperty.call(v,E)?v[E]:v[E]=f(E)}function l(E,f){this.h=f;for(var v=[],T=!0,A=E.length-1;0<=A;A--){var j=E[A]|0;T&&j==f||(v[A]=j,T=!1)}this.g=v}var c={};function u(E){return-128<=E&&128>E?a(E,function(f){return new l([f|0],0>f?-1:0)}):new l([E|0],0>E?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return g;if(0>E)return N(h(-E));for(var f=[],v=1,T=0;E>=v;T++)f[T]=E/v|0,v*=4294967296;return new l(f,0)}function p(E,f){if(E.length==0)throw Error("number format error: empty string");if(f=f||10,2>f||36<f)throw Error("radix out of range: "+f);if(E.charAt(0)=="-")return N(p(E.substring(1),f));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=h(Math.pow(f,8)),T=g,A=0;A<E.length;A+=8){var j=Math.min(8,E.length-A),b=parseInt(E.substring(A,A+j),f);8>j?(j=h(Math.pow(f,j)),T=T.j(j).add(h(b))):(T=T.j(v),T=T.add(h(b)))}return T}var g=u(0),y=u(1),w=u(16777216);r=l.prototype,r.m=function(){if(_(this))return-N(this).m();for(var E=0,f=1,v=0;v<this.g.length;v++){var T=this.i(v);E+=(0<=T?T:4294967296+T)*f,f*=4294967296}return E},r.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(C(this))return"0";if(_(this))return"-"+N(this).toString(E);for(var f=h(Math.pow(E,6)),v=this,T="";;){var A=P(v,f).g;v=R(v,A.j(f));var j=((0<v.g.length?v.g[0]:v.h)>>>0).toString(E);if(v=A,C(v))return j+T;for(;6>j.length;)j="0"+j;T=j+T}},r.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function C(E){if(E.h!=0)return!1;for(var f=0;f<E.g.length;f++)if(E.g[f]!=0)return!1;return!0}function _(E){return E.h==-1}r.l=function(E){return E=R(this,E),_(E)?-1:C(E)?0:1};function N(E){for(var f=E.g.length,v=[],T=0;T<f;T++)v[T]=~E.g[T];return new l(v,~E.h).add(y)}r.abs=function(){return _(this)?N(this):this},r.add=function(E){for(var f=Math.max(this.g.length,E.g.length),v=[],T=0,A=0;A<=f;A++){var j=T+(this.i(A)&65535)+(E.i(A)&65535),b=(j>>>16)+(this.i(A)>>>16)+(E.i(A)>>>16);T=b>>>16,j&=65535,b&=65535,v[A]=b<<16|j}return new l(v,v[v.length-1]&-2147483648?-1:0)};function R(E,f){return E.add(N(f))}r.j=function(E){if(C(this)||C(E))return g;if(_(this))return _(E)?N(this).j(N(E)):N(N(this).j(E));if(_(E))return N(this.j(N(E)));if(0>this.l(w)&&0>E.l(w))return h(this.m()*E.m());for(var f=this.g.length+E.g.length,v=[],T=0;T<2*f;T++)v[T]=0;for(T=0;T<this.g.length;T++)for(var A=0;A<E.g.length;A++){var j=this.i(T)>>>16,b=this.i(T)&65535,M=E.i(A)>>>16,Q=E.i(A)&65535;v[2*T+2*A]+=b*Q,k(v,2*T+2*A),v[2*T+2*A+1]+=j*Q,k(v,2*T+2*A+1),v[2*T+2*A+1]+=b*M,k(v,2*T+2*A+1),v[2*T+2*A+2]+=j*M,k(v,2*T+2*A+2)}for(T=0;T<f;T++)v[T]=v[2*T+1]<<16|v[2*T];for(T=f;T<2*f;T++)v[T]=0;return new l(v,0)};function k(E,f){for(;(E[f]&65535)!=E[f];)E[f+1]+=E[f]>>>16,E[f]&=65535,f++}function D(E,f){this.g=E,this.h=f}function P(E,f){if(C(f))throw Error("division by zero");if(C(E))return new D(g,g);if(_(E))return f=P(N(E),f),new D(N(f.g),N(f.h));if(_(f))return f=P(E,N(f)),new D(N(f.g),f.h);if(30<E.g.length){if(_(E)||_(f))throw Error("slowDivide_ only works with positive integers.");for(var v=y,T=f;0>=T.l(E);)v=B(v),T=B(T);var A=L(v,1),j=L(T,1);for(T=L(T,2),v=L(v,2);!C(T);){var b=j.add(T);0>=b.l(E)&&(A=A.add(v),j=b),T=L(T,1),v=L(v,1)}return f=R(E,A.j(f)),new D(A,f)}for(A=g;0<=E.l(f);){for(v=Math.max(1,Math.floor(E.m()/f.m())),T=Math.ceil(Math.log(v)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),j=h(v),b=j.j(f);_(b)||0<b.l(E);)v-=T,j=h(v),b=j.j(f);C(j)&&(j=y),A=A.add(j),E=R(E,b)}return new D(A,E)}r.A=function(E){return P(this,E).h},r.and=function(E){for(var f=Math.max(this.g.length,E.g.length),v=[],T=0;T<f;T++)v[T]=this.i(T)&E.i(T);return new l(v,this.h&E.h)},r.or=function(E){for(var f=Math.max(this.g.length,E.g.length),v=[],T=0;T<f;T++)v[T]=this.i(T)|E.i(T);return new l(v,this.h|E.h)},r.xor=function(E){for(var f=Math.max(this.g.length,E.g.length),v=[],T=0;T<f;T++)v[T]=this.i(T)^E.i(T);return new l(v,this.h^E.h)};function B(E){for(var f=E.g.length+1,v=[],T=0;T<f;T++)v[T]=E.i(T)<<1|E.i(T-1)>>>31;return new l(v,E.h)}function L(E,f){var v=f>>5;f%=32;for(var T=E.g.length-v,A=[],j=0;j<T;j++)A[j]=0<f?E.i(j+v)>>>f|E.i(j+v+1)<<32-f:E.i(j+v);return new l(A,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Qh=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=h,l.fromString=p,bs=l}).apply(typeof wu<"u"?wu:typeof self<"u"?self:typeof window<"u"?window:{});var Ai=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xh,yn,Yh,Bi,Fo,Jh,Zh,em;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,d,m){return o==Array.prototype||o==Object.prototype||(o[d]=m.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ai=="object"&&Ai];for(var d=0;d<o.length;++d){var m=o[d];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var n=t(this);function i(o,d){if(d)e:{var m=n;o=o.split(".");for(var x=0;x<o.length-1;x++){var O=o[x];if(!(O in m))break e;m=m[O]}o=o[o.length-1],x=m[o],d=d(x),d!=x&&d!=null&&e(m,o,{configurable:!0,writable:!0,value:d})}}function a(o,d){o instanceof String&&(o+="");var m=0,x=!1,O={next:function(){if(!x&&m<o.length){var V=m++;return{value:d(V,o[V]),done:!1}}return x=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}i("Array.prototype.values",function(o){return o||function(){return a(this,function(d,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function u(o){var d=typeof o;return d=d!="object"?d:o?Array.isArray(o)?"array":d:"null",d=="array"||d=="object"&&typeof o.length=="number"}function h(o){var d=typeof o;return d=="object"&&o!=null||d=="function"}function p(o,d,m){return o.call.apply(o.bind,arguments)}function g(o,d,m){if(!o)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,x),o.apply(d,O)}}return function(){return o.apply(d,arguments)}}function y(o,d,m){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,y.apply(null,arguments)}function w(o,d){var m=Array.prototype.slice.call(arguments,1);return function(){var x=m.slice();return x.push.apply(x,arguments),o.apply(this,x)}}function C(o,d){function m(){}m.prototype=d.prototype,o.aa=d.prototype,o.prototype=new m,o.prototype.constructor=o,o.Qb=function(x,O,V){for(var $=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)$[ve-2]=arguments[ve];return d.prototype[O].apply(x,$)}}function _(o){const d=o.length;if(0<d){const m=Array(d);for(let x=0;x<d;x++)m[x]=o[x];return m}return[]}function N(o,d){for(let m=1;m<arguments.length;m++){const x=arguments[m];if(u(x)){const O=o.length||0,V=x.length||0;o.length=O+V;for(let $=0;$<V;$++)o[O+$]=x[$]}else o.push(x)}}class R{constructor(d,m){this.i=d,this.j=m,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function k(o){return/^[\s\xa0]*$/.test(o)}function D(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function P(o){return P[" "](o),o}P[" "]=function(){};var B=D().indexOf("Gecko")!=-1&&!(D().toLowerCase().indexOf("webkit")!=-1&&D().indexOf("Edge")==-1)&&!(D().indexOf("Trident")!=-1||D().indexOf("MSIE")!=-1)&&D().indexOf("Edge")==-1;function L(o,d,m){for(const x in o)d.call(m,o[x],x,o)}function E(o,d){for(const m in o)d.call(void 0,o[m],m,o)}function f(o){const d={};for(const m in o)d[m]=o[m];return d}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(o,d){let m,x;for(let O=1;O<arguments.length;O++){x=arguments[O];for(m in x)o[m]=x[m];for(let V=0;V<v.length;V++)m=v[V],Object.prototype.hasOwnProperty.call(x,m)&&(o[m]=x[m])}}function A(o){var d=1;o=o.split(":");const m=[];for(;0<d&&o.length;)m.push(o.shift()),d--;return o.length&&m.push(o.join(":")),m}function j(o){c.setTimeout(()=>{throw o},0)}function b(){var o=ce;let d=null;return o.g&&(d=o.g,o.g=o.g.next,o.g||(o.h=null),d.next=null),d}class M{constructor(){this.h=this.g=null}add(d,m){const x=Q.get();x.set(d,m),this.h?this.h.next=x:this.g=x,this.h=x}}var Q=new R(()=>new re,o=>o.reset());class re{constructor(){this.next=this.g=this.h=null}set(d,m){this.h=d,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let X,ee=!1,ce=new M,le=()=>{const o=c.Promise.resolve(void 0);X=()=>{o.then(Oe)}};var Oe=()=>{for(var o;o=b();){try{o.h.call(o.g)}catch(m){j(m)}var d=Q;d.j(o),100>d.h&&(d.h++,o.next=d.g,d.g=o)}ee=!1};function me(){this.s=this.s,this.C=this.C}me.prototype.s=!1,me.prototype.ma=function(){this.s||(this.s=!0,this.N())},me.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function we(o,d){this.type=o,this.g=this.target=d,this.defaultPrevented=!1}we.prototype.h=function(){this.defaultPrevented=!0};var dr=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,d=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const m=()=>{};c.addEventListener("test",m,d),c.removeEventListener("test",m,d)}catch{}return o}();function ut(o,d){if(we.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var m=this.type=o.type,x=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=d,d=o.relatedTarget){if(B){e:{try{P(d.nodeName);var O=!0;break e}catch{}O=!1}O||(d=null)}}else m=="mouseover"?d=o.fromElement:m=="mouseout"&&(d=o.toElement);this.relatedTarget=d,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:si[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&ut.aa.h.call(this)}}C(ut,we);var si={2:"touch",3:"pen",4:"mouse"};ut.prototype.h=function(){ut.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var pt="closure_listenable_"+(1e6*Math.random()|0),ri=0;function Ke(o,d,m,x,O){this.listener=o,this.proxy=null,this.src=d,this.type=m,this.capture=!!x,this.ha=O,this.key=++ri,this.da=this.fa=!1}function Vt(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function hr(o){this.src=o,this.g={},this.h=0}hr.prototype.add=function(o,d,m,x,O){var V=o.toString();o=this.g[V],o||(o=this.g[V]=[],this.h++);var $=Wr(o,d,x,O);return-1<$?(d=o[$],m||(d.fa=!1)):(d=new Ke(d,this.src,V,!!x,O),d.fa=m,o.push(d)),d};function ts(o,d){var m=d.type;if(m in o.g){var x=o.g[m],O=Array.prototype.indexOf.call(x,d,void 0),V;(V=0<=O)&&Array.prototype.splice.call(x,O,1),V&&(Vt(d),o.g[m].length==0&&(delete o.g[m],o.h--))}}function Wr(o,d,m,x){for(var O=0;O<o.length;++O){var V=o[O];if(!V.da&&V.listener==d&&V.capture==!!m&&V.ha==x)return O}return-1}var mr="closure_lm_"+(1e6*Math.random()|0),pr={};function Rs(o,d,m,x,O){if(Array.isArray(d)){for(var V=0;V<d.length;V++)Rs(o,d[V],m,x,O);return null}return m=Xr(m),o&&o[pt]?o.K(d,m,h(x)?!!x.capture:!1,O):ni(o,d,m,!1,x,O)}function ni(o,d,m,x,O,V){if(!d)throw Error("Invalid event type");var $=h(O)?!!O.capture:!!O,ve=ss(o);if(ve||(o[mr]=ve=new hr(o)),m=ve.add(d,m,x,$,V),m.proxy)return m;if(x=fr(),m.proxy=x,x.src=o,x.listener=m,o.addEventListener)dr||(O=$),O===void 0&&(O=!1),o.addEventListener(d.toString(),x,O);else if(o.attachEvent)o.attachEvent(ii(d.toString()),x);else if(o.addListener&&o.removeListener)o.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return m}function fr(){function o(m){return d.call(o.src,o.listener,m)}const d=Ha;return o}function Kr(o,d,m,x,O){if(Array.isArray(d))for(var V=0;V<d.length;V++)Kr(o,d[V],m,x,O);else x=h(x)?!!x.capture:!!x,m=Xr(m),o&&o[pt]?(o=o.i,d=String(d).toString(),d in o.g&&(V=o.g[d],m=Wr(V,m,x,O),-1<m&&(Vt(V[m]),Array.prototype.splice.call(V,m,1),V.length==0&&(delete o.g[d],o.h--)))):o&&(o=ss(o))&&(d=o.g[d.toString()],o=-1,d&&(o=Wr(d,m,x,O)),(m=-1<o?d[o]:null)&&xe(m))}function xe(o){if(typeof o!="number"&&o&&!o.da){var d=o.src;if(d&&d[pt])ts(d.i,o);else{var m=o.type,x=o.proxy;d.removeEventListener?d.removeEventListener(m,x,o.capture):d.detachEvent?d.detachEvent(ii(m),x):d.addListener&&d.removeListener&&d.removeListener(x),(m=ss(d))?(ts(m,o),m.h==0&&(m.src=null,d[mr]=null)):Vt(o)}}}function ii(o){return o in pr?pr[o]:pr[o]="on"+o}function Ha(o,d){if(o.da)o=!0;else{d=new ut(d,this);var m=o.listener,x=o.ha||o.src;o.fa&&xe(o),o=m.call(x,d)}return o}function ss(o){return o=o[mr],o instanceof hr?o:null}var Qr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xr(o){return typeof o=="function"?o:(o[Qr]||(o[Qr]=function(d){return o.handleEvent(d)}),o[Qr])}function Le(){me.call(this),this.i=new hr(this),this.M=this,this.F=null}C(Le,me),Le.prototype[pt]=!0,Le.prototype.removeEventListener=function(o,d,m,x){Kr(this,o,d,m,x)};function Re(o,d){var m,x=o.F;if(x)for(m=[];x;x=x.F)m.push(x);if(o=o.M,x=d.type||d,typeof d=="string")d=new we(d,o);else if(d instanceof we)d.target=d.target||o;else{var O=d;d=new we(x,o),T(d,O)}if(O=!0,m)for(var V=m.length-1;0<=V;V--){var $=d.g=m[V];O=Ps($,x,!0,d)&&O}if($=d.g=o,O=Ps($,x,!0,d)&&O,O=Ps($,x,!1,d)&&O,m)for(V=0;V<m.length;V++)$=d.g=m[V],O=Ps($,x,!1,d)&&O}Le.prototype.N=function(){if(Le.aa.N.call(this),this.i){var o=this.i,d;for(d in o.g){for(var m=o.g[d],x=0;x<m.length;x++)Vt(m[x]);delete o.g[d],o.h--}}this.F=null},Le.prototype.K=function(o,d,m,x){return this.i.add(String(o),d,!1,m,x)},Le.prototype.L=function(o,d,m,x){return this.i.add(String(o),d,!0,m,x)};function Ps(o,d,m,x){if(d=o.i.g[String(d)],!d)return!0;d=d.concat();for(var O=!0,V=0;V<d.length;++V){var $=d[V];if($&&!$.da&&$.capture==m){var ve=$.listener,Be=$.ha||$.src;$.fa&&ts(o.i,$),O=ve.call(Be,x)!==!1&&O}}return O&&!x.defaultPrevented}function Ds(o,d,m){if(typeof o=="function")m&&(o=y(o,m));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:c.setTimeout(o,d||0)}function Yr(o){o.g=Ds(()=>{o.g=null,o.i&&(o.i=!1,Yr(o))},o.l);const d=o.h;o.h=null,o.m.apply(null,d)}class be extends me{constructor(d,m){super(),this.m=d,this.l=m,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Yr(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function rs(o){me.call(this),this.h=o,this.g={}}C(rs,me);var dt=[];function ns(o){L(o.g,function(d,m){this.g.hasOwnProperty(m)&&xe(d)},o),o.g={}}rs.prototype.N=function(){rs.aa.N.call(this),ns(this)},rs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Jr=c.JSON.stringify,Mt=c.JSON.parse,ai=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function Ft(){}Ft.prototype.h=null;function Zr(o){return o.h||(o.h=o.i())}function oi(){}var Os={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function en(){we.call(this,"d")}C(en,we);function tn(){we.call(this,"c")}C(tn,we);var Ut={},sn=null;function gr(){return sn=sn||new Le}Ut.La="serverreachability";function li(o){we.call(this,Ut.La,o)}C(li,we);function Ls(o){const d=gr();Re(d,new li(d))}Ut.STAT_EVENT="statevent";function ci(o,d){we.call(this,Ut.STAT_EVENT,o),this.stat=d}C(ci,we);function Ue(o){const d=gr();Re(d,new ci(d,o))}Ut.Ma="timingevent";function ui(o,d){we.call(this,Ut.Ma,o),this.size=d}C(ui,we);function Vs(o,d){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},d)}function jt(){this.g=!0}jt.prototype.xa=function(){this.g=!1};function di(o,d,m,x,O,V){o.info(function(){if(o.g)if(V)for(var $="",ve=V.split("&"),Be=0;Be<ve.length;Be++){var ge=ve[Be].split("=");if(1<ge.length){var Qe=ge[0];ge=ge[1];var Xe=Qe.split("_");$=2<=Xe.length&&Xe[1]=="type"?$+(Qe+"="+ge+"&"):$+(Qe+"=redacted&")}}else $=null;else $=V;return"XMLHTTP REQ ("+x+") [attempt "+O+"]: "+d+`
`+m+`
`+$})}function Ms(o,d,m,x,O,V,$){o.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+O+"]: "+d+`
`+m+`
`+V+" "+$})}function is(o,d,m,x){o.info(function(){return"XMLHTTP TEXT ("+d+"): "+H(o,m)+(x?" "+x:"")})}function I(o,d){o.info(function(){return"TIMEOUT: "+d})}jt.prototype.info=function(){};function H(o,d){if(!o.g)return d;if(!d)return null;try{var m=JSON.parse(d);if(m){for(o=0;o<m.length;o++)if(Array.isArray(m[o])){var x=m[o];if(!(2>x.length)){var O=x[1];if(Array.isArray(O)&&!(1>O.length)){var V=O[0];if(V!="noop"&&V!="stop"&&V!="close")for(var $=1;$<O.length;$++)O[$]=""}}}}return Jr(m)}catch{return d}}var q={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},z={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ie;function ft(){}C(ft,Ft),ft.prototype.g=function(){return new XMLHttpRequest},ft.prototype.i=function(){return{}},ie=new ft;function gt(o,d,m,x){this.j=o,this.i=d,this.l=m,this.R=x||1,this.U=new rs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fs}function Fs(){this.i=null,this.g="",this.h=!1}var hi={},rn={};function ne(o,d,m){o.L=1,o.v=gi(qt(d)),o.m=m,o.P=!0,Bt(o,null)}function Bt(o,d){o.F=Date.now(),mi(o),o.A=qt(o.v);var m=o.A,x=o.R;Array.isArray(x)||(x=[String(x)]),uc(m.i,"t",x),o.C=0,m=o.j.J,o.h=new Fs,o.g=Sc(o.j,m?d:null,!o.m),0<o.O&&(o.M=new be(y(o.Y,o,o.g),o.O)),d=o.U,m=o.g,x=o.ca;var O="readystatechange";Array.isArray(O)||(O&&(dt[0]=O.toString()),O=dt);for(var V=0;V<O.length;V++){var $=Rs(m,O[V],x||d.handleEvent,!1,d.h||d);if(!$)break;d.g[$.key]=$}d=o.H?f(o.H):{},o.m?(o.u||(o.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,d)):(o.u="GET",o.g.ea(o.A,o.u,null,d)),Ls(),di(o.i,o.u,o.A,o.l,o.R,o.m)}gt.prototype.ca=function(o){o=o.target;const d=this.M;d&&zt(o)==3?d.j():this.Y(o)},gt.prototype.Y=function(o){try{if(o==this.g)e:{const Xe=zt(this.g);var d=this.g.Ba();const br=this.g.Z();if(!(3>Xe)&&(Xe!=3||this.g&&(this.h.h||this.g.oa()||xc(this.g)))){this.J||Xe!=4||d==7||(d==8||0>=br?Ls(3):Ls(2)),Wa(this);var m=this.g.Z();this.X=m;t:if(Ga(this)){var x=xc(this.g);o="";var O=x.length,V=zt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Us(this),an(this);var $="";break t}this.h.i=new c.TextDecoder}for(d=0;d<O;d++)this.h.h=!0,o+=this.h.i.decode(x[d],{stream:!(V&&d==O-1)});x.length=0,this.h.g+=o,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=m==200,Ms(this.i,this.u,this.A,this.l,this.R,Xe,m),this.o){if(this.T&&!this.K){t:{if(this.g){var ve,Be=this.g;if((ve=Be.g?Be.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(ve)){var ge=ve;break t}}ge=null}if(m=ge)is(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ka(this,m);else{this.o=!1,this.s=3,Ue(12),Us(this),an(this);break e}}if(this.P){m=!0;let xt;for(;!this.J&&this.C<$.length;)if(xt=nn(this,$),xt==rn){Xe==4&&(this.s=4,Ue(14),m=!1),is(this.i,this.l,null,"[Incomplete Response]");break}else if(xt==hi){this.s=4,Ue(15),is(this.i,this.l,$,"[Invalid Chunk]"),m=!1;break}else is(this.i,this.l,xt,null),Ka(this,xt);if(Ga(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xe!=4||$.length!=0||this.h.h||(this.s=1,Ue(16),m=!1),this.o=this.o&&m,!m)is(this.i,this.l,$,"[Invalid Chunked Response]"),Us(this),an(this);else if(0<$.length&&!this.W){this.W=!0;var Qe=this.j;Qe.g==this&&Qe.ba&&!Qe.M&&(Qe.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),eo(Qe),Qe.M=!0,Ue(11))}}else is(this.i,this.l,$,null),Ka(this,$);Xe==4&&Us(this),this.o&&!this.J&&(Xe==4?Nc(this.j,this):(this.o=!1,mi(this)))}else Kp(this.g),m==400&&0<$.indexOf("Unknown SID")?(this.s=3,Ue(12)):(this.s=0,Ue(13)),Us(this),an(this)}}}catch{}finally{}};function Ga(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function nn(o,d){var m=o.C,x=d.indexOf(`
`,m);return x==-1?rn:(m=Number(d.substring(m,x)),isNaN(m)?hi:(x+=1,x+m>d.length?rn:(d=d.slice(x,x+m),o.C=x+m,d)))}gt.prototype.cancel=function(){this.J=!0,Us(this)};function mi(o){o.S=Date.now()+o.I,Jl(o,o.I)}function Jl(o,d){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Vs(y(o.ba,o),d)}function Wa(o){o.B&&(c.clearTimeout(o.B),o.B=null)}gt.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(I(this.i,this.A),this.L!=2&&(Ls(),Ue(17)),Us(this),this.s=2,an(this)):Jl(this,this.S-o)};function an(o){o.j.G==0||o.J||Nc(o.j,o)}function Us(o){Wa(o);var d=o.M;d&&typeof d.ma=="function"&&d.ma(),o.M=null,ns(o.U),o.g&&(d=o.g,o.g=null,d.abort(),d.ma())}function Ka(o,d){try{var m=o.j;if(m.G!=0&&(m.g==o||Qa(m.h,o))){if(!o.K&&Qa(m.h,o)&&m.G==3){try{var x=m.Da.g.parse(d)}catch{x=null}if(Array.isArray(x)&&x.length==3){var O=x;if(O[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<o.F)_i(m),vi(m);else break e;Za(m),Ue(18)}}else m.za=O[1],0<m.za-m.T&&37500>O[2]&&m.F&&m.v==0&&!m.C&&(m.C=Vs(y(m.Za,m),6e3));if(1>=tc(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else qs(m,11)}else if((o.K||m.g==o)&&_i(m),!k(d))for(O=m.Da.g.parse(d),d=0;d<O.length;d++){let ge=O[d];if(m.T=ge[0],ge=ge[1],m.G==2)if(ge[0]=="c"){m.K=ge[1],m.ia=ge[2];const Qe=ge[3];Qe!=null&&(m.la=Qe,m.j.info("VER="+m.la));const Xe=ge[4];Xe!=null&&(m.Aa=Xe,m.j.info("SVER="+m.Aa));const br=ge[5];br!=null&&typeof br=="number"&&0<br&&(x=1.5*br,m.L=x,m.j.info("backChannelRequestTimeoutMs_="+x)),x=m;const xt=o.g;if(xt){const Ni=xt.g?xt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ni){var V=x.h;V.g||Ni.indexOf("spdy")==-1&&Ni.indexOf("quic")==-1&&Ni.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(Xa(V,V.h),V.h=null))}if(x.D){const to=xt.g?xt.g.getResponseHeader("X-HTTP-Session-Id"):null;to&&(x.ya=to,_e(x.I,x.D,to))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-o.F,m.j.info("Handshake RTT: "+m.R+"ms")),x=m;var $=o;if(x.qa=Ic(x,x.J?x.ia:null,x.W),$.K){sc(x.h,$);var ve=$,Be=x.L;Be&&(ve.I=Be),ve.B&&(Wa(ve),mi(ve)),x.g=$}else _c(x);0<m.i.length&&wi(m)}else ge[0]!="stop"&&ge[0]!="close"||qs(m,7);else m.G==3&&(ge[0]=="stop"||ge[0]=="close"?ge[0]=="stop"?qs(m,7):Ja(m):ge[0]!="noop"&&m.l&&m.l.ta(ge),m.v=0)}}Ls(4)}catch{}}var Rp=class{constructor(o,d){this.g=o,this.map=d}};function Zl(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ec(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function tc(o){return o.h?1:o.g?o.g.size:0}function Qa(o,d){return o.h?o.h==d:o.g?o.g.has(d):!1}function Xa(o,d){o.g?o.g.add(d):o.h=d}function sc(o,d){o.h&&o.h==d?o.h=null:o.g&&o.g.has(d)&&o.g.delete(d)}Zl.prototype.cancel=function(){if(this.i=rc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function rc(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let d=o.i;for(const m of o.g.values())d=d.concat(m.D);return d}return _(o.i)}function Pp(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var d=[],m=o.length,x=0;x<m;x++)d.push(o[x]);return d}d=[],m=0;for(x in o)d[m++]=o[x];return d}function Dp(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var d=[];o=o.length;for(var m=0;m<o;m++)d.push(m);return d}d=[],m=0;for(const x in o)d[m++]=x;return d}}}function nc(o,d){if(o.forEach&&typeof o.forEach=="function")o.forEach(d,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,d,void 0);else for(var m=Dp(o),x=Pp(o),O=x.length,V=0;V<O;V++)d.call(void 0,x[V],m&&m[V],o)}var ic=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Op(o,d){if(o){o=o.split("&");for(var m=0;m<o.length;m++){var x=o[m].indexOf("="),O=null;if(0<=x){var V=o[m].substring(0,x);O=o[m].substring(x+1)}else V=o[m];d(V,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function Bs(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Bs){this.h=o.h,pi(this,o.j),this.o=o.o,this.g=o.g,fi(this,o.s),this.l=o.l;var d=o.i,m=new cn;m.i=d.i,d.g&&(m.g=new Map(d.g),m.h=d.h),ac(this,m),this.m=o.m}else o&&(d=String(o).match(ic))?(this.h=!1,pi(this,d[1]||"",!0),this.o=on(d[2]||""),this.g=on(d[3]||"",!0),fi(this,d[4]),this.l=on(d[5]||"",!0),ac(this,d[6]||"",!0),this.m=on(d[7]||"")):(this.h=!1,this.i=new cn(null,this.h))}Bs.prototype.toString=function(){var o=[],d=this.j;d&&o.push(ln(d,oc,!0),":");var m=this.g;return(m||d=="file")&&(o.push("//"),(d=this.o)&&o.push(ln(d,oc,!0),"@"),o.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&o.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&o.push("/"),o.push(ln(m,m.charAt(0)=="/"?Mp:Vp,!0))),(m=this.i.toString())&&o.push("?",m),(m=this.m)&&o.push("#",ln(m,Up)),o.join("")};function qt(o){return new Bs(o)}function pi(o,d,m){o.j=m?on(d,!0):d,o.j&&(o.j=o.j.replace(/:$/,""))}function fi(o,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);o.s=d}else o.s=null}function ac(o,d,m){d instanceof cn?(o.i=d,Bp(o.i,o.h)):(m||(d=ln(d,Fp)),o.i=new cn(d,o.h))}function _e(o,d,m){o.i.set(d,m)}function gi(o){return _e(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function on(o,d){return o?d?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function ln(o,d,m){return typeof o=="string"?(o=encodeURI(o).replace(d,Lp),m&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Lp(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var oc=/[#\/\?@]/g,Vp=/[#\?:]/g,Mp=/[#\?]/g,Fp=/[#\?@]/g,Up=/#/g;function cn(o,d){this.h=this.g=null,this.i=o||null,this.j=!!d}function as(o){o.g||(o.g=new Map,o.h=0,o.i&&Op(o.i,function(d,m){o.add(decodeURIComponent(d.replace(/\+/g," ")),m)}))}r=cn.prototype,r.add=function(o,d){as(this),this.i=null,o=xr(this,o);var m=this.g.get(o);return m||this.g.set(o,m=[]),m.push(d),this.h+=1,this};function lc(o,d){as(o),d=xr(o,d),o.g.has(d)&&(o.i=null,o.h-=o.g.get(d).length,o.g.delete(d))}function cc(o,d){return as(o),d=xr(o,d),o.g.has(d)}r.forEach=function(o,d){as(this),this.g.forEach(function(m,x){m.forEach(function(O){o.call(d,O,x,this)},this)},this)},r.na=function(){as(this);const o=Array.from(this.g.values()),d=Array.from(this.g.keys()),m=[];for(let x=0;x<d.length;x++){const O=o[x];for(let V=0;V<O.length;V++)m.push(d[x])}return m},r.V=function(o){as(this);let d=[];if(typeof o=="string")cc(this,o)&&(d=d.concat(this.g.get(xr(this,o))));else{o=Array.from(this.g.values());for(let m=0;m<o.length;m++)d=d.concat(o[m])}return d},r.set=function(o,d){return as(this),this.i=null,o=xr(this,o),cc(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[d]),this.h+=1,this},r.get=function(o,d){return o?(o=this.V(o),0<o.length?String(o[0]):d):d};function uc(o,d,m){lc(o,d),0<m.length&&(o.i=null,o.g.set(xr(o,d),_(m)),o.h+=m.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],d=Array.from(this.g.keys());for(var m=0;m<d.length;m++){var x=d[m];const V=encodeURIComponent(String(x)),$=this.V(x);for(x=0;x<$.length;x++){var O=V;$[x]!==""&&(O+="="+encodeURIComponent(String($[x]))),o.push(O)}}return this.i=o.join("&")};function xr(o,d){return d=String(d),o.j&&(d=d.toLowerCase()),d}function Bp(o,d){d&&!o.j&&(as(o),o.i=null,o.g.forEach(function(m,x){var O=x.toLowerCase();x!=O&&(lc(this,x),uc(this,O,m))},o)),o.j=d}function qp(o,d){const m=new jt;if(c.Image){const x=new Image;x.onload=w(os,m,"TestLoadImage: loaded",!0,d,x),x.onerror=w(os,m,"TestLoadImage: error",!1,d,x),x.onabort=w(os,m,"TestLoadImage: abort",!1,d,x),x.ontimeout=w(os,m,"TestLoadImage: timeout",!1,d,x),c.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=o}else d(!1)}function zp(o,d){const m=new jt,x=new AbortController,O=setTimeout(()=>{x.abort(),os(m,"TestPingServer: timeout",!1,d)},1e4);fetch(o,{signal:x.signal}).then(V=>{clearTimeout(O),V.ok?os(m,"TestPingServer: ok",!0,d):os(m,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(O),os(m,"TestPingServer: error",!1,d)})}function os(o,d,m,x,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),x(m)}catch{}}function $p(){this.g=new ai}function Hp(o,d,m){const x=m||"";try{nc(o,function(O,V){let $=O;h(O)&&($=Jr(O)),d.push(x+V+"="+encodeURIComponent($))})}catch(O){throw d.push(x+"type="+encodeURIComponent("_badmap")),O}}function xi(o){this.l=o.Ub||null,this.j=o.eb||!1}C(xi,Ft),xi.prototype.g=function(){return new yi(this.l,this.j)},xi.prototype.i=function(o){return function(){return o}}({});function yi(o,d){Le.call(this),this.D=o,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(yi,Le),r=yi.prototype,r.open=function(o,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=d,this.readyState=1,dn(this)},r.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(d.body=o),(this.D||c).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,un(this)),this.readyState=0},r.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,dn(this)),this.g&&(this.readyState=3,dn(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;dc(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function dc(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}r.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var d=o.value?o.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!o.done}))&&(this.response=this.responseText+=d)}o.done?un(this):dn(this),this.readyState==3&&dc(this)}},r.Ra=function(o){this.g&&(this.response=this.responseText=o,un(this))},r.Qa=function(o){this.g&&(this.response=o,un(this))},r.ga=function(){this.g&&un(this)};function un(o){o.readyState=4,o.l=null,o.j=null,o.v=null,dn(o)}r.setRequestHeader=function(o,d){this.u.append(o,d)},r.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],d=this.h.entries();for(var m=d.next();!m.done;)m=m.value,o.push(m[0]+": "+m[1]),m=d.next();return o.join(`\r
`)};function dn(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(yi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function hc(o){let d="";return L(o,function(m,x){d+=x,d+=":",d+=m,d+=`\r
`}),d}function Ya(o,d,m){e:{for(x in m){var x=!1;break e}x=!0}x||(m=hc(m),typeof o=="string"?m!=null&&encodeURIComponent(String(m)):_e(o,d,m))}function Ie(o){Le.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Ie,Le);var Gp=/^https?$/i,Wp=["POST","PUT"];r=Ie.prototype,r.Ha=function(o){this.J=o},r.ea=function(o,d,m,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);d=d?d.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ie.g(),this.v=this.o?Zr(this.o):Zr(ie),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(d,String(o),!0),this.B=!1}catch(V){mc(this,V);return}if(o=m||"",m=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var O in x)m.set(O,x[O]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const V of x.keys())m.set(V,x.get(V));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(m.keys()).find(V=>V.toLowerCase()=="content-type"),O=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Wp,d,void 0))||x||O||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,$]of m)this.g.setRequestHeader(V,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{gc(this),this.u=!0,this.g.send(o),this.u=!1}catch(V){mc(this,V)}};function mc(o,d){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=d,o.m=5,pc(o),bi(o)}function pc(o){o.A||(o.A=!0,Re(o,"complete"),Re(o,"error"))}r.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Re(this,"complete"),Re(this,"abort"),bi(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bi(this,!0)),Ie.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?fc(this):this.bb())},r.bb=function(){fc(this)};function fc(o){if(o.h&&typeof l<"u"&&(!o.v[1]||zt(o)!=4||o.Z()!=2)){if(o.u&&zt(o)==4)Ds(o.Ea,0,o);else if(Re(o,"readystatechange"),zt(o)==4){o.h=!1;try{const $=o.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var m;if(!(m=d)){var x;if(x=$===0){var O=String(o.D).match(ic)[1]||null;!O&&c.self&&c.self.location&&(O=c.self.location.protocol.slice(0,-1)),x=!Gp.test(O?O.toLowerCase():"")}m=x}if(m)Re(o,"complete"),Re(o,"success");else{o.m=6;try{var V=2<zt(o)?o.g.statusText:""}catch{V=""}o.l=V+" ["+o.Z()+"]",pc(o)}}finally{bi(o)}}}}function bi(o,d){if(o.g){gc(o);const m=o.g,x=o.v[0]?()=>{}:null;o.g=null,o.v=null,d||Re(o,"ready");try{m.onreadystatechange=x}catch{}}}function gc(o){o.I&&(c.clearTimeout(o.I),o.I=null)}r.isActive=function(){return!!this.g};function zt(o){return o.g?o.g.readyState:0}r.Z=function(){try{return 2<zt(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(o){if(this.g){var d=this.g.responseText;return o&&d.indexOf(o)==0&&(d=d.substring(o.length)),Mt(d)}};function xc(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Kp(o){const d={};o=(o.g&&2<=zt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<o.length;x++){if(k(o[x]))continue;var m=A(o[x]);const O=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const V=d[O]||[];d[O]=V,V.push(m)}E(d,function(x){return x.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function hn(o,d,m){return m&&m.internalChannelParams&&m.internalChannelParams[o]||d}function yc(o){this.Aa=0,this.i=[],this.j=new jt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=hn("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=hn("baseRetryDelayMs",5e3,o),this.cb=hn("retryDelaySeedMs",1e4,o),this.Wa=hn("forwardChannelMaxRetries",2,o),this.wa=hn("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Zl(o&&o.concurrentRequestLimit),this.Da=new $p,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=yc.prototype,r.la=8,r.G=1,r.connect=function(o,d,m,x){Ue(0),this.W=o,this.H=d||{},m&&x!==void 0&&(this.H.OSID=m,this.H.OAID=x),this.F=this.X,this.I=Ic(this,null,this.W),wi(this)};function Ja(o){if(bc(o),o.G==3){var d=o.U++,m=qt(o.I);if(_e(m,"SID",o.K),_e(m,"RID",d),_e(m,"TYPE","terminate"),mn(o,m),d=new gt(o,o.j,d),d.L=2,d.v=gi(qt(m)),m=!1,c.navigator&&c.navigator.sendBeacon)try{m=c.navigator.sendBeacon(d.v.toString(),"")}catch{}!m&&c.Image&&(new Image().src=d.v,m=!0),m||(d.g=Sc(d.j,null),d.g.ea(d.v)),d.F=Date.now(),mi(d)}Tc(o)}function vi(o){o.g&&(eo(o),o.g.cancel(),o.g=null)}function bc(o){vi(o),o.u&&(c.clearTimeout(o.u),o.u=null),_i(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function wi(o){if(!ec(o.h)&&!o.s){o.s=!0;var d=o.Ga;X||le(),ee||(X(),ee=!0),ce.add(d,o),o.B=0}}function Qp(o,d){return tc(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=d.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Vs(y(o.Ga,o,d),Ec(o,o.B)),o.B++,!0)}r.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const O=new gt(this,this.j,o);let V=this.o;if(this.S&&(V?(V=f(V),T(V,this.S)):V=this.S),this.m!==null||this.O||(O.H=V,V=null),this.P)e:{for(var d=0,m=0;m<this.i.length;m++){t:{var x=this.i[m];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(d+=x,4096<d){d=m;break e}if(d===4096||m===this.i.length-1){d=m+1;break e}}d=1e3}else d=1e3;d=wc(this,O,d),m=qt(this.I),_e(m,"RID",o),_e(m,"CVER",22),this.D&&_e(m,"X-HTTP-Session-Id",this.D),mn(this,m),V&&(this.O?d="headers="+encodeURIComponent(String(hc(V)))+"&"+d:this.m&&Ya(m,this.m,V)),Xa(this.h,O),this.Ua&&_e(m,"TYPE","init"),this.P?(_e(m,"$req",d),_e(m,"SID","null"),O.T=!0,ne(O,m,null)):ne(O,m,d),this.G=2}}else this.G==3&&(o?vc(this,o):this.i.length==0||ec(this.h)||vc(this))};function vc(o,d){var m;d?m=d.l:m=o.U++;const x=qt(o.I);_e(x,"SID",o.K),_e(x,"RID",m),_e(x,"AID",o.T),mn(o,x),o.m&&o.o&&Ya(x,o.m,o.o),m=new gt(o,o.j,m,o.B+1),o.m===null&&(m.H=o.o),d&&(o.i=d.D.concat(o.i)),d=wc(o,m,1e3),m.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Xa(o.h,m),ne(m,x,d)}function mn(o,d){o.H&&L(o.H,function(m,x){_e(d,x,m)}),o.l&&nc({},function(m,x){_e(d,x,m)})}function wc(o,d,m){m=Math.min(o.i.length,m);var x=o.l?y(o.l.Na,o.l,o):null;e:{var O=o.i;let V=-1;for(;;){const $=["count="+m];V==-1?0<m?(V=O[0].g,$.push("ofs="+V)):V=0:$.push("ofs="+V);let ve=!0;for(let Be=0;Be<m;Be++){let ge=O[Be].g;const Qe=O[Be].map;if(ge-=V,0>ge)V=Math.max(0,O[Be].g-100),ve=!1;else try{Hp(Qe,$,"req"+ge+"_")}catch{x&&x(Qe)}}if(ve){x=$.join("&");break e}}}return o=o.i.splice(0,m),d.D=o,x}function _c(o){if(!o.g&&!o.u){o.Y=1;var d=o.Fa;X||le(),ee||(X(),ee=!0),ce.add(d,o),o.v=0}}function Za(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Vs(y(o.Fa,o),Ec(o,o.v)),o.v++,!0)}r.Fa=function(){if(this.u=null,jc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Vs(y(this.ab,this),o)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ue(10),vi(this),jc(this))};function eo(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function jc(o){o.g=new gt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var d=qt(o.qa);_e(d,"RID","rpc"),_e(d,"SID",o.K),_e(d,"AID",o.T),_e(d,"CI",o.F?"0":"1"),!o.F&&o.ja&&_e(d,"TO",o.ja),_e(d,"TYPE","xmlhttp"),mn(o,d),o.m&&o.o&&Ya(d,o.m,o.o),o.L&&(o.g.I=o.L);var m=o.g;o=o.ia,m.L=1,m.v=gi(qt(d)),m.m=null,m.P=!0,Bt(m,o)}r.Za=function(){this.C!=null&&(this.C=null,vi(this),Za(this),Ue(19))};function _i(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function Nc(o,d){var m=null;if(o.g==d){_i(o),eo(o),o.g=null;var x=2}else if(Qa(o.h,d))m=d.D,sc(o.h,d),x=1;else return;if(o.G!=0){if(d.o)if(x==1){m=d.m?d.m.length:0,d=Date.now()-d.F;var O=o.B;x=gr(),Re(x,new ui(x,m)),wi(o)}else _c(o);else if(O=d.s,O==3||O==0&&0<d.X||!(x==1&&Qp(o,d)||x==2&&Za(o)))switch(m&&0<m.length&&(d=o.h,d.i=d.i.concat(m)),O){case 1:qs(o,5);break;case 4:qs(o,10);break;case 3:qs(o,6);break;default:qs(o,2)}}}function Ec(o,d){let m=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(m*=2),m*d}function qs(o,d){if(o.j.info("Error code "+d),d==2){var m=y(o.fb,o),x=o.Xa;const O=!x;x=new Bs(x||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||pi(x,"https"),gi(x),O?qp(x.toString(),m):zp(x.toString(),m)}else Ue(2);o.G=0,o.l&&o.l.sa(d),Tc(o),bc(o)}r.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Ue(2)):(this.j.info("Failed to ping google.com"),Ue(1))};function Tc(o){if(o.G=0,o.ka=[],o.l){const d=rc(o.h);(d.length!=0||o.i.length!=0)&&(N(o.ka,d),N(o.ka,o.i),o.h.i.length=0,_(o.i),o.i.length=0),o.l.ra()}}function Ic(o,d,m){var x=m instanceof Bs?qt(m):new Bs(m);if(x.g!="")d&&(x.g=d+"."+x.g),fi(x,x.s);else{var O=c.location;x=O.protocol,d=d?d+"."+O.hostname:O.hostname,O=+O.port;var V=new Bs(null);x&&pi(V,x),d&&(V.g=d),O&&fi(V,O),m&&(V.l=m),x=V}return m=o.D,d=o.ya,m&&d&&_e(x,m,d),_e(x,"VER",o.la),mn(o,x),x}function Sc(o,d,m){if(d&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=o.Ca&&!o.pa?new Ie(new xi({eb:m})):new Ie(o.pa),d.Ha(o.J),d}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ac(){}r=Ac.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function ji(){}ji.prototype.g=function(o,d){return new at(o,d)};function at(o,d){Le.call(this),this.g=new yc(d),this.l=o,this.h=d&&d.messageUrlParams||null,o=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(o?o["X-WebChannel-Content-Type"]=d.messageContentType:o={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(o?o["X-WebChannel-Client-Profile"]=d.va:o={"X-WebChannel-Client-Profile":d.va}),this.g.S=o,(o=d&&d.Sb)&&!k(o)&&(this.g.m=o),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!k(d)&&(this.g.D=d,o=this.h,o!==null&&d in o&&(o=this.h,d in o&&delete o[d])),this.j=new yr(this)}C(at,Le),at.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},at.prototype.close=function(){Ja(this.g)},at.prototype.o=function(o){var d=this.g;if(typeof o=="string"){var m={};m.__data__=o,o=m}else this.u&&(m={},m.__data__=Jr(o),o=m);d.i.push(new Rp(d.Ya++,o)),d.G==3&&wi(d)},at.prototype.N=function(){this.g.l=null,delete this.j,Ja(this.g),delete this.g,at.aa.N.call(this)};function Cc(o){en.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var d=o.__sm__;if(d){e:{for(const m in d){o=m;break e}o=void 0}(this.i=o)&&(o=this.i,d=d!==null&&o in d?d[o]:void 0),this.data=d}else this.data=o}C(Cc,en);function kc(){tn.call(this),this.status=1}C(kc,tn);function yr(o){this.g=o}C(yr,Ac),yr.prototype.ua=function(){Re(this.g,"a")},yr.prototype.ta=function(o){Re(this.g,new Cc(o))},yr.prototype.sa=function(o){Re(this.g,new kc)},yr.prototype.ra=function(){Re(this.g,"b")},ji.prototype.createWebChannel=ji.prototype.g,at.prototype.send=at.prototype.o,at.prototype.open=at.prototype.m,at.prototype.close=at.prototype.close,em=function(){return new ji},Zh=function(){return gr()},Jh=Ut,Fo={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},q.NO_ERROR=0,q.TIMEOUT=8,q.HTTP_ERROR=6,Bi=q,z.COMPLETE="complete",Yh=z,oi.EventType=Os,Os.OPEN="a",Os.CLOSE="b",Os.ERROR="c",Os.MESSAGE="d",Le.prototype.listen=Le.prototype.K,yn=oi,Ie.prototype.listenOnce=Ie.prototype.L,Ie.prototype.getLastError=Ie.prototype.Ka,Ie.prototype.getLastErrorCode=Ie.prototype.Ba,Ie.prototype.getStatus=Ie.prototype.Z,Ie.prototype.getResponseJson=Ie.prototype.Oa,Ie.prototype.getResponseText=Ie.prototype.oa,Ie.prototype.send=Ie.prototype.ea,Ie.prototype.setWithCredentials=Ie.prototype.Ha,Xh=Ie}).apply(typeof Ai<"u"?Ai:typeof self<"u"?self:typeof window<"u"?window:{});const _u="@firebase/firestore",ju="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Je.UNAUTHENTICATED=new Je(null),Je.GOOGLE_CREDENTIALS=new Je("google-credentials-uid"),Je.FIRST_PARTY=new Je("first-party-uid"),Je.MOCK_USER=new Je("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zr="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr=new al("@firebase/firestore");function vr(){return rr.logLevel}function K(r,...e){if(rr.logLevel<=ue.DEBUG){const t=e.map(_l);rr.debug(`Firestore (${zr}): ${r}`,...t)}}function Jt(r,...e){if(rr.logLevel<=ue.ERROR){const t=e.map(_l);rr.error(`Firestore (${zr}): ${r}`,...t)}}function Or(r,...e){if(rr.logLevel<=ue.WARN){const t=e.map(_l);rr.warn(`Firestore (${zr}): ${r}`,...t)}}function _l(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function se(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,tm(r,n,t)}function tm(r,e,t){let n=`FIRESTORE (${zr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Jt(n),new Error(n)}function ye(r,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,r||tm(e,i,n)}function oe(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends Lt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ev{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Je.UNAUTHENTICATED))}shutdown(){}}class Tv{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Iv{constructor(e){this.t=e,this.currentUser=Je.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ye(this.o===void 0,42304);let n=this.i;const i=u=>this.i!==n?(n=this.i,t(u)):Promise.resolve();let a=new vs;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new vs,e.enqueueRetryable(()=>i(this.currentUser))};const l=()=>{const u=a;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new vs)}},0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ye(typeof n.accessToken=="string",31837,{l:n}),new sm(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ye(e===null||typeof e=="string",2055,{h:e}),new Je(e)}}class Sv{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Je.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Av{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new Sv(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Je.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Nu{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Cv{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,lt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ye(this.o===void 0,3512);const n=a=>{a.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,K("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Nu(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ye(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Nu(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=kv(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<t&&(n+=e.charAt(i[a]%62))}return n}}function de(r,e){return r<e?-1:r>e?1:0}function Uo(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const i=r.charAt(n),a=e.charAt(n);if(i!==a)return fo(i)===fo(a)?de(i,a):fo(i)?1:-1}return de(r.length,e.length)}const Rv=55296,Pv=57343;function fo(r){const e=r.charCodeAt(0);return e>=Rv&&e<=Pv}function Lr(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eu="__name__";class Nt{constructor(e,t,n){t===void 0?t=0:t>e.length&&se(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&se(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Nt.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Nt?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const a=Nt.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return de(e.length,t.length)}static compareSegments(e,t){const n=Nt.isNumericId(e),i=Nt.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Nt.extractNumericId(e).compare(Nt.extractNumericId(t)):Uo(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bs.fromString(e.substring(4,e.length-2))}}class je extends Nt{construct(e,t,n){return new je(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Y(U.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new je(t)}static emptyPath(){return new je([])}}const Dv=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ze extends Nt{construct(e,t,n){return new ze(e,t,n)}static isValidIdentifier(e){return Dv.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ze.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Eu}static keyField(){return new ze([Eu])}static fromServerFormat(e){const t=[];let n="",i=0;const a=()=>{if(n.length===0)throw new Y(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let l=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Y(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Y(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else c==="`"?(l=!l,i++):c!=="."||l?(n+=c,i++):(a(),i++)}if(a(),l)throw new Y(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ze(t)}static emptyPath(){return new ze([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.path=e}static fromPath(e){return new Z(je.fromString(e))}static fromName(e){return new Z(je.fromString(e).popFirst(5))}static empty(){return new Z(je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return je.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new je(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rm(r,e,t){if(!t)throw new Y(U.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function Ov(r,e,t,n){if(e===!0&&n===!0)throw new Y(U.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function Tu(r){if(!Z.isDocumentKey(r))throw new Y(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function Iu(r){if(Z.isDocumentKey(r))throw new Y(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function nm(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function Nl(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":se(12329,{type:typeof r})}function Ln(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Y(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Nl(r);throw new Y(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(r,e){const t={typeString:r};return e&&(t.value=e),t}function Yn(r,e){if(!nm(r))throw new Y(U.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const l=r[n];if(i&&typeof l!==i){t=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${n}' field to equal '${a.value}'`;break}}if(t)throw new Y(U.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=-62135596800,Au=1e6;class Ne{static now(){return Ne.fromMillis(Date.now())}static fromDate(e){return Ne.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Au);return new Ne(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Y(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Y(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Su)throw new Y(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Au}_compareTo(e){return this.seconds===e.seconds?de(this.nanoseconds,e.nanoseconds):de(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ne._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yn(e,Ne._jsonSchema))return new Ne(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Su;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ne._jsonSchemaVersion="firestore/timestamp/1.0",Ne._jsonSchema={type:De("string",Ne._jsonSchemaVersion),seconds:De("number"),nanoseconds:De("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{static fromTimestamp(e){return new ae(e)}static min(){return new ae(new Ne(0,0))}static max(){return new ae(new Ne(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn=-1;function Lv(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=ae.fromTimestamp(n===1e9?new Ne(t+1,0):new Ne(t,n));return new js(i,Z.empty(),e)}function Vv(r){return new js(r.readTime,r.key,Vn)}class js{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new js(ae.min(),Z.empty(),Vn)}static max(){return new js(ae.max(),Z.empty(),Vn)}}function Mv(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=Z.comparator(r.documentKey,e.documentKey),t!==0?t:de(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Uv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $r(r){if(r.code!==U.FAILED_PRECONDITION||r.message!==Fv)throw r;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new F((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof F?t:F.resolve(t)}catch(t){return F.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):F.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):F.reject(t)}static resolve(e){return new F((t,n)=>{t(e)})}static reject(e){return new F((t,n)=>{n(e)})}static waitFor(e){return new F((t,n)=>{let i=0,a=0,l=!1;e.forEach(c=>{++i,c.next(()=>{++a,l&&a===i&&t()},u=>n(u))}),l=!0,a===i&&t()})}static or(e){let t=F.resolve(!1);for(const n of e)t=t.next(i=>i?F.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,a)=>{n.push(t.call(this,i,a))}),this.waitFor(n)}static mapArray(e,t){return new F((n,i)=>{const a=e.length,l=new Array(a);let c=0;for(let u=0;u<a;u++){const h=u;t(e[h]).next(p=>{l[h]=p,++c,c===a&&n(l)},p=>i(p))}})}static doWhile(e,t){return new F((n,i)=>{const a=()=>{e()===!0?t().next(()=>{a()},i):n()};a()})}}function Bv(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Hr(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ca.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const El=-1;function ka(r){return r==null}function ia(r){return r===0&&1/r==-1/0}function qv(r){return typeof r=="number"&&Number.isInteger(r)&&!ia(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const im="";function zv(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=Cu(e)),e=$v(r.get(t),e);return Cu(e)}function $v(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const a=r.charAt(i);switch(a){case"\0":t+="";break;case im:t+="";break;default:t+=a}}return t}function Cu(r){return r+im+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function or(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function am(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e,t){this.comparator=e,this.root=t||qe.EMPTY}insert(e,t){return new Te(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qe.BLACK,null,null))}remove(e){return new Te(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qe.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ci(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ci(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ci(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ci(this.root,e,this.comparator,!0)}}class Ci{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qe{constructor(e,t,n,i,a){this.key=e,this.value=t,this.color=n??qe.RED,this.left=i??qe.EMPTY,this.right=a??qe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,a){return new qe(e??this.key,t??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,n),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return qe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return qe.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw se(27949);return e+(this.isRed()?0:1)}}qe.EMPTY=null,qe.RED=!0,qe.BLACK=!1;qe.EMPTY=new class{constructor(){this.size=0}get key(){throw se(57766)}get value(){throw se(16141)}get color(){throw se(16727)}get left(){throw se(29726)}get right(){throw se(36894)}copy(e,t,n,i,a){return this}insert(e,t,n){return new qe(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e){this.comparator=e,this.data=new Te(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ru(this.data.getIterator())}getIteratorFrom(e){return new Ru(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Me)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Me(this.comparator);return t.data=e,t}}class Ru{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new wt([])}unionWith(e){let t=new Me(ze.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new wt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Lr(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new om("Invalid base64 string: "+a):a}}(e);return new We(t)}static fromUint8Array(e){const t=function(i){let a="";for(let l=0;l<i.length;++l)a+=String.fromCharCode(i[l]);return a}(e);return new We(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return de(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}We.EMPTY_BYTE_STRING=new We("");const Hv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ns(r){if(ye(!!r,39018),typeof r=="string"){let e=0;const t=Hv.exec(r);if(ye(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ce(r.seconds),nanos:Ce(r.nanos)}}function Ce(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Es(r){return typeof r=="string"?We.fromBase64String(r):We.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lm="server_timestamp",cm="__type__",um="__previous_value__",dm="__local_write_time__";function Tl(r){return(r?.mapValue?.fields||{})[cm]?.stringValue===lm}function Ra(r){const e=r.mapValue.fields[um];return Tl(e)?Ra(e):e}function Mn(r){const e=Ns(r.mapValue.fields[dm].timestampValue);return new Ne(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(e,t,n,i,a,l,c,u,h,p){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=p}}const aa="(default)";class Fn{constructor(e,t){this.projectId=e,this.database=t||aa}static empty(){return new Fn("","")}get isDefaultDatabase(){return this.database===aa}isEqual(e){return e instanceof Fn&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hm="__type__",Wv="__max__",ki={mapValue:{}},mm="__vector__",oa="value";function Ts(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Tl(r)?4:Qv(r)?9007199254740991:Kv(r)?10:11:se(28295,{value:r})}function Dt(r,e){if(r===e)return!0;const t=Ts(r);if(t!==Ts(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Mn(r).isEqual(Mn(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const l=Ns(i.timestampValue),c=Ns(a.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,a){return Es(i.bytesValue).isEqual(Es(a.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,a){return Ce(i.geoPointValue.latitude)===Ce(a.geoPointValue.latitude)&&Ce(i.geoPointValue.longitude)===Ce(a.geoPointValue.longitude)}(r,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return Ce(i.integerValue)===Ce(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const l=Ce(i.doubleValue),c=Ce(a.doubleValue);return l===c?ia(l)===ia(c):isNaN(l)&&isNaN(c)}return!1}(r,e);case 9:return Lr(r.arrayValue.values||[],e.arrayValue.values||[],Dt);case 10:case 11:return function(i,a){const l=i.mapValue.fields||{},c=a.mapValue.fields||{};if(ku(l)!==ku(c))return!1;for(const u in l)if(l.hasOwnProperty(u)&&(c[u]===void 0||!Dt(l[u],c[u])))return!1;return!0}(r,e);default:return se(52216,{left:r})}}function Un(r,e){return(r.values||[]).find(t=>Dt(t,e))!==void 0}function Vr(r,e){if(r===e)return 0;const t=Ts(r),n=Ts(e);if(t!==n)return de(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return de(r.booleanValue,e.booleanValue);case 2:return function(a,l){const c=Ce(a.integerValue||a.doubleValue),u=Ce(l.integerValue||l.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(r,e);case 3:return Pu(r.timestampValue,e.timestampValue);case 4:return Pu(Mn(r),Mn(e));case 5:return Uo(r.stringValue,e.stringValue);case 6:return function(a,l){const c=Es(a),u=Es(l);return c.compareTo(u)}(r.bytesValue,e.bytesValue);case 7:return function(a,l){const c=a.split("/"),u=l.split("/");for(let h=0;h<c.length&&h<u.length;h++){const p=de(c[h],u[h]);if(p!==0)return p}return de(c.length,u.length)}(r.referenceValue,e.referenceValue);case 8:return function(a,l){const c=de(Ce(a.latitude),Ce(l.latitude));return c!==0?c:de(Ce(a.longitude),Ce(l.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return Du(r.arrayValue,e.arrayValue);case 10:return function(a,l){const c=a.fields||{},u=l.fields||{},h=c[oa]?.arrayValue,p=u[oa]?.arrayValue,g=de(h?.values?.length||0,p?.values?.length||0);return g!==0?g:Du(h,p)}(r.mapValue,e.mapValue);case 11:return function(a,l){if(a===ki.mapValue&&l===ki.mapValue)return 0;if(a===ki.mapValue)return 1;if(l===ki.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),h=l.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let g=0;g<u.length&&g<p.length;++g){const y=Uo(u[g],p[g]);if(y!==0)return y;const w=Vr(c[u[g]],h[p[g]]);if(w!==0)return w}return de(u.length,p.length)}(r.mapValue,e.mapValue);default:throw se(23264,{he:t})}}function Pu(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return de(r,e);const t=Ns(r),n=Ns(e),i=de(t.seconds,n.seconds);return i!==0?i:de(t.nanos,n.nanos)}function Du(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const a=Vr(t[i],n[i]);if(a)return a}return de(t.length,n.length)}function Mr(r){return Bo(r)}function Bo(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Ns(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Es(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return Z.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const a of t.values||[])i?i=!1:n+=",",n+=Bo(a);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const l of n)a?a=!1:i+=",",i+=`${l}:${Bo(t.fields[l])}`;return i+"}"}(r.mapValue):se(61005,{value:r})}function qi(r){switch(Ts(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ra(r);return e?16+qi(e):16;case 5:return 2*r.stringValue.length;case 6:return Es(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+qi(a),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return or(n.fields,(a,l)=>{i+=a.length+qi(l)}),i}(r.mapValue);default:throw se(13486,{value:r})}}function qo(r){return!!r&&"integerValue"in r}function Il(r){return!!r&&"arrayValue"in r}function Ou(r){return!!r&&"nullValue"in r}function Lu(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function zi(r){return!!r&&"mapValue"in r}function Kv(r){return(r?.mapValue?.fields||{})[hm]?.stringValue===mm}function Nn(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return or(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Nn(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Nn(r.arrayValue.values[t]);return e}return{...r}}function Qv(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===Wv}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.value=e}static empty(){return new ht({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!zi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nn(t)}setAll(e){let t=ze.emptyPath(),n={},i=[];e.forEach((l,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,n,i),n={},i=[],t=c.popLast()}l?n[c.lastSegment()]=Nn(l):i.push(c.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,n,i)}delete(e){const t=this.field(e.popLast());zi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Dt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];zi(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){or(t,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new ht(Nn(this.value))}}function pm(r){const e=[];return or(r.fields,(t,n)=>{const i=new ze([t]);if(zi(n)){const a=pm(n.mapValue).fields;if(a.length===0)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new wt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,t,n,i,a,l,c){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=a,this.data=l,this.documentState=c}static newInvalidDocument(e){return new Ze(e,0,ae.min(),ae.min(),ae.min(),ht.empty(),0)}static newFoundDocument(e,t,n,i){return new Ze(e,1,t,ae.min(),n,i,0)}static newNoDocument(e,t){return new Ze(e,2,t,ae.min(),ae.min(),ht.empty(),0)}static newUnknownDocument(e,t){return new Ze(e,3,t,ae.min(),ae.min(),ht.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ht.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ht.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ze&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ze(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(e,t){this.position=e,this.inclusive=t}}function Vu(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const a=e[i],l=r.position[i];if(a.field.isKeyField()?n=Z.comparator(Z.fromName(l.referenceValue),t.key):n=Vr(l,t.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function Mu(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Dt(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,t="asc"){this.field=e,this.dir=t}}function Xv(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{}class Ve extends fm{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Jv(e,t,n):t==="array-contains"?new tw(e,n):t==="in"?new sw(e,n):t==="not-in"?new rw(e,n):t==="array-contains-any"?new nw(e,n):new Ve(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Zv(e,n):new ew(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Vr(t,this.value)):t!==null&&Ts(this.value)===Ts(t)&&this.matchesComparison(Vr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ot extends fm{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ot(e,t)}matches(e){return gm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function gm(r){return r.op==="and"}function xm(r){return Yv(r)&&gm(r)}function Yv(r){for(const e of r.filters)if(e instanceof Ot)return!1;return!0}function zo(r){if(r instanceof Ve)return r.field.canonicalString()+r.op.toString()+Mr(r.value);if(xm(r))return r.filters.map(e=>zo(e)).join(",");{const e=r.filters.map(t=>zo(t)).join(",");return`${r.op}(${e})`}}function ym(r,e){return r instanceof Ve?function(n,i){return i instanceof Ve&&n.op===i.op&&n.field.isEqual(i.field)&&Dt(n.value,i.value)}(r,e):r instanceof Ot?function(n,i){return i instanceof Ot&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,l,c)=>a&&ym(l,i.filters[c]),!0):!1}(r,e):void se(19439)}function bm(r){return r instanceof Ve?function(t){return`${t.field.canonicalString()} ${t.op} ${Mr(t.value)}`}(r):r instanceof Ot?function(t){return t.op.toString()+" {"+t.getFilters().map(bm).join(" ,")+"}"}(r):"Filter"}class Jv extends Ve{constructor(e,t,n){super(e,t,n),this.key=Z.fromName(n.referenceValue)}matches(e){const t=Z.comparator(e.key,this.key);return this.matchesComparison(t)}}class Zv extends Ve{constructor(e,t){super(e,"in",t),this.keys=vm("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ew extends Ve{constructor(e,t){super(e,"not-in",t),this.keys=vm("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function vm(r,e){return(e.arrayValue?.values||[]).map(t=>Z.fromName(t.referenceValue))}class tw extends Ve{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Il(t)&&Un(t.arrayValue,this.value)}}class sw extends Ve{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Un(this.value.arrayValue,t)}}class rw extends Ve{constructor(e,t){super(e,"not-in",t)}matches(e){if(Un(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Un(this.value.arrayValue,t)}}class nw extends Ve{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Il(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Un(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e,t=null,n=[],i=[],a=null,l=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=l,this.endAt=c,this.Te=null}}function Fu(r,e=null,t=[],n=[],i=null,a=null,l=null){return new iw(r,e,t,n,i,a,l)}function Sl(r){const e=oe(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>zo(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),ka(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Mr(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Mr(n)).join(",")),e.Te=t}return e.Te}function Al(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!Xv(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!ym(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!Mu(r.startAt,e.startAt)&&Mu(r.endAt,e.endAt)}function $o(r){return Z.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,t=null,n=[],i=[],a=null,l="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=l,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function aw(r,e,t,n,i,a,l,c){return new Pa(r,e,t,n,i,a,l,c)}function wm(r){return new Pa(r)}function Uu(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function ow(r){return r.collectionGroup!==null}function En(r){const e=oe(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new Me(ze.comparator);return l.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new ca(a,n))}),t.has(ze.keyField().canonicalString())||e.Ie.push(new ca(ze.keyField(),n))}return e.Ie}function At(r){const e=oe(r);return e.Ee||(e.Ee=lw(e,En(r))),e.Ee}function lw(r,e){if(r.limitType==="F")return Fu(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new ca(i.field,a)});const t=r.endAt?new la(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new la(r.startAt.position,r.startAt.inclusive):null;return Fu(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Ho(r,e,t){return new Pa(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Da(r,e){return Al(At(r),At(e))&&r.limitType===e.limitType}function _m(r){return`${Sl(At(r))}|lt:${r.limitType}`}function wr(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>bm(i)).join(", ")}]`),ka(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Mr(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Mr(i)).join(",")),`Target(${n})`}(At(r))}; limitType=${r.limitType})`}function Oa(r,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Z.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(r,e)&&function(n,i){for(const a of En(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(l,c,u){const h=Vu(l,c,u);return l.inclusive?h<=0:h<0}(n.startAt,En(n),i)||n.endAt&&!function(l,c,u){const h=Vu(l,c,u);return l.inclusive?h>=0:h>0}(n.endAt,En(n),i))}(r,e)}function cw(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function jm(r){return(e,t)=>{let n=!1;for(const i of En(r)){const a=uw(i,e,t);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function uw(r,e,t){const n=r.field.isKeyField()?Z.comparator(e.key,t.key):function(a,l,c){const u=l.data.field(a),h=c.data.field(a);return u!==null&&h!==null?Vr(u,h):se(42886)}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return se(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){or(this.inner,(t,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return am(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dw=new Te(Z.comparator);function Zt(){return dw}const Nm=new Te(Z.comparator);function bn(...r){let e=Nm;for(const t of r)e=e.insert(t.key,t);return e}function Em(r){let e=Nm;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function $s(){return Tn()}function Tm(){return Tn()}function Tn(){return new lr(r=>r.toString(),(r,e)=>r.isEqual(e))}const hw=new Te(Z.comparator),mw=new Me(Z.comparator);function he(...r){let e=mw;for(const t of r)e=e.add(t);return e}const pw=new Me(de);function fw(){return pw}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cl(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ia(e)?"-0":e}}function Im(r){return{integerValue:""+r}}function gw(r,e){return qv(e)?Im(e):Cl(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(){this._=void 0}}function xw(r,e,t){return r instanceof ua?function(i,a){const l={fields:{[cm]:{stringValue:lm},[dm]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Tl(a)&&(a=Ra(a)),a&&(l.fields[um]=a),{mapValue:l}}(t,e):r instanceof Bn?Am(r,e):r instanceof qn?Cm(r,e):function(i,a){const l=Sm(i,a),c=Bu(l)+Bu(i.Ae);return qo(l)&&qo(i.Ae)?Im(c):Cl(i.serializer,c)}(r,e)}function yw(r,e,t){return r instanceof Bn?Am(r,e):r instanceof qn?Cm(r,e):t}function Sm(r,e){return r instanceof da?function(n){return qo(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class ua extends La{}class Bn extends La{constructor(e){super(),this.elements=e}}function Am(r,e){const t=km(e);for(const n of r.elements)t.some(i=>Dt(i,n))||t.push(n);return{arrayValue:{values:t}}}class qn extends La{constructor(e){super(),this.elements=e}}function Cm(r,e){let t=km(e);for(const n of r.elements)t=t.filter(i=>!Dt(i,n));return{arrayValue:{values:t}}}class da extends La{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Bu(r){return Ce(r.integerValue||r.doubleValue)}function km(r){return Il(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function bw(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Bn&&i instanceof Bn||n instanceof qn&&i instanceof qn?Lr(n.elements,i.elements,Dt):n instanceof da&&i instanceof da?Dt(n.Ae,i.Ae):n instanceof ua&&i instanceof ua}(r.transform,e.transform)}class vw{constructor(e,t){this.version=e,this.transformResults=t}}class Ct{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ct}static exists(e){return new Ct(void 0,e)}static updateTime(e){return new Ct(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function $i(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Va{}function Rm(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new kl(r.key,Ct.none()):new Jn(r.key,r.data,Ct.none());{const t=r.data,n=ht.empty();let i=new Me(ze.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?n.delete(a):n.set(a,l),i=i.add(a)}return new cr(r.key,n,new wt(i.toArray()),Ct.none())}}function ww(r,e,t){r instanceof Jn?function(i,a,l){const c=i.value.clone(),u=zu(i.fieldTransforms,a,l.transformResults);c.setAll(u),a.convertToFoundDocument(l.version,c).setHasCommittedMutations()}(r,e,t):r instanceof cr?function(i,a,l){if(!$i(i.precondition,a))return void a.convertToUnknownDocument(l.version);const c=zu(i.fieldTransforms,a,l.transformResults),u=a.data;u.setAll(Pm(i)),u.setAll(c),a.convertToFoundDocument(l.version,u).setHasCommittedMutations()}(r,e,t):function(i,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,t)}function In(r,e,t,n){return r instanceof Jn?function(a,l,c,u){if(!$i(a.precondition,l))return c;const h=a.value.clone(),p=$u(a.fieldTransforms,u,l);return h.setAll(p),l.convertToFoundDocument(l.version,h).setHasLocalMutations(),null}(r,e,t,n):r instanceof cr?function(a,l,c,u){if(!$i(a.precondition,l))return c;const h=$u(a.fieldTransforms,u,l),p=l.data;return p.setAll(Pm(a)),p.setAll(h),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(g=>g.field))}(r,e,t,n):function(a,l,c){return $i(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c}(r,e,t)}function _w(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),a=Sm(n.transform,i||null);a!=null&&(t===null&&(t=ht.empty()),t.set(n.field,a))}return t||null}function qu(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Lr(n,i,(a,l)=>bw(a,l))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class Jn extends Va{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class cr extends Va{constructor(e,t,n,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Pm(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function zu(r,e,t){const n=new Map;ye(r.length===t.length,32656,{Re:t.length,Ve:r.length});for(let i=0;i<t.length;i++){const a=r[i],l=a.transform,c=e.data.field(a.field);n.set(a.field,yw(l,c,t[i]))}return n}function $u(r,e,t){const n=new Map;for(const i of r){const a=i.transform,l=t.data.field(i.field);n.set(i.field,xw(a,l,e))}return n}class kl extends Va{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class jw extends Va{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&ww(a,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=In(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=In(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Tm();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let c=this.applyToLocalView(l,a.mutatedFields);c=t.has(i.key)?null:c;const u=Rm(l,c);u!==null&&n.set(i.key,u),l.isValidDocument()||l.convertToNoDocument(ae.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),he())}isEqual(e){return this.batchId===e.batchId&&Lr(this.mutations,e.mutations,(t,n)=>qu(t,n))&&Lr(this.baseMutations,e.baseMutations,(t,n)=>qu(t,n))}}class Rl{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){ye(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return hw}();const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,n[l].version);return new Rl(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pe,pe;function Iw(r){switch(r){case U.OK:return se(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return se(15467,{code:r})}}function Dm(r){if(r===void 0)return Jt("GRPC error has no .code"),U.UNKNOWN;switch(r){case Pe.OK:return U.OK;case Pe.CANCELLED:return U.CANCELLED;case Pe.UNKNOWN:return U.UNKNOWN;case Pe.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case Pe.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case Pe.INTERNAL:return U.INTERNAL;case Pe.UNAVAILABLE:return U.UNAVAILABLE;case Pe.UNAUTHENTICATED:return U.UNAUTHENTICATED;case Pe.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case Pe.NOT_FOUND:return U.NOT_FOUND;case Pe.ALREADY_EXISTS:return U.ALREADY_EXISTS;case Pe.PERMISSION_DENIED:return U.PERMISSION_DENIED;case Pe.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case Pe.ABORTED:return U.ABORTED;case Pe.OUT_OF_RANGE:return U.OUT_OF_RANGE;case Pe.UNIMPLEMENTED:return U.UNIMPLEMENTED;case Pe.DATA_LOSS:return U.DATA_LOSS;default:return se(39323,{code:r})}}(pe=Pe||(Pe={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw=new bs([4294967295,4294967295],0);function Hu(r){const e=Sw().encode(r),t=new Qh;return t.update(e),new Uint8Array(t.digest())}function Gu(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new bs([t,n],0),new bs([i,a],0)]}class Pl{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new vn(`Invalid padding: ${t}`);if(n<0)throw new vn(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new vn(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new vn(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=bs.fromNumber(this.ge)}ye(e,t,n){let i=e.add(t.multiply(bs.fromNumber(n)));return i.compare(Aw)===1&&(i=new bs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Hu(e),[n,i]=Gu(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(n,i,a);if(!this.we(l))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new Pl(a,i,t);return n.forEach(c=>l.insert(c)),l}insert(e){if(this.ge===0)return;const t=Hu(e),[n,i]=Gu(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(n,i,a);this.Se(l)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class vn extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,t,n,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Zn.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Ma(ae.min(),i,new Te(de),Zt(),he())}}class Zn{constructor(e,t,n,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Zn(n,t,he(),he(),he())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,t,n,i){this.be=e,this.removedTargetIds=t,this.key=n,this.De=i}}class Om{constructor(e,t){this.targetId=e,this.Ce=t}}class Lm{constructor(e,t,n=We.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Wu{constructor(){this.ve=0,this.Fe=Ku(),this.Me=We.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=he(),t=he(),n=he();return this.Fe.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:se(38017,{changeType:a})}}),new Zn(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Ku()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ye(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Cw{constructor(e){this.Ge=e,this.ze=new Map,this.je=Zt(),this.Je=Ri(),this.He=Ri(),this.Ye=new Te(de)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:se(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((n,i)=>{this.rt(i)&&t(i)})}st(e){const t=e.targetId,n=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if($o(a))if(n===0){const l=new Z(a.path);this.et(t,l,Ze.newNoDocument(l,ae.min()))}else ye(n===1,20013,{expectedCount:n});else{const l=this._t(t);if(l!==n){const c=this.ut(e),u=c?this.ct(c,e,l):1;if(u!==0){this.it(t);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=t;let l,c;try{l=Es(n).toUint8Array()}catch(u){if(u instanceof om)return Or("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Pl(l,i,a)}catch(u){return Or(u instanceof vn?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let i=0;return n.forEach(a=>{const l=this.Ge.ht(),c=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)}),i}Tt(e){const t=new Map;this.ze.forEach((a,l)=>{const c=this.ot(l);if(c){if(a.current&&$o(c.target)){const u=new Z(c.target.path);this.It(u).has(l)||this.Et(l,u)||this.et(l,u,Ze.newNoDocument(u,e))}a.Be&&(t.set(l,a.ke()),a.qe())}});let n=he();this.He.forEach((a,l)=>{let c=!0;l.forEachWhile(u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(a))}),this.je.forEach((a,l)=>l.setReadTime(e));const i=new Ma(e,t,this.Ye,this.je,n);return this.je=Zt(),this.Je=Ri(),this.He=Ri(),this.Ye=new Te(de),i}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Wu,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Me(de),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Me(de),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||K("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Wu),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ri(){return new Te(Z.comparator)}function Ku(){return new Te(Z.comparator)}const kw={asc:"ASCENDING",desc:"DESCENDING"},Rw={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Pw={and:"AND",or:"OR"};class Dw{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Go(r,e){return r.useProto3Json||ka(e)?e:{value:e}}function ha(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vm(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function Ow(r,e){return ha(r,e.toTimestamp())}function kt(r){return ye(!!r,49232),ae.fromTimestamp(function(t){const n=Ns(t);return new Ne(n.seconds,n.nanos)}(r))}function Dl(r,e){return Wo(r,e).canonicalString()}function Wo(r,e){const t=function(i){return new je(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function Mm(r){const e=je.fromString(r);return ye(zm(e),10190,{key:e.toString()}),e}function Ko(r,e){return Dl(r.databaseId,e.path)}function go(r,e){const t=Mm(e);if(t.get(1)!==r.databaseId.projectId)throw new Y(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Y(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Z(Um(t))}function Fm(r,e){return Dl(r.databaseId,e)}function Lw(r){const e=Mm(r);return e.length===4?je.emptyPath():Um(e)}function Qo(r){return new je(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function Um(r){return ye(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function Qu(r,e,t){return{name:Ko(r,e),fields:t.value.mapValue.fields}}function Vw(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:se(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(h,p){return h.useProto3Json?(ye(p===void 0||typeof p=="string",58123),We.fromBase64String(p||"")):(ye(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),We.fromUint8Array(p||new Uint8Array))}(r,e.targetChange.resumeToken),l=e.targetChange.cause,c=l&&function(h){const p=h.code===void 0?U.UNKNOWN:Dm(h.code);return new Y(p,h.message||"")}(l);t=new Lm(n,i,a,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=go(r,n.document.name),a=kt(n.document.updateTime),l=n.document.createTime?kt(n.document.createTime):ae.min(),c=new ht({mapValue:{fields:n.document.fields}}),u=Ze.newFoundDocument(i,a,l,c),h=n.targetIds||[],p=n.removedTargetIds||[];t=new Hi(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=go(r,n.document),a=n.readTime?kt(n.readTime):ae.min(),l=Ze.newNoDocument(i,a),c=n.removedTargetIds||[];t=new Hi([],c,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=go(r,n.document),a=n.removedTargetIds||[];t=new Hi([],a,i,null)}else{if(!("filter"in e))return se(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,l=new Tw(i,a),c=n.targetId;t=new Om(c,l)}}return t}function Mw(r,e){let t;if(e instanceof Jn)t={update:Qu(r,e.key,e.value)};else if(e instanceof kl)t={delete:Ko(r,e.key)};else if(e instanceof cr)t={update:Qu(r,e.key,e.data),updateMask:Ww(e.fieldMask)};else{if(!(e instanceof jw))return se(16599,{Vt:e.type});t={verify:Ko(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(a,l){const c=l.transform;if(c instanceof ua)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Bn)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof qn)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof da)return{fieldPath:l.field.canonicalString(),increment:c.Ae};throw se(20930,{transform:l.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:Ow(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:se(27497)}(r,e.precondition)),t}function Fw(r,e){return r&&r.length>0?(ye(e!==void 0,14353),r.map(t=>function(i,a){let l=i.updateTime?kt(i.updateTime):kt(a);return l.isEqual(ae.min())&&(l=kt(a)),new vw(l,i.transformResults||[])}(t,e))):[]}function Uw(r,e){return{documents:[Fm(r,e.path)]}}function Bw(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Fm(r,i);const a=function(h){if(h.length!==0)return qm(Ot.create(h,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const l=function(h){if(h.length!==0)return h.map(p=>function(y){return{field:_r(y.field),direction:$w(y.dir)}}(p))}(e.orderBy);l&&(t.structuredQuery.orderBy=l);const c=Go(r,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:t,parent:i}}function qw(r){let e=Lw(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){ye(n===1,65062);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let a=[];t.where&&(a=function(g){const y=Bm(g);return y instanceof Ot&&xm(y)?y.getFilters():[y]}(t.where));let l=[];t.orderBy&&(l=function(g){return g.map(y=>function(C){return new ca(jr(C.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(y))}(t.orderBy));let c=null;t.limit&&(c=function(g){let y;return y=typeof g=="object"?g.value:g,ka(y)?null:y}(t.limit));let u=null;t.startAt&&(u=function(g){const y=!!g.before,w=g.values||[];return new la(w,y)}(t.startAt));let h=null;return t.endAt&&(h=function(g){const y=!g.before,w=g.values||[];return new la(w,y)}(t.endAt)),aw(e,i,l,a,c,"F",u,h)}function zw(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return se(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Bm(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=jr(t.unaryFilter.field);return Ve.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=jr(t.unaryFilter.field);return Ve.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=jr(t.unaryFilter.field);return Ve.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=jr(t.unaryFilter.field);return Ve.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return se(61313);default:return se(60726)}}(r):r.fieldFilter!==void 0?function(t){return Ve.create(jr(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return se(58110);default:return se(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return Ot.create(t.compositeFilter.filters.map(n=>Bm(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return se(1026)}}(t.compositeFilter.op))}(r):se(30097,{filter:r})}function $w(r){return kw[r]}function Hw(r){return Rw[r]}function Gw(r){return Pw[r]}function _r(r){return{fieldPath:r.canonicalString()}}function jr(r){return ze.fromServerFormat(r.fieldPath)}function qm(r){return r instanceof Ve?function(t){if(t.op==="=="){if(Lu(t.value))return{unaryFilter:{field:_r(t.field),op:"IS_NAN"}};if(Ou(t.value))return{unaryFilter:{field:_r(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Lu(t.value))return{unaryFilter:{field:_r(t.field),op:"IS_NOT_NAN"}};if(Ou(t.value))return{unaryFilter:{field:_r(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_r(t.field),op:Hw(t.op),value:t.value}}}(r):r instanceof Ot?function(t){const n=t.getFilters().map(i=>qm(i));return n.length===1?n[0]:{compositeFilter:{op:Gw(t.op),filters:n}}}(r):se(54877,{filter:r})}function Ww(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function zm(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,t,n,i,a=ae.min(),l=ae.min(),c=We.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new ps(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e){this.yt=e}}function Qw(r){const e=qw({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Ho(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(){this.Cn=new Yw}addToCollectionParentIndex(e,t){return this.Cn.add(t),F.resolve()}getCollectionParents(e,t){return F.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return F.resolve()}deleteFieldIndex(e,t){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,t){return F.resolve()}getDocumentsMatchingTarget(e,t){return F.resolve(null)}getIndexType(e,t){return F.resolve(0)}getFieldIndexes(e,t){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,t){return F.resolve(js.min())}getMinOffsetFromCollectionGroup(e,t){return F.resolve(js.min())}updateCollectionGroup(e,t,n){return F.resolve()}updateIndexEntries(e,t){return F.resolve()}}class Yw{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new Me(je.comparator),a=!i.has(n);return this.index[t]=i.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Me(je.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$m=41943040;class it{static withCacheSize(e){return new it(e,it.DEFAULT_COLLECTION_PERCENTILE,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */it.DEFAULT_COLLECTION_PERCENTILE=10,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,it.DEFAULT=new it($m,it.DEFAULT_COLLECTION_PERCENTILE,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),it.DISABLED=new it(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Fr(0)}static cr(){return new Fr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu="LruGarbageCollector",Jw=1048576;function Ju([r,e],[t,n]){const i=de(r,t);return i===0?de(e,n):i}class Zw{constructor(e){this.Ir=e,this.buffer=new Me(Ju),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Ju(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class e_{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){K(Yu,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Hr(t)?K(Yu,"Ignoring IndexedDB error during garbage collection: ",t):await $r(t)}await this.Vr(3e5)})}}class t_{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return F.resolve(Ca.ce);const n=new Zw(t);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(Xu)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Xu):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,i,a,l,c,u,h;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,l=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(n=g,c=Date.now(),this.removeTargets(e,n,t))).next(g=>(a=g,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(g=>(h=Date.now(),vr()<=ue.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${i} in `+(c-l)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-p}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:g})))}}function s_(r,e){return new t_(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(){this.changes=new lr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ze.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?F.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&In(n.mutation,i,wt.empty(),Ne.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,he()).next(()=>n))}getLocalViewOfDocuments(e,t,n=he()){const i=$s();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(a=>{let l=bn();return a.forEach((c,u)=>{l=l.insert(c,u.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const n=$s();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,he()))}populateOverlays(e,t,n){const i=[];return n.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,c)=>{t.set(l,c)})})}computeViews(e,t,n,i){let a=Zt();const l=Tn(),c=function(){return Tn()}();return t.forEach((u,h)=>{const p=n.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof cr)?a=a.insert(h.key,h):p!==void 0?(l.set(h.key,p.mutation.getFieldMask()),In(p.mutation,h,p.mutation.getFieldMask(),Ne.now())):l.set(h.key,wt.empty())}),this.recalculateAndSaveOverlays(e,a).next(u=>(u.forEach((h,p)=>l.set(h,p)),t.forEach((h,p)=>c.set(h,new n_(p,l.get(h)??null))),c))}recalculateAndSaveOverlays(e,t){const n=Tn();let i=new Te((l,c)=>l-c),a=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const c of l)c.keys().forEach(u=>{const h=t.get(u);if(h===null)return;let p=n.get(u)||wt.empty();p=c.applyToLocalView(h,p),n.set(u,p);const g=(i.get(c.batchId)||he()).add(u);i=i.insert(c.batchId,g)})}).next(()=>{const l=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,p=u.value,g=Tm();p.forEach(y=>{if(!a.has(y)){const w=Rm(t.get(y),n.get(y));w!==null&&g.set(y,w),a=a.add(y)}}),l.push(this.documentOverlayCache.saveOverlays(e,h,g))}return F.waitFor(l)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(l){return Z.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ow(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-a.size):F.resolve($s());let c=Vn,u=a;return l.next(h=>F.forEach(h,(p,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),a.get(p)?F.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{u=u.insert(p,y)}))).next(()=>this.populateOverlays(e,h,a)).next(()=>this.computeViews(e,u,h,he())).next(p=>({batchId:c,changes:Em(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Z(t)).next(n=>{let i=bn();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const a=t.collectionGroup;let l=bn();return this.indexManager.getCollectionParents(e,a).next(c=>F.forEach(c,u=>{const h=function(g,y){return new Pa(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(t,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(p=>{p.forEach((g,y)=>{l=l.insert(g,y)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,t,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,i))).next(l=>{a.forEach((u,h)=>{const p=h.getKey();l.get(p)===null&&(l=l.insert(p,Ze.newInvalidDocument(p)))});let c=bn();return l.forEach((u,h)=>{const p=a.get(u);p!==void 0&&In(p.mutation,h,wt.empty(),Ne.now()),Oa(t,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return F.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:kt(i.createTime)}}(t)),F.resolve()}getNamedQuery(e,t){return F.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(i){return{name:i.name,query:Qw(i.bundledQuery),readTime:kt(i.readTime)}}(t)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(){this.overlays=new Te(Z.comparator),this.qr=new Map}getOverlay(e,t){return F.resolve(this.overlays.get(t))}getOverlays(e,t){const n=$s();return F.forEach(t,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,a)=>{this.St(e,t,a)}),F.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),F.resolve()}getOverlaysForCollection(e,t,n){const i=$s(),a=t.length+1,l=new Z(t.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===a&&u.largestBatchId>n&&i.set(u.getKey(),u)}return F.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let a=new Te((h,p)=>h-p);const l=this.overlays.getIterator();for(;l.hasNext();){const h=l.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let p=a.get(h.largestBatchId);p===null&&(p=$s(),a=a.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const c=$s(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>c.set(h,p)),!(c.size()>=i)););return F.resolve(c)}St(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new Ew(t,n));let a=this.qr.get(t);a===void 0&&(a=he(),this.qr.set(t,a)),this.qr.set(t,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(){this.sessionToken=We.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(){this.Qr=new Me(Fe.$r),this.Ur=new Me(Fe.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Fe(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new Fe(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){const t=new Z(new je([])),n=new Fe(t,e),i=new Fe(t,e+1),a=[];return this.Ur.forEachInRange([n,i],l=>{this.Gr(l),a.push(l.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Z(new je([])),n=new Fe(t,e),i=new Fe(t,e+1);let a=he();return this.Ur.forEachInRange([n,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new Fe(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Fe{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Z.comparator(e.key,t.key)||de(e.Yr,t.Yr)}static Kr(e,t){return de(e.Yr,t.Yr)||Z.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Me(Fe.$r)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new Nw(a,t,n,i);this.mutationQueue.push(l);for(const c of i)this.Zr=this.Zr.add(new Fe(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return F.resolve(l)}lookupMutationBatch(e,t){return F.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.ei(n),a=i<0?0:i;return F.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?El:this.tr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Fe(t,0),i=new Fe(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],l=>{const c=this.Xr(l.Yr);a.push(c)}),F.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Me(de);return t.forEach(i=>{const a=new Fe(i,0),l=new Fe(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],c=>{n=n.add(c.Yr)})}),F.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let a=n;Z.isDocumentKey(a)||(a=a.child(""));const l=new Fe(new Z(a),0);let c=new Me(de);return this.Zr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Yr)),!0)},l),F.resolve(this.ti(c))}ti(e){const t=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ye(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return F.forEach(t.mutations,i=>{const a=new Fe(i.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Fe(t,0),i=this.Zr.firstAfterOrEqual(n);return F.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e){this.ri=e,this.docs=function(){return new Te(Z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),a=i?i.size:0,l=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return F.resolve(n?n.document.mutableCopy():Ze.newInvalidDocument(t))}getEntries(e,t){let n=Zt();return t.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Ze.newInvalidDocument(i))}),F.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let a=Zt();const l=t.path,c=new Z(l.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!l.isPrefixOf(h.path))break;h.path.length>l.length+1||Mv(Vv(p),n)<=0||(i.has(p.key)||Oa(t,p))&&(a=a.insert(p.key,p.mutableCopy()))}return F.resolve(a)}getAllFromCollectionGroup(e,t,n,i){se(9500)}ii(e,t){return F.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new d_(this)}getSize(e){return F.resolve(this.size)}}class d_ extends r_{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),F.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e){this.persistence=e,this.si=new lr(t=>Sl(t),Al),this.lastRemoteSnapshotVersion=ae.min(),this.highestTargetId=0,this.oi=0,this._i=new Ol,this.targetCount=0,this.ai=Fr.ur()}forEachTarget(e,t){return this.si.forEach((n,i)=>t(i)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),F.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Fr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,F.resolve()}updateTargetData(e,t){return this.Pr(t),F.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,t,n){let i=0;const a=[];return this.si.forEach((l,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),F.waitFor(a).next(()=>i)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return F.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),F.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),F.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),F.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return F.resolve(n)}containsKey(e,t){return F.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ca(0),this.li=!1,this.li=!0,this.hi=new l_,this.referenceDelegate=e(this),this.Pi=new h_(this),this.indexManager=new Xw,this.remoteDocumentCache=function(i){return new u_(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new Kw(t),this.Ii=new a_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new o_,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new c_(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){K("MemoryPersistence","Starting transaction:",e);const i=new m_(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ai(e,t){return F.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class m_ extends Uv{constructor(e){super(),this.currentSequenceNumber=e}}class Ll{constructor(e){this.persistence=e,this.Ri=new Ol,this.Vi=null}static mi(e){return new Ll(e)}get fi(){if(this.Vi)return this.Vi;throw se(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),F.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),F.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),F.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.fi,n=>{const i=Z.fromPath(n);return this.gi(e,i).next(a=>{a||t.removeEntry(i,ae.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return F.or([()=>F.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class ma{constructor(e,t){this.persistence=e,this.pi=new lr(n=>zv(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=s_(this,t)}static mi(e,t){return new ma(e,t)}Ei(){}di(e){return F.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}pr(e,t){return F.forEach(this.pi,(n,i)=>this.br(e,n,i).next(a=>a?F.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,l=>this.br(e,l,t).next(c=>{c||(n++,a.removeEntry(l,ae.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),F.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),F.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=qi(e.data.value)),t}br(e,t,n){return F.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return F.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=i}static As(e,t){let n=he(),i=he();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Vl(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Dg()?8:Bv(et())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,i){const a={result:null};return this.ys(e,t).next(l=>{a.result=l}).next(()=>{if(!a.result)return this.ws(e,t,i,n).next(l=>{a.result=l})}).next(()=>{if(a.result)return;const l=new p_;return this.Ss(e,t,l).next(c=>{if(a.result=c,this.Vs)return this.bs(e,t,l,c.size)})}).next(()=>a.result)}bs(e,t,n,i){return n.documentReadCount<this.fs?(vr()<=ue.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",wr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),F.resolve()):(vr()<=ue.DEBUG&&K("QueryEngine","Query:",wr(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(vr()<=ue.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",wr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,At(t))):F.resolve())}ys(e,t){if(Uu(t))return F.resolve(null);let n=At(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Ho(t,null,"F"),n=At(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const l=he(...a);return this.ps.getDocuments(e,l).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.Ds(t,c);return this.Cs(t,h,l,u.readTime)?this.ys(e,Ho(t,null,"F")):this.vs(e,h,t,u)}))})))}ws(e,t,n,i){return Uu(t)||i.isEqual(ae.min())?F.resolve(null):this.ps.getDocuments(e,n).next(a=>{const l=this.Ds(t,a);return this.Cs(t,l,n,i)?F.resolve(null):(vr()<=ue.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wr(t)),this.vs(e,l,t,Lv(i,Vn)).next(c=>c))})}Ds(e,t){let n=new Me(jm(e));return t.forEach((i,a)=>{Oa(e,a)&&(n=n.add(a))}),n}Cs(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,n){return vr()<=ue.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",wr(t)),this.ps.getDocumentsMatchingQuery(e,t,js.min(),n)}vs(e,t,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ml="LocalStore",g_=3e8;class x_{constructor(e,t,n,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Te(de),this.xs=new lr(a=>Sl(a),Al),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new i_(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function y_(r,e,t,n){return new x_(r,e,t,n)}async function Gm(r,e){const t=oe(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(a=>{const l=[],c=[];let u=he();for(const h of i){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of a){c.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return t.localDocuments.getDocuments(n,u).next(h=>({Ls:h,removedBatchIds:l,addedBatchIds:c}))})})}function b_(r,e){const t=oe(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,h,p){const g=h.batch,y=g.keys();let w=F.resolve();return y.forEach(C=>{w=w.next(()=>p.getEntry(u,C)).next(_=>{const N=h.docVersions.get(C);ye(N!==null,48541),_.version.compareTo(N)<0&&(g.applyToRemoteDocument(_,h),_.isValidDocument()&&(_.setReadTime(h.commitVersion),p.addEntry(_)))})}),w.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(t,n,e,a).next(()=>a.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=he();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function Wm(r){const e=oe(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function v_(r,e){const t=oe(r),n=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach((p,g)=>{const y=i.get(g);if(!y)return;c.push(t.Pi.removeMatchingKeys(a,p.removedDocuments,g).next(()=>t.Pi.addMatchingKeys(a,p.addedDocuments,g)));let w=y.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(g)!==null?w=w.withResumeToken(We.EMPTY_BYTE_STRING,ae.min()).withLastLimboFreeSnapshotVersion(ae.min()):p.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(p.resumeToken,n)),i=i.insert(g,w),function(_,N,R){return _.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=g_?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(y,w,p)&&c.push(t.Pi.updateTargetData(a,w))});let u=Zt(),h=he();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,p))}),c.push(w_(a,l,e.documentUpdates).next(p=>{u=p.ks,h=p.qs})),!n.isEqual(ae.min())){const p=t.Pi.getLastRemoteSnapshotVersion(a).next(g=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));c.push(p)}return F.waitFor(c).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,u,h)).next(()=>u)}).then(a=>(t.Ms=i,a))}function w_(r,e,t){let n=he(),i=he();return t.forEach(a=>n=n.add(a)),e.getEntries(r,n).next(a=>{let l=Zt();return t.forEach((c,u)=>{const h=a.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(ae.min())?(e.removeEntry(c,u.readTime),l=l.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),l=l.insert(c,u)):K(Ml,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{ks:l,qs:i}})}function __(r,e){const t=oe(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=El),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function j_(r,e){const t=oe(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Pi.getTargetData(n,e).next(a=>a?(i=a,F.resolve(i)):t.Pi.allocateTargetId(n).next(l=>(i=new ps(e,l,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n})}async function Xo(r,e,t){const n=oe(r),i=n.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",a,l=>n.persistence.referenceDelegate.removeTarget(l,i))}catch(l){if(!Hr(l))throw l;K(Ml,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Zu(r,e,t){const n=oe(r);let i=ae.min(),a=he();return n.persistence.runTransaction("Execute query","readwrite",l=>function(u,h,p){const g=oe(u),y=g.xs.get(p);return y!==void 0?F.resolve(g.Ms.get(y)):g.Pi.getTargetData(h,p)}(n,l,At(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,c.targetId).next(u=>{a=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(l,e,t?i:ae.min(),t?a:he())).next(c=>(N_(n,cw(e),c),{documents:c,Qs:a})))}function N_(r,e,t){let n=r.Os.get(e)||ae.min();t.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),r.Os.set(e,n)}class ed{constructor(){this.activeTargetIds=fw()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class E_{constructor(){this.Mo=new ed,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new ed,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td="ConnectivityMonitor";class sd{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){K(td,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){K(td,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pi=null;function Yo(){return Pi===null?Pi=function(){return 268435456+Math.round(2147483648*Math.random())}():Pi++,"0x"+Pi.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo="RestConnection",I_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class S_{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===aa?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,t,n,i,a){const l=Yo(),c=this.zo(e,t.toUriEncodedString());K(xo,`Sending RPC '${e}' ${l}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:h}=new URL(c),p=As(h);return this.Jo(e,c,u,n,p).then(g=>(K(xo,`Received RPC '${e}' ${l}: `,g),g),g=>{throw Or(xo,`RPC '${e}' ${l} failed with error: `,g,"url: ",c,"request:",n),g})}Ho(e,t,n,i,a,l){return this.Go(e,t,n,i,a)}jo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+zr}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}zo(e,t){const n=I_[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ye="WebChannelConnection";class C_ extends S_{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,i,a){const l=Yo();return new Promise((c,u)=>{const h=new Xh;h.setWithCredentials(!0),h.listenOnce(Yh.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Bi.NO_ERROR:const g=h.getResponseJson();K(Ye,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(g)),c(g);break;case Bi.TIMEOUT:K(Ye,`RPC '${e}' ${l} timed out`),u(new Y(U.DEADLINE_EXCEEDED,"Request time out"));break;case Bi.HTTP_ERROR:const y=h.getStatus();if(K(Ye,`RPC '${e}' ${l} failed with status:`,y,"response text:",h.getResponseText()),y>0){let w=h.getResponseJson();Array.isArray(w)&&(w=w[0]);const C=w?.error;if(C&&C.status&&C.message){const _=function(R){const k=R.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(k)>=0?k:U.UNKNOWN}(C.status);u(new Y(_,C.message))}else u(new Y(U.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Y(U.UNAVAILABLE,"Connection failed."));break;default:se(9055,{l_:e,streamId:l,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{K(Ye,`RPC '${e}' ${l} completed.`)}});const p=JSON.stringify(i);K(Ye,`RPC '${e}' ${l} sending request:`,i),h.send(t,"POST",p,n,15)})}T_(e,t,n){const i=Yo(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=em(),c=Zh(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const p=a.join("");K(Ye,`Creating RPC '${e}' stream ${i}: ${p}`,u);const g=l.createWebChannel(p,u);this.I_(g);let y=!1,w=!1;const C=new A_({Yo:N=>{w?K(Ye,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(y||(K(Ye,`Opening RPC '${e}' stream ${i} transport.`),g.open(),y=!0),K(Ye,`RPC '${e}' stream ${i} sending:`,N),g.send(N))},Zo:()=>g.close()}),_=(N,R,k)=>{N.listen(R,D=>{try{k(D)}catch(P){setTimeout(()=>{throw P},0)}})};return _(g,yn.EventType.OPEN,()=>{w||(K(Ye,`RPC '${e}' stream ${i} transport opened.`),C.o_())}),_(g,yn.EventType.CLOSE,()=>{w||(w=!0,K(Ye,`RPC '${e}' stream ${i} transport closed`),C.a_(),this.E_(g))}),_(g,yn.EventType.ERROR,N=>{w||(w=!0,Or(Ye,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),C.a_(new Y(U.UNAVAILABLE,"The operation could not be completed")))}),_(g,yn.EventType.MESSAGE,N=>{if(!w){const R=N.data[0];ye(!!R,16349);const k=R,D=k?.error||k[0]?.error;if(D){K(Ye,`RPC '${e}' stream ${i} received error:`,D);const P=D.status;let B=function(f){const v=Pe[f];if(v!==void 0)return Dm(v)}(P),L=D.message;B===void 0&&(B=U.INTERNAL,L="Unknown error status: "+P+" with message "+D.message),w=!0,C.a_(new Y(B,L)),g.close()}else K(Ye,`RPC '${e}' stream ${i} received:`,R),C.u_(R)}}),_(c,Jh.STAT_EVENT,N=>{N.stat===Fo.PROXY?K(Ye,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Fo.NOPROXY&&K(Ye,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function yo(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(r){return new Dw(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e,t,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-n);i>0&&K("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd="PersistentStream";class Qm{constructor(e,t,n,i,a,l,c,u){this.Mi=e,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Km(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===U.RESOURCE_EXHAUSTED?(Jt(t.toString()),Jt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===t&&this.G_(n,i)},n=>{e(()=>{const i=new Y(U.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return K(rd,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(K(rd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class k_ extends Qm{constructor(e,t,n,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Vw(this.serializer,e),n=function(a){if(!("targetChange"in a))return ae.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?ae.min():l.readTime?kt(l.readTime):ae.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Qo(this.serializer),t.addTarget=function(a,l){let c;const u=l.target;if(c=$o(u)?{documents:Uw(a,u)}:{query:Bw(a,u).ft},c.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){c.resumeToken=Vm(a,l.resumeToken);const h=Go(a,l.expectedCount);h!==null&&(c.expectedCount=h)}else if(l.snapshotVersion.compareTo(ae.min())>0){c.readTime=ha(a,l.snapshotVersion.toTimestamp());const h=Go(a,l.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=zw(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Qo(this.serializer),t.removeTarget=e,this.q_(t)}}class R_ extends Qm{constructor(e,t,n,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ye(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ye(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ye(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=Fw(e.writeResults,e.commitTime),n=kt(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Qo(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>Mw(this.serializer,n))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{}class D_ extends P_{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Y(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Go(e,Wo(t,n),i,a,l)).catch(a=>{throw a.name==="FirebaseError"?(a.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Y(U.UNKNOWN,a.toString())})}Ho(e,t,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,c])=>this.connection.Ho(e,Wo(t,n),i,l,c,a)).catch(l=>{throw l.name==="FirebaseError"?(l.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Y(U.UNKNOWN,l.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class O_{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Jt(t),this.aa=!1):K("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr="RemoteStore";class L_{constructor(e,t,n,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(l=>{n.enqueueAndForget(async()=>{ur(this)&&(K(nr,"Restarting streams for network reachability change."),await async function(u){const h=oe(u);h.Ea.add(4),await ei(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Ua(h)}(this))})}),this.Ra=new O_(n,i)}}async function Ua(r){if(ur(r))for(const e of r.da)await e(!0)}async function ei(r){for(const e of r.da)await e(!1)}function Xm(r,e){const t=oe(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ql(t)?Bl(t):Gr(t).O_()&&Ul(t,e))}function Fl(r,e){const t=oe(r),n=Gr(t);t.Ia.delete(e),n.O_()&&Ym(t,e),t.Ia.size===0&&(n.O_()?n.L_():ur(t)&&t.Ra.set("Unknown"))}function Ul(r,e){if(r.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ae.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Gr(r).Y_(e)}function Ym(r,e){r.Va.Ue(e),Gr(r).Z_(e)}function Bl(r){r.Va=new Cw({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),Gr(r).start(),r.Ra.ua()}function ql(r){return ur(r)&&!Gr(r).x_()&&r.Ia.size>0}function ur(r){return oe(r).Ea.size===0}function Jm(r){r.Va=void 0}async function V_(r){r.Ra.set("Online")}async function M_(r){r.Ia.forEach((e,t)=>{Ul(r,e)})}async function F_(r,e){Jm(r),ql(r)?(r.Ra.ha(e),Bl(r)):r.Ra.set("Unknown")}async function U_(r,e,t){if(r.Ra.set("Online"),e instanceof Lm&&e.state===2&&e.cause)try{await async function(i,a){const l=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,l),i.Ia.delete(c),i.Va.removeTarget(c))}(r,e)}catch(n){K(nr,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await pa(r,n)}else if(e instanceof Hi?r.Va.Ze(e):e instanceof Om?r.Va.st(e):r.Va.tt(e),!t.isEqual(ae.min()))try{const n=await Wm(r.localStore);t.compareTo(n)>=0&&await function(a,l){const c=a.Va.Tt(l);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=a.Ia.get(h);p&&a.Ia.set(h,p.withResumeToken(u.resumeToken,l))}}),c.targetMismatches.forEach((u,h)=>{const p=a.Ia.get(u);if(!p)return;a.Ia.set(u,p.withResumeToken(We.EMPTY_BYTE_STRING,p.snapshotVersion)),Ym(a,u);const g=new ps(p.target,u,h,p.sequenceNumber);Ul(a,g)}),a.remoteSyncer.applyRemoteEvent(c)}(r,t)}catch(n){K(nr,"Failed to raise snapshot:",n),await pa(r,n)}}async function pa(r,e,t){if(!Hr(e))throw e;r.Ea.add(1),await ei(r),r.Ra.set("Offline"),t||(t=()=>Wm(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{K(nr,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await Ua(r)})}function Zm(r,e){return e().catch(t=>pa(r,t,e))}async function Ba(r){const e=oe(r),t=Is(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:El;for(;B_(e);)try{const i=await __(e.localStore,n);if(i===null){e.Ta.length===0&&t.L_();break}n=i.batchId,q_(e,i)}catch(i){await pa(e,i)}ep(e)&&tp(e)}function B_(r){return ur(r)&&r.Ta.length<10}function q_(r,e){r.Ta.push(e);const t=Is(r);t.O_()&&t.X_&&t.ea(e.mutations)}function ep(r){return ur(r)&&!Is(r).x_()&&r.Ta.length>0}function tp(r){Is(r).start()}async function z_(r){Is(r).ra()}async function $_(r){const e=Is(r);for(const t of r.Ta)e.ea(t.mutations)}async function H_(r,e,t){const n=r.Ta.shift(),i=Rl.from(n,e,t);await Zm(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await Ba(r)}async function G_(r,e){e&&Is(r).X_&&await async function(n,i){if(function(l){return Iw(l)&&l!==U.ABORTED}(i.code)){const a=n.Ta.shift();Is(n).B_(),await Zm(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Ba(n)}}(r,e),ep(r)&&tp(r)}async function nd(r,e){const t=oe(r);t.asyncQueue.verifyOperationInProgress(),K(nr,"RemoteStore received new credentials");const n=ur(t);t.Ea.add(3),await ei(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Ua(t)}async function W_(r,e){const t=oe(r);e?(t.Ea.delete(2),await Ua(t)):e||(t.Ea.add(2),await ei(t),t.Ra.set("Unknown"))}function Gr(r){return r.ma||(r.ma=function(t,n,i){const a=oe(t);return a.sa(),new k_(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(r.datastore,r.asyncQueue,{Xo:V_.bind(null,r),t_:M_.bind(null,r),r_:F_.bind(null,r),H_:U_.bind(null,r)}),r.da.push(async e=>{e?(r.ma.B_(),ql(r)?Bl(r):r.Ra.set("Unknown")):(await r.ma.stop(),Jm(r))})),r.ma}function Is(r){return r.fa||(r.fa=function(t,n,i){const a=oe(t);return a.sa(),new R_(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(r.datastore,r.asyncQueue,{Xo:()=>Promise.resolve(),t_:z_.bind(null,r),r_:G_.bind(null,r),ta:$_.bind(null,r),na:H_.bind(null,r)}),r.da.push(async e=>{e?(r.fa.B_(),await Ba(r)):(await r.fa.stop(),r.Ta.length>0&&(K(nr,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))})),r.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,t,n,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new vs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,a){const l=Date.now()+n,c=new zl(e,t,l,i,a);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $l(r,e){if(Jt("AsyncQueue",`${e}: ${r}`),Hr(r))return new Y(U.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{static emptySet(e){return new Ar(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Z.comparator(t.key,n.key):(t,n)=>Z.comparator(t.key,n.key),this.keyedMap=bn(),this.sortedSet=new Te(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ar)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Ar;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(){this.ga=new Te(Z.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):se(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Ur{constructor(e,t,n,i,a,l,c,u,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,i,a){const l=[];return t.forEach(c=>{l.push({type:0,doc:c})}),new Ur(e,t,Ar.emptySet(t),l,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Da(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Q_{constructor(){this.queries=ad(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const i=oe(t),a=i.queries;i.queries=ad(),a.forEach((l,c)=>{for(const u of c.Sa)u.onError(n)})})(this,new Y(U.ABORTED,"Firestore shutting down"))}}function ad(){return new lr(r=>_m(r),Da)}async function X_(r,e){const t=oe(r);let n=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(n=2):(a=new K_,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(l){const c=$l(l,`Initialization of query '${wr(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&Hl(t)}async function Y_(r,e){const t=oe(r),n=e.query;let i=3;const a=t.queries.get(n);if(a){const l=a.Sa.indexOf(e);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function J_(r,e){const t=oe(r);let n=!1;for(const i of e){const a=i.query,l=t.queries.get(a);if(l){for(const c of l.Sa)c.Fa(i)&&(n=!0);l.wa=i}}n&&Hl(t)}function Z_(r,e,t){const n=oe(r),i=n.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);n.queries.delete(e)}function Hl(r){r.Ca.forEach(e=>{e.next()})}var Jo,od;(od=Jo||(Jo={})).Ma="default",od.Cache="cache";class ej{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Ur(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ur.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Jo.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e){this.key=e}}class rp{constructor(e){this.key=e}}class tj{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=he(),this.mutatedKeys=he(),this.eu=jm(e),this.tu=new Ar(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new id,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,g)=>{const y=i.get(p),w=Oa(this.query,g)?g:null,C=!!y&&this.mutatedKeys.has(y.key),_=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let N=!1;y&&w?y.data.isEqual(w.data)?C!==_&&(n.track({type:3,doc:w}),N=!0):this.su(y,w)||(n.track({type:2,doc:w}),N=!0,(u&&this.eu(w,u)>0||h&&this.eu(w,h)<0)&&(c=!0)):!y&&w?(n.track({type:0,doc:w}),N=!0):y&&!w&&(n.track({type:1,doc:y}),N=!0,(u||h)&&(c=!0)),N&&(w?(l=l.add(w),a=_?a.add(p):a.delete(p)):(l=l.delete(p),a=a.delete(p)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const p=this.query.limitType==="F"?l.last():l.first();l=l.delete(p.key),a=a.delete(p.key),n.track({type:1,doc:p})}return{tu:l,iu:n,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort((p,g)=>function(w,C){const _=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return se(20277,{Rt:N})}};return _(w)-_(C)}(p.type,g.type)||this.eu(p.doc,g.doc)),this.ou(n),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,h=u!==this.Za;return this.Za=u,l.length!==0||h?{snapshot:new Ur(this.query,e.tu,a,l,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new id,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=he(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const t=[];return e.forEach(n=>{this.Xa.has(n)||t.push(new rp(n))}),this.Xa.forEach(n=>{e.has(n)||t.push(new sp(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=he();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ur.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Gl="SyncEngine";class sj{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class rj{constructor(e){this.key=e,this.hu=!1}}class nj{constructor(e,t,n,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new lr(c=>_m(c),Da),this.Iu=new Map,this.Eu=new Set,this.du=new Te(Z.comparator),this.Au=new Map,this.Ru=new Ol,this.Vu={},this.mu=new Map,this.fu=Fr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function ij(r,e,t=!0){const n=cp(r);let i;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await np(n,e,t,!0),i}async function aj(r,e){const t=cp(r);await np(t,e,!0,!1)}async function np(r,e,t,n){const i=await j_(r.localStore,At(e)),a=i.targetId,l=r.sharedClientState.addLocalQueryTarget(a,t);let c;return n&&(c=await oj(r,e,a,l==="current",i.resumeToken)),r.isPrimaryClient&&t&&Xm(r.remoteStore,i),c}async function oj(r,e,t,n,i){r.pu=(g,y,w)=>async function(_,N,R,k){let D=N.view.ru(R);D.Cs&&(D=await Zu(_.localStore,N.query,!1).then(({documents:E})=>N.view.ru(E,D)));const P=k&&k.targetChanges.get(N.targetId),B=k&&k.targetMismatches.get(N.targetId)!=null,L=N.view.applyChanges(D,_.isPrimaryClient,P,B);return cd(_,N.targetId,L.au),L.snapshot}(r,g,y,w);const a=await Zu(r.localStore,e,!0),l=new tj(e,a.Qs),c=l.ru(a.documents),u=Zn.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),h=l.applyChanges(c,r.isPrimaryClient,u);cd(r,t,h.au);const p=new sj(e,t,l);return r.Tu.set(e,p),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),h.snapshot}async function lj(r,e,t){const n=oe(r),i=n.Tu.get(e),a=n.Iu.get(i.targetId);if(a.length>1)return n.Iu.set(i.targetId,a.filter(l=>!Da(l,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Xo(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&Fl(n.remoteStore,i.targetId),Zo(n,i.targetId)}).catch($r)):(Zo(n,i.targetId),await Xo(n.localStore,i.targetId,!0))}async function cj(r,e){const t=oe(r),n=t.Tu.get(e),i=t.Iu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Fl(t.remoteStore,n.targetId))}async function uj(r,e,t){const n=xj(r);try{const i=await function(l,c){const u=oe(l),h=Ne.now(),p=c.reduce((w,C)=>w.add(C.key),he());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",w=>{let C=Zt(),_=he();return u.Ns.getEntries(w,p).next(N=>{C=N,C.forEach((R,k)=>{k.isValidDocument()||(_=_.add(R))})}).next(()=>u.localDocuments.getOverlayedDocuments(w,C)).next(N=>{g=N;const R=[];for(const k of c){const D=_w(k,g.get(k.key).overlayedDocument);D!=null&&R.push(new cr(k.key,D,pm(D.value.mapValue),Ct.exists(!0)))}return u.mutationQueue.addMutationBatch(w,h,R,c)}).next(N=>{y=N;const R=N.applyToLocalDocumentSet(g,_);return u.documentOverlayCache.saveOverlays(w,N.batchId,R)})}).then(()=>({batchId:y.batchId,changes:Em(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(l,c,u){let h=l.Vu[l.currentUser.toKey()];h||(h=new Te(de)),h=h.insert(c,u),l.Vu[l.currentUser.toKey()]=h}(n,i.batchId,t),await ti(n,i.changes),await Ba(n.remoteStore)}catch(i){const a=$l(i,"Failed to persist write");t.reject(a)}}async function ip(r,e){const t=oe(r);try{const n=await v_(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.Au.get(a);l&&(ye(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?ye(l.hu,14607):i.removedDocuments.size>0&&(ye(l.hu,42227),l.hu=!1))}),await ti(t,n,e)}catch(n){await $r(n)}}function ld(r,e,t){const n=oe(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Tu.forEach((a,l)=>{const c=l.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(l,c){const u=oe(l);u.onlineState=c;let h=!1;u.queries.forEach((p,g)=>{for(const y of g.Sa)y.va(c)&&(h=!0)}),h&&Hl(u)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function dj(r,e,t){const n=oe(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Au.get(e),a=i&&i.key;if(a){let l=new Te(Z.comparator);l=l.insert(a,Ze.newNoDocument(a,ae.min()));const c=he().add(a),u=new Ma(ae.min(),new Map,new Te(de),l,c);await ip(n,u),n.du=n.du.remove(a),n.Au.delete(e),Wl(n)}else await Xo(n.localStore,e,!1).then(()=>Zo(n,e,t)).catch($r)}async function hj(r,e){const t=oe(r),n=e.batch.batchId;try{const i=await b_(t.localStore,e);op(t,n,null),ap(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await ti(t,i)}catch(i){await $r(i)}}async function mj(r,e,t){const n=oe(r);try{const i=await function(l,c){const u=oe(l);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(ye(g!==null,37113),p=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(n.localStore,e);op(n,e,t),ap(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await ti(n,i)}catch(i){await $r(i)}}function ap(r,e){(r.mu.get(e)||[]).forEach(t=>{t.resolve()}),r.mu.delete(e)}function op(r,e,t){const n=oe(r);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function Zo(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Ru.jr(e).forEach(n=>{r.Ru.containsKey(n)||lp(r,n)})}function lp(r,e){r.Eu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(Fl(r.remoteStore,t),r.du=r.du.remove(e),r.Au.delete(t),Wl(r))}function cd(r,e,t){for(const n of t)n instanceof sp?(r.Ru.addReference(n.key,e),pj(r,n)):n instanceof rp?(K(Gl,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,e),r.Ru.containsKey(n.key)||lp(r,n.key)):se(19791,{wu:n})}function pj(r,e){const t=e.key,n=t.path.canonicalString();r.du.get(t)||r.Eu.has(n)||(K(Gl,"New document in limbo: "+t),r.Eu.add(n),Wl(r))}function Wl(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new Z(je.fromString(e)),n=r.fu.next();r.Au.set(n,new rj(t)),r.du=r.du.insert(t,n),Xm(r.remoteStore,new ps(At(wm(t.path)),n,"TargetPurposeLimboResolution",Ca.ce))}}async function ti(r,e,t){const n=oe(r),i=[],a=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{l.push(n.pu(u,e,t).then(h=>{if((h||t)&&n.isPrimaryClient){const p=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;n.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(h){i.push(h);const p=Vl.As(u.targetId,h);a.push(p)}}))}),await Promise.all(l),n.Pu.H_(i),await async function(u,h){const p=oe(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>F.forEach(h,y=>F.forEach(y.Es,w=>p.persistence.referenceDelegate.addReference(g,y.targetId,w)).next(()=>F.forEach(y.ds,w=>p.persistence.referenceDelegate.removeReference(g,y.targetId,w)))))}catch(g){if(!Hr(g))throw g;K(Ml,"Failed to update sequence numbers: "+g)}for(const g of h){const y=g.targetId;if(!g.fromCache){const w=p.Ms.get(y),C=w.snapshotVersion,_=w.withLastLimboFreeSnapshotVersion(C);p.Ms=p.Ms.insert(y,_)}}}(n.localStore,a))}async function fj(r,e){const t=oe(r);if(!t.currentUser.isEqual(e)){K(Gl,"User change. New user:",e.toKey());const n=await Gm(t.localStore,e);t.currentUser=e,function(a,l){a.mu.forEach(c=>{c.forEach(u=>{u.reject(new Y(U.CANCELLED,l))})}),a.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ti(t,n.Ls)}}function gj(r,e){const t=oe(r),n=t.Au.get(e);if(n&&n.hu)return he().add(n.key);{let i=he();const a=t.Iu.get(e);if(!a)return i;for(const l of a){const c=t.Tu.get(l);i=i.unionWith(c.view.nu)}return i}}function cp(r){const e=oe(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=ip.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dj.bind(null,e),e.Pu.H_=J_.bind(null,e.eventManager),e.Pu.yu=Z_.bind(null,e.eventManager),e}function xj(r){const e=oe(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mj.bind(null,e),e}class fa{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Fa(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return y_(this.persistence,new f_,e.initialUser,this.serializer)}Cu(e){return new Hm(Ll.mi,this.serializer)}Du(e){return new E_}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fa.provider={build:()=>new fa};class yj extends fa{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ye(this.persistence.referenceDelegate instanceof ma,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new e_(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?it.withCacheSize(this.cacheSizeBytes):it.DEFAULT;return new Hm(n=>ma.mi(n,t),this.serializer)}}class el{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>ld(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=fj.bind(null,this.syncEngine),await W_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Q_}()}createDatastore(e){const t=Fa(e.databaseInfo.databaseId),n=function(a){return new C_(a)}(e.databaseInfo);return function(a,l,c,u){return new D_(a,l,c,u)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,a,l,c){return new L_(n,i,a,l,c)}(this.localStore,this.datastore,e.asyncQueue,t=>ld(this.syncEngine,t,0),function(){return sd.v()?new sd:new T_}())}createSyncEngine(e,t){return function(i,a,l,c,u,h,p){const g=new nj(i,a,l,c,u,h);return p&&(g.gu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(t){const n=oe(t);K(nr,"RemoteStore shutting down."),n.Ea.add(5),await ei(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}el.provider={build:()=>new el};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Jt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss="FirestoreClient";class vj{constructor(e,t,n,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Je.UNAUTHENTICATED,this.clientId=jl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async l=>{K(Ss,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(n,l=>(K(Ss,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=$l(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function bo(r,e){r.asyncQueue.verifyOperationInProgress(),K(Ss,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Gm(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function ud(r,e){r.asyncQueue.verifyOperationInProgress();const t=await wj(r);K(Ss,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>nd(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>nd(e.remoteStore,i)),r._onlineComponents=e}async function wj(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){K(Ss,"Using user provided OfflineComponentProvider");try{await bo(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Or("Error using user provided cache. Falling back to memory cache: "+t),await bo(r,new fa)}}else K(Ss,"Using default OfflineComponentProvider"),await bo(r,new yj(void 0));return r._offlineComponents}async function up(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(K(Ss,"Using user provided OnlineComponentProvider"),await ud(r,r._uninitializedComponentsProvider._online)):(K(Ss,"Using default OnlineComponentProvider"),await ud(r,new el))),r._onlineComponents}function _j(r){return up(r).then(e=>e.syncEngine)}async function jj(r){const e=await up(r),t=e.eventManager;return t.onListen=ij.bind(null,e.syncEngine),t.onUnlisten=lj.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=aj.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=cj.bind(null,e.syncEngine),t}function Nj(r,e,t={}){const n=new vs;return r.asyncQueue.enqueueAndForget(async()=>function(a,l,c,u,h){const p=new bj({next:y=>{p.Nu(),l.enqueueAndForget(()=>Y_(a,g)),y.fromCache&&u.source==="server"?h.reject(new Y(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new ej(c,p,{includeMetadataChanges:!0,qa:!0});return X_(a,g)}(await jj(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dp(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hp="firestore.googleapis.com",hd=!0;class md{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Y(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hp,this.ssl=hd}else this.host=e.host,this.ssl=e.ssl??hd;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$m;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Jw)throw new Y(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Ov("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dp(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Y(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Y(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Y(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qa{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new md({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Y(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Y(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new md(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Ev;switch(n.type){case"firstParty":return new Av(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Y(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=dd.get(t);n&&(K("ComponentProvider","Removing Datastore"),dd.delete(t),n.terminate())}(this),Promise.resolve()}}function Ej(r,e,t,n={}){r=Ln(r,qa);const i=As(e),a=r._getSettings(),l={...a,emulatorOptions:r._getEmulatorOptions()},c=`${e}:${t}`;i&&(nl(`https://${c}`),il("Firestore",!0)),a.host!==hp&&a.host!==c&&Or("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:n};if(!Js(u,l)&&(r._setSettings(u),n.mockUserToken)){let h,p;if(typeof n.mockUserToken=="string")h=n.mockUserToken,p=Je.MOCK_USER;else{h=zd(n.mockUserToken,r._app?.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new Y(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Je(g)}r._authCredentials=new Tv(new sm(h,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new za(this.firestore,e,this._query)}}class He{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ws(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new He(this.firestore,e,this._key)}toJSON(){return{type:He._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Yn(t,He._jsonSchema))return new He(e,n||null,new Z(je.fromString(t.referencePath)))}}He._jsonSchemaVersion="firestore/documentReference/1.0",He._jsonSchema={type:De("string",He._jsonSchemaVersion),referencePath:De("string")};class ws extends za{constructor(e,t,n){super(e,t,wm(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new He(this.firestore,null,new Z(e))}withConverter(e){return new ws(this.firestore,e,this._path)}}function pd(r,e,...t){if(r=Ge(r),rm("collection","path",e),r instanceof qa){const n=je.fromString(e,...t);return Iu(n),new ws(r,null,n)}{if(!(r instanceof He||r instanceof ws))throw new Y(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(je.fromString(e,...t));return Iu(n),new ws(r.firestore,null,n)}}function mp(r,e,...t){if(r=Ge(r),arguments.length===1&&(e=jl.newId()),rm("doc","path",e),r instanceof qa){const n=je.fromString(e,...t);return Tu(n),new He(r,null,new Z(n))}{if(!(r instanceof He||r instanceof ws))throw new Y(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(je.fromString(e,...t));return Tu(n),new He(r.firestore,r instanceof ws?r.converter:null,new Z(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd="AsyncQueue";class gd{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Km(this,"async_queue_retry"),this._c=()=>{const n=yo();n&&K(fd,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=yo();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=yo();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new vs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Hr(e))throw e;K(fd,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Jt("INTERNAL UNHANDLED ERROR: ",xd(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=zl.createAndSchedule(this,e,t,n,a=>this.hc(a));return this.tc.push(i),i}uc(){this.nc&&se(47125,{Pc:xd(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function xd(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}class $a extends qa{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new gd,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new gd(e),this._firestoreClient=void 0,await e}}}function Tj(r,e){const t=typeof r=="object"?r:ll(),n=typeof r=="string"?r:aa,i=Ta(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=Ud("firestore");a&&Ej(i,...a)}return i}function pp(r){if(r._terminated)throw new Y(U.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||Ij(r),r._firestoreClient}function Ij(r){const e=r._freezeSettings(),t=function(i,a,l,c){return new Gv(i,a,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,dp(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(r._databaseId,r._app?.options.appId||"",r._persistenceKey,e);r._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new vj(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mt(We.fromBase64String(e))}catch(t){throw new Y(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new mt(We.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:mt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yn(e,mt._jsonSchema))return mt.fromBase64String(e.bytes)}}mt._jsonSchemaVersion="firestore/bytes/1.0",mt._jsonSchema={type:De("string",mt._jsonSchemaVersion),bytes:De("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Y(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Y(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Y(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return de(this._lat,e._lat)||de(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Rt._jsonSchemaVersion}}static fromJSON(e){if(Yn(e,Rt._jsonSchema))return new Rt(e.latitude,e.longitude)}}Rt._jsonSchemaVersion="firestore/geoPoint/1.0",Rt._jsonSchema={type:De("string",Rt._jsonSchemaVersion),latitude:De("number"),longitude:De("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Pt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yn(e,Pt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Pt(e.vectorValues);throw new Y(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Pt._jsonSchemaVersion="firestore/vectorValue/1.0",Pt._jsonSchema={type:De("string",Pt._jsonSchemaVersion),vectorValues:De("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sj=/^__.*__$/;class Aj{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new cr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Jn(e,this.data,t,this.fieldTransforms)}}function gp(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw se(40011,{Ac:r})}}class Ql{constructor(e,t,n,i,a,l){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ql({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ga(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(gp(this.Ac)&&Sj.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Cj{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Fa(e)}Cc(e,t,n,i=!1){return new Ql({Ac:e,methodName:t,Dc:n,path:ze.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function kj(r){const e=r._freezeSettings(),t=Fa(r._databaseId);return new Cj(r._databaseId,!!e.ignoreUndefinedProperties,t)}function Rj(r,e,t,n,i,a={}){const l=r.Cc(a.merge||a.mergeFields?2:0,e,t,i);vp("Data must be an object, but it was:",l,n);const c=yp(n,l);let u,h;if(a.merge)u=new wt(l.fieldMask),h=l.fieldTransforms;else if(a.mergeFields){const p=[];for(const g of a.mergeFields){const y=Pj(e,g,t);if(!l.contains(y))throw new Y(U.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Oj(p,y)||p.push(y)}u=new wt(p),h=l.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=l.fieldTransforms;return new Aj(new ht(c),u,h)}function xp(r,e){if(bp(r=Ge(r)))return vp("Unsupported field value:",e,r),yp(r,e);if(r instanceof fp)return function(n,i){if(!gp(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const a=[];let l=0;for(const c of n){let u=xp(c,i.wc(l));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),l++}return{arrayValue:{values:a}}}(r,e)}return function(n,i){if((n=Ge(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return gw(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Ne.fromDate(n);return{timestampValue:ha(i.serializer,a)}}if(n instanceof Ne){const a=new Ne(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ha(i.serializer,a)}}if(n instanceof Rt)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof mt)return{bytesValue:Vm(i.serializer,n._byteString)};if(n instanceof He){const a=i.databaseId,l=n.firestore._databaseId;if(!l.isEqual(a))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Dl(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Pt)return function(l,c){return{mapValue:{fields:{[hm]:{stringValue:mm},[oa]:{arrayValue:{values:l.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Cl(c.serializer,h)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Nl(n)}`)}(r,e)}function yp(r,e){const t={};return am(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):or(r,(n,i)=>{const a=xp(i,e.mc(n));a!=null&&(t[n]=a)}),{mapValue:{fields:t}}}function bp(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Ne||r instanceof Rt||r instanceof mt||r instanceof He||r instanceof fp||r instanceof Pt)}function vp(r,e,t){if(!bp(t)||!nm(t)){const n=Nl(t);throw n==="an object"?e.Sc(r+" a custom object"):e.Sc(r+" "+n)}}function Pj(r,e,t){if((e=Ge(e))instanceof Kl)return e._internalPath;if(typeof e=="string")return wp(r,e);throw ga("Field path arguments must be of type string or ",r,!1,void 0,t)}const Dj=new RegExp("[~\\*/\\[\\]]");function wp(r,e,t){if(e.search(Dj)>=0)throw ga(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Kl(...e.split("."))._internalPath}catch{throw ga(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function ga(r,e,t,n,i){const a=n&&!n.isEmpty(),l=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||l)&&(u+=" (found",a&&(u+=` in field ${n}`),l&&(u+=` in document ${i}`),u+=")"),new Y(U.INVALID_ARGUMENT,c+r+u)}function Oj(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(e,t,n,i,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new He(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Lj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(jp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Lj extends _p{data(){return super.data()}}function jp(r,e){return typeof e=="string"?wp(r,e):e instanceof Kl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vj(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new Y(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Mj{convertValue(e,t="none"){switch(Ts(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ce(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Es(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw se(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return or(e,(i,a)=>{n[i]=this.convertValue(a,t)}),n}convertVectorValue(e){const t=e.fields?.[oa].arrayValue?.values?.map(n=>Ce(n.doubleValue));return new Pt(t)}convertGeoPoint(e){return new Rt(Ce(e.latitude),Ce(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ra(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Mn(e));default:return null}}convertTimestamp(e){const t=Ns(e);return new Ne(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=je.fromString(e);ye(zm(n),9688,{name:e});const i=new Fn(n.get(1),n.get(3)),a=new Z(n.popFirst(5));return i.isEqual(t)||Jt(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(r,e,t){let n;return n=r?r.toFirestore(e):e,n}class Di{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Cr extends _p{constructor(e,t,n,i,a,l){super(e,t,n,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Gi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(jp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Y(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Cr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Cr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Cr._jsonSchema={type:De("string",Cr._jsonSchemaVersion),bundleSource:De("string","DocumentSnapshot"),bundleName:De("string"),bundle:De("string")};class Gi extends Cr{data(e={}){return super.data(e)}}class kr{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Di(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Gi(this._firestore,this._userDataWriter,n.key,n,new Di(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Y(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map(c=>{const u=new Gi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Di(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:l++}})}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>a||c.type!==3).map(c=>{const u=new Gi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Di(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return c.type!==0&&(h=l.indexOf(c.doc.key),l=l.delete(c.doc.key)),c.type!==1&&(l=l.add(c.doc),p=l.indexOf(c.doc.key)),{type:Uj(c.type),doc:u,oldIndex:h,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Y(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=kr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jl.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(t.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Uj(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return se(61501,{type:r})}}kr._jsonSchemaVersion="firestore/querySnapshot/1.0",kr._jsonSchema={type:De("string",kr._jsonSchemaVersion),bundleSource:De("string","QuerySnapshot"),bundleName:De("string"),bundle:De("string")};class Bj extends Mj{constructor(e){super(),this.firestore=e}convertBytes(e){return new mt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new He(this.firestore,null,t)}}function qj(r){r=Ln(r,za);const e=Ln(r.firestore,$a),t=pp(e),n=new Bj(e);return Vj(r._query),Nj(t,r._query).then(i=>new kr(e,n,r,i))}function zj(r){return Np(Ln(r.firestore,$a),[new kl(r._key,Ct.none())])}function $j(r,e){const t=Ln(r.firestore,$a),n=mp(r),i=Fj(r.converter,e);return Np(t,[Rj(kj(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,Ct.exists(!1))]).then(()=>n)}function Np(r,e){return function(n,i){const a=new vs;return n.asyncQueue.enqueueAndForget(async()=>uj(await _j(n),i,a)),a.promise}(pp(r),e)}(function(e,t=!0){(function(i){zr=i})(ir),Zs(new _s("firestore",(n,{instanceIdentifier:i,options:a})=>{const l=n.getProvider("app").getImmediate(),c=new $a(new Iv(n.getProvider("auth-internal")),new Cv(l,n.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Y(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fn(h.options.projectId,p)}(l,i),l);return a={useFetchStreams:t,...a},c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),Tt(_u,ju,e),Tt(_u,ju,"esm2020")})();const Ep={apiKey:"AIzaSyCtpOMtw3GR5yZhokfVox8eP9Ldo5srLrE",authDomain:"mypictures-9dc8b.firebaseapp.com",projectId:"mypictures-9dc8b",storageBucket:"mypictures-9dc8b.firebasestorage.app",messagingSenderId:"722783244073",appId:"1:722783244073:web:e29da99ccd0602e2b3b138"},Xl=Wc().length===0?Gd(Ep):Wc()[0],Oi=jv(Xl),vo=Tj(Xl),Yl=iy(Xl);console.log("Firebase Storage configuré:",Yl);console.log("Storage bucket:",Ep.storageBucket);const Tp=({boatId:r,existingPeriods:e=[],onAvailabilityChange:t,isEditing:n=!1})=>{const[i,a]=S.useState(e),[l,c]=S.useState({startDate:"",endDate:"",notes:""}),[u,h]=S.useState(!1),[p,g]=S.useState(null),[y,w]=S.useState({}),[C,_]=S.useState("");S.useEffect(()=>{a(e)},[e]),S.useEffect(()=>{r&&e.length===0&&N()},[r,e.length]);const N=async()=>{try{console.log("🔄 Chargement des disponibilités pour le bateau:",r);const f=await fetch(`http://localhost:3001/api/boats/${r}/availability`);if(console.log("📡 Réponse du serveur:",f.status,f.statusText),f.ok){const v=await f.json();console.log("✅ Disponibilités chargées:",v),a(v)}else{console.error("❌ Erreur lors du chargement des disponibilités:",f.status,f.statusText),f.status===404?console.error("Bateau non trouvé"):f.status===500&&console.error("Erreur serveur");try{const v=await f.json();console.error("Détails de l'erreur:",v)}catch{console.error("Impossible de lire le message d'erreur")}}}catch(f){console.error("❌ Erreur lors du chargement des disponibilités:",f)}},R=()=>{if(console.log("🔄 Ajout d'une nouvelle période:",l),!l.startDate||!l.endDate){_("Veuillez remplir toutes les dates");return}if(new Date(l.startDate)>new Date(l.endDate)){_("La date de fin doit être égale ou postérieure à la date de début");return}if(console.log("✅ Validation des données réussie"),i.length>0){_("Une disponibilité existe déjà. Vous pouvez la modifier ou la supprimer.");return}const f={...l,id:Date.now(),boatId:r};console.log("📅 Période à ajouter:",f),console.log("📋 Périodes existantes avant ajout:",i),a([f]),_(""),t&&(console.log("📤 Notification au composant parent avec la nouvelle disponibilité"),t([f]))},k=()=>{a([]),_(""),t&&t([])},D=f=>{g(f.id||f._id),w({startDate:f.startDate.split("T")[0],endDate:f.endDate.split("T")[0],notes:f.notes||""})},P=()=>{if(!y.startDate||!y.endDate){_("Veuillez remplir toutes les dates");return}if(new Date(y.startDate)>new Date(y.endDate)){_("La date de fin doit être égale ou postérieure à la date de début");return}if(i.some(T=>{if(T.id===p||T._id===p)return!1;const A=new Date(y.startDate),j=new Date(y.endDate),b=new Date(T.startDate),M=new Date(T.endDate);return A<M&&j>b})){_("Cette période chevauche une période existante");return}const v=i.map(T=>T.id===p||T._id===p?{...T,startDate:y.startDate,endDate:y.endDate,notes:y.notes}:T);a(v),g(null),w({}),_(""),t&&t(v)},B=()=>{g(null),w({}),_("")},L=f=>new Date(f).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),E=(f,v)=>{const T=new Date(f),A=new Date(v);T.setHours(0,0,0,0),A.setHours(0,0,0,0);const b=(A.getTime()-T.getTime())/(1e3*60*60*24);return Math.max(1,Math.ceil(b))};return s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[s.jsx(rt,{className:"h-5 w-5 text-blue-600 mr-2"}),"Gestion de la disponibilité"]}),!u&&i.length===0&&s.jsxs("button",{onClick:()=>h(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(Gs,{className:"h-4 w-4"}),s.jsx("span",{children:"Ajouter une disponibilité"})]})]}),u&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Nouvelle période de disponibilité"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de début *"}),s.jsx("input",{type:"date",value:l.startDate,onChange:f=>c({...l,startDate:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:new Date().toISOString().split("T")[0]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin *"}),s.jsx("input",{type:"date",value:l.endDate,onChange:f=>c({...l,endDate:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:l.startDate||new Date().toISOString().split("T")[0]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),s.jsx("input",{type:"text",value:l.notes,onChange:f=>c({...l,notes:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Conditions spéciales..."})]})]}),(l.startDate||l.endDate)&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[s.jsx("h5",{className:"font-medium text-blue-900 mb-2 flex items-center",children:i.length>0?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-green-600 mr-2",children:"✅"}),"Disponibilité confirmée et visible ci-dessous"]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-blue-600 mr-2",children:"👁️"}),"Prévisualisation de la disponibilité"]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Période :"}),s.jsxs("p",{className:"text-blue-900",children:[l.startDate?L(l.startDate):"Non définie"," - ",l.endDate?L(l.endDate):"Non définie"]}),l.startDate&&l.endDate&&s.jsxs("span",{className:"text-xs text-blue-600",children:[E(l.startDate,l.endDate)," jours"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Notes :"}),s.jsx("p",{className:"text-blue-900",children:l.notes||"Aucune note"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Statut :"}),s.jsx("p",{className:"text-blue-900",children:i.length>0?"✅ Confirmée et visible":"⏳ En cours de saisie"})]})]}),i.length>0&&s.jsx("div",{className:"mt-3 p-2 bg-green-100 border border-green-300 rounded text-green-800 text-xs",children:'💡 La disponibilité a été confirmée ! Elle apparaît maintenant dans la section "Disponibilité actuelle" ci-dessous.'})]}),C&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-center space-x-2 text-red-800",children:[s.jsx(Hs,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:C})]})}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsxs("button",{onClick:R,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[s.jsx(Wi,{className:"h-4 w-4"}),s.jsx("span",{children:"Confirmer"})]}),s.jsxs("button",{onClick:()=>{h(!1),_(""),c({startDate:"",endDate:"",notes:""})},className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center space-x-2",children:[s.jsx(ke,{className:"h-4 w-4"}),s.jsx("span",{children:"Annuler"})]}),i.length>0&&s.jsxs("button",{onClick:()=>{h(!1),_(""),c({startDate:"",endDate:"",notes:""})},className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(ke,{className:"h-4 w-4"}),s.jsx("span",{children:"Fermer le formulaire"})]})]})]}),i.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(rt,{className:"h-5 w-5 text-green-600 mr-2"}),"Disponibilité actuelle"]}),s.jsx("div",{className:"space-y-3",children:i.map((f,v)=>s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[p===(f.id||f._id)?s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de début"}),s.jsx("input",{type:"date",value:y.startDate,onChange:T=>w({...y,startDate:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin"}),s.jsx("input",{type:"date",value:y.endDate,onChange:T=>w({...y,endDate:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),s.jsx("input",{type:"text",value:y.notes,onChange:T=>w({...y,notes:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}):s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-center",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-green-700",children:"Période"}),s.jsxs("p",{className:"text-green-900 font-semibold",children:[L(f.startDate)," - ",L(f.endDate)]}),s.jsxs("span",{className:"text-xs text-green-600",children:[E(f.startDate,f.endDate)," jours"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-green-700",children:"Notes"}),s.jsx("p",{className:"text-green-900",children:f.notes||"Aucune note"})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>D(f),className:"bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 transition-colors",title:"Modifier",children:s.jsx(Xi,{className:"h-4 w-4"})}),s.jsx("button",{onClick:k,className:"bg-red-600 text-white p-2 rounded-lg hover:bg-red-700 transition-colors",title:"Supprimer",children:s.jsx(ke,{className:"h-4 w-4"})})]})]}),p===(f.id||f._id)&&s.jsxs("div",{className:"flex space-x-3 mt-4",children:[s.jsxs("button",{onClick:P,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[s.jsx(Wi,{className:"h-4 w-4"}),s.jsx("span",{children:"Sauvegarder"})]}),s.jsxs("button",{onClick:B,className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center space-x-2",children:[s.jsx(ke,{className:"h-4 w-4"}),s.jsx("span",{children:"Annuler"})]})]})]},f.id||f._id||v))})]}),i.length===0&&!u&&s.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[s.jsx(rt,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),s.jsx("p",{className:"text-lg font-medium mb-2",children:"Aucune disponibilité définie"}),s.jsx("p",{className:"text-sm",children:'Cliquez sur "Ajouter une disponibilité" pour commencer'})]}),s.jsx("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Hs,{className:"h-5 w-5 text-yellow-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-yellow-800",children:[s.jsx("p",{className:"font-medium mb-1",children:"Gestion automatique des réservations"}),s.jsx("p",{children:"Les clients ne pourront réserver que pendant les périodes de disponibilité définies. Les dates déjà réservées seront automatiquement exclues des périodes disponibles."}),s.jsxs("p",{className:"mt-2 text-xs italic",children:["💡 ",s.jsx("strong",{children:"Conseil :"})," Définissez vos disponibilités avant d'ajouter le bateau pour une meilleure visibilité."]})]})]})})]})};function Ip({isOpen:r,onClose:e,onBoatAdded:t}){const[n,i]=S.useState({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:[]}),[a,l]=S.useState(null),[c,u]=S.useState(null),[h,p]=S.useState(""),[g,y]=S.useState(!1),[w,C]=S.useState([]),[_,N]=S.useState(!1),[R,k]=S.useState(""),[D,P]=S.useState(""),B=!!localStorage.getItem("token");console.log("🔍 AddBoat: État des disponibilités:",w);const L=["Climatisation","Wifi","Cuisine équipée","Salle de bain","Pont solarium","GPS","Radio VHF","Gilets de sauvetage","Équipement de pêche","Panneaux solaires"],E=M=>{const{name:Q,value:re,type:X,checked:ee}=M.target;i(X==="checkbox"?ee?ce=>({...ce,equipements:[...ce.equipements,re]}):ce=>({...ce,equipements:ce.equipements.filter(le=>le!==re)}):ce=>({...ce,[Q]:re}))},f=()=>{h.trim()&&!n.equipements.includes(h.trim())&&(i(M=>({...M,equipements:[...M.equipements,h.trim()]})),p(""))},v=M=>{i(Q=>({...Q,equipements:Q.equipements.filter(re=>re!==M)}))},T=M=>{M.key==="Enter"&&(M.preventDefault(),f())},A=M=>{const Q=M.target.files[0];if(Q){l(Q);const re=new FileReader;re.onload=X=>{u(X.target.result)},re.readAsDataURL(Q)}},j=M=>{console.log("📥 AddBoat: Mise à jour des disponibilités reçue:",M),C(M)},b=async M=>{M.preventDefault(),N(!0),k(""),P("");try{let Q="";if(a){const ce=ph(Yl,`boats/${Date.now()}_${a.name}`),le=await hh(ce,a);Q=await mh(le.ref)}const re={nom:n.nom,type:n.type,longueur:parseFloat(n.longueur),prix_jour:parseFloat(n.prix_jour),capacite:parseInt(n.capacite),image:Q,destination:n.destination,description:n.description,equipements:n.equipements,availability:w.length>0?{startDate:w[0].startDate,endDate:w[0].endDate,notes:w[0].notes||""}:null},X=localStorage.getItem("token");if(!X)throw new Error("Vous devez être connecté pour ajouter un bateau");console.log("🔄 Ajout du bateau dans MongoDB...");const ee=await bt(nt.BOATS,{method:"POST",headers:Li(X),body:JSON.stringify(re)});console.log("✅ Bateau ajouté avec succès:",ee),console.log("✅ Bateau créé avec succès:",ee),console.log("📋 Disponibilités incluses:",ee.availabilities),P("Bateau et disponibilités ajoutés avec succès !"),i({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:[]}),l(null),u(null),w.length>0&&(C([]),y(!1)),t&&t(ee),setTimeout(()=>{e()},2e3)}catch(Q){console.error("Erreur:",Q),k(Q.message||"Une erreur est survenue")}finally{N(!1)}};return r?B?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx(Gs,{className:"h-6 w-6 text-blue-600 mr-2"}),"Ajouter un nouveau bateau"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ke,{className:"h-6 w-6"})})]}),s.jsxs("form",{onSubmit:b,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du bateau *"}),s.jsx("input",{type:"text",name:"nom",value:n.nom,onChange:E,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nom du bateau"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de bateau *"}),s.jsxs("select",{name:"type",value:n.type,onChange:E,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"}),s.jsx("option",{value:"moteur",children:"Bateau à moteur"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longueur (mètres) *"}),s.jsx("input",{type:"number",name:"longueur",value:n.longueur,onChange:E,required:!0,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Longueur en mètres"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacité (personnes) *"}),s.jsx("input",{type:"number",name:"capacite",value:n.capacite,onChange:E,required:!0,min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de personnes"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prix par jour (€) *"}),s.jsx("input",{type:"number",name:"prix_jour",value:n.prix_jour,onChange:E,required:!0,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Prix en euros"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination *"}),s.jsx("input",{type:"text",name:"destination",value:n.destination,onChange:E,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Port d'attache"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),s.jsx("textarea",{name:"description",value:n.description,onChange:E,required:!0,rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description détaillée du bateau..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image du bateau"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:A,className:"hidden",id:"image-upload"}),s.jsxs("label",{htmlFor:"image-upload",className:"cursor-pointer bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(Td,{className:"h-4 w-4"}),s.jsx("span",{children:"Choisir une image"})]}),c&&s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:c,alt:"Aperçu",className:"w-20 h-20 object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{l(null),u(null)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600",children:s.jsx(ke,{className:"h-3 w-3"})})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Équipements disponibles"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:L.map(M=>s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",value:M,checked:n.equipements.includes(M),onChange:E,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:M})]},M))}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("input",{type:"text",value:h,onChange:M=>p(M.target.value),onKeyPress:T,placeholder:"Ajouter un équipement personnalisé",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("button",{type:"button",onClick:f,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"Ajouter"})]}),n.equipements.length>0&&s.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:n.equipements.map(M=>s.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[M,s.jsx("button",{type:"button",onClick:()=>v(M),className:"ml-2 text-blue-600 hover:text-blue-800",children:s.jsx(ke,{className:"h-3 w-3"})})]},M))})]}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(rt,{className:"h-5 w-5 text-blue-600 mr-2"}),"Gestion des disponibilités"]}),s.jsxs("button",{type:"button",onClick:()=>y(!g),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[g?s.jsx(ke,{className:"h-4 w-4"}):s.jsx(Gs,{className:"h-4 w-4"}),s.jsx("span",{children:g?"Masquer":"Gérer les disponibilités"})]})]}),g&&s.jsx(Tp,{boatId:null,onAvailabilityChange:j})]}),R&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-red-800",children:R})}),D&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsx("p",{className:"text-green-800",children:D})}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[s.jsx("button",{type:"button",onClick:e,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",disabled:_,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:_?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Ajout en cours..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Gs,{className:"h-4 w-4"}),s.jsx("span",{children:"Ajouter le bateau"})]})})]})]})]})})}):s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 text-center",children:[s.jsx("div",{className:"text-red-600 mb-4",children:s.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Connexion requise"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Vous devez être connecté pour ajouter un bateau."}),s.jsx("button",{onClick:e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Fermer"})]})}):null}function Hj({isOpen:r,onClose:e,onBoatUpdated:t,boatData:n}){const[i,a]=S.useState({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:[]}),[l,c]=S.useState(null),[u,h]=S.useState(null),[p,g]=S.useState(!1),[y,w]=S.useState(""),[C,_]=S.useState(!1),[N,R]=S.useState([]),[k,D]=S.useState(!1),[P,B]=S.useState(""),[L,E]=S.useState(""),f=!!localStorage.getItem("token"),v=["Climatisation","Wifi","Cuisine équipée","Salle de bain","Pont solarium","GPS","Radio VHF","Gilets de sauvetage","Équipement de pêche","Panneaux solaires"];S.useEffect(()=>{n&&r&&(a({nom:n.nom||"",type:n.type||"voilier",longueur:n.longueur||"",prix_jour:n.prix_jour||"",capacite:n.capacite||"",image:n.image||"",destination:n.destination||"",description:n.description||"",equipements:n.equipements||[]}),n.image&&h(n.image),c(null),g(!1),w(""),n.availability&&n.availability.startDate?(console.log("📋 Disponibilité trouvée dans le bateau:",n.availability),R([{startDate:n.availability.startDate.split("T")[0],endDate:n.availability.endDate.split("T")[0],price:n.availability.price,notes:n.availability.notes||""}])):(console.log("ℹ️ Aucune disponibilité trouvée dans le bateau"),R([])))},[n,r]);const T=X=>{const{name:ee,value:ce,type:le,checked:Oe}=X.target;a(le==="checkbox"?Oe?me=>({...me,equipements:[...me.equipements,ce]}):me=>({...me,equipements:me.equipements.filter(we=>we!==ce)}):me=>({...me,[ee]:ce}))},A=()=>{y.trim()&&!i.equipements.includes(y.trim())&&(a(X=>({...X,equipements:[...X.equipements,y.trim()]})),w(""))},j=X=>{a(ee=>({...ee,equipements:ee.equipements.filter(ce=>ce!==X)}))},b=X=>{X.key==="Enter"&&(X.preventDefault(),A())},M=X=>{const ee=X.target.files[0];if(ee){c(ee),g(!0);const ce=new FileReader;ce.onload=le=>{h(le.target.result)},ce.readAsDataURL(ee)}},Q=X=>{R(X)},re=async X=>{X.preventDefault(),D(!0),B(""),E("");try{const ee=localStorage.getItem("token");if(!ee)throw new Error("Vous devez être connecté pour modifier un bateau");if(!i.nom||!i.type||!i.longueur||!i.prix_jour||!i.capacite)throw new Error("Veuillez remplir tous les champs obligatoires");const ce={nom:i.nom,type:i.type,longueur:parseFloat(i.longueur),prix_jour:parseFloat(i.prix_jour),capacite:parseInt(i.capacite),destination:i.destination,description:i.description,equipements:i.equipements,availability:N.length>0?{startDate:N[0].startDate,endDate:N[0].endDate,price:parseFloat(N[0].price),notes:N[0].notes||""}:null};if(p&&l){const me=ph(Yl,`boats/${Date.now()}_${l.name}`),we=await hh(me,l),dr=await mh(we.ref);ce.image=dr}const le=await fetch(`http://localhost:3001/api/boats/${n._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ee}`},body:JSON.stringify(ce)});if(!le.ok){const me=await le.json();throw le.status===401?new Error("Vous devez être connecté pour modifier ce bateau"):le.status===403?new Error("Vous n'avez pas les permissions pour modifier ce bateau"):new Error(me.message||"Erreur lors de la modification du bateau")}const Oe=await le.json();console.log("✅ Bateau mis à jour avec succès:",Oe),console.log("📋 Disponibilités mises à jour:",Oe.availability),E("Bateau modifié avec succès !"),a({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:[]}),c(null),h(null),g(!1),w(""),R([]),_(!1),t&&t(Oe),setTimeout(()=>{e()},2e3)}catch(ee){console.error("Erreur:",ee),B(ee.message||"Une erreur est survenue")}finally{D(!1)}};return r?f?n?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx(Xi,{className:"h-6 w-6 text-blue-600 mr-2"}),"Modifier le bateau : ",n.nom]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ke,{className:"h-6 w-6"})})]}),s.jsxs("form",{onSubmit:re,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du bateau *"}),s.jsx("input",{type:"text",name:"nom",value:i.nom,onChange:T,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nom du bateau"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de bateau *"}),s.jsxs("select",{name:"type",value:i.type,onChange:T,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"}),s.jsx("option",{value:"moteur",children:"Bateau à moteur"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longueur (mètres) *"}),s.jsx("input",{type:"number",name:"longueur",value:i.longueur,onChange:T,required:!0,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Longueur en mètres"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacité (personnes) *"}),s.jsx("input",{type:"number",name:"capacite",value:i.capacite,onChange:T,required:!0,min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de personnes"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prix par jour (€) *"}),s.jsx("input",{type:"number",name:"prix_jour",value:i.prix_jour,onChange:T,required:!0,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Prix en euros"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination *"}),s.jsx("input",{type:"text",name:"destination",value:i.destination,onChange:T,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Port d'attache"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),s.jsx("textarea",{name:"description",value:i.description,onChange:T,required:!0,rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description détaillée du bateau..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image du bateau"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:M,className:"hidden",id:"image-upload-edit"}),s.jsxs("label",{htmlFor:"image-upload-edit",className:"cursor-pointer bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(Td,{className:"h-4 w-4"}),s.jsx("span",{children:p?"Changer l'image":"Modifier l'image"})]}),u&&s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:u,alt:"Aperçu",className:"w-20 h-20 object-cover rounded-lg"}),p&&s.jsx("button",{type:"button",onClick:()=>{c(null),h(n.image),g(!1)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600",children:s.jsx(ke,{className:"h-3 w-3"})})]})]}),!p&&n.image&&s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:`Image actuelle conservée. Cliquez sur "Modifier l'image" pour la changer.`})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Équipements disponibles"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:v.map(X=>s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",value:X,checked:i.equipements.includes(X),onChange:T,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:X})]},X))}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("input",{type:"text",value:y,onChange:X=>w(X.target.value),onKeyPress:b,placeholder:"Ajouter un équipement personnalisé",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("button",{type:"button",onClick:A,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"Ajouter"})]}),i.equipements.length>0&&s.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:i.equipements.map(X=>s.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[X,s.jsx("button",{type:"button",onClick:()=>j(X),className:"ml-2 text-blue-600 hover:text-blue-800",children:s.jsx(ke,{className:"h-3 w-3"})})]},X))})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{type:"button",onClick:()=>_(!C),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 font-medium",children:[s.jsx(rt,{className:"h-5 w-5"}),s.jsx("span",{children:"Gestion des disponibilités"})]}),C&&s.jsx("div",{className:"mt-4",children:s.jsx(Tp,{boatId:n._id,existingPeriods:N,onAvailabilityChange:Q,isEditing:!0})})]}),P&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-red-800",children:P})}),L&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsx("p",{className:"text-green-800",children:L})}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[s.jsx("button",{type:"button",onClick:e,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",disabled:k,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:k?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Mise à jour en cours..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Xi,{className:"h-4 w-4"}),s.jsx("span",{children:"Mettre à jour le bateau"})]})})]})]})]})})}):s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 text-center",children:[s.jsx("div",{className:"text-red-600 mb-4",children:s.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Données manquantes"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Les données du bateau ne sont pas disponibles."}),s.jsx("button",{onClick:e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Fermer"})]})}):s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 text-center",children:[s.jsx("div",{className:"text-red-600 mb-4",children:s.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Connexion requise"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Vous devez être connecté pour modifier un bateau."}),s.jsx("button",{onClick:e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Fermer"})]})}):null}function Gj(){const[r,e]=S.useState([]),[t,n]=S.useState(!1),[i,a]=S.useState(!1),[l,c]=S.useState(null),[u,h]=S.useState(!0),[p,g]=S.useState("");S.useEffect(()=>{y()},[]);const y=async()=>{try{h(!0);const P=localStorage.getItem("token");if(!P){g("Vous devez être connecté");return}const B=await fetch("http://localhost:3001/api/boats/my-boats",{headers:{Authorization:`Bearer ${P}`}});if(!B.ok)throw new Error("Erreur lors de la récupération des bateaux");const L=await B.json();e(L)}catch(P){g(P.message)}finally{h(!1)}},w=async P=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer ce bateau ?"))try{const B=localStorage.getItem("token");if(!(await fetch(`http://localhost:3001/api/boats/${P}`,{method:"DELETE",headers:{Authorization:`Bearer ${B}`}})).ok)throw new Error("Erreur lors de la suppression");e(r.filter(E=>E._id!==P))}catch(B){g(B.message)}},C=P=>{c(P),a(!0)},_=()=>{n(!0)},N=P=>{e([...r,P])},R=P=>{e(r.map(B=>B._id===P._id?P:B))},k=()=>{n(!1)},D=()=>{a(!1),c(null)};return u?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-24 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement des bateaux..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-24 flex flex-col items-center",children:[s.jsxs("div",{className:"w-full max-w-6xl bg-white rounded-2xl shadow-xl p-8",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("h2",{className:"text-3xl font-bold text-blue-700 flex items-center gap-3",children:[s.jsx($e,{className:"h-8 w-8"}),"Gestion de mes bateaux"]}),s.jsxs("button",{onClick:_,className:"inline-flex items-center space-x-2 bg-orange-500 text-white px-6 py-3 rounded-full font-bold hover:bg-orange-600 transition-colors shadow-lg",children:[s.jsx(Gs,{className:"h-5 w-5"}),"Ajouter un bateau"]})]}),p&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:p}),r.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx($e,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun bateau trouvé"}),s.jsx("p",{className:"text-gray-500",children:"Commencez par ajouter votre premier bateau !"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(P=>s.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"h-48 bg-gray-200 rounded-t-xl flex items-center justify-center",children:[P.image?s.jsx("img",{src:P.image,alt:P.nom,className:"w-full h-full object-cover rounded-t-xl",onError:B=>{B.target.style.display="none",B.target.nextSibling.style.display="flex"}}):null,s.jsx("div",{className:"hidden items-center justify-center text-gray-400",children:s.jsx(mf,{className:"h-12 w-12"})})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:P.nom}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx($e,{className:"h-4 w-4"}),s.jsx("span",{className:"capitalize",children:P.type})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(sl,{className:"h-4 w-4"}),s.jsxs("span",{children:[P.longueur,"m"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Xs,{className:"h-4 w-4"}),s.jsxs("span",{children:[P.capacite," personnes"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Ki,{className:"h-4 w-4"}),s.jsxs("span",{children:[P.prix_jour,"€/jour"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Gt,{className:"h-4 w-4"}),s.jsx("span",{children:P.localisation})]})]}),P.description&&s.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:P.description}),P.equipements&&P.equipements.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"Équipements :"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[P.equipements.slice(0,3).map((B,L)=>s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:B},L)),P.equipements.length>3&&s.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",P.equipements.length-3]})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-100",children:[s.jsxs("button",{onClick:()=>C(P),className:"flex items-center gap-2 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[s.jsx(Xi,{className:"h-4 w-4"}),"Modifier"]}),s.jsxs("button",{onClick:()=>w(P._id),className:"flex items-center gap-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[s.jsx(Ws,{className:"h-4 w-4"}),"Supprimer"]})]})]})]},P._id))})]}),s.jsx(Ip,{isOpen:t,onClose:k,onBoatAdded:N}),s.jsx(Hj,{isOpen:i,onClose:D,onBoatUpdated:R,boatData:l})]})}function Wj(){const r=es(),[e,t]=S.useState(!0),[n,i]=S.useState("");S.useEffect(()=>{a()},[]);const a=()=>{try{if(t(!0),!(localStorage.getItem("token")||sessionStorage.getItem("token"))){i("Vous devez être connecté pour ajouter un bateau"),t(!1);return}t(!1)}catch{i("Erreur lors de la vérification de l'authentification"),t(!1)}},l=u=>{console.log("Nouveau bateau ajouté:",u),r("/gestion-bateaux")},c=()=>{r("/gestion-bateaux")};return e?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(Kt,{className:"h-12 w-12 text-blue-500 animate-spin"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]}):n?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(Sn,{className:"h-16 w-16 text-red-500 mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Connexion requise"}),s.jsx("p",{className:"text-lg text-gray-800 mb-6",children:n}),s.jsx(G,{to:"/connexion",children:s.jsx("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})})]}):s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx(Br,{}),s.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-4xl",children:[s.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-6 text-center",children:"Ajouter un nouveau bateau"}),s.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Remplissez le formulaire ci-dessous pour ajouter votre bateau à notre plateforme de location."}),s.jsx(Ip,{isOpen:!0,onClose:c,onBoatAdded:l})]})}),s.jsx(Id,{})]})}function Kj(){const[r,e]=S.useState("overview"),[t,n]=S.useState([]),[i,a]=S.useState([]),[l,c]=S.useState(!0),[u,h]=S.useState(!1),[p,g]=S.useState(!1),[y,w]=S.useState(!1),[C,_]=S.useState(!1),[N,R]=S.useState(null),[k,D]=S.useState(null),[P,B]=S.useState(null),[L,E]=S.useState(null),[f,v]=S.useState(!1),[T,A]=S.useState([]),[j,b]=S.useState({nom:"",prenom:"",email:"",tel:"",role:"client",isProfessionnel:!1,siret:"",siren:""}),[M,Q]=S.useState({nom:"",prenom:"",email:"",tel:"",password:"",role:"client",isProfessionnel:!1,siret:"",siren:""}),[re,X]=S.useState({nom:"",type:"",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:""}),[ee,ce]=S.useState({totalUsers:0,totalBoats:0,totalBookings:0,totalReviews:0}),[le,Oe]=S.useState(1),[me]=S.useState(10),[we,dr]=S.useState(""),[ut,si]=S.useState("all"),[pt,ri]=S.useState("all"),[Ke,Vt]=S.useState({currentPage:1,totalPages:1,totalUsers:0,usersPerPage:10}),[hr,ts]=S.useState(1),[Wr]=S.useState(10),[mr,pr]=S.useState(""),[Rs,ni]=S.useState("all"),[fr,Kr]=S.useState("all"),[xe,ii]=S.useState({currentPage:1,totalPages:1,totalBoats:0,boatsPerPage:10}),[Ha,ss]=S.useState(1),[Qr]=S.useState(10),[Xr,Le]=S.useState(""),[Re,Ps]=S.useState("all"),[Ds,Yr]=S.useState("all"),[be,rs]=S.useState({currentPage:1,totalPages:1,totalReviews:0,reviewsPerPage:10});S.useEffect(()=>{dt(),ns(),jt()},[]),S.useEffect(()=>{(Rs!=="all"||fr!=="all")&&(ts(1),ns())},[Rs,fr]),S.useEffect(()=>{if(ut!=="all"||pt!=="all"){Oe(1);const I=new URLSearchParams({page:"1",limit:me.toString(),search:we,role:ut,status:pt}),H=localStorage.getItem("token");H&&fetch(`http://localhost:3001/api/auth/dashboard?${I}`,{headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"}}).then(q=>q.json()).then(q=>{n(q.allUsers.map(z=>({id:z._id,nom:z.nom,prenom:z.prenom,email:z.email,role:z.role,status:z.status||"actif",tel:z.tel||"",siret:z.siret||"",siren:z.siren||"",isProfessionnel:z.isProfessionnel||!1}))),q.pagination&&Vt(q.pagination)}).catch(q=>{console.error("Erreur lors du changement de filtre:",q),W.error("Erreur lors du changement de filtre")})}},[ut,pt]),S.useEffect(()=>{(Re!=="all"||Ds!=="all")&&(ss(1),jt())},[Re,Ds]);const dt=async()=>{try{c(!0);const I=localStorage.getItem("token");if(!I){W.error("Token d'authentification manquant"),window.location.href="/connexion";return}const H=new URLSearchParams({page:le.toString(),limit:me.toString(),search:we,role:ut,status:pt}),q=await fetch(`http://localhost:3001/api/auth/dashboard?${H}`,{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"}});if(!q.ok){if(q.status===401){W.error("Accès non autorisé"),window.location.href="/connexion";return}throw new Error("Erreur lors de la récupération des données")}const z=await q.json();let ie=[];try{const ne=await fetch("http://localhost:3001/api/boats",{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"}});ne.ok&&(ie=await ne.json()||[])}catch{}let ft=[];try{const ne=await fetch("http://localhost:3001/api/bookings?limit=1000",{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"}});ne.ok?(ft=(await ne.json()).data||[],console.log(`Récupération de ${ft.length} réservations depuis la base de données`)):console.log("Erreur API réservations:",ne.status,ne.statusText)}catch(ne){console.log("API des réservations non disponible:",ne.message)}let gt=0,Fs=[];for(const ne of ie)try{const Bt=await fetch(`http://localhost:3001/api/reviews/boat/${ne._id}`,{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"}});if(Bt.ok){const nn=(await Bt.json()).data||[];gt+=nn.length,Fs.push({...ne,reviews:nn,reviewCount:nn.length})}else Fs.push({...ne,reviews:[],reviewCount:0})}catch(Bt){console.log(`Erreur lors de la récupération des avis pour ${ne.nom}:`,Bt.message),Fs.push({...ne,reviews:[],reviewCount:0})}const hi=ie.length,rn=ft.length;ie.length===0?console.log("Aucun bateau trouvé dans la base de données"):console.log("Bateaux récupérés:",ie.map(ne=>({nom:ne.nom,type:ne.type,prix:ne.prix_jour}))),ft.length===0&&console.log("Aucune réservation trouvée dans la base de données"),ce({totalUsers:z.stats.totalUsers,totalBoats:hi,totalBookings:rn,totalReviews:gt}),n(z.allUsers.map(ne=>({id:ne._id,nom:ne.nom,prenom:ne.prenom,email:ne.email,role:ne.role,status:ne.status||"actif",tel:ne.tel||"",siret:ne.siret||"",siren:ne.siren||"",isProfessionnel:ne.isProfessionnel||!1}))),z.pagination&&Vt(z.pagination),a(Fs.map(ne=>({id:ne._id,nom:ne.nom,type:ne.type,longueur:ne.longueur,capacite:ne.capacite,prix:ne.prix_jour,localisation:ne.localisation,status:ne.disponible?"disponible":"indisponible",image:ne.image,createdAt:ne.createdAt,reviews:ne.reviews,reviewCount:ne.reviewCount})))}catch(I){W.error("Erreur lors du chargement des données"),console.error(I)}finally{c(!1)}},ns=async()=>{try{const I=localStorage.getItem("token");if(!I){W.error("Token d'authentification manquant");return}const H=new URLSearchParams({page:hr.toString(),limit:Wr.toString(),search:mr,type:Rs,status:fr}),q=await fetch(`http://localhost:3001/api/auth/boats?${H}`,{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"}});if(q.ok){const z=await q.json();a(z.boats.map(ie=>({id:ie._id,nom:ie.nom,type:ie.type,longueur:ie.longueur,capacite:ie.capacite,prix:ie.prix_jour,localisation:ie.localisation,status:ie.disponible?"disponible":"indisponible",image:ie.image,createdAt:ie.createdAt,proprietaire:ie.proprietaire}))),z.pagination&&ii(z.pagination)}else W.error("Erreur lors de la récupération des bateaux")}catch(I){console.error("Erreur lors de la récupération des bateaux:",I),W.error("Erreur lors de la récupération des bateaux")}},Jr=()=>{localStorage.removeItem("token"),localStorage.removeItem("userNom"),localStorage.removeItem("userPrenom"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("userTel"),window.location.href="/connexion"},Mt=I=>{Oe(I);const H=new URLSearchParams({page:I.toString(),limit:me.toString(),search:we,role:ut,status:pt}),q=localStorage.getItem("token");q&&fetch(`http://localhost:3001/api/auth/dashboard?${H}`,{headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"}}).then(z=>z.json()).then(z=>{n(z.allUsers.map(ie=>({id:ie._id,nom:ie.nom,prenom:ie.prenom,email:ie.email,role:ie.role,status:ie.status||"actif",tel:ie.tel||"",siret:ie.siret||"",siren:ie.siren||"",isProfessionnel:ie.isProfessionnel||!1}))),z.pagination&&Vt(z.pagination)}).catch(z=>{console.error("Erreur lors du changement de page:",z),W.error("Erreur lors du chargement de la page")})},ai=()=>{Oe(1),dt()},Ft=I=>{ts(I),ns()},Zr=()=>{ts(1),ns()},oi=()=>{pr(""),ni("all"),Kr("all"),ts(1),ns()},Os=()=>{dr(""),si("all"),ri("all"),Oe(1);const I=new URLSearchParams({page:"1",limit:me.toString(),search:"",role:"all",status:"all"}),H=localStorage.getItem("token");H&&fetch(`http://localhost:3001/api/auth/dashboard?${I}`,{headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"}}).then(q=>q.json()).then(q=>{n(q.allUsers.map(z=>({id:z._id,nom:z.nom,prenom:z.prenom,email:z.email,role:z.role,status:z.status||"actif",tel:z.tel||"",siret:z.siret||"",siren:z.siren||"",isProfessionnel:z.isProfessionnel||!1}))),q.pagination&&Vt(q.pagination)}).catch(q=>{console.error("Erreur lors du rechargement:",q),W.error("Erreur lors du rechargement des données")})},en=async I=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer cet utilisateur ?"))try{const H=localStorage.getItem("token");if(!H){W.error("Token d'authentification manquant"),window.location.href="/connexion";return}const q=await fetch(`http://localhost:3001/api/auth/users/${I}`,{method:"DELETE",headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"}});if(!q.ok){const z=await q.json();throw new Error(z.message||"Erreur lors de la suppression")}n(t.filter(z=>z.id!==I)),W.success("Utilisateur supprimé avec succès"),dt()}catch(H){W.error(H.message||"Erreur lors de la suppression de l'utilisateur"),console.error(H)}},tn=I=>{B(I),g(!0)},Ut=I=>{E(I),v(!0)},sn=I=>{R(I),b({nom:I.nom,prenom:I.prenom,email:I.email,tel:I.tel||"",role:I.role,isProfessionnel:I.isProfessionnel||!1,siret:I.siret||"",siren:I.siren||""}),h(!0)},gr=()=>{Q({nom:"",prenom:"",email:"",tel:"",password:"",role:"client",isProfessionnel:!1,siret:"",siren:""}),w(!0)},li=async I=>{if(I.preventDefault(),M.role==="proprietaire"&&M.isProfessionnel){if(!M.siret||M.siret.length!==14){W.error("Le SIRET doit contenir exactement 14 chiffres pour les professionnels");return}if(!M.siren||M.siren.length!==9){W.error("Le SIREN doit contenir exactement 9 chiffres pour les professionnels");return}}try{const H=localStorage.getItem("token");if(!H){W.error("Token d'authentification manquant"),window.location.href="/connexion";return}const q=await fetch("http://localhost:3001/api/auth/register",{method:"POST",headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"},body:JSON.stringify({nom:M.nom,prenom:M.prenom,email:M.email,password:M.password,tel:M.tel,role:M.role,...M.role==="proprietaire"&&{isProfessionnel:M.isProfessionnel,...M.isProfessionnel&&{siret:M.siret,siren:M.siren}}})});if(!q.ok){const ft=await q.json();throw new Error(ft.message||"Erreur lors de la création")}const z=await q.json(),ie={id:z.user.id,nom:z.user.nom,prenom:z.user.prenom,email:z.user.email,tel:z.user.tel,role:z.user.role,status:z.user.status||"actif",siret:z.user.siret||"",siren:z.user.siren||"",isProfessionnel:z.user.isProfessionnel||!1};n([ie,...t]),W.success("Utilisateur créé avec succès"),w(!1),dt()}catch(H){W.error(H.message||"Erreur lors de la création de l'utilisateur"),console.error(H)}},Ls=async I=>{if(I.preventDefault(),j.role==="proprietaire"&&j.isProfessionnel){if(!j.siret||j.siret.length!==14){W.error("Le SIRET doit contenir exactement 14 chiffres pour les professionnels");return}if(!j.siren||j.siren.length!==9){W.error("Le SIREN doit contenir exactement 9 chiffres pour les professionnels");return}}try{const H=localStorage.getItem("token");if(!H){W.error("Token d'authentification manquant"),window.location.href="/connexion";return}const q=await fetch(`http://localhost:3001/api/auth/users/${N.id}`,{method:"PUT",headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"},body:JSON.stringify(j)});if(!q.ok){const ie=await q.json();throw new Error(ie.message||"Erreur lors de la modification")}const z=await q.json();n(t.map(ie=>ie.id===N.id?{...ie,...z.user}:ie)),W.success("Utilisateur modifié avec succès"),h(!1),R(null),dt()}catch(H){W.error(H.message||"Erreur lors de la modification de l'utilisateur"),console.error(H)}},ci=async I=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer ce bateau ?"))try{const H=localStorage.getItem("token");if(!H){W.error("Token d'authentification manquant");return}const q=await fetch(`http://localhost:3001/api/boats/${I}`,{method:"DELETE",headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"}});if(!q.ok){const z=await q.json();throw new Error(z.message||"Erreur lors de la suppression")}a(i.filter(z=>z.id!==I)),W.success("Bateau supprimé avec succès"),dt()}catch(H){W.error(H.message||"Erreur lors de la suppression du bateau"),console.error(H)}},Ue=I=>{D(I),X({nom:I.nom||"",type:I.type||"",longueur:I.longueur||"",prix_jour:I.prix||I.prix_jour||"",capacite:I.capacite||"",image:I.image||"",destination:I.destination||I.localisation||"",description:I.description||"",equipements:I.equipements||""}),_(!0)},ui=async()=>{try{const I=localStorage.getItem("token");if(!I){W.error("Token d'authentification manquant");return}const H=await fetch(`http://localhost:3001/api/boats/${k.id}`,{method:"PUT",headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"},body:JSON.stringify(re)});if(!H.ok){const z=await H.json();throw new Error(z.message||"Erreur lors de la modification")}const q=await H.json();a(i.map(z=>z.id===k.id?{...z,...q}:z)),W.success("Bateau modifié avec succès"),_(!1),D(null),dt()}catch(I){W.error(I.message||"Erreur lors de la modification du bateau"),console.error(I)}},Vs=async I=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer cet avis ?"))try{const H=localStorage.getItem("token");if(!H){W.error("Token d'authentification manquant");return}const q=await fetch(`http://localhost:3001/api/reviews/${I}`,{method:"DELETE",headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"}});if(!q.ok){const z=await q.json();throw new Error(z.message||"Erreur lors de la suppression")}A(T.filter(z=>z.id!==I)),W.success("Avis supprimé avec succès"),dt()}catch(H){W.error(H.message||"Erreur lors de la suppression de l'avis"),console.error(H)}},jt=async()=>{try{const I=localStorage.getItem("token");if(!I){W.error("Token d'authentification manquant");return}const H=new URLSearchParams({page:Ha.toString(),limit:Qr.toString(),search:Xr,rating:Re,boatId:Ds});console.log("Appel API avis avec paramètres:",H.toString());const q=await fetch(`http://localhost:3001/api/reviews?${H}`,{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"}});if(q.ok){const z=await q.json();console.log("Réponse API avis:",z),A(z.reviews.map(ie=>({id:ie._id,userId:ie.userId,boatId:ie.boatId,rating:ie.rating,comment:ie.comment,createdAt:ie.createdAt}))),z.pagination&&rs(z.pagination)}else{const z=await q.json().catch(()=>({}));console.error("Erreur API avis:",q.status,z),W.error(`Erreur lors de la récupération des avis: ${z.message||q.statusText}`)}}catch(I){console.error("Erreur réseau avis:",I),W.error("Erreur réseau lors de la récupération des avis")}},di=()=>{ss(1),jt()},Ms=I=>{ss(I),jt()},is=()=>{Le(""),Ps("all"),Yr("all"),ss(1);const I=new URLSearchParams({page:"1",limit:"10",search:"",rating:"all",boatId:"all"}),H=localStorage.getItem("token");H&&fetch(`http://localhost:3001/api/reviews?${I}`,{headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"}}).then(q=>q.json()).then(q=>{A(q.reviews.map(z=>({id:z._id,userId:z.userId,boatId:z.boatId,rating:z.rating,comment:z.comment,createdAt:z.createdAt}))),q.pagination&&rs(q.pagination)}).catch(q=>{console.error("Erreur lors de l'effacement des filtres:",q),W.error("Erreur lors de l'effacement des filtres")})};return l?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement du tableau de bord..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx(ja,{}),s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center py-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de Bord Admin"}),s.jsx("p",{className:"text-gray-600",children:"Gestion de la plateforme SailingLoc"})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsxs("button",{onClick:dt,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Rafraîchir les données",children:[s.jsx(ro,{className:"h-5 w-5 mr-2"}),"Actualiser"]}),s.jsxs("button",{onClick:Jr,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[s.jsx(xf,{className:"h-5 w-5 mr-2"}),"Déconnexion"]})]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:s.jsx(Xs,{className:"h-8 w-8 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ee.totalUsers})]})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:s.jsx(fs,{className:"h-8 w-8 text-green-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Bateaux"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ee.totalBoats})]})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:s.jsx(ro,{className:"h-8 w-8 text-purple-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Réservations"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ee.totalBookings})]})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:s.jsx(ro,{className:"h-8 w-8 text-yellow-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avis"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ee.totalReviews})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border mb-8",children:[s.jsx("div",{className:"border-b border-gray-200",children:s.jsxs("nav",{className:"flex space-x-8 px-6",children:[s.jsx("button",{onClick:()=>e("overview"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Vue d'ensemble"}),s.jsx("button",{onClick:()=>e("users"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Utilisateurs"}),s.jsx("button",{onClick:()=>e("boats"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="boats"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Bateaux"}),s.jsx("button",{onClick:()=>e("reviews"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="reviews"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Avis"})]})}),s.jsxs("div",{className:"p-6",children:[r==="overview"&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activité récente"}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Utilisateurs récents"}),s.jsx("div",{className:"space-y-2",children:t.slice(0,3).map(I=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[I.prenom," ",I.nom," (",I.role,")"]}),s.jsx("span",{className:"text-xs text-gray-400",children:I.email})]},I.id))})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Bateaux disponibles"}),s.jsx("div",{className:"space-y-2",children:i.slice(0,3).map(I=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:I.nom}),s.jsxs("span",{className:"text-xs text-gray-400",children:[I.prix,"€/jour - ",I.type]})]},I.id))})]})]})]}),r==="users"&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestion des utilisateurs"}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Total : ",Ke.totalUsers," utilisateurs • Page ",Ke.currentPage," sur ",Ke.totalPages]})]}),s.jsxs("button",{onClick:gr,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Ajouter un utilisateur"]})]}),s.jsx("div",{className:"bg-white p-4 rounded-lg border mb-4",children:s.jsxs("div",{className:"flex items-end gap-4",children:[s.jsxs("div",{className:"w-2/3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rechercher"}),s.jsx("input",{type:"text",placeholder:"Nom, prénom ou email...",value:we,onChange:I=>dr(I.target.value),onKeyPress:I=>I.key==="Enter"&&ai(),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rôle"}),s.jsxs("select",{value:ut,onChange:I=>si(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Tous"}),s.jsx("option",{value:"client",children:"Client"}),s.jsx("option",{value:"proprietaire",children:"Propriétaire"}),s.jsx("option",{value:"admin",children:"Admin"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),s.jsxs("select",{value:pt,onChange:I=>ri(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Tous"}),s.jsx("option",{value:"actif",children:"Actif"}),s.jsx("option",{value:"inactif",children:"Inactif"}),s.jsx("option",{value:"suspendu",children:"Suspendu"})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:ai,className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",children:"Rechercher"}),s.jsx("button",{onClick:Os,className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:"Effacer"})]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilisateur"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rôle"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut Pro"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(I=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[I.prenom," ",I.nom]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:I.email})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I.role==="admin"?"bg-red-100 text-red-800":I.role==="proprietaire"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:I.role})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.role==="proprietaire"?s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I.isProfessionnel?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:I.isProfessionnel?"Professionnel":"Particulier"}):s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:"N/A"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I.status==="actif"?"bg-green-100 text-green-800":I.status==="inactif"?"bg-red-100 text-red-800":I.status==="suspendu"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:I.status})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>tn(I),className:"text-blue-600 hover:text-blue-900",title:"Voir les détails",children:s.jsx(Pr,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>sn(I),className:"text-indigo-600 hover:text-indigo-900",title:"Modifier",children:s.jsx(no,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>en(I.id),className:"text-red-600 hover:text-red-900",title:"Supprimer",children:s.jsx(Ws,{className:"h-4 w-4"})})]})})]},I.id))})]})}),Ke.totalPages>1&&s.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6 mt-4 rounded-lg",children:[s.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[s.jsx("button",{onClick:()=>Mt(le-1),disabled:le===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Précédent"}),s.jsx("button",{onClick:()=>Mt(le+1),disabled:le===Ke.totalPages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Suivant"})]}),s.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[s.jsx("div",{children:s.jsxs("p",{className:"text-sm text-gray-700",children:["Affichage de ",s.jsx("span",{className:"font-medium",children:(le-1)*me+1})," à"," ",s.jsx("span",{className:"font-medium",children:Math.min(le*me,Ke.totalUsers)})," ","sur ",s.jsx("span",{className:"font-medium",children:Ke.totalUsers})," résultats"]})}),s.jsx("div",{children:s.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[s.jsxs("button",{onClick:()=>Mt(1),disabled:le===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx("span",{className:"sr-only",children:"Première page"}),"«"]}),s.jsxs("button",{onClick:()=>Mt(le-1),disabled:le===1,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx("span",{className:"sr-only",children:"Précédent"}),"‹"]}),Array.from({length:Math.min(5,Ke.totalPages)},(I,H)=>{let q;return Ke.totalPages<=5||le<=3?q=H+1:le>=Ke.totalPages-2?q=Ke.totalPages-4+H:q=le-2+H,s.jsx("button",{onClick:()=>Mt(q),className:`relative inline-flex items-center px-4 py-2 text-sm font-medium border ${le===q?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:q},q)}),s.jsxs("button",{onClick:()=>Mt(le+1),disabled:le===Ke.totalPages,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx("span",{className:"sr-only",children:"Suivant"}),"›"]}),s.jsxs("button",{onClick:()=>Mt(Ke.totalPages),disabled:le===Ke.totalPages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx("span",{className:"sr-only",children:"Dernière page"}),"»"]})]})})]})]})]}),r==="boats"&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestion des bateaux"}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Total : ",xe.totalBoats," bateaux • Page ",xe.currentPage," sur ",xe.totalPages]})]}),s.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Ajouter un bateau"]})]}),s.jsx("div",{className:"bg-white p-4 rounded-lg border mb-4",children:s.jsxs("div",{className:"flex items-end gap-4",children:[s.jsxs("div",{className:"w-2/3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rechercher"}),s.jsx("input",{type:"text",placeholder:"Rechercher par nom ou type...",value:mr,onChange:I=>pr(I.target.value),onKeyPress:I=>I.key==="Enter"&&Zr(),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),s.jsxs("select",{value:Rs,onChange:I=>ni(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Tous"}),s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"moteur",children:"Moteur"}),s.jsx("option",{value:"catamaran",children:"Catamaran"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"pneumatique",children:"Pneumatique"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),s.jsxs("select",{value:fr,onChange:I=>Kr(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Tous"}),s.jsx("option",{value:"disponible",children:"Disponible"}),s.jsx("option",{value:"loué",children:"Loué"}),s.jsx("option",{value:"maintenance",children:"Maintenance"}),s.jsx("option",{value:"réservé",children:"Réservé"})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:Zr,className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",children:"Rechercher"}),s.jsx("button",{onClick:oi,className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:"Effacer"})]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bateau"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Longueur"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capacité"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avis"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(I=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.nom})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900 capitalize",children:I.type})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[I.longueur,"m"]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[I.capacite," pers."]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:s.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:[I.reviewCount||0," avis"]})})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I.status==="disponible"?"bg-green-100 text-green-800":I.status==="loué"?"bg-blue-100 text-blue-800":I.status==="maintenance"?"bg-yellow-100 text-yellow-800":I.status==="réservé"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:I.status})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>Ut(I),className:"text-blue-600 hover:text-blue-900",title:"Voir les avis",children:s.jsx(Pr,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>Ue(I),className:"text-indigo-600 hover:text-indigo-900",title:"Modifier le bateau",children:s.jsx(no,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>ci(I.id),className:"text-red-600 hover:text-red-900",title:"Supprimer le bateau",children:s.jsx(Ws,{className:"h-4 w-4"})})]})})]},I.id))})]})}),xe.totalPages>1&&s.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",(xe.currentPage-1)*xe.boatsPerPage+1," à"," ",Math.min(xe.currentPage*xe.boatsPerPage,xe.totalBoats)," sur"," ",xe.totalBoats," bateaux"]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>Ft(1),disabled:xe.currentPage===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Première"}),s.jsx("button",{onClick:()=>Ft(xe.currentPage-1),disabled:xe.currentPage===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Précédente"}),s.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,xe.totalPages)},(I,H)=>{let q;return xe.totalPages<=5||xe.currentPage<=3?q=H+1:xe.currentPage>=xe.totalPages-2?q=xe.totalPages-4+H:q=xe.currentPage-2+H,s.jsx("button",{onClick:()=>Ft(q),className:`px-3 py-2 text-sm font-medium rounded-md ${q===xe.currentPage?"bg-blue-600 text-white":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50"}`,children:q},q)})}),s.jsx("button",{onClick:()=>Ft(xe.currentPage+1),disabled:xe.currentPage===xe.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Suivante"}),s.jsx("button",{onClick:()=>Ft(xe.totalPages),disabled:xe.currentPage===xe.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Dernière"})]})]})]}),r==="reviews"&&s.jsxs("div",{children:[s.jsx("div",{className:"flex justify-between items-center mb-4",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestion des avis"}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Total : ",be.totalReviews," avis • Page ",be.currentPage," sur ",be.totalPages]})]})}),s.jsx("div",{className:"bg-white p-4 rounded-lg border mb-4",children:s.jsxs("div",{className:"flex items-end gap-4",children:[s.jsxs("div",{className:"w-2/3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rechercher"}),s.jsx("input",{type:"text",placeholder:"Rechercher par commentaire...",value:Xr,onChange:I=>Le(I.target.value),onKeyPress:I=>I.key==="Enter"&&di(),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note"}),s.jsxs("select",{value:Re,onChange:I=>Ps(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Toutes"}),s.jsx("option",{value:"5",children:"5 étoiles"}),s.jsx("option",{value:"4",children:"4 étoiles"}),s.jsx("option",{value:"3",children:"3 étoiles"}),s.jsx("option",{value:"2",children:"2 étoiles"}),s.jsx("option",{value:"1",children:"1 étoile"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bateau"}),s.jsxs("select",{value:Ds,onChange:I=>Yr(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Tous"}),i.map(I=>s.jsx("option",{value:I.id,children:I.nom},I.id))]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:di,className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",children:"Rechercher"}),s.jsx("button",{onClick:is,className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:"Effacer"})]})]})}),T.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun avis disponible"}),s.jsx("p",{className:"text-gray-500",children:"Aucun utilisateur n'a encore laissé d'avis sur les bateaux."})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilisateur"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bateau"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Note"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commentaire"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(I=>s.jsxs("tr",{children:[s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[I.userId?.prenom," ",I.userId?.nom]}),s.jsx("div",{className:"text-xs text-gray-500",children:I.userId?.email})]}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:i.find(H=>H.id===I.boatId?._id||H.id===I.boatId)?.nom||"Bateau supprimé"}),s.jsx("div",{className:"text-xs text-gray-500",children:i.find(H=>H.id===I.boatId?._id||H.id===I.boatId)?.type||""})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center space-x-1",children:[[...Array(5)].map((H,q)=>s.jsx("span",{className:`text-lg ${q<I.rating?"text-yellow-400":"text-gray-300"}`,children:"★"},q)),s.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",I.rating,"/5)"]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"max-w-xs",children:s.jsxs("p",{className:"text-sm text-gray-900 truncate",title:I.comment,children:['"',I.comment,'"']})})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(I.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsx("div",{className:"flex space-x-2",children:s.jsx("button",{onClick:()=>Vs(I.id),className:"text-red-600 hover:text-red-900",title:"Supprimer l'avis",children:s.jsx(Ws,{className:"h-4 w-4"})})})})]},I.id))})]})}),be.totalPages>1&&s.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",(be.currentPage-1)*be.reviewsPerPage+1," à"," ",Math.min(be.currentPage*be.reviewsPerPage,be.totalReviews)," sur"," ",be.totalReviews," avis"]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>Ms(1),disabled:be.currentPage===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Première"}),s.jsx("button",{onClick:()=>Ms(be.currentPage-1),disabled:be.currentPage===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:cursor-not-allowed",children:"Précédent"}),Array.from({length:Math.min(5,be.totalPages)},(I,H)=>{let q;return be.totalPages<=5||be.currentPage<=3?q=H+1:be.currentPage>=be.totalPages-2?q=be.totalPages-4+H:q=be.currentPage-2+H,s.jsx("button",{onClick:()=>Ms(q),className:`relative inline-flex items-center px-4 py-2 text-sm font-medium border ${be.currentPage===q?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:q},q)}),s.jsx("button",{onClick:()=>Ms(be.currentPage+1),disabled:be.currentPage===be.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Suivant"}),s.jsx("button",{onClick:()=>Ms(be.totalPages),disabled:be.currentPage===be.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Dernière"})]})]})]})]})]})]}),u&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b flex-shrink-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Modifier l'utilisateur"}),s.jsx("button",{onClick:()=>{h(!1),R(null)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(ke,{className:"h-6 w-6"})})]}),s.jsxs("form",{id:"editUserForm",onSubmit:Ls,className:"p-6 space-y-4 flex-1 overflow-y-auto",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prénom"}),s.jsx("input",{type:"text",value:j.prenom,onChange:I=>b({...j,prenom:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom"}),s.jsx("input",{type:"text",value:j.nom,onChange:I=>b({...j,nom:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),s.jsx("input",{type:"email",value:j.email,onChange:I=>b({...j,email:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Téléphone"}),s.jsx("input",{type:"tel",value:j.tel,onChange:I=>b({...j,tel:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0123456789"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rôle"}),s.jsxs("select",{value:j.role,onChange:I=>b({...j,role:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"client",children:"Client"}),s.jsx("option",{value:"proprietaire",children:"Propriétaire"}),s.jsx("option",{value:"admin",children:"Admin"})]})]}),j.role==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"false",checked:j.isProfessionnel===!1,onChange:I=>b({...j,isProfessionnel:I.target.value==="true"}),className:"mr-2 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Particulier"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"true",checked:j.isProfessionnel===!0,onChange:I=>b({...j,isProfessionnel:I.target.value==="true"}),className:"mr-2 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Professionnel"})]})]})]}),j.isProfessionnel&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Informations professionnelles"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SIRET *"}),s.jsx("input",{type:"text",value:j.siret||"",onChange:I=>b({...j,siret:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"12345678901234",pattern:"[0-9]{14}"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"14 chiffres sans espaces"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SIREN *"}),s.jsx("input",{type:"text",value:j.siren||"",onChange:I=>b({...j,siren:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"123456789",pattern:"[0-9]{9}"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"9 chiffres sans espaces"})]})]})]})})]})]}),s.jsx("div",{className:"p-6 border-t bg-gray-50 flex-shrink-0",children:s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>{h(!1),R(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",form:"editUserForm",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Modifier"})]})})]})}),p&&P&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Détails de l'utilisateur"}),s.jsx("button",{onClick:()=>{g(!1),B(null)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(ke,{className:"h-6 w-6"})})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[P.prenom.charAt(0),P.nom.charAt(0)]})}),s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xl font-semibold text-gray-900",children:[P.prenom," ",P.nom]}),s.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${P.role==="admin"?"bg-red-100 text-red-800":P.role==="proprietaire"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:P.role})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Prénom"}),s.jsx("span",{className:"text-sm text-gray-900",children:P.prenom})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Nom"}),s.jsx("span",{className:"text-sm text-gray-900",children:P.nom})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Email"}),s.jsx("span",{className:"text-sm text-gray-900",children:P.email})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Téléphone"}),s.jsx("span",{className:"text-sm text-gray-900",children:P.tel||"Non renseigné"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Statut"}),s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:P.status||"Actif"})]}),P.role==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Statut"}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${P.isProfessionnel?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:P.isProfessionnel?"Professionnel":"Particulier"})]}),P.isProfessionnel&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"SIRET"}),s.jsx("span",{className:"text-sm text-gray-900",children:P.siret||"Non renseigné"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"SIREN"}),s.jsx("span",{className:"text-sm text-gray-900",children:P.siren||"Non renseigné"})]})]})]})]}),s.jsxs("div",{className:"flex space-x-3 pt-6",children:[s.jsx("button",{onClick:()=>{g(!1),B(null),sn(P)},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Modifier"}),s.jsx("button",{onClick:()=>{g(!1),B(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Fermer"})]})]})]})}),y&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b flex-shrink-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ajouter un utilisateur"}),s.jsx("button",{onClick:()=>{w(!1)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(ke,{className:"h-6 w-6"})})]}),s.jsxs("form",{id:"addUserForm",onSubmit:li,className:"p-6 space-y-4 flex-1 overflow-y-auto",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prénom *"}),s.jsx("input",{type:"text",value:M.prenom,onChange:I=>Q({...M,prenom:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom *"}),s.jsx("input",{type:"text",value:M.nom,onChange:I=>Q({...M,nom:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),s.jsx("input",{type:"email",value:M.email,onChange:I=>Q({...M,email:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe *"}),s.jsx("input",{type:"password",value:M.password,onChange:I=>Q({...M,password:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,minLength:"6"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Téléphone *"}),s.jsx("input",{type:"tel",value:M.tel,onChange:I=>Q({...M,tel:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0123456789",pattern:"[0-9]{10}",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rôle *"}),s.jsxs("select",{value:M.role,onChange:I=>Q({...M,role:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"client",children:"Client"}),s.jsx("option",{value:"proprietaire",children:"Propriétaire"}),s.jsx("option",{value:"admin",children:"Admin"})]})]}),M.role==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"false",checked:M.isProfessionnel===!1,onChange:I=>Q({...M,isProfessionnel:I.target.value==="true"}),className:"mr-2 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Particulier"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"true",checked:M.isProfessionnel===!0,onChange:I=>Q({...M,isProfessionnel:I.target.value==="true"}),className:"mr-2 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Professionnel"})]})]})]}),M.isProfessionnel&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Informations professionnelles"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SIRET *"}),s.jsx("input",{type:"text",value:M.siret||"",onChange:I=>Q({...M,siret:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"12345678901234",pattern:"[0-9]{14}",required:!0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"14 chiffres sans espaces"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SIREN *"}),s.jsx("input",{type:"text",value:M.siren||"",onChange:I=>Q({...M,siren:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"123456789",pattern:"[0-9]{9}",required:!0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"9 chiffres sans espaces"})]})]})]})})]})]}),s.jsx("div",{className:"p-6 border-t bg-gray-50 flex-shrink-0",children:s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>{w(!1)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",form:"addUserForm",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Créer"})]})})]})}),f&&L&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Avis du bateau : ",L.nom]}),s.jsx("button",{onClick:()=>{v(!1),E(null)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(ke,{className:"h-6 w-6"})})]}),s.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:L.reviews&&L.reviews.length>0?s.jsx("div",{className:"space-y-4",children:L.reviews.map((I,H)=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-sm font-semibold text-blue-600",children:I.userId?.nom?.charAt(0)||I.userId?.prenom?.charAt(0)||"U"})}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-medium text-gray-900",children:[I.userId?.prenom," ",I.userId?.nom]}),s.jsx("p",{className:"text-sm text-gray-500",children:new Date(I.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})})]})]}),s.jsx("div",{className:"flex items-center space-x-1",children:[...Array(5)].map((q,z)=>s.jsx("span",{className:`text-lg ${z<I.rating?"text-yellow-400":"text-gray-300"}`,children:"★"},z))})]}),s.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-100",children:s.jsxs("p",{className:"text-gray-700 italic",children:['"',I.comment,'"']})})]},H))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun avis disponible"}),s.jsx("p",{className:"text-gray-500",children:"Ce bateau n'a pas encore reçu d'avis."})]})}),s.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:s.jsx("button",{onClick:()=>{v(!1),E(null)},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Fermer"})})]})}),C&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(no,{className:"h-6 w-6 text-blue-600"}),"Modifier le bateau"]}),s.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx(ke,{className:"h-6 w-6 text-gray-500"})})]}),s.jsxs("form",{onSubmit:I=>{I.preventDefault(),ui()},className:"p-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du bateau *"}),s.jsx("input",{type:"text",value:re.nom,onChange:I=>X({...re,nom:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nom du bateau",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type *"}),s.jsxs("select",{value:re.type,onChange:I=>X({...re,type:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Sélectionner un type"}),s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longueur (m) *"}),s.jsx("input",{type:"number",value:re.longueur,onChange:I=>X({...re,longueur:parseFloat(I.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Longueur en mètres",min:"2",max:"100",step:"0.1",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix par jour (€) *"}),s.jsx("input",{type:"number",value:re.prix_jour,onChange:I=>X({...re,prix_jour:parseFloat(I.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Prix par jour",min:"1",step:"0.01",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacité (personnes) *"}),s.jsx("input",{type:"number",value:re.capacite,onChange:I=>X({...re,capacite:parseInt(I.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de personnes",min:"1",max:"50",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Destination *"}),s.jsxs("select",{value:re.destination,onChange:I=>X({...re,destination:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Sélectionner une destination"}),s.jsx("option",{value:"saint-malo",children:"Saint-Malo"}),s.jsx("option",{value:"les-glenan",children:"Les Glénan"}),s.jsx("option",{value:"crozon",children:"Crozon"}),s.jsx("option",{value:"la-rochelle",children:"La Rochelle"}),s.jsx("option",{value:"marseille",children:"Marseille"}),s.jsx("option",{value:"cannes",children:"Cannes"}),s.jsx("option",{value:"ajaccio",children:"Ajaccio"}),s.jsx("option",{value:"barcelone",children:"Barcelone"}),s.jsx("option",{value:"palma",children:"Palma"}),s.jsx("option",{value:"athenes",children:"Athènes"}),s.jsx("option",{value:"venise",children:"Venise"}),s.jsx("option",{value:"amsterdam",children:"Amsterdam"}),s.jsx("option",{value:"split",children:"Split"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL de l'image *"}),s.jsx("input",{type:"url",value:re.image,onChange:I=>X({...re,image:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com/image.jpg",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{value:re.description,onChange:I=>X({...re,description:I.target.value}),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description du bateau"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Équipements"}),s.jsx("textarea",{value:re.equipements,onChange:I=>X({...re,equipements:I.target.value}),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Équipements disponibles (séparés par des virgules)"})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:()=>_(!1),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Modifier le bateau"})]})]})]})})]})}function Qj(){return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx(Br,{}),s.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-4xl",children:[s.jsxs("header",{className:"text-center mb-12",children:[s.jsx("h1",{className:"text-4xl font-bold text-blue-700 mb-4",children:"Politique de confidentialité"}),s.jsx("p",{className:"text-gray-600 text-lg",children:"Dernière mise à jour : 01/01/2025"})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(Ed,{className:"h-7 w-7 mr-3"}),"1. Introduction"]}),s.jsx("p",{className:"text-gray-700 leading-relaxed text-lg",children:"La présente politique de confidentialité a pour but d'expliquer comment SailingLoc collecte, utilise, protège et partage les données personnelles de ses utilisateurs conformément au Règlement Général sur la Protection des Données (RGPD)."})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(Pr,{className:"h-7 w-7 mr-3"}),"2. Données collectées"]}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Lors de l'utilisation de la plateforme SailingLoc, nous pouvons collecter les données suivantes :"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Nom, prénom"}),s.jsx("li",{children:"Adresse e-mail"}),s.jsx("li",{children:"Numéro de téléphone"}),s.jsx("li",{children:"Adresse IP et données de navigation"})]}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Données de géolocalisation (si autorisées)"}),s.jsx("li",{children:"Informations de paiement (via Stripe ou PayPal)"}),s.jsx("li",{children:"Historique des réservations"}),s.jsx("li",{children:"Préférences de navigation"})]})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"3. Finalités de la collecte"}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Les données collectées ont pour objectif :"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"La création et la gestion du compte utilisateur"}),s.jsx("li",{children:"La mise en relation entre propriétaires et locataires"}),s.jsx("li",{children:"Le traitement des paiements"}),s.jsx("li",{children:"La gestion des réservations"})]}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Le service client"}),s.jsx("li",{children:"L'envoi de notifications ou emails (rappels, suggestions, sécurité)"}),s.jsx("li",{children:"L'amélioration continue de nos services"}),s.jsx("li",{children:"La personnalisation de l'expérience utilisateur"})]})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"4. Consentement"}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Le consentement est obtenu explicitement via :"}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Case à cocher lors de la création de compte"}),s.jsx("li",{children:"Bandeau cookie au premier accès au site"}),s.jsx("li",{children:"Formulaires spécifiques pour la newsletter ou contact"}),s.jsx("li",{children:"Paramètres de confidentialité dans le profil utilisateur"})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"5. Cookies"}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Le site utilise des cookies pour :"}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Analyser la fréquentation (Google Analytics)"}),s.jsx("li",{children:"Optimiser les performances du site"}),s.jsx("li",{children:"Mémoriser vos préférences de navigation"}),s.jsx("li",{children:"Assurer la sécurité de votre session"})]}),s.jsx("p",{className:"text-gray-700 mt-4 text-lg",children:"Vous pouvez configurer les cookies à tout moment via notre bandeau de gestion (outil : Axeptio, Cookiebot...)"})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"6. Durée de conservation"}),s.jsx("p",{className:"text-gray-700 leading-relaxed text-lg",children:"Les données sont conservées pour une durée maximale de 3 ans après la dernière interaction. Les données liées aux paiements sont conservées selon les obligations fiscales et légales."})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"7. Vos droits"}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Conformément au RGPD, vous disposez des droits suivants :"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Droit d'accès à vos données"}),s.jsx("li",{children:"Droit de rectification"}),s.jsx("li",{children:`Droit à l'effacement ("droit à l'oubli")`}),s.jsx("li",{children:"Droit à la portabilité"})]}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Droit d'opposition et de retrait du consentement"}),s.jsx("li",{children:"Droit à la limitation du traitement"}),s.jsx("li",{children:"Droit de réclamation auprès de la CNIL"}),s.jsx("li",{children:"Droit à la notification des violations"})]})]}),s.jsxs("p",{className:"text-gray-700 mt-4 text-lg",children:["Pour exercer vos droits, envoyez un e-mail à : ",s.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"sailinglocequipe@gmail.com"})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(Qi,{className:"h-7 w-7 mr-3"}),"8. Sécurité des données"]}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"SailingLoc utilise les technologies suivantes pour assurer la sécurité des données :"}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Hachage des mots de passe via bcryptjs"}),s.jsx("li",{children:"Token d'authentification sécurisés (JWT)"}),s.jsx("li",{children:"Certificat SSL (HTTPS)"}),s.jsx("li",{children:"Accès limité au personnel autorisé"}),s.jsx("li",{children:"Chiffrement des données sensibles"}),s.jsx("li",{children:"Audit de sécurité régulier"})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(_d,{className:"h-7 w-7 mr-3"}),"9. Hébergement"]}),s.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-4",children:"Vercel Inc."}),s.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Adresse :"})," 340 S Lemon Ave #4133, Walnut, CA 91789, États-Unis"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Site web :"})," ",s.jsx("a",{href:"https://vercel.com",target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"vercel.com"})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Conformité :"})," RGPD, SOC 2 Type II, ISO 27001"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Sécurité :"})," Infrastructure cloud sécurisée avec chiffrement des données en transit et au repos"]})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(wo,{className:"h-7 w-7 mr-3"}),"10. Développement et maintenance"]}),s.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-4",children:"Agence Pandawan"}),s.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Dénomination sociale :"})," Pandawan"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Date de création :"})," 14/03/2014"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Siège social :"})," 25 Rue du Faubourg Saint-Antoine, 75011 Paris"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Statut juridique :"})," SAS"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Expertise :"})," Développement web, IA, UX design, référencement"]})]}),s.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:s.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed",children:[s.jsx("strong",{children:"Présentation :"})," Pandawan est une agence digitale internationale spécialisée dans la création de contenus digitaux de haute qualité, valorisant l'identité de ses clients à travers l'innovation et la créativité."]})})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"11. Modifications"}),s.jsx("p",{className:"text-gray-700 leading-relaxed text-lg",children:"Cette politique peut être modifiée à tout moment. Les utilisateurs seront informés des changements par notification sur le site ou par e-mail."})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(Dr,{className:"h-7 w-7 mr-3"}),"12. Contact"]}),s.jsxs("p",{className:"text-gray-700 leading-relaxed text-lg",children:["Pour toute question concernant cette politique de confidentialité ou pour exercer vos droits, contactez-nous à : ",s.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"sailinglocequipe@gmail.com"})]}),s.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:s.jsxs("p",{className:"text-gray-600 text-sm",children:[s.jsx("strong",{children:"Note :"})," Cette politique est conforme au RGPD et aux dernières recommandations de la CNIL. Pour plus d'informations sur vos droits, consultez le site de la ",s.jsx("a",{href:"https://www.cnil.fr",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline hover:text-blue-700 transition-colors",children:"CNIL"}),"."]})})]})]})})]})}var Sp={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},yd=fe.createContext&&fe.createContext(Sp),Xj=["attr","size","title"];function Yj(r,e){if(r==null)return{};var t=Jj(r,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function Jj(r,e){if(r==null)return{};var t={};for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){if(e.indexOf(n)>=0)continue;t[n]=r[n]}return t}function xa(){return xa=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},xa.apply(this,arguments)}function bd(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ya(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?bd(Object(t),!0).forEach(function(n){Zj(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):bd(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Zj(r,e,t){return e=eN(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function eN(r){var e=tN(r,"string");return typeof e=="symbol"?e:e+""}function tN(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Ap(r){return r&&r.map((e,t)=>fe.createElement(e.tag,ya({key:t},e.attr),Ap(e.child)))}function Cp(r){return e=>fe.createElement(sN,xa({attr:ya({},r.attr)},e),Ap(r.child))}function sN(r){var e=t=>{var{attr:n,size:i,title:a}=r,l=Yj(r,Xj),c=i||t.size||"1em",u;return t.className&&(u=t.className),r.className&&(u=(u?u+" ":"")+r.className),fe.createElement("svg",xa({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,l,{className:u,style:ya(ya({color:r.color||t.color},t.style),r.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),a&&fe.createElement("title",null,a),r.children)};return yd!==void 0?fe.createElement(yd.Consumer,null,t=>e(t)):e(Sp)}function rN(r){return Cp({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(r)}function nN(r){return Cp({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(r)}function iN(){const r=es(),[e,t]=S.useState(!0),[n,i]=S.useState(""),[a,l]=S.useState({nom:localStorage.getItem("userNom")||"",prenom:localStorage.getItem("userPrenom")||"",email:localStorage.getItem("userEmail")||"",telephone:localStorage.getItem("userTel")||"",password:"",siret:localStorage.getItem("userSiret")||"",siren:localStorage.getItem("userSiren")||""}),[c,u]=S.useState(""),[h,p]=S.useState(!1),[g,y]=S.useState(!1),[w,C]=S.useState(!1);S.useEffect(()=>{_()},[]);const _=()=>{try{if(t(!0),!(localStorage.getItem("token")||sessionStorage.getItem("token"))){i("Vous devez être connecté pour voir votre profil"),t(!1);return}t(!1)}catch{i("Erreur lors de la vérification de l'authentification"),t(!1)}},N=D=>{l({...a,[D.target.name]:D.target.value})},R=async D=>{D.preventDefault(),u("");try{const P=localStorage.getItem("userId"),B=await fetch("http://localhost:3001/api/user/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:P,nom:a.nom,prenom:a.prenom,email:a.email,telephone:a.telephone,password:a.password,siret:a.siret,siren:a.siren})}),L=await B.json();if(!B.ok)throw new Error(L.message||"Erreur lors de la mise à jour");localStorage.setItem("userNom",L.user.nom),localStorage.setItem("userPrenom",L.user.prenom),localStorage.setItem("userEmail",L.user.email),localStorage.setItem("userTel",L.user.tel),L.user.siret&&localStorage.setItem("userSiret",L.user.siret),L.user.siren&&localStorage.setItem("userSiren",L.user.siren),W.success(s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),s.jsx("div",{children:s.jsx("strong",{style:{color:"#16a34a"},children:"Profil mis à jour avec succès !"})})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1}),u("")}catch(P){u(P.message)}},k=async()=>{C(!0);try{const D=localStorage.getItem("token");if(!D)throw new Error("Vous devez être connecté");const P=await fetch("http://localhost:3001/api/user/delete-account",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${D}`}}),B=await P.json();if(!P.ok)throw new Error(B.message||"Erreur lors de la suppression du compte");localStorage.clear(),W.success(s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),s.jsxs("div",{children:[s.jsx("strong",{style:{color:"#16a34a"},children:"Compte supprimé avec succès"}),s.jsx("br",{}),s.jsx("span",{style:{fontSize:14},children:"Vous allez être redirigé vers l'accueil"})]})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1}),setTimeout(()=>{r("/")},3e3)}catch(D){W.error(s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:22,marginRight:10},children:"❌"}),s.jsxs("div",{children:[s.jsx("strong",{style:{color:"#dc2626"},children:"Erreur"}),s.jsx("br",{}),s.jsx("span",{style:{fontSize:14},children:D.message})]})]}),{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#fef2f2",color:"#dc2626",fontWeight:500,fontSize:18,border:"2px solid #dc2626"},icon:!1})}finally{C(!1),y(!1)}};return e?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(Kt,{className:"h-12 w-12 text-blue-500 animate-spin"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement du profil..."})]}):n?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(Sn,{className:"h-12 w-12 text-red-500 mb-4"}),s.jsx("p",{className:"text-lg text-gray-800 mb-2",children:n}),s.jsx(G,{to:"/connexion",children:s.jsx("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})})]}):s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx(Br,{}),s.jsx(ja,{}),s.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md",children:[s.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-6 text-center",children:"Mon profil"}),s.jsxs("form",{onSubmit:R,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Nom"}),s.jsx("input",{type:"text",name:"nom",value:a.nom,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre nom"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Prénom"}),s.jsx("input",{type:"text",name:"prenom",value:a.prenom,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre prénom"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Email"}),s.jsx("input",{type:"email",name:"email",value:a.email,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre email"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Téléphone"}),s.jsx("input",{type:"tel",name:"telephone",value:a.telephone,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre téléphone"})]}),localStorage.getItem("userRole")==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"SIRET"}),s.jsx("input",{type:"text",name:"siret",value:a.siret,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"12345678901234",maxLength:"14"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"14 chiffres sans espaces"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"SIREN"}),s.jsx("input",{type:"text",name:"siren",value:a.siren,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"123456789",maxLength:"9"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"9 chiffres sans espaces"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Mot de passe"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:h?"text":"password",name:"password",value:a.password,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200 pr-12",placeholder:"Nouveau mot de passe (laisser vide pour ne pas changer)"}),s.jsx("span",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 cursor-pointer text-gray-500",onClick:()=>p(D=>!D),tabIndex:0,role:"button","aria-label":h?"Masquer le mot de passe":"Afficher le mot de passe",children:h?s.jsx(rN,{size:22}):s.jsx(nN,{size:22})})]})]}),s.jsx("button",{type:"submit",className:"w-full py-3 px-6 rounded-full font-bold text-lg bg-orange-500 text-white hover:bg-orange-600 transition-colors shadow-lg",children:"Enregistrer"}),c&&s.jsx("div",{className:"text-green-600 text-center mt-2",children:c})]}),s.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zone dangereuse"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"La suppression de votre compte est irréversible. Toutes vos données, réservations et bateaux seront définitivement supprimés."}),s.jsxs("button",{onClick:()=>y(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:[s.jsx(Ws,{className:"h-5 w-5"}),"Supprimer mon compte"]})]})})]})}),g&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:s.jsx(Hs,{className:"h-6 w-6 text-red-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Supprimer votre compte ?"}),s.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Cette action est irréversible. Toutes vos données seront définitivement supprimées."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:()=>y(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"button",onClick:k,disabled:w,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:w?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Suppression..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ws,{className:"h-4 w-4"}),"Supprimer définitivement"]})})]})]})})})]})}function aN(){return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx(Br,{}),s.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-2xl",children:[s.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-6 text-center",children:"Conditions Générales d’Utilisation (CGU) et de Vente (CGV)"}),s.jsx("p",{className:"mb-4 text-gray-700 text-center",children:"Dernière mise à jour : 01/04/2025"}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"1. Présentation de la plateforme"}),s.jsx("p",{className:"text-gray-700",children:"SailingLoc est une plateforme de mise en relation entre propriétaires de bateaux et particuliers souhaitant louer un voilier ou yacht en Europe. La société est basée à La Rochelle, sous le statut SAS (RCS La Rochelle B 923 456 789)."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"2. Acceptation des CGU/CGV"}),s.jsx("p",{className:"text-gray-700",children:"En accédant ou en utilisant le site SailingLoc, tout utilisateur reconnaît avoir lu, compris et accepté les présentes CGU/CGV sans réserve."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"3. Obligations des parties"}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 mb-2",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Propriétaires :"})," doivent fournir des informations exactes sur leur bateau (entretien, assurance, équipements)."]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Locataires :"})," s’engagent à utiliser les bateaux de manière responsable et à respecter les conditions de location."]}),s.jsxs("li",{children:[s.jsx("strong",{children:"SailingLoc :"})," s’assure de la conformité juridique des contrats et du respect du RGPD."]})]})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"4. Réservation et Paiement"}),s.jsx("p",{className:"text-gray-700",children:"Les réservations sont effectuées directement via la plateforme, avec paiement sécurisé via Stripe ou PayPal. Des frais de service peuvent s’appliquer."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"5. Droit de rétractation et annulation"}),s.jsx("p",{className:"text-gray-700",children:"Les conditions d’annulation sont définies dans chaque annonce. SailingLoc permet l’annulation selon les délais spécifiés par le propriétaire."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"6. Données personnelles"}),s.jsxs("p",{className:"text-gray-700",children:["Les données collectées (nom, email, numéro, localisation, etc.) sont utilisées dans le cadre de la mise en relation et sont traitées conformément au RGPD. Consultez notre "," ",s.jsx(G,{to:"/politique-confidentialite",className:"text-orange-500 underline",children:"politique de confidentialité"}),"."]})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"7. Responsabilité"}),s.jsx("p",{className:"text-gray-700",children:"SailingLoc décline toute responsabilité en cas de litige entre les utilisateurs. Toutefois, une équipe de modération peut intervenir en cas de signalement."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"8. Modification des CGU/CGV"}),s.jsx("p",{className:"text-gray-700",children:"SailingLoc se réserve le droit de modifier les présentes conditions à tout moment. Les utilisateurs seront notifiés lors de la mise à jour."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"9. Contact"}),s.jsxs("p",{className:"text-gray-700",children:["Pour toute question, vous pouvez contacter l’équipe via : ",s.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline",children:"sailinglocequipe@gmail.com"}),"."]})]})]})})]})}function oN(){return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx(Br,{}),s.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-4xl",children:[s.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-8 text-center",children:"Mentions légales"}),s.jsxs("section",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[s.jsx(wo,{className:"h-6 w-6 mr-2"}),"1. Éditeur du site"]}),s.jsx("p",{className:"text-gray-700 mb-3",children:"Le site SailingLoc est édité par :"}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 mb-3 space-y-1",children:[s.jsx("li",{children:"SailingLoc SAS"}),s.jsx("li",{children:"Société par actions simplifiée au capital de [à compléter] €"}),s.jsx("li",{children:"RCS La Rochelle B 923 456 789"}),s.jsx("li",{children:"Siège social : 12 Rue du Port, 17000 La Rochelle, France"}),s.jsxs("li",{children:["Email : ",s.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"sailinglocequipe@gmail.com"})]}),s.jsx("li",{children:"Directeur de la publication : [Nom du responsable légal ou fondateur]"})]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[s.jsx(_d,{className:"h-6 w-6 mr-2"}),"2. Hébergement"]}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 mb-3 space-y-1",children:[s.jsx("li",{children:"Le site est hébergé par :"}),s.jsx("li",{children:s.jsx("strong",{children:"Vercel Inc."})}),s.jsxs("li",{children:[s.jsx("strong",{children:"Adresse :"})," 340 S Lemon Ave #4133, Walnut, CA 91789, États-Unis"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Site web :"})," ",s.jsx("a",{href:"https://vercel.com",target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"vercel.com"})]}),s.jsx("li",{children:"Le prestataire assure un niveau de sécurité conforme aux exigences du RGPD."})]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[s.jsx(wo,{className:"h-6 w-6 mr-2"}),"3. Conception et développement"]}),s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200",children:[s.jsx("h4",{className:"text-lg font-semibold text-blue-800 mb-4",children:"Agence Pandawan"}),s.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Dénomination sociale :"})," Pandawan"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Date de création :"})," 14/03/2014"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Siège social :"})," 25 Rue du Faubourg Saint-Antoine, 75011 Paris"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Statut juridique :"})," SAS"]})]}),s.jsxs("div",{className:"mt-4 p-4 bg-white rounded-lg border border-blue-100",children:[s.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed",children:[s.jsx("strong",{children:"Présentation :"})," Pandawan est une agence digitale internationale fondée en 2014, spécialisée dans le développement web, l'intelligence artificielle, le UX design et le référencement performant. Experte dans la création de contenus digitaux, tant pour le web que pour le mobile, l'agence poursuit son expansion dans plusieurs grandes villes à travers le monde."]}),s.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed mt-2",children:[s.jsx("strong",{children:"Son ambition :"})," offrir des services et produits de haute qualité, en valorisant l'identité de ses clients tout en y apportant une véritable valeur ajoutée à travers l'innovation et la créativité."]})]})]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"4. Propriété intellectuelle"}),s.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["L'ensemble des éléments du site (textes, images, graphismes, logo, vidéos, base de données, etc.) est protégé par le Code de la propriété intellectuelle.",s.jsx("br",{}),"Toute reproduction, représentation, modification ou extraction, totale ou partielle, sans autorisation écrite de SailingLoc est interdite."]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"5. Responsabilité"}),s.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["SailingLoc met tout en œuvre pour assurer l'exactitude des informations diffusées, mais ne saurait être tenue responsable des erreurs ou omissions.",s.jsx("br",{}),"SailingLoc décline toute responsabilité quant à l'utilisation du site ou aux dommages directs ou indirects pouvant en résulter."]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"6. Données personnelles"}),s.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Pour consulter notre politique de confidentialité, veuillez vous rendre sur la page dédiée :",s.jsx("br",{}),s.jsx(G,{to:"/politique-confidentialite",className:"text-orange-500 underline hover:text-orange-600 transition-colors inline-flex items-center mt-2",children:s.jsx("span",{children:"👉 Politique de confidentialité"})})]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"7. Cookies"}),s.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Lors de votre navigation, des cookies peuvent être déposés sur votre terminal. Vous pouvez à tout moment gérer vos préférences via notre bandeau dédié.",s.jsx("br",{}),"Pour plus d'informations, consultez notre ",s.jsx(G,{to:"/politique-confidentialite",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"politique de confidentialité"}),"."]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[s.jsx(Dr,{className:"h-6 w-6 mr-2"}),"8. Contact"]}),s.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Pour toute question ou signalement, vous pouvez nous écrire à :",s.jsx("br",{}),s.jsxs("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors inline-flex items-center mt-2",children:[s.jsx(Dr,{className:"h-4 w-4 mr-1"}),s.jsx("span",{children:"📧 sailinglocequipe@gmail.com"})]})]})]})]})})]})}const kp=({isOpen:r,onClose:e,title:t,message:n,type:i="error",details:a=null})=>{if(!r)return null;const l=()=>{switch(i){case"warning":return s.jsx(Hs,{className:"h-6 w-6 text-yellow-500"});case"success":return s.jsx(rt,{className:"h-6 w-6 text-green-500"});default:return s.jsx(Hs,{className:"h-6 w-6 text-red-500"})}},c=()=>{switch(i){case"warning":return"bg-yellow-50 border-yellow-200";case"success":return"bg-green-50 border-green-200";default:return"bg-red-50 border-red-200"}},u=()=>{switch(i){case"warning":return"text-yellow-800";case"success":return"text-green-800";default:return"text-red-800"}},h=()=>{switch(i){case"warning":return"bg-yellow-600 hover:bg-yellow-700";case"success":return"bg-green-600 hover:bg-green-700";default:return"bg-red-600 hover:bg-red-700"}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:`${c()} border rounded-lg shadow-xl max-w-md w-full mx-4`,children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[l(),s.jsx("h3",{className:`text-lg font-semibold ${u()}`,children:t})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ke,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("p",{className:`text-sm ${u()} mb-4`,children:n}),i==="error"&&s.jsx("div",{className:"bg-red-100 border border-red-300 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Hs,{className:"h-5 w-5 text-red-600"}),s.jsx("span",{className:"font-semibold text-red-800 text-sm",children:"⚠️ ATTENTION : Ces dates ne peuvent pas être réservées"})]})}),a&&a.conflictingBookings&&a.conflictingBookings.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:`font-medium text-sm ${u()} mb-2`,children:"Périodes déjà réservées :"}),s.jsx("div",{className:"space-y-2",children:a.conflictingBookings.map((p,g)=>s.jsxs("div",{className:"bg-white border border-gray-200 rounded p-3",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(gs,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-xs text-gray-600",children:["Client #",p.userId.slice(-6)]})]}),s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Du :"}),s.jsx("span",{className:"font-medium",children:new Date(p.startDate).toLocaleDateString("fr-FR")})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Au :"}),s.jsx("span",{className:"font-medium",children:new Date(p.endDate).toLocaleDateString("fr-FR")})]})]})]},g))})]}),a&&a.availabilityPeriods&&a.availabilityPeriods.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:`font-medium text-sm ${u()} mb-2`,children:"Disponibilité :"}),s.jsx("div",{className:"space-y-2",children:a.availabilityPeriods.map((p,g)=>s.jsx("div",{className:"bg-white border border-gray-200 rounded p-3",children:s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Du :"}),s.jsx("span",{className:"font-medium",children:new Date(p.startDate).toLocaleDateString("fr-FR")})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Au :"}),s.jsx("span",{className:"font-medium",children:new Date(p.endDate).toLocaleDateString("fr-FR")})]}),s.jsxs("div",{className:"flex justify-between mt-1",children:[s.jsx("span",{children:"Prix :"}),s.jsxs("span",{className:"font-medium text-green-600",children:[p.price,"€/jour"]})]})]})},g))})]}),i==="error"&&s.jsxs("div",{className:"bg-white border border-gray-200 rounded p-3",children:[s.jsx("h4",{className:"font-medium text-sm text-gray-800 mb-2",children:"Que faire ?"}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsx("li",{children:"• Choisir une autre période disponible"}),s.jsx("li",{children:"• Contacter le propriétaire pour plus d'options"}),s.jsx("li",{children:"• Vérifier le calendrier pour voir les disponibilités"})]})]})]}),s.jsx("div",{className:"flex justify-end p-4 border-t border-gray-200",children:s.jsx("button",{onClick:e,className:`${h()} text-white px-4 py-2 rounded-lg font-medium transition-colors`,children:"Compris"})})]})})},lN=({boatAvailability:r,existingBookings:e=[],onDateSelect:t,selectedStartDate:n,selectedEndDate:i})=>{const[a,l]=S.useState(new Date),[c,u]=S.useState(null),[h,p]=S.useState({isOpen:!1,title:"",message:"",type:"error",details:null}),g=j=>new Date(j.getFullYear(),j.getMonth(),1),y=j=>new Date(j.getFullYear(),j.getMonth()+1,0),w=j=>y(j).getDate(),C=j=>g(j).getDay(),_=j=>{if(!r||!r.startDate||!r.endDate)return!1;const b=new Date(r.startDate),M=new Date(r.endDate),Q=new Date(j);return Q.setHours(0,0,0,0),b.setHours(0,0,0,0),M.setHours(0,0,0,0),Q>=b&&Q<=M},N=j=>{if(!e||e.length===0)return!1;const b=new Date(j);return b.setHours(0,0,0,0),e.some(M=>{if(M.status==="cancelled")return!1;const Q=new Date(M.startDate),re=new Date(M.endDate);return Q.setHours(0,0,0,0),re.setHours(0,0,0,0),b>=Q&&b<=re})},R=j=>{if(!e||e.length===0)return[];const b=new Date(j);return b.setHours(0,0,0,0),e.filter(M=>{if(M.status==="cancelled")return!1;const Q=new Date(M.startDate),re=new Date(M.endDate);return Q.setHours(0,0,0,0),re.setHours(0,0,0,0),b>=Q&&b<=re})},k=j=>{if(!n||!i)return!1;const b=new Date(j),M=new Date(n),Q=new Date(i);return b.setHours(0,0,0,0),M.setHours(0,0,0,0),Q.setHours(0,0,0,0),b>=M&&b<=Q},D=j=>{if(!n)return!1;const b=new Date(j),M=new Date(n);return b.setHours(0,0,0,0),M.setHours(0,0,0,0),b.getTime()===M.getTime()},P=j=>{if(!i)return!1;const b=new Date(j),M=new Date(i);return b.setHours(0,0,0,0),M.setHours(0,0,0,0),b.getTime()===M.getTime()},B=j=>{const b=new Date;b.setHours(0,0,0,0);const M=new Date(j);return M.setHours(0,0,0,0),_(j)&&!N(j)&&M>=b},L=j=>{if(N(j)){const M=R(j);p({isOpen:!0,title:"Dates indisponibles",message:"Ces dates sont déjà réservées par un autre client.",type:"error",details:{conflictingBookings:M}});return}if(!_(j)){p({isOpen:!0,title:"Période non disponible",message:"Cette date n'est pas dans la disponibilité générale du bateau.",type:"error",details:null});return}if(!B(j))return;const b=j.toISOString().split("T")[0];n?i?t(b,null):new Date(b)>new Date(n)?t(n,b):t(b,n):t(b,null)},E=()=>{l(new Date(a.getFullYear(),a.getMonth()-1,1))},f=()=>{l(new Date(a.getFullYear(),a.getMonth()+1,1))},v=()=>{l(new Date)},A=(()=>{g(a),y(a);const j=w(a),b=C(a),M=[],Q=new Date(a.getFullYear(),a.getMonth()-1,1),re=w(Q);for(let ee=b-1;ee>=0;ee--){const ce=re-ee,le=new Date(Q.getFullYear(),Q.getMonth(),ce);M.push({date:le,isCurrentMonth:!1,isClickable:!1})}for(let ee=1;ee<=j;ee++){const ce=new Date(a.getFullYear(),a.getMonth(),ee);M.push({date:ce,isCurrentMonth:!0,isClickable:B(ce)})}const X=42-M.length;for(let ee=1;ee<=X;ee++){const ce=new Date(a.getFullYear(),a.getMonth()+1,ee);M.push({date:ce,isCurrentMonth:!1,isClickable:!1})}return M})();return s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[s.jsx(rt,{className:"h-5 w-5 text-blue-600 mr-2"}),"Calendrier de disponibilité"]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:E,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:"←"}),s.jsx("button",{onClick:v,className:"px-3 py-2 text-sm text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",children:"Aujourd'hui"}),s.jsx("button",{onClick:f,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:"→"})]})]}),r&&r.startDate&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-blue-800 mb-2",children:[s.jsx(Wi,{className:"h-4 w-4"}),s.jsx("span",{className:"font-medium",children:"Disponibilité du bateau"})]}),s.jsxs("p",{className:"text-sm text-blue-700",children:["Du ",new Date(r.startDate).toLocaleDateString("fr-FR"),"au ",new Date(r.endDate).toLocaleDateString("fr-FR")]}),s.jsxs("p",{className:"text-sm text-blue-700",children:["Prix : ",r.price,"€ par jour"]}),r.notes&&s.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Notes : ",r.notes]})]}),s.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"].map((j,b)=>s.jsx("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:j},b))}),s.jsx("div",{className:"grid grid-cols-7 gap-1",children:A.map((j,b)=>{const M=_(j.date),Q=N(j.date),re=k(j.date),X=D(j.date),ee=P(j.date),ce=j.date.toDateString()===new Date().toDateString();let le="bg-white",Oe="text-gray-400",me="border-gray-200";return j.isCurrentMonth&&(re?X||ee?(le="bg-blue-600",Oe="text-white",me="border-blue-600"):(le="bg-blue-100",Oe="text-blue-800",me="border-blue-200"):Q?(le="bg-red-100",Oe="text-red-800",me="border-red-200"):M?(le="bg-green-50",Oe="text-green-800",me="border-green-200"):Oe="text-gray-900"),ce&&(me="border-blue-500"),s.jsxs("div",{className:`
                ${le} ${Oe} ${me}
                border rounded-lg p-2 text-center text-sm cursor-pointer
                transition-all duration-200 hover:shadow-md
                ${j.isClickable?"hover:scale-105":""}
                ${j.isCurrentMonth?"":"opacity-50"}
                ${j.isClickable?"":"cursor-not-allowed"}
              `,onClick:()=>L(j.date),onMouseEnter:()=>u(j.date),onMouseLeave:()=>u(null),children:[s.jsx("div",{className:"font-medium",children:j.date.getDate()}),ce&&s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mx-auto mt-1"}),M&&!re&&!Q&&s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mx-auto mt-1"}),Q&&s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mx-auto mt-1"}),X&&s.jsx("div",{className:"text-xs font-bold mt-1",children:"Début"}),ee&&s.jsx("div",{className:"text-xs font-bold mt-1",children:"Fin"}),Q&&s.jsx("div",{className:"text-xs font-bold text-red-700 bg-red-200 px-2 py-1 rounded-full mt-1",children:"❌ RÉSERVÉ"})]},b)})}),s.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-green-50 border border-green-200 rounded"}),s.jsx("span",{children:"Disponible"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-red-100 border border-red-200 rounded"}),s.jsx("span",{children:"Réservé"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-blue-100 border border-blue-200 rounded"}),s.jsx("span",{children:"Sélectionné"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-blue-600 rounded"}),s.jsx("span",{children:"Début/Fin"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-white border border-blue-500 rounded"}),s.jsx("span",{children:"Aujourd'hui"})]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Instructions :"})," Cliquez sur une date disponible pour sélectionner le début de votre réservation, puis cliquez sur une autre date pour sélectionner la fin."]})}),s.jsx(kp,{isOpen:h.isOpen,onClose:()=>p({...h,isOpen:!1}),title:h.title,message:h.message,type:h.type,details:h.details})]})},cN=({startDate:r,endDate:e,boatAvailability:t,existingBookings:n,onConflictDetected:i})=>{if(S.useEffect(()=>{if(r&&e&&i&&l()){const w=c();i({title:"Conflit de réservation détecté",message:"La période sélectionnée chevauche des réservations existantes.",type:"error",details:{conflictingBookings:w}})}},[r,e,n,i]),!r||!e)return null;const a=()=>{if(!t||!t.startDate||!t.endDate)return!1;const y=new Date(t.startDate),w=new Date(t.endDate),C=new Date(r),_=new Date(e);return y.setHours(0,0,0,0),w.setHours(0,0,0,0),C.setHours(0,0,0,0),_.setHours(0,0,0,0),C>=y&&_<=w},l=()=>{if(!n||n.length===0)return!1;const y=new Date(r),w=new Date(e);return y.setHours(0,0,0,0),w.setHours(0,0,0,0),n.some(C=>{if(C.status==="cancelled")return!1;const _=new Date(C.startDate),N=new Date(C.endDate);return _.setHours(0,0,0,0),N.setHours(0,0,0,0),!(w<=_||y>=N)})},c=()=>{if(!n||n.length===0)return[];const y=new Date(r),w=new Date(e);return y.setHours(0,0,0,0),w.setHours(0,0,0,0),n.filter(C=>{if(C.status==="cancelled")return!1;const _=new Date(C.startDate),N=new Date(C.endDate);return _.setHours(0,0,0,0),N.setHours(0,0,0,0),!(w<=_||y>=N)})},u=(y,w)=>{const C=new Date(y),_=new Date(w);C.setHours(0,0,0,0),_.setHours(0,0,0,0);const R=(_.getTime()-C.getTime())/(1e3*60*60*24);return Math.max(1,Math.ceil(R))},h=a(),p=l(),g=c();return h?p?s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-red-800 mb-2",children:[s.jsx(Hs,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"⚠️ DATES INDISPONIBLES"})]}),s.jsx("p",{className:"text-sm text-red-700 mb-3",children:"La période sélectionnée chevauche des réservations existantes :"}),s.jsx("div",{className:"space-y-2",children:g.map((y,w)=>s.jsxs("div",{className:"bg-red-100 border border-red-200 rounded p-2",children:[s.jsxs("div",{className:"text-sm text-red-800",children:[s.jsx("span",{className:"font-medium",children:"Réservé du :"})," ",new Date(y.startDate).toLocaleDateString("fr-FR")]}),s.jsxs("div",{className:"text-sm text-red-800",children:[s.jsx("span",{className:"font-medium",children:"Au :"})," ",new Date(y.endDate).toLocaleDateString("fr-FR")]})]},w))}),s.jsx("p",{className:"text-sm text-red-600 mt-3",children:"Veuillez sélectionner une autre période ou contacter le propriétaire."})]}):s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-green-800 mb-2",children:[s.jsx(Rr,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"Période disponible"})]}),s.jsx("p",{className:"text-sm text-green-700",children:"La période sélectionnée est disponible et peut être réservée."}),s.jsxs("div",{className:"mt-2 text-sm text-green-600",children:[s.jsxs("div",{children:["Du : ",new Date(r).toLocaleDateString("fr-FR")]}),s.jsxs("div",{children:["Au : ",new Date(e).toLocaleDateString("fr-FR")]}),s.jsxs("div",{className:"font-medium mt-1",children:["Durée : ",u(r,e)," jours"]})]})]}):s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-red-800 mb-2",children:[s.jsx(Yi,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"Période non disponible"})]}),s.jsx("p",{className:"text-sm text-red-700",children:"La période sélectionnée n'est pas dans la disponibilité générale du bateau."}),s.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Disponibilité : du ",new Date(t?.startDate).toLocaleDateString("fr-FR"),"au ",new Date(t?.endDate).toLocaleDateString("fr-FR")]})]})};function uN(){const{boatId:r}=vd();es();const[e,t]=S.useState(null),[n,i]=S.useState(!0),[a,l]=S.useState(!1),[c,u]=S.useState(!1),[h,p]=S.useState(""),[g,y]=S.useState([]),[w,C]=S.useState({isOpen:!1,title:"",message:"",type:"error",details:null}),[_,N]=S.useState({startDate:"",endDate:"",numberOfGuests:1,specialRequests:"",totalPrice:0});S.useEffect(()=>{r&&R()},[r]),S.useEffect(()=>{_.startDate&&_.endDate&&e&&k()},[_.startDate,_.endDate,_.numberOfGuests,e]),S.useEffect(()=>{if(_.startDate&&_.endDate&&e){const f=new Date(_.startDate),v=new Date(_.endDate),T=new Date;T.setHours(0,0,0,0),f<=v&&f>=T&&p("")}},[_.startDate,_.endDate,e]);const R=async()=>{try{i(!0);const f=await fetch(`http://localhost:3001/api/boats/${r}`);if(!f.ok)throw new Error("Bateau non trouvé");const v=await f.json();t(v);const T=await fetch(`http://localhost:3001/api/bookings/boat/${r}`);if(T.ok){const A=await T.json();A.success&&(y(A.data),console.log("Réservations existantes chargées:",A.data))}}catch(f){p(f.message)}finally{i(!1)}},k=()=>{if(!_.startDate||!_.endDate||!e)return;const f=new Date(_.startDate),v=new Date(_.endDate),A=Math.max(1,Math.ceil((v-f)/(1e3*60*60*24)))*e.prix_jour;N(j=>({...j,totalPrice:A}))},D=(f,v)=>{const T=new Date(f),A=new Date(v);T.setHours(0,0,0,0),A.setHours(0,0,0,0);const b=(A.getTime()-T.getTime())/(1e3*60*60*24);return Math.max(1,Math.ceil(b))},P=(f,v)=>{N(T=>({...T,[f]:v})),(f==="startDate"||f==="endDate")&&p("")},B=(f,v)=>{N(T=>({...T,startDate:f||"",endDate:v||""})),p("")},L=f=>{C(f),f.title==="Période non disponible"&&p("Période non disponible - Veuillez sélectionner des dates valides")},E=async f=>{if(f.preventDefault(),!_.startDate||!_.endDate){p("Veuillez sélectionner les dates de début et de fin");return}const v=new Date(_.startDate),T=new Date(_.endDate);if(v>T){p("La date de fin doit être égale ou postérieure à la date de début");return}const A=new Date;if(A.setHours(0,0,0,0),v<A){p("La date de début ne peut pas être dans le passé");return}if(g&&g.length>0&&g.some(b=>{if(b.status==="cancelled")return!1;const M=new Date(b.startDate),Q=new Date(b.endDate);return v.setHours(0,0,0,0),T.setHours(0,0,0,0),M.setHours(0,0,0,0),Q.setHours(0,0,0,0),!(T<=M||v>=Q)})){p("La période sélectionnée chevauche des réservations existantes. Veuillez choisir une autre période.");return}try{l(!0),p("");const j=localStorage.getItem("token")||sessionStorage.getItem("token");if(!j){p("Vous devez être connecté pour effectuer une réservation");return}const b=await fetch("http://localhost:3001/api/payment/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify({boatId:r,startDate:_.startDate,endDate:_.endDate,numberOfGuests:_.numberOfGuests,specialRequests:_.specialRequests})});if(!b.ok){const Q=await b.json();throw new Error(Q.message||"Erreur lors de l’initiation du paiement")}const{url:M}=await b.json();window.location.href=M}catch(j){p(j.message)}finally{l(!1)}};return n?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Kt,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement du bateau..."})]})}):h&&!e?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx($e,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:h}),s.jsx(G,{to:"/bateaux",className:"text-blue-600 hover:text-blue-700",children:"Retourner à la liste des bateaux"})]})}):c?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto",children:[s.jsx(Rr,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Réservation confirmée !"}),s.jsx("p",{className:"text-gray-600 mb-6",children:'Votre réservation a été créée avec succès ! Elle apparaîtra dans votre espace "Mes Réservations".'}),s.jsx("p",{className:"text-sm text-gray-500",children:'Redirection vers "Mes Réservations" dans quelques secondes...'})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[s.jsxs(G,{to:`/bateaux/${r}`,className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 mb-4",children:[s.jsx(ba,{size:20}),s.jsx("span",{children:"Retour au bateau"})]}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Réserver ce bateau"})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Détails de la réservation"}),h&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6",children:h}),s.jsxs("form",{onSubmit:E,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de début"}),s.jsx("input",{type:"date",value:_.startDate,onChange:f=>P("startDate",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de fin"}),s.jsx("input",{type:"date",value:_.endDate,onChange:f=>P("endDate",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de personnes"}),s.jsx("select",{value:_.numberOfGuests,onChange:f=>P("numberOfGuests",parseInt(f.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[...Array(e.capacite)].map((f,v)=>s.jsxs("option",{value:v+1,children:[v+1," personne",v+1>1?"s":""]},v+1))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Demandes spéciales (optionnel)"}),s.jsx("textarea",{value:_.specialRequests,onChange:f=>P("specialRequests",f.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Équipements supplémentaires, préférences particulières..."})]}),!h&&s.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx(Kt,{className:"h-5 w-5 animate-spin"}),s.jsx("span",{children:"Redirection vers le paiement..."})]}):"Confirmer la réservation"})]}),_.startDate&&_.endDate&&s.jsx(cN,{startDate:_.startDate,endDate:_.endDate,boatAvailability:e?.availability,existingBookings:g,onConflictDetected:L})]}),e&&e.availability&&e.availability.startDate&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Calendrier de disponibilité"}),s.jsx(lN,{boatAvailability:e.availability,existingBookings:g,onDateSelect:B,selectedStartDate:_.startDate,selectedEndDate:_.endDate})]})]}),s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-24",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Résumé"}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx("img",{src:e.image,alt:e.nom,className:"w-16 h-16 object-cover rounded-lg"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.nom}),s.jsx("p",{className:"text-sm text-gray-600 capitalize",children:e.type})]})]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Gt,{size:16}),s.jsx("span",{children:e.localisation})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Xs,{size:16}),s.jsxs("span",{children:["Capacité : ",e.capacite," personnes"]})]})]}),e.availability&&e.availability.startDate&&s.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-md",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-green-800 mb-2",children:[s.jsx(rt,{size:16}),s.jsx("span",{className:"font-medium text-sm",children:"Disponibilité"})]}),s.jsxs("div",{className:"text-xs text-green-700 space-y-1",children:[s.jsxs("div",{children:["Du ",new Date(e.availability.startDate).toLocaleDateString("fr-FR")]}),s.jsxs("div",{children:["Au ",new Date(e.availability.endDate).toLocaleDateString("fr-FR")]}),s.jsxs("div",{className:"font-medium",children:["Prix : ",e.availability.price,"€ par jour"]}),e.availability.notes&&s.jsx("div",{className:"italic",children:e.availability.notes})]})]})]}),s.jsxs("div",{className:"space-y-3 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Prix par jour"}),s.jsxs("span",{className:"font-medium",children:[e.prix_jour,"€"]})]}),_.startDate&&_.endDate&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Durée"}),s.jsxs("span",{className:"font-medium",children:[D(_.startDate,_.endDate)," jours"]})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Nombre de personnes"}),s.jsx("span",{className:"font-medium",children:_.numberOfGuests})]})]}),s.jsx("div",{className:"border-t pt-3",children:s.jsxs("div",{className:"flex items-center justify-between font-semibold",children:[s.jsx("span",{children:"Total"}),s.jsxs("span",{className:"text-lg text-blue-600",children:[_.totalPrice,"€"]})]})})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Informations importantes"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[s.jsx("li",{children:"• Réservation sécurisée"}),s.jsx("li",{children:"• Annulation gratuite jusqu'à 24h avant"}),s.jsx("li",{children:"• Paiement sécurisé"}),s.jsx("li",{children:"• Support client 24/7"})]})]})]})})]})}),s.jsx(kp,{isOpen:w.isOpen,onClose:()=>C({...w,isOpen:!1}),title:w.title,message:w.message,type:w.type,details:w.details})]})}function dN(){const[r,e]=S.useState([]),[t,n]=S.useState(!0),[i,a]=S.useState("");S.useEffect(()=>{l()},[]);const l=async()=>{try{n(!0);const p=localStorage.getItem("token")||sessionStorage.getItem("token");if(!p){a("Vous devez être connecté pour voir vos réservations"),n(!1);return}const g=await fetch("http://localhost:3001/api/bookings/my-bookings",{headers:{Authorization:`Bearer ${p}`}});if(!g.ok)throw new Error("Erreur lors de la récupération des réservations");const y=await g.json();e(y.data||[])}catch(p){a(p.message)}finally{n(!1)}},c=p=>{switch(p){case"confirmed":return{icon:s.jsx(yt,{size:20,className:"text-blue-600"}),label:"Confirmée",color:"bg-blue-100 text-blue-800 border-blue-200"};case"pending":return{icon:s.jsx(yt,{size:20,className:"text-yellow-600"}),label:"En attente",color:"bg-yellow-100 text-yellow-800 border-yellow-200"};case"cancelled":return{icon:s.jsx(Yi,{size:20,className:"text-red-600"}),label:"Annulée",color:"bg-red-100 text-red-800 border-red-200"};default:return{icon:s.jsx(Sn,{size:20,className:"text-gray-600"}),label:p,color:"bg-gray-100 text-gray-800 border-gray-200"}}},u=p=>new Date(p).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),h=(p,g)=>{const y=new Date(p),w=new Date(g);y.setHours(0,0,0,0),w.setHours(0,0,0,0);const _=(w.getTime()-y.getTime())/(1e3*60*60*24);return Math.max(1,Math.ceil(_))};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Kt,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement de vos réservations..."})]})}):i?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto",children:[s.jsx(Sn,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Erreur"}),s.jsx("p",{className:"text-gray-600 mb-6",children:i}),s.jsx(G,{to:"/connexion",className:"inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mes Réservations"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Gérez et suivez toutes vos réservations de bateaux"})]}),s.jsx(G,{to:"/bateaux",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Réserver un bateau"})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r.length===0?s.jsxs("div",{className:"text-center py-16",children:[s.jsx($e,{className:"h-24 w-24 text-gray-300 mx-auto mb-6"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Aucune réservation pour le moment"}),s.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:"Vous n'avez pas encore de réservations. Commencez par explorer nos bateaux disponibles et réservez votre première sortie en mer !"}),s.jsx(G,{to:"/bateaux",className:"inline-block bg-orange-500 text-white px-8 py-4 rounded-lg text-lg font-medium hover:bg-orange-600 transition-colors",children:"Découvrir nos bateaux"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(rt,{className:"h-6 w-6 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(yt,{className:"h-6 w-6 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Confirmées"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(p=>p.status==="confirmed").length})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:s.jsx(yt,{className:"h-6 w-6 text-yellow-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En attente"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(p=>p.status==="pending").length})]})]})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Toutes vos réservations"}),r.map(p=>{const g=c(p.status),y=h(p.startDate,p.endDate);return s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:p.boatId?.nom||"Bateau"}),s.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${g.color}`,children:[g.icon,s.jsx("span",{className:"ml-1",children:g.label})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(rt,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-600",children:["Du ",u(p.startDate)," au ",u(p.endDate)]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(yt,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-600",children:[y," jour",y>1?"s":""]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Xs,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-600",children:[p.numberOfGuests," personne",p.numberOfGuests>1?"s":""]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ki,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-600 font-medium",children:[p.totalPrice,"€"]})]})]}),p.specialRequests&&s.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Demandes spéciales :"})," ",p.specialRequests]})})]}),s.jsx("div",{className:"flex flex-col items-end space-y-2",children:s.jsx(G,{to:`/bateaux/${p.boatId?._id||p.boatId}`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Voir le bateau"})})]})})},p._id)})]})]})})]})}const hN=()=>{const[r,e]=S.useState([]),[t,n]=S.useState(!0),[i,a]=S.useState("");S.useEffect(()=>{l()},[]);const l=async()=>{try{n(!0),a("");const w=localStorage.getItem("token")||sessionStorage.getItem("token");if(!w)throw new Error("Token d'authentification manquant");const C=await fetch("http://localhost:3001/api/bookings/owner",{headers:{Authorization:`Bearer ${w}`}}),_=await C.json();if(!C.ok)throw new Error(_.message||`Erreur ${C.status}: ${C.statusText}`);if(_.success)e(_.data),_.message&&console.log(_.message);else throw new Error(_.message||"Erreur lors du chargement des réservations")}catch(w){console.error("Erreur loadOwnerBookings:",w),a(w.message)}finally{n(!1)}},c=async(w,C)=>{try{const _=localStorage.getItem("token")||sessionStorage.getItem("token");if(!_)throw new Error("Token d'authentification manquant");const N=await fetch(`http://localhost:3001/api/bookings/${w}/owner-action`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`},body:JSON.stringify({action:C})}),R=await N.json();if(!N.ok)throw new Error(R.message||`Erreur ${N.status}: ${N.statusText}`);if(R.success)await l(),alert(R.message);else throw new Error(R.message||"Erreur lors de l'action")}catch(_){console.error("Erreur handleOwnerAction:",_),alert(`Erreur: ${_.message}`)}},u=w=>{switch(w){case"pending":return s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[s.jsx(yt,{className:"h-3 w-3 mr-1"}),"En attente"]});case"confirmed":return s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[s.jsx(Rr,{className:"h-3 w-3 mr-1"}),"Confirmée"]});case"cancelled":return s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[s.jsx(Yi,{className:"h-3 w-3 mr-1"}),"Annulée"]});case"completed":return s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Terminée"});default:return s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:w})}},h=w=>new Date(w).toLocaleDateString("fr-FR"),p=(w,C)=>{const _=new Date(w),N=new Date(C);_.setHours(0,0,0,0),N.setHours(0,0,0,0);const k=(N.getTime()-_.getTime())/(1e3*60*60*24);return Math.max(1,Math.ceil(k))};if(t)return s.jsx("div",{className:"flex items-center justify-center p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx(yt,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-600",children:"Chargement des réservations..."})]})});if(i)return s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("p",{className:"text-red-800",children:["Erreur: ",i]})});const g=r.filter(w=>w.status==="pending"),y=r.filter(w=>w.status!=="pending");return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(yt,{className:"h-5 w-5 text-yellow-600 mr-2"}),"Réservations en attente de confirmation (",g.length,")"]}),g.length===0?s.jsx("p",{className:"text-gray-500 text-sm",children:"Aucune réservation en attente"}):s.jsx("div",{className:"space-y-4",children:g.map(w=>s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(gs,{className:"h-5 w-5 text-yellow-600"}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[w.userId?.nom," ",w.userId?.prenom]}),s.jsx("p",{className:"text-sm text-gray-600",children:w.userId?.email})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx($e,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:w.boatId?.nom})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(rt,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm text-gray-700",children:["Du ",h(w.startDate)," au ",h(w.endDate)]})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(Ki,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm text-gray-700",children:["Total: ",w.totalPrice,"€ (",p(w.startDate,w.endDate)," jours)"]})]}),w.numberOfGuests&&s.jsxs("p",{className:"text-sm text-gray-600",children:["Nombre de personnes: ",w.numberOfGuests]}),w.specialRequests&&s.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[s.jsx("span",{className:"font-medium",children:"Demandes spéciales:"})," ",w.specialRequests]})]}),s.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[u(w.status),s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs("button",{onClick:()=>c(w._id,"confirm"),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[s.jsx(Rr,{className:"h-4 w-4 mr-1"}),"Confirmer"]}),s.jsxs("button",{onClick:()=>c(w._id,"refuse"),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[s.jsx(Yi,{className:"h-4 w-4 mr-1"}),"Refuser"]})]})]})]})},w._id))})]}),y.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Autres réservations"}),s.jsx("div",{className:"space-y-4",children:y.map(w=>s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(gs,{className:"h-5 w-5 text-gray-600"}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[w.userId?.nom," ",w.userId?.prenom]}),s.jsx("p",{className:"text-sm text-gray-600",children:w.userId?.email})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx($e,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:w.boatId?.nom})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(rt,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm text-gray-700",children:["Du ",h(w.startDate)," au ",h(w.endDate)]})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(Ki,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm text-gray-700",children:["Total: ",w.totalPrice,"€"]})]})]}),s.jsx("div",{className:"ml-4",children:u(w.status)})]})},w._id))})]})]})};function mN(){const r=es();return s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[s.jsxs("button",{onClick:()=>r(-1),className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 mb-4",children:[s.jsx(ba,{size:20}),s.jsx("span",{children:"Retour"})]}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des réservations"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Gérez les réservations de vos bateaux et confirmez ou refusez les demandes"})]})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8",children:[s.jsxs("h2",{className:"text-lg font-semibold text-blue-900 mb-4 flex items-center",children:[s.jsx(yt,{className:"h-5 w-5 text-blue-600 mr-2"}),"Comment ça fonctionne ?"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"bg-blue-100 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3",children:s.jsx("span",{className:"text-blue-600 font-bold text-lg",children:"1"})}),s.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Client réserve et paie"}),s.jsx("p",{className:"text-sm text-blue-700",children:'Le client sélectionne ses dates, paie et la réservation passe en statut "En attente"'})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"bg-blue-100 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3",children:s.jsx("span",{className:"text-blue-600 font-bold text-lg",children:"2"})}),s.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Dates bloquées"}),s.jsx("p",{className:"text-sm text-blue-700",children:"Les dates sont automatiquement bloquées (rouge) pour éviter les conflits"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"bg-blue-100 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3",children:s.jsx("span",{className:"text-blue-600 font-bold text-lg",children:"3"})}),s.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Vous confirmez"}),s.jsx("p",{className:"text-sm text-blue-700",children:"Vous confirmez ou refusez la réservation selon votre disponibilité"})]})]})]}),s.jsx(hN,{})]})]})}function pN(){return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-50 pt-20",children:s.jsx("section",{className:"relative py-20",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"relative inline-block",children:[s.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-2xl",children:s.jsx($e,{className:"h-16 w-16 text-white"})}),s.jsx("div",{className:"absolute -top-2 -right-2 w-12 h-12 bg-red-500 rounded-full flex items-center justify-center shadow-lg",children:s.jsx("span",{className:"text-white font-bold text-xl",children:"!"})})]}),s.jsx("h1",{className:"text-8xl md:text-9xl font-bold text-blue-600 mb-4 tracking-wider",children:"404"}),s.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-6",children:"Page introuvable"}),s.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed",children:"Oups ! Il semble que vous ayez navigué vers des eaux inconnues. Cette page n'existe pas ou a été déplacée."})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-12 border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-6",children:[s.jsx(Lc,{className:"h-8 w-8 text-blue-500"}),s.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Navigation perdue"})]}),s.jsx("p",{className:"text-gray-600 text-lg mb-6",children:"Ne vous inquiétez pas, même les meilleurs navigateurs peuvent se perdre ! Utilisez la boussole ci-dessous pour retrouver votre route."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"🌊"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Océans explorés"}),s.jsx("div",{className:"text-2xl font-bold text-blue-800",children:"7"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"⚓"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Ports visités"}),s.jsx("div",{className:"text-2xl font-bold text-green-800",children:"42"})]}),s.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[s.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:"🧭"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Direction trouvée"}),s.jsx("div",{className:"text-2xl font-bold text-orange-800",children:"100%"})]})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-12",children:[s.jsxs(G,{to:"/",className:"inline-flex items-center space-x-3 bg-blue-600 text-white px-8 py-4 rounded-full font-bold text-lg hover:bg-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg",children:[s.jsx(hf,{size:24}),s.jsx("span",{children:"Retour à l'accueil"})]}),s.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center space-x-3 border-2 border-blue-600 text-blue-600 px-8 py-4 rounded-full font-bold text-lg hover:bg-blue-50 transition-all duration-300 transform hover:scale-105",children:[s.jsx(ba,{size:24}),s.jsx("span",{children:"Page précédente"})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:[s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Destinations populaires"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs(G,{to:"/bateaux",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[s.jsx(fs,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"Nos bateaux"})]}),s.jsxs(G,{to:"/a-propos",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[s.jsx($e,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"À propos"})]}),s.jsxs(G,{to:"/contact",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[s.jsx(Lc,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"Contact"})]}),s.jsxs(G,{to:"/inscription",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[s.jsx(fs,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"S'inscrire"})]})]})]}),s.jsxs("div",{className:"mt-12 text-center",children:[s.jsxs("p",{className:"text-lg text-gray-600 mb-4",children:["💡 ",s.jsx("strong",{children:"Conseil de navigateur :"}),"Gardez toujours un œil sur votre boussole !"]}),s.jsxs("div",{className:"flex items-center justify-center space-x-2 text-blue-600",children:[s.jsx(fs,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"SailingLoc - Votre boussole vers l'aventure"})]})]})]})})})}function fN(){const{pathname:r}=tl();return S.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[r]),null}function gN(){const[r,e]=S.useState(!1);S.useEffect(()=>{try{(typeof window<"u"?window.localStorage.getItem("cookieConsent"):null)||e(!0)}catch{e(!0)}},[]),S.useEffect(()=>{if(!(typeof document>"u")&&r){const n=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=n}}},[r]);const t=n=>{try{typeof window<"u"&&(window.localStorage.setItem("cookieConsent",n),window.localStorage.setItem("cookieConsentAt",new Date().toISOString()))}catch{}e(!1)};return r?s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm",role:"dialog","aria-modal":"true","aria-labelledby":"cookie-consent-title",children:s.jsx("div",{className:"min-h-full flex items-end md:items-center justify-center p-4",children:s.jsxs("div",{className:"w-full md:max-w-3xl rounded-2xl bg-white shadow-2xl border border-gray-200 p-6 md:p-8",children:[s.jsx("h2",{id:"cookie-consent-title",className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3",children:"Gestion des cookies"}),s.jsxs("p",{className:"text-base md:text-lg text-gray-700 leading-relaxed mb-4",children:["Nous utilisons des cookies pour assurer le bon fonctionnement du site, améliorer votre expérience, mesurer l'audience et sécuriser votre session. Vous pouvez"," ",s.jsx("span",{className:"font-semibold",children:"refuser"})," les cookies non essentiels ou ",s.jsx("span",{className:"font-semibold",children:"accepter"})," tous les cookies. Pour en savoir plus, consultez notre",s.jsxs(G,{to:"/politique-confidentialite",className:"text-blue-600 underline hover:text-blue-700",children:[" ","politique de confidentialité"]}),"."]}),s.jsxs("ul",{className:"text-sm md:text-base text-gray-600 list-disc pl-5 space-y-1 mb-6",children:[s.jsx("li",{children:"Cookies essentiels: nécessaires au fonctionnement et à la sécurité (toujours actifs)."}),s.jsx("li",{children:"Cookies de mesure d’audience et de personnalisation: activés uniquement si vous acceptez."})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3",children:[s.jsx("button",{type:"button",onClick:()=>t("rejected"),className:"w-full sm:w-auto px-5 py-3 rounded-xl border border-gray-300 text-gray-800 bg-white hover:bg-gray-50 text-base font-medium",children:"Refuser"}),s.jsx("button",{type:"button",onClick:()=>t("accepted"),className:"w-full sm:w-auto px-5 py-3 rounded-xl bg-blue-600 text-white hover:bg-blue-700 text-base font-semibold",children:"Accepter"})]})]})})}):null}function xN(){const r=tl();es();const[e,t]=S.useState(!0),[n,i]=S.useState(""),a=new URLSearchParams(r.search),l=a.get("boatId"),c=a.get("startDate"),u=a.get("endDate"),h=a.get("numberOfGuests")?parseInt(a.get("numberOfGuests"),10):1,p=a.get("specialRequests")||"",g=async()=>{try{t(!0),i("");const y=localStorage.getItem("token")||sessionStorage.getItem("token");if(!y)throw new Error("Vous devez être connecté pour payer.");if(!l||!c||!u)throw new Error("Paramètres de réservation manquants.");const w=await fetch("http://localhost:3001/api/payment/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify({boatId:l,startDate:c,endDate:u,numberOfGuests:h,specialRequests:p})});if(!w.ok){const _=await w.json().catch(()=>({}));throw new Error(_.message||"Échec de l’initiation du paiement.")}const{url:C}=await w.json();window.location.href=C}catch(y){i(y.message)}finally{t(!1)}};return S.useEffect(()=>{l&&c&&u?g():(t(!1),i("Paramètres manquants. Veuillez recommencer la réservation."))},[]),e?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Kt,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-700",children:"Redirection vers le paiement sécurisé..."})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-8 max-w-md w-full text-center",children:[s.jsx(wd,{className:"h-12 w-12 text-blue-600 mx-auto mb-3"}),s.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Paiement"}),n?s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-red-600 mb-4",children:n}),s.jsxs("div",{className:"space-x-3",children:[s.jsx(G,{to:"/bateaux",className:"text-blue-600 hover:text-blue-700",children:"Retour aux bateaux"}),l&&c&&u&&s.jsx("button",{onClick:g,className:"inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Réessayer le paiement"})]})]}):s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-gray-700 mb-4",children:"Cliquez sur le bouton ci-dessous si vous n’avez pas été redirigé automatiquement."}),s.jsx("button",{onClick:g,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Continuer vers Stripe"})]})]})})}function yN(){const r=es(),[e,t]=S.useState("Validation du paiement en cours..."),[n,i]=S.useState("");return S.useEffect(()=>{const l=new URLSearchParams(window.location.search).get("session_id"),c=localStorage.getItem("token")||sessionStorage.getItem("token");async function u(){try{if(!l)throw new Error("Identifiant de session Stripe manquant.");if(!c)throw new Error("Vous devez être connecté pour finaliser la réservation.");const h=await fetch("http://localhost:3001/api/payment/confirm",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({session_id:l})});if(!h.ok){const p=await h.json().catch(()=>({}));throw new Error(p.message||"Échec de la confirmation du paiement.")}t("Paiement confirmé ! Votre réservation est en attente de confirmation par le propriétaire."),setTimeout(()=>r("/mes-reservations"),4e3)}catch(h){i(h.message)}}u()},[r]),n?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-600 mb-4",children:n}),s.jsx("button",{onClick:()=>r("/"),className:"text-blue-600 hover:text-blue-700",children:"Retour à l’accueil"})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Rr,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-800",children:e}),s.jsx(Kt,{className:"h-6 w-6 animate-spin text-blue-600 mx-auto mt-4"}),s.jsx("div",{className:"mt-6",children:s.jsx("button",{onClick:()=>r("/mes-reservations"),className:"text-blue-600 hover:text-blue-700",children:"Aller à mes réservations"})})]})})}function bN(){const[r]=Jp(),e=es(),[t,n]=S.useState("Paiement annulé. Annulation de la réservation en cours..."),[i,a]=S.useState("");return S.useEffect(()=>{const l=r.get("bookingId"),c=localStorage.getItem("token")||sessionStorage.getItem("token");async function u(){try{if(!l){n("Paiement annulé.");return}if(!c){a("Veuillez vous connecter pour annuler la réservation.");return}const h=await fetch(`http://localhost:3001/api/bookings/${l}/cancel`,{method:"PUT",headers:{Authorization:`Bearer ${c}`}});if(!h.ok){const p=await h.json().catch(()=>({}));throw new Error(p.message||"Impossible d’annuler la réservation.")}n("Réservation annulée suite à l’annulation du paiement.")}catch(h){a(h.message)}}u()},[r]),s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-8 max-w-md w-full text-center",children:[s.jsx("h1",{className:"text-2xl font-bold mb-3",children:"Paiement annulé"}),i?s.jsx("p",{className:"text-red-600 mb-6",children:i}):s.jsx("p",{className:"text-gray-700 mb-6",children:t}),s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx("button",{onClick:()=>e(-1),className:"text-blue-600 hover:text-blue-700",children:"Revenir en arrière"}),s.jsx(G,{to:"/bateaux",className:"text-blue-600 hover:text-blue-700",children:"Voir les bateaux"})]})]})})}function vN(){const[r,e]=S.useState(null),[t,n]=S.useState(""),[i,a]=S.useState(""),[l,c]=S.useState([]),[u,h]=S.useState({nom:"",type:"voilier",prix:"",capacite:""}),[p,g]=S.useState(null),[y,w]=S.useState(null),[C,_]=S.useState("");S.useEffect(()=>{const L=Oi.onAuthStateChanged(E=>{e(E),E&&N()});return()=>L()},[]);const N=async()=>{try{const E=(await qj(pd(vo,"boats"))).docs.map(f=>({id:f.id,...f.data()}));c(E)}catch(L){_(`Erreur lors de la récupération: ${L.message}`)}},R=async L=>{try{L?(await cb(Oi,t,i),_("Connexion réussie !")):(await lb(Oi,t,i),_("Compte créé avec succès !")),n(""),a("")}catch(E){_(`Erreur: ${E.message}`)}},k=async()=>{try{await hb(Oi),_("Déconnexion réussie !")}catch(L){_(`Erreur lors de la déconnexion: ${L.message}`)}},D=async L=>{if(L.preventDefault(),!r){_("Vous devez être connecté pour ajouter un bateau");return}try{const E={...u,prix:parseFloat(u.prix),capacite:parseInt(u.capacite),userId:r.uid,createdAt:new Date,imageName:p?p.name:null,imagePreview:y||null};await $j(pd(vo,"boats"),E),_("Bateau ajouté avec succès !"),h({nom:"",type:"voilier",prix:"",capacite:""}),g(null),w(null),N()}catch(E){_(`Erreur lors de l'ajout: ${E.message}`)}},P=L=>{const E=L.target.files[0];if(E){g(E);const f=new FileReader;f.onload=v=>{w(v.target.result)},f.readAsDataURL(E)}},B=async L=>{try{await zj(mp(vo,"boats",L)),_("Bateau supprimé avec succès !"),N()}catch(E){_(`Erreur lors de la suppression: ${E.message}`)}};return s.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Test Firebase - Nouvelle Configuration"}),s.jsxs("div",{className:"mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-orange-800",children:"🗄️ Test API MongoDB"}),s.jsx("p",{className:"text-orange-700 mb-3",children:"Testez la connexion à votre API backend MongoDB pour récupérer les données des bateaux et avis."}),s.jsx(G,{to:"/api-test",className:"inline-block bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition-colors",children:"🧪 Tester l'API MongoDB"})]}),s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3 text-blue-800",children:"🔐 Authentication"}),r?s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-blue-800",children:[s.jsx("strong",{children:"Connecté :"})," ",r.email]}),s.jsxs("p",{className:"text-sm text-blue-600",children:["UID: ",r.uid]})]}),s.jsx("button",{onClick:k,className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors",children:"Se déconnecter"})]}):s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:L=>n(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"password",placeholder:"Mot de passe",value:i,onChange:L=>a(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>R(!1),className:"flex-1 bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition-colors",children:"Créer un compte"}),s.jsx("button",{onClick:()=>R(!0),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 transition-colors",children:"Se connecter"})]})]})]}),s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3 text-green-800",children:"🗄️ Firestore Database"}),r?s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:D,className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[s.jsx("input",{type:"text",placeholder:"Nom du bateau",value:u.nom,onChange:L=>h({...u,nom:L.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),s.jsxs("select",{value:u.type,onChange:L=>h({...u,type:L.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"})]}),s.jsx("input",{type:"number",placeholder:"Prix/jour",value:u.prix,onChange:L=>h({...u,prix:L.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),s.jsx("input",{type:"number",placeholder:"Capacité",value:u.capacite,onChange:L=>h({...u,capacite:L.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:P,className:"hidden",id:"image-upload"}),s.jsx("div",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"📷 Ajouter une image"})]}),p&&s.jsxs("span",{className:"text-sm text-green-600",children:["✓ ",p.name]})]}),y&&s.jsxs("div",{className:"mt-3",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Aperçu de l'image :"}),s.jsx("img",{src:y,alt:"Aperçu",className:"w-32 h-32 object-cover rounded-lg border"})]})]}),s.jsx("button",{type:"submit",className:"w-full bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition-colors",children:"Ajouter le bateau"})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-medium mb-2",children:["Bateaux enregistrés (",l.length,")"]}),l.length===0?s.jsx("p",{className:"text-gray-500 text-center py-4",children:"Aucun bateau trouvé"}):s.jsx("div",{className:"space-y-2",children:l.map(L=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border",children:[s.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[L.imagePreview&&s.jsx("img",{src:L.imagePreview,alt:L.nom,className:"w-16 h-16 object-cover rounded-lg border"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:L.nom}),s.jsxs("div",{className:"text-sm text-gray-600",children:[L.type," • ",L.prix,"€/jour • ",L.capacite," personnes"]}),L.imageName&&s.jsxs("div",{className:"text-xs text-blue-600",children:["📷 ",L.imageName]})]})]}),s.jsx("button",{onClick:()=>B(L.id),className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors",children:"Supprimer"})]},L.id))})]})]}):s.jsx("p",{className:"text-green-700",children:"Connectez-vous pour gérer les bateaux"})]}),C&&s.jsx("div",{className:"mt-4 p-3 bg-blue-100 border border-blue-300 rounded-md",children:s.jsx("p",{className:"text-sm text-blue-800",children:C})}),s.jsxs("div",{className:"mt-6 text-xs text-gray-500",children:[s.jsx("p",{children:"✅ Firebase configuré avec le projet : mypictures-9dc8b"}),s.jsx("p",{children:"🔐 Authentication et Firestore activés"})]})]})}function wN(){const[r,e]=S.useState("Vérification..."),[t,n]=S.useState(0),[i,a]=S.useState(0),[l,c]=S.useState("");S.useEffect(()=>{u()},[]);const u=async()=>{try{e("🔄 Test de connexion à l'API MongoDB..."),console.log("🧪 Test 1: Récupération des bateaux...");const g=await bt(nt.BOATS);n(g.length||0),console.log(`✅ ${g.length||0} bateaux trouvés`),console.log("🧪 Test 2: Récupération des avis...");const y=await bt(nt.FIVE_STAR_REVIEWS);a(y.data?.length||0),console.log(`✅ ${y.data?.length||0} avis trouvés`),console.log("🧪 Test 3: Test de l'API de réservation...");try{const w=localStorage.getItem("token");if(w){const C=await bt(nt.BOOKINGS,{headers:Li(w)});console.log("✅ API de réservation accessible:",C)}else console.log("⚠️ Pas de token, test de réservation ignoré")}catch(w){console.log("⚠️ API de réservation non accessible:",w.message)}console.log("🧪 Test 4: Test de l'API d'ajout de bateaux...");try{const w=localStorage.getItem("token");if(w){const C=await bt(nt.BOATS,{method:"GET",headers:Li(w)});console.log("✅ API d'ajout de bateaux accessible:",C)}else console.log("⚠️ Pas de token, test d'ajout de bateaux ignoré")}catch(w){console.log("⚠️ API d'ajout de bateaux non accessible:",w.message)}e(`✅ API MongoDB accessible - ${g.length||0} bateaux, ${y.data?.length||0} avis`),c("")}catch(g){console.error("❌ Erreur de connexion API:",g),e(`❌ Erreur de connexion: ${g.message}`),c(g.message)}},h=()=>{u()},p=async()=>{try{e("🧪 Test d'ajout de bateau...");const g=localStorage.getItem("token");if(!g){c("Vous devez être connecté pour tester l'ajout de bateau");return}const y={nom:"Bateau Test",type:"voilier",longueur:10,prix_jour:100,capacite:4,image:"https://via.placeholder.com/300x200?text=Test",destination:"saint-malo",description:"Bateau de test",equipements:["GPS","Radio VHF"]};console.log("🧪 Test d'ajout de bateau avec:",y);const w=await bt(nt.BOATS,{method:"POST",headers:Li(g),body:JSON.stringify(y)});console.log("✅ Test d'ajout réussi:",w),e("✅ Test d'ajout de bateau réussi !"),c("")}catch(g){console.error("❌ Test d'ajout échoué:",g),e("❌ Test d'ajout de bateau échoué"),c("Erreur lors du test: "+g.message)}};return s.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"🧪 Test de Connexion API MongoDB"}),s.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-800",children:"Statut de l'API"}),s.jsx("p",{className:"text-blue-700",children:r}),l&&s.jsx("div",{className:"mt-3 p-3 bg-red-100 border border-red-300 rounded",children:s.jsxs("p",{className:"text-red-800 text-sm",children:[s.jsx("strong",{children:"Erreur:"})," ",l]})}),s.jsxs("div",{className:"mt-3 space-x-3",children:[s.jsx("button",{onClick:h,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"🔄 Réessayer"}),s.jsx("button",{onClick:p,className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors",children:"🧪 Tester Ajout Bateau"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-green-800",children:"📊 Bateaux"}),s.jsx("p",{className:"text-3xl font-bold text-green-600",children:t}),s.jsx("p",{className:"text-green-700 text-sm",children:"bateaux trouvés dans MongoDB"})]}),s.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-purple-800",children:"⭐ Avis"}),s.jsx("p",{className:"text-3xl font-bold text-purple-600",children:i}),s.jsx("p",{className:"text-purple-700 text-sm",children:"avis 5 étoiles trouvés"})]})]}),s.jsxs("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-800",children:"🔧 Informations techniques"}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"URL de base:"})," ",nt.BOATS.replace("/api/boats","")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Endpoint bateaux:"})," ",nt.BOATS]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Endpoint avis:"})," ",nt.FIVE_STAR_REVIEWS]})]})]})]})}function _N(){return s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"container mx-auto px-4",children:s.jsx(wN,{})})})}function jN(){return s.jsxs(Zp,{children:[s.jsx(fN,{}),s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(Br,{}),s.jsx("main",{children:s.jsxs(ef,{children:[s.jsx(Ee,{path:"/",element:s.jsx(ag,{})}),s.jsx(Ee,{path:"/bateaux",element:s.jsx(og,{})}),s.jsx(Ee,{path:"/bateaux/:id",element:s.jsx(mg,{})}),s.jsx(Ee,{path:"/reservation/:boatId",element:s.jsx(uN,{})}),s.jsx(Ee,{path:"/mes-reservations",element:s.jsx(dN,{})}),s.jsx(Ee,{path:"/payment",element:s.jsx(xN,{})}),s.jsx(Ee,{path:"/payment/success",element:s.jsx(yN,{})}),s.jsx(Ee,{path:"/payment/cancel",element:s.jsx(bN,{})}),s.jsx(Ee,{path:"/a-propos",element:s.jsx(cg,{})}),s.jsx(Ee,{path:"/contact",element:s.jsx(ug,{})}),s.jsx(Ee,{path:"/connexion",element:s.jsx(pg,{})}),s.jsx(Ee,{path:"/inscription",element:s.jsx(fg,{})}),s.jsx(Ee,{path:"/favoris",element:s.jsx(gg,{})}),s.jsx(Ee,{path:"/gestion-bateaux",element:s.jsx(Gj,{})}),s.jsx(Ee,{path:"/gestion-reservations",element:s.jsx(mN,{})}),s.jsx(Ee,{path:"/ajouter-bateau",element:s.jsx(Wj,{})}),s.jsx(Ee,{path:"/admin",element:s.jsx(Kj,{})}),s.jsx(Ee,{path:"/politique-confidentialite",element:s.jsx(Qj,{})}),s.jsx(Ee,{path:"/profil",element:s.jsx(iN,{})}),s.jsx(Ee,{path:"/cgu-cgv",element:s.jsx(aN,{})}),s.jsx(Ee,{path:"/mentions-legales",element:s.jsx(oN,{})}),s.jsx(Ee,{path:"/firebase-test",element:s.jsx(vN,{})}),s.jsx(Ee,{path:"/api-test",element:s.jsx(_N,{})}),s.jsx(Ee,{path:"*",element:s.jsx(pN,{})})]})}),s.jsx(Id,{}),s.jsx(gN,{})]})]})}nf.createRoot(document.getElementById("root")).render(s.jsx(S.StrictMode,{children:s.jsx(jN,{})}));
