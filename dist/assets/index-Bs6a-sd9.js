import{r as Xp,a as Yp}from"./vendor-DavUf6mE.js";import{r as S,u as Zo,L as z,R as xe,a as bd,b as es,c as Jp,B as Zp,d as ef,e as Se}from"./router-DONNKEte.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var eo={exports:{}},pr={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rc;function tf(){if(Rc)return pr;Rc=1;var n=Xp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(c,u,h){var p,g={},y=null,_=null;h!==void 0&&(y=""+h),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(_=u.ref);for(p in u)r.call(u,p)&&!a.hasOwnProperty(p)&&(g[p]=u[p]);if(c&&c.defaultProps)for(p in u=c.defaultProps,u)g[p]===void 0&&(g[p]=u[p]);return{$$typeof:e,type:c,key:y,ref:_,props:g,_owner:i.current}}return pr.Fragment=t,pr.jsx=l,pr.jsxs=l,pr}var kc;function sf(){return kc||(kc=1,eo.exports=tf()),eo.exports}var s=sf(),Ei={},Pc;function nf(){if(Pc)return Ei;Pc=1;var n=Yp();return Ei.createRoot=n.createRoot,Ei.hydrateRoot=n.hydrateRoot,Ei}var rf=nf();/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var af={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const of=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),J=(n,e)=>{const t=S.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:c="",children:u,...h},p)=>S.createElement("svg",{ref:p,...af,width:i,height:i,stroke:r,strokeWidth:l?Number(a)*24/Number(i):a,className:["lucide",`lucide-${of(n)}`,c].join(" "),...h},[...e.map(([g,y])=>S.createElement(g,y)),...Array.isArray(u)?u:[u]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=J("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=J("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=J("Anchor",[["path",{d:"M12 22V8",key:"qkxhtm"}],["path",{d:"M5 12H2a10 10 0 0 0 20 0h-3",key:"1hv3nh"}],["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=J("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=J("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dc=J("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=J("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=J("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=J("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=J("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=J("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gi=J("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=J("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=J("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=J("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=J("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=J("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=J("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=J("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=J("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=J("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const df=J("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=J("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=J("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mf=J("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=J("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=J("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gf=J("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=J("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=J("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=J("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=J("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=J("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=J("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=J("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=J("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=J("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=J("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=J("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=J("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=J("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jd=J("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=J("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=J("Ship",[["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"iegodh"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-9-4-9 4c0 2.9.94 5.34 2.81 7.76",key:"fp8vka"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M12 10v4",key:"1kjpxc"}],["path",{d:"M12 2v3",key:"qbqxhf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=J("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=J("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=J("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=J("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=J("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=J("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=J("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=J("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=J("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=J("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=J("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),jf="/assets/Logo-DwvqwfSC.png";function $n(){const[n,e]=S.useState(!1),t=Zo(),[r,i]=S.useState(!1),a=[{name:"Accueil",path:"/"},{name:"Bateaux",path:"/bateaux"},{name:"À propos",path:"/a-propos"},{name:"Contact",path:"/contact"}],l=g=>t.pathname===g,c=typeof window<"u"?localStorage.getItem("userPrenom"):null,u=typeof window<"u"?localStorage.getItem("userRole"):null,h=()=>{localStorage.removeItem("token"),localStorage.removeItem("userNom"),localStorage.removeItem("userPrenom"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("userTel"),window.location.href="/connexion"},p=()=>{window.scrollTo({top:0,behavior:"smooth"})};return s.jsx("header",{className:"bg-white shadow-sm fixed w-full top-0 z-50 border-b border-gray-100",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsx(z,{to:"/",className:"flex items-center space-x-2",children:s.jsx("img",{src:jf,alt:"Logo SailingLoc",className:"h-9 w-auto"})}),s.jsx("nav",{className:"hidden md:flex space-x-8",children:a.map(g=>s.jsx(z,{to:g.path,onClick:p,className:`px-3 py-2 text-sm font-medium transition-colors ${l(g.path)?"text-blue-600 border-b-2 border-blue-600":"text-gray-700 hover:text-blue-600"}`,children:g.name},g.name))}),s.jsx("div",{className:"hidden md:flex items-center space-x-4",children:c?s.jsxs(s.Fragment,{children:[s.jsx(z,{to:"/favoris",className:"text-blue-600 hover:text-blue-800 px-4 py-2 text-sm font-medium transition-colors flex items-center",children:s.jsx(Sr,{className:"h-5 w-5"})}),u==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsx(z,{to:"/gestion-bateaux",className:"text-blue-600 hover:text-blue-800 px-4 py-2 text-sm font-medium transition-colors flex items-center",children:"Gestion bateaux"}),s.jsx(z,{to:"/gestion-reservations",className:"text-blue-600 hover:text-blue-800 px-4 py-2 text-sm font-medium transition-colors flex items-center",children:"Gestion réservations"})]}),u==="admin"&&s.jsx(z,{to:"/admin",className:"bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors shadow-sm flex items-center",children:"Dashboard Admin"}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>i(g=>!g),className:"bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-medium hover:bg-blue-700 transition-colors shadow-sm flex items-center justify-center focus:outline-none",children:s.jsx(gs,{className:"h-5 w-5"})}),r&&s.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-4 z-50 border border-gray-100",children:[s.jsxs("div",{className:"px-4 py-2 text-gray-700 text-sm mb-2",children:["Bienvenue ",s.jsx("span",{className:"font-bold text-blue-700",children:c})]}),u!=="proprietaire"&&u!=="admin"&&s.jsx(z,{to:"/mes-reservations",onClick:()=>i(!1),className:"block w-full text-left px-4 py-2 text-blue-600 hover:bg-blue-50 text-sm font-medium",children:"Mes Réservations"}),s.jsxs(z,{to:"/profil",onClick:()=>i(!1),className:"w-full text-left px-4 py-2 text-blue-600 hover:bg-blue-50 text-sm font-medium flex items-center gap-2 border-t border-gray-100 mt-2",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6l4 2"})}),"Settings"]}),s.jsx("button",{onClick:h,className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 text-sm font-medium border-t border-gray-100 mt-2",children:"Déconnexion"})]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx(z,{to:"/connexion",className:"text-gray-700 hover:text-blue-600 px-4 py-2 text-sm font-medium transition-colors",onClick:p,children:"Connexion"}),s.jsx(z,{to:"/inscription",className:"bg-orange-500 text-white px-6 py-2 rounded-full text-sm font-medium hover:bg-orange-600 transition-colors shadow-sm",onClick:p,children:"Inscription"})]})}),s.jsx("button",{className:"md:hidden p-2",onClick:()=>e(!n),children:n?s.jsx(Re,{size:24}):s.jsx(yf,{size:24})})]}),n&&s.jsx("div",{className:"md:hidden border-t border-gray-100",children:s.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 bg-white",children:[a.map(g=>s.jsx(z,{to:g.path,className:`block px-3 py-2 text-base font-medium ${l(g.path)?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,onClick:()=>{e(!1),p()},children:g.name},g.name)),s.jsx("div",{className:"mt-4 space-y-2",children:c?s.jsxs(s.Fragment,{children:[u==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsx(z,{to:"/gestion-bateaux",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),p()},children:"Gestion bateaux"}),s.jsx(z,{to:"/gestion-reservations",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),p()},children:"Gestion réservations"})]}),u==="admin"&&s.jsx(z,{to:"/admin",className:"block w-full text-center bg-red-600 text-white px-3 py-2 rounded-lg text-base font-medium hover:bg-red-700 transition-colors",onClick:()=>{e(!1),p()},children:"Dashboard Admin"}),s.jsx(z,{to:"/favoris",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),p()},children:s.jsx(Sr,{className:"h-5 w-5"})}),u!=="proprietaire"&&u!=="admin"&&s.jsx(z,{to:"/mes-reservations",className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",onClick:()=>{e(!1),p()},children:"Mes Réservations"}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>i(g=>!g),className:"block w-full text-center border border-blue-600 text-blue-600 px-3 py-2 rounded-full text-base font-medium hover:bg-blue-50 transition-colors flex items-center justify-center",children:s.jsx(gs,{className:"h-5 w-5"})}),r&&s.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-4 z-50 border border-gray-100",children:[s.jsxs("div",{className:"px-4 py-2 text-gray-700 text-sm mb-2",children:["Bienvenue ",s.jsx("span",{className:"font-bold text-blue-700",children:c})]}),s.jsx("button",{onClick:h,className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 text-sm font-medium",children:"Déconnexion"})]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx(z,{to:"/connexion",className:"block w-full text-center border border-orange-500 text-orange-500 px-3 py-2 rounded-full text-base font-medium hover:bg-orange-50 transition-colors",onClick:()=>{e(!1),p()},children:"Connexion"}),s.jsx(z,{to:"/inscription",className:"block w-full text-center bg-orange-500 text-white px-3 py-2 rounded-full text-base font-medium hover:bg-orange-600 transition-colors",onClick:()=>{e(!1),p()},children:"Inscription"})]})})]})})]})})}function Td(){const[n,e]=S.useState("");typeof window<"u"&&localStorage.getItem("userPrenom");const t=typeof window<"u"?localStorage.getItem("userRole"):null,r=i=>{i.preventDefault(),console.log("Newsletter signup:",n),e(""),alert("Inscription réussie !")};return s.jsx("footer",{className:"bg-blue-900 text-white",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold mb-6",children:"MODE DE PAIEMENT"}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-white rounded flex items-center justify-center",children:s.jsx(vd,{className:"h-5 w-5 text-blue-900"})}),s.jsx("span",{children:"Carte bancaire"})]})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold mb-6",children:"PLAN DU SITE"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide",children:"Pages principales"}),s.jsx(z,{to:"/",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Accueil"}),s.jsx(z,{to:"/bateaux",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Catalogue des bateaux"}),s.jsx(z,{to:"/a-propos",className:"block hover:text-blue-300 transition-colors text-sm",children:"• À propos de SailingLoc"}),s.jsx(z,{to:"/contact",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Contact et support"})]}),s.jsxs("div",{className:"space-y-2 pt-3",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide",children:"Espace utilisateur"}),s.jsx(z,{to:"/connexion",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Connexion"}),s.jsx(z,{to:"/inscription",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Inscription"}),s.jsx(z,{to:"/profil",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Mon profil"}),t!=="proprietaire"&&s.jsx(z,{to:"/mes-reservations",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Mes réservations"}),s.jsx(z,{to:"/favoris",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Mes favoris"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold mb-6",children:" "}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2 pt-3",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide",children:"Gestion des bateaux"}),s.jsx(z,{to:"/gestion-bateaux",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Gérer mes bateaux"}),s.jsx(z,{to:"/gestion-reservations",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Gérer mes réservations"}),s.jsx(z,{to:"/ajouter-bateau",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Ajouter un bateau"})]}),s.jsxs("div",{className:"space-y-2 pt-3",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide",children:"Légal"}),s.jsx(z,{to:"/mentions-legales",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Mentions légales"}),s.jsx(z,{to:"/politique-confidentialite",className:"block hover:text-blue-300 transition-colors text-sm",children:"• Politique de confidentialité"}),s.jsx(z,{to:"/cgu-cgv",className:"block hover:text-blue-300 transition-colors text-sm",children:"• CGU / CGV"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold mb-6",children:"SUIVEZ-NOUS"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("a",{href:"https://www.facebook.com/profile.php?id=61579074677515",target:"_blank",rel:"noopener noreferrer","aria-label":"SailingLoc sur Facebook",className:"w-10 h-10 bg-blue-800 rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors",title:"Facebook",children:s.jsx(uf,{className:"h-5 w-5"})}),s.jsx("a",{href:"https://www.instagram.com/salingloc/",target:"_blank",rel:"noopener noreferrer","aria-label":"SailingLoc sur Instagram",className:"w-10 h-10 bg-blue-800 rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors",title:"Instagram",children:s.jsx(pf,{className:"h-5 w-5"})}),s.jsx("a",{href:"#",className:"w-10 h-10 bg-blue-800 rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors",title:"YouTube",children:s.jsx(wf,{className:"h-5 w-5"})}),s.jsx("a",{href:"https://www.linkedin.com/in/sailingloc-equipe-0a1a5937a/",target:"_blank",rel:"noopener noreferrer","aria-label":"SailingLoc sur LinkedIn",className:"w-10 h-10 bg-blue-800 rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors",title:"LinkedIn",children:s.jsx(ff,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"pt-4",children:[s.jsx("h4",{className:"font-semibold text-blue-200 text-sm uppercase tracking-wide mb-3",children:"Newsletter"}),s.jsxs("form",{onSubmit:r,className:"space-y-3",children:[s.jsx("input",{type:"email",value:n,onChange:i=>e(i.target.value),placeholder:"Votre email",className:"w-full px-3 py-2 bg-blue-800 border border-blue-700 rounded-lg text-white placeholder-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),s.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm font-medium",children:"S'abonner"})]})]})]})]})]}),s.jsxs("div",{className:"border-t border-blue-800 mt-12 pt-8 text-center",children:[s.jsxs("p",{className:"text-blue-300 text-sm",children:["© 2025 SailingLoc. Tous droits réservés. |",s.jsx(z,{to:"/mentions-legales",className:"hover:text-white transition-colors ml-2",children:"Mentions légales"})," ","|",s.jsx(z,{to:"/politique-confidentialite",className:"hover:text-white transition-colors ml-2",children:"Politique de confidentialité"})]}),s.jsx("p",{className:"text-blue-400 text-xs mt-2",children:"SailingLoc - Location de bateaux à La Rochelle et en Europe"})]})]})})}function Ar({rating:n,maxRating:e=5,size:t=16,interactive:r=!1,onRatingChange:i}){const a=Array.from({length:e},(l,c)=>{const u=c+1,h=u<=n,p=u-.5<=n&&n<u;return s.jsx("button",{type:"button",onClick:()=>r&&i&&i(u),className:`${r?"cursor-pointer hover:scale-110":"cursor-default"} transition-transform`,disabled:!r,children:s.jsx(tl,{size:t,className:`${h||p?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},c)});return s.jsx("div",{className:"flex items-center space-x-1",children:a})}const lt="https://sailingloc-back-lilac.vercel.app",se={LOGIN:`${lt}/api/auth/login`,REGISTER:`${lt}/api/auth/register`,DASHBOARD:`${lt}/api/auth/dashboard`,USERS:`${lt}/api/auth/users`,BOATS:`${lt}/api/boats`,BOAT_DETAIL:n=>`${lt}/api/boats/${n}`,MY_BOATS:`${lt}/api/boats/my-boats`,BOOKINGS:`${lt}/api/bookings`,MY_BOOKINGS:`${lt}/api/bookings/my-bookings`,REVIEWS:`${lt}/api/reviews`,BOAT_REVIEWS:n=>`${lt}/api/reviews/boat/${n}`,FIVE_STAR_REVIEWS:`${lt}/api/reviews/five-stars`,CONTACT:`${lt}/api/contact`,FAVORITES:`${lt}/api/favorites`},he=n=>({"Content-Type":"application/json",Authorization:n?`Bearer ${n}`:""}),te=async(n,e={})=>{try{const t=await fetch(n,{...e,headers:{"Content-Type":"application/json",...e.headers}});if(!t.ok){const r=await t.json().catch(()=>({}));throw new Error(r.message||`Erreur HTTP: ${t.status}`)}return await t.json()}catch(t){throw console.error("Erreur API:",t),t}};function Id(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=Id(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function Qs(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=Id(n))&&(r&&(r+=" "),r+=e);return r}function Nf(n){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}Nf(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var qr=n=>typeof n=="number"&&!isNaN(n),Js=n=>typeof n=="string",Qt=n=>typeof n=="function",Ef=n=>Js(n)||qr(n),wo=n=>Js(n)||Qt(n)?n:null,Tf=(n,e)=>n===!1||qr(n)&&n>0?n:e,jo=n=>S.isValidElement(n)||Js(n)||Qt(n)||qr(n);function If(n,e,t=300){let{scrollHeight:r,style:i}=n;requestAnimationFrame(()=>{i.minHeight="initial",i.height=r+"px",i.transition=`all ${t}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(e,t)})})}function Sf({enter:n,exit:e,appendPosition:t=!1,collapse:r=!0,collapseDuration:i=300}){return function({children:a,position:l,preventExitTransition:c,done:u,nodeRef:h,isIn:p,playToast:g}){let y=t?`${n}--${l}`:n,_=t?`${e}--${l}`:e,C=S.useRef(0);return S.useLayoutEffect(()=>{let E=h.current,N=y.split(" "),k=R=>{R.target===h.current&&(g(),E.removeEventListener("animationend",k),E.removeEventListener("animationcancel",k),C.current===0&&R.type!=="animationcancel"&&E.classList.remove(...N))};E.classList.add(...N),E.addEventListener("animationend",k),E.addEventListener("animationcancel",k)},[]),S.useEffect(()=>{let E=h.current,N=()=>{E.removeEventListener("animationend",N),r?If(E,u,i):u()};p||(c?N():(C.current=1,E.className+=` ${_}`,E.addEventListener("animationend",N)))},[p]),xe.createElement(xe.Fragment,null,a)}}function Vc(n,e){return{content:Sd(n.content,n.props),containerId:n.props.containerId,id:n.props.toastId,theme:n.props.theme,type:n.props.type,data:n.props.data||{},isLoading:n.props.isLoading,icon:n.props.icon,reason:n.removalReason,status:e}}function Sd(n,e,t=!1){return S.isValidElement(n)&&!Js(n.type)?S.cloneElement(n,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):Qt(n)?n({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):n}function Af({closeToast:n,theme:e,ariaLabel:t="close"}){return xe.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:r=>{r.stopPropagation(),n(!0)},"aria-label":t},xe.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},xe.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function Cf({delay:n,isRunning:e,closeToast:t,type:r="default",hide:i,className:a,controlledProgress:l,progress:c,rtl:u,isIn:h,theme:p}){let g=i||l&&c===0,y={animationDuration:`${n}ms`,animationPlayState:e?"running":"paused"};l&&(y.transform=`scaleX(${c})`);let _=Qs("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${p}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":u}),C=Qt(a)?a({rtl:u,type:r,defaultClassName:_}):Qs(_,a),E={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{h&&t()}};return xe.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":g},xe.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${p} Toastify__progress-bar--${r}`}),xe.createElement("div",{role:"progressbar","aria-hidden":g?"true":"false","aria-label":"notification timer",className:C,style:y,...E}))}var Rf=1,Ad=()=>`${Rf++}`;function kf(n,e,t){let r=1,i=0,a=[],l=[],c=e,u=new Map,h=new Set,p=R=>(h.add(R),()=>h.delete(R)),g=()=>{l=Array.from(u.values()),h.forEach(R=>R())},y=({containerId:R,toastId:P,updateId:V})=>{let B=R?R!==n:n!==1,O=u.has(P)&&V==null;return B||O},_=(R,P)=>{u.forEach(V=>{var B;(P==null||P===V.props.toastId)&&((B=V.toggle)==null||B.call(V,R))})},C=R=>{var P,V;(V=(P=R.props)==null?void 0:P.onClose)==null||V.call(P,R.removalReason),R.isActive=!1},E=R=>{if(R==null)u.forEach(C);else{let P=u.get(R);P&&C(P)}g()},N=()=>{i-=a.length,a=[]},k=R=>{var P,V;let{toastId:B,updateId:O}=R.props,j=O==null;R.staleId&&u.delete(R.staleId),R.isActive=!0,u.set(B,R),g(),t(Vc(R,j?"added":"updated")),j&&((V=(P=R.props).onOpen)==null||V.call(P))};return{id:n,props:c,observe:p,toggle:_,removeToast:E,toasts:u,clearQueue:N,buildToast:(R,P)=>{if(y(P))return;let{toastId:V,updateId:B,data:O,staleId:j,delay:f}=P,w=B==null;w&&i++;let T={...c,style:c.toastStyle,key:r++,...Object.fromEntries(Object.entries(P).filter(([b,v])=>v!=null)),toastId:V,updateId:B,data:O,isIn:!1,className:wo(P.className||c.toastClassName),progressClassName:wo(P.progressClassName||c.progressClassName),autoClose:P.isLoading?!1:Tf(P.autoClose,c.autoClose),closeToast(b){u.get(V).removalReason=b,E(V)},deleteToast(){let b=u.get(V);if(b!=null){if(t(Vc(b,"removed")),u.delete(V),i--,i<0&&(i=0),a.length>0){k(a.shift());return}g()}}};T.closeButton=c.closeButton,P.closeButton===!1||jo(P.closeButton)?T.closeButton=P.closeButton:P.closeButton===!0&&(T.closeButton=jo(c.closeButton)?c.closeButton:!0);let A={content:R,props:T,staleId:j};c.limit&&c.limit>0&&i>c.limit&&w?a.push(A):qr(f)?setTimeout(()=>{k(A)},f):k(A)},setProps(R){c=R},setToggle:(R,P)=>{let V=u.get(R);V&&(V.toggle=P)},isToastActive:R=>{var P;return(P=u.get(R))==null?void 0:P.isActive},getSnapshot:()=>l}}var it=new Map,Cr=[],No=new Set,Pf=n=>No.forEach(e=>e(n)),Cd=()=>it.size>0;function Df(){Cr.forEach(n=>kd(n.content,n.options)),Cr=[]}var Of=(n,{containerId:e})=>{var t;return(t=it.get(e||1))==null?void 0:t.toasts.get(n)};function Rd(n,e){var t;if(e)return!!((t=it.get(e))!=null&&t.isToastActive(n));let r=!1;return it.forEach(i=>{i.isToastActive(n)&&(r=!0)}),r}function Lf(n){if(!Cd()){Cr=Cr.filter(e=>n!=null&&e.options.toastId!==n);return}if(n==null||Ef(n))it.forEach(e=>{e.removeToast(n)});else if(n&&("containerId"in n||"id"in n)){let e=it.get(n.containerId);e?e.removeToast(n.id):it.forEach(t=>{t.removeToast(n.id)})}}var Vf=(n={})=>{it.forEach(e=>{e.props.limit&&(!n.containerId||e.id===n.containerId)&&e.clearQueue()})};function kd(n,e){jo(n)&&(Cd()||Cr.push({content:n,options:e}),it.forEach(t=>{t.buildToast(n,e)}))}function Mf(n){var e;(e=it.get(n.containerId||1))==null||e.setToggle(n.id,n.fn)}function Pd(n,e){it.forEach(t=>{(e==null||!(e!=null&&e.containerId)||e?.containerId===t.id)&&t.toggle(n,e?.id)})}function Ff(n){let e=n.containerId||1;return{subscribe(t){let r=kf(e,n,Pf);it.set(e,r);let i=r.observe(t);return Df(),()=>{i(),it.delete(e)}},setProps(t){var r;(r=it.get(e))==null||r.setProps(t)},getSnapshot(){var t;return(t=it.get(e))==null?void 0:t.getSnapshot()}}}function Uf(n){return No.add(n),()=>{No.delete(n)}}function Bf(n){return n&&(Js(n.toastId)||qr(n.toastId))?n.toastId:Ad()}function zr(n,e){return kd(n,e),e.toastId}function ba(n,e){return{...e,type:e&&e.type||n,toastId:Bf(e)}}function va(n){return(e,t)=>zr(e,ba(n,t))}function G(n,e){return zr(n,ba("default",e))}G.loading=(n,e)=>zr(n,ba("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function qf(n,{pending:e,error:t,success:r},i){let a;e&&(a=Js(e)?G.loading(e,i):G.loading(e.render,{...i,...e}));let l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(h,p,g)=>{if(p==null){G.dismiss(a);return}let y={type:h,...l,...i,data:g},_=Js(p)?{render:p}:p;return a?G.update(a,{...y,..._}):G(_.render,{...y,..._}),g},u=Qt(n)?n():n;return u.then(h=>c("success",r,h)).catch(h=>c("error",t,h)),u}G.promise=qf;G.success=va("success");G.info=va("info");G.error=va("error");G.warning=va("warning");G.warn=G.warning;G.dark=(n,e)=>zr(n,ba("default",{theme:"dark",...e}));function zf(n){Lf(n)}G.dismiss=zf;G.clearWaitingQueue=Vf;G.isActive=Rd;G.update=(n,e={})=>{let t=Of(n,e);if(t){let{props:r,content:i}=t,a={delay:100,...r,...e,toastId:e.toastId||n,updateId:Ad()};a.toastId!==n&&(a.staleId=n);let l=a.render||i;delete a.render,zr(l,a)}};G.done=n=>{G.update(n,{progress:1})};G.onChange=Uf;G.play=n=>Pd(!0,n);G.pause=n=>Pd(!1,n);function $f(n){var e;let{subscribe:t,getSnapshot:r,setProps:i}=S.useRef(Ff(n)).current;i(n);let a=(e=S.useSyncExternalStore(t,r,r))==null?void 0:e.slice();function l(c){if(!a)return[];let u=new Map;return n.newestOnTop&&a.reverse(),a.forEach(h=>{let{position:p}=h.props;u.has(p)||u.set(p,[]),u.get(p).push(h)}),Array.from(u,h=>c(h[0],h[1]))}return{getToastToRender:l,isToastActive:Rd,count:a?.length}}function Hf(n){let[e,t]=S.useState(!1),[r,i]=S.useState(!1),a=S.useRef(null),l=S.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:c,pauseOnHover:u,closeToast:h,onClick:p,closeOnClick:g}=n;Mf({id:n.toastId,containerId:n.containerId,fn:t}),S.useEffect(()=>{if(n.pauseOnFocusLoss)return y(),()=>{_()}},[n.pauseOnFocusLoss]);function y(){document.hasFocus()||k(),window.addEventListener("focus",N),window.addEventListener("blur",k)}function _(){window.removeEventListener("focus",N),window.removeEventListener("blur",k)}function C(j){if(n.draggable===!0||n.draggable===j.pointerType){R();let f=a.current;l.canCloseOnClick=!0,l.canDrag=!0,f.style.transition="none",n.draggableDirection==="x"?(l.start=j.clientX,l.removalDistance=f.offsetWidth*(n.draggablePercent/100)):(l.start=j.clientY,l.removalDistance=f.offsetHeight*(n.draggablePercent===80?n.draggablePercent*1.5:n.draggablePercent)/100)}}function E(j){let{top:f,bottom:w,left:T,right:A}=a.current.getBoundingClientRect();j.nativeEvent.type!=="touchend"&&n.pauseOnHover&&j.clientX>=T&&j.clientX<=A&&j.clientY>=f&&j.clientY<=w?k():N()}function N(){t(!0)}function k(){t(!1)}function R(){l.didMove=!1,document.addEventListener("pointermove",V),document.addEventListener("pointerup",B)}function P(){document.removeEventListener("pointermove",V),document.removeEventListener("pointerup",B)}function V(j){let f=a.current;if(l.canDrag&&f){l.didMove=!0,e&&k(),n.draggableDirection==="x"?l.delta=j.clientX-l.start:l.delta=j.clientY-l.start,l.start!==j.clientX&&(l.canCloseOnClick=!1);let w=n.draggableDirection==="x"?`${l.delta}px, var(--y)`:`0, calc(${l.delta}px + var(--y))`;f.style.transform=`translate3d(${w},0)`,f.style.opacity=`${1-Math.abs(l.delta/l.removalDistance)}`}}function B(){P();let j=a.current;if(l.canDrag&&l.didMove&&j){if(l.canDrag=!1,Math.abs(l.delta)>l.removalDistance){i(!0),n.closeToast(!0),n.collapseAll();return}j.style.transition="transform 0.2s, opacity 0.2s",j.style.removeProperty("transform"),j.style.removeProperty("opacity")}}let O={onPointerDown:C,onPointerUp:E};return c&&u&&(O.onMouseEnter=k,n.stacked||(O.onMouseLeave=N)),g&&(O.onClick=j=>{p&&p(j),l.canCloseOnClick&&h(!0)}),{playToast:N,pauseToast:k,isRunning:e,preventExitTransition:r,toastRef:a,eventHandlers:O}}var Gf=typeof window<"u"?S.useLayoutEffect:S.useEffect,_a=({theme:n,type:e,isLoading:t,...r})=>xe.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:n==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...r});function Wf(n){return xe.createElement(_a,{...n},xe.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function Kf(n){return xe.createElement(_a,{...n},xe.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Qf(n){return xe.createElement(_a,{...n},xe.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Xf(n){return xe.createElement(_a,{...n},xe.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Yf(){return xe.createElement("div",{className:"Toastify__spinner"})}var Eo={info:Kf,warning:Wf,success:Qf,error:Xf,spinner:Yf},Jf=n=>n in Eo;function Zf({theme:n,type:e,isLoading:t,icon:r}){let i=null,a={theme:n,type:e};return r===!1||(Qt(r)?i=r({...a,isLoading:t}):S.isValidElement(r)?i=S.cloneElement(r,a):t?i=Eo.spinner():Jf(e)&&(i=Eo[e](a))),i}var eg=n=>{let{isRunning:e,preventExitTransition:t,toastRef:r,eventHandlers:i,playToast:a}=Hf(n),{closeButton:l,children:c,autoClose:u,onClick:h,type:p,hideProgressBar:g,closeToast:y,transition:_,position:C,className:E,style:N,progressClassName:k,updateId:R,role:P,progress:V,rtl:B,toastId:O,deleteToast:j,isIn:f,isLoading:w,closeOnClick:T,theme:A,ariaLabel:b}=n,v=Qs("Toastify__toast",`Toastify__toast-theme--${A}`,`Toastify__toast--${p}`,{"Toastify__toast--rtl":B},{"Toastify__toast--close-on-click":T}),M=Qt(E)?E({rtl:B,position:C,type:p,defaultClassName:v}):Qs(v,E),Q=Zf(n),ie=!!V||!u,X={closeToast:y,type:p,theme:A},ee=null;return l===!1||(Qt(l)?ee=l(X):S.isValidElement(l)?ee=S.cloneElement(l,X):ee=Af(X)),xe.createElement(_,{isIn:f,done:j,position:C,preventExitTransition:t,nodeRef:r,playToast:a},xe.createElement("div",{id:O,tabIndex:0,onClick:h,"data-in":f,className:M,...i,style:N,ref:r,...f&&{role:P,"aria-label":b}},Q!=null&&xe.createElement("div",{className:Qs("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!w})},Q),Sd(c,n,!e),ee,!n.customProgressBar&&xe.createElement(Cf,{...R&&!ie?{key:`p-${R}`}:{},rtl:B,theme:A,delay:u,isRunning:e,isIn:f,closeToast:y,hide:g,type:p,className:k,controlledProgress:ie,progress:V||0})))},tg=(n,e=!1)=>({enter:`Toastify--animate Toastify__${n}-enter`,exit:`Toastify--animate Toastify__${n}-exit`,appendPosition:e}),sg=Sf(tg("bounce",!0)),ng={position:"top-right",transition:sg,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:n=>n.altKey&&n.code==="KeyT"};function wa(n){let e={...ng,...n},t=n.stacked,[r,i]=S.useState(!0),a=S.useRef(null),{getToastToRender:l,isToastActive:c,count:u}=$f(e),{className:h,style:p,rtl:g,containerId:y,hotKeys:_}=e;function C(N){let k=Qs("Toastify__toast-container",`Toastify__toast-container--${N}`,{"Toastify__toast-container--rtl":g});return Qt(h)?h({position:N,rtl:g,defaultClassName:k}):Qs(k,wo(h))}function E(){t&&(i(!0),G.play())}return Gf(()=>{var N;if(t){let k=a.current.querySelectorAll('[data-in="true"]'),R=12,P=(N=e.position)==null?void 0:N.includes("top"),V=0,B=0;Array.from(k).reverse().forEach((O,j)=>{let f=O;f.classList.add("Toastify__toast--stacked"),j>0&&(f.dataset.collapsed=`${r}`),f.dataset.pos||(f.dataset.pos=P?"top":"bot");let w=V*(r?.2:1)+(r?0:R*j);f.style.setProperty("--y",`${P?w:w*-1}px`),f.style.setProperty("--g",`${R}`),f.style.setProperty("--s",`${1-(r?B:0)}`),V+=f.offsetHeight,B+=.025})}},[r,u,t]),S.useEffect(()=>{function N(k){var R;let P=a.current;_(k)&&((R=P.querySelector('[tabIndex="0"]'))==null||R.focus(),i(!1),G.pause()),k.key==="Escape"&&(document.activeElement===P||P!=null&&P.contains(document.activeElement))&&(i(!0),G.play())}return document.addEventListener("keydown",N),()=>{document.removeEventListener("keydown",N)}},[_]),xe.createElement("section",{ref:a,className:"Toastify",id:y,onMouseEnter:()=>{t&&(i(!1),G.pause())},onMouseLeave:E,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},l((N,k)=>{let R=k.length?{...p}:{...p,pointerEvents:"none"};return xe.createElement("div",{tabIndex:-1,className:C(N),"data-stacked":t,style:R,key:`c-${N}`},k.map(({content:P,props:V})=>xe.createElement(eg,{...V,stacked:t,collapseAll:E,isIn:c(V.toastId,V.containerId),key:`t-${V.key}`},P)))}))}function To({boatId:n,className:e=""}){const[t,r]=S.useState(!1),[i,a]=S.useState(!1);S.useEffect(()=>{l()},[n]);const l=async()=>{try{const u=localStorage.getItem("token")||sessionStorage.getItem("token");if(!u)return;const h=await te(`${se.FAVORITES}/check/${n}`,{headers:he(u)});r(h.isFavorite)}catch(u){console.error("Erreur vérification favori:",u)}},c=async()=>{try{a(!0);const u=localStorage.getItem("token")||sessionStorage.getItem("token");if(!u){G.error("Vous devez être connecté pour ajouter des favoris");return}t?(await te(`${se.FAVORITES}/${n}`,{method:"DELETE",headers:he(u)}),r(!1),G.success("Bateau retiré des favoris")):(await te(se.FAVORITES,{method:"POST",headers:he(u),body:JSON.stringify({boatId:n})}),r(!0),G.success("Bateau ajouté aux favoris !"))}catch(u){G.error(u.message||"Erreur lors de la gestion des favoris")}finally{a(!1)}};return s.jsx("button",{onClick:c,disabled:i,className:`absolute top-4 right-4 p-2 rounded-full transition-all duration-200 hover:scale-110 ${t?"bg-red-500 text-white shadow-lg":"bg-white/90 text-gray-600 hover:bg-white"} ${e}`,title:t?"Retirer des favoris":"Ajouter aux favoris",children:s.jsx(Sr,{size:20,className:`transition-all duration-200 ${t?"fill-current":""}`})})}function ja({boat:n,viewMode:e="grid"}){return e==="list"?s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-center space-x-6",children:[s.jsxs("div",{className:"flex-shrink-0 relative",children:[s.jsx("img",{src:n.image,alt:n.nom,className:"w-32 h-24 object-cover rounded-lg"}),s.jsx(To,{boatId:n._id,className:"top-2 right-2"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:n.nom}),s.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[s.jsx(Ar,{rating:n.rating||0,size:16}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",n.reviews||0,")"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-4 mb-3 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Wt,{size:16}),s.jsx("span",{className:"capitalize",children:n.destination})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(el,{size:16}),s.jsxs("span",{children:[n.longueur,"m"]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Ys,{size:16}),s.jsxs("span",{children:[n.capacite," pers."]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Wt,{size:16}),s.jsx("span",{children:n.destination})]})]}),n.description&&s.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-3",children:n.description})]}),s.jsxs("div",{className:"flex-shrink-0 text-right",children:[s.jsxs("div",{className:"text-2xl font-bold text-blue-600 mb-3",children:[n.prix_jour,"€",s.jsx("span",{className:"text-base font-normal text-gray-600",children:"/jour"})]}),s.jsx(z,{to:`/bateaux/${n._id}`,className:"bg-orange-500 text-white px-6 py-2 rounded-full text-sm font-medium hover:bg-orange-600 transition-colors shadow-sm",children:"Réserver"})]})]})}):s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:n.image,alt:n.nom,className:"w-full h-56 object-cover"}),s.jsx("div",{className:"absolute top-4 left-4 bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:n.type}),s.jsx(To,{boatId:n._id})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 leading-tight",children:n.nom}),s.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[s.jsx(Ar,{rating:n.rating||0,size:16}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",n.reviews||0,")"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-4 mb-4 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Wt,{size:16}),s.jsx("span",{className:"capitalize",children:n.destination})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Ys,{size:16}),s.jsxs("span",{children:[n.capacite," pers."]})]})]}),n.description&&s.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4",children:n.description}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[n.prix_jour,"€",s.jsx("span",{className:"text-base font-normal text-gray-600",children:"/jour"})]}),s.jsx(z,{to:`/bateaux/${n._id}`,className:"bg-orange-500 text-white px-6 py-2 rounded-full text-sm font-medium hover:bg-orange-600 transition-colors shadow-sm",children:"Réserver"})]})]})]})}function rg({boats:n,onReset:e,searchFilters:t}){const[r,i]=S.useState("nom"),[a,l]=S.useState("asc"),[c,u]=S.useState(!1),[h,p]=S.useState(!1);xe.useEffect(()=>{p(!0)},[]);const g=[...n].sort((N,k)=>{let R,P;switch(r){case"prix_jour":R=N.prix_jour,P=k.prix_jour;break;case"longueur":R=N.longueur,P=k.longueur;break;case"capacite":R=N.capacite,P=k.capacite;break;case"nom":default:R=N.nom.toLowerCase(),P=k.nom.toLowerCase();break}return a==="asc"?R>P?1:-1:R<P?1:-1}),y=N=>{r===N?l(a==="asc"?"desc":"asc"):(i(N),l("asc"))},_=N=>r!==N?null:a==="asc"?s.jsx(cf,{size:16}):s.jsx(lf,{size:16}),C=(N,k)=>{if(!k)return"";switch(N){case"destination":return k.charAt(0).toUpperCase()+k.slice(1).replace("-"," ");case"type":return k.charAt(0).toUpperCase()+k.slice(1);case"dateDebut":case"dateFin":return new Date(k).toLocaleDateString("fr-FR");default:return k}},E=Object.entries(t).filter(([N,k])=>k);return s.jsx("section",{id:"search-results",className:`py-20 bg-white scroll-mt-20 transition-all duration-700 ease-out ${h?"opacity-100 translate-y-0":"opacity-0 translate-y-8"}`,ref:N=>{N&&(N.scrollIntoView=k=>{const V=N.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:V,behavior:k?.behavior||"smooth"})})},children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-2 h-12 bg-gradient-to-b from-blue-500 to-blue-600 rounded-full"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Résultats de votre recherche"}),s.jsxs("p",{className:"text-xl text-gray-600",children:[n.length," bateau",n.length>1?"x":""," trouvé",n.length>1?"s":""," pour vos critères"]})]})]}),s.jsxs("button",{onClick:e,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2",children:[s.jsx(Re,{size:20}),s.jsx("span",{children:"Réinitialiser"})]})]}),E.length>0&&s.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200 animate-pulse",children:[s.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-3",children:"Filtres actifs :"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(([N,k])=>s.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:[N==="destination"?"📍":N==="type"?"🚢":N.includes("date")?"📅":"🔍",C(N,k)]},N))})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8 p-4 bg-gray-50 rounded-lg",children:[s.jsxs("button",{onClick:()=>u(!c),className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(_o,{size:16}),s.jsx("span",{children:"Filtres avancés"})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Trier par :"}),s.jsx("div",{className:"flex gap-2",children:[{key:"nom",label:"Nom"},{key:"prix_jour",label:"Prix"},{key:"longueur",label:"Longueur"},{key:"capacite",label:"Capacité"}].map(({key:N,label:k})=>s.jsxs("button",{onClick:()=>y(N),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1 ${r===N?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:[k,_(N)]},N))})]})]}),c&&s.jsxs("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filtres avancés"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix maximum par jour"}),s.jsx("input",{type:"number",placeholder:"€",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longueur minimum"}),s.jsx("input",{type:"number",placeholder:"mètres",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacité minimum"}),s.jsx("input",{type:"number",placeholder:"personnes",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),g.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:g.map(N=>s.jsx(ja,{boat:N},N._id))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx(_o,{size:64})}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun résultat"}),s.jsx("p",{className:"text-gray-500",children:"Essayez de modifier vos critères de recherche"})]})]})})}const ig=new URL("/assets/Yacht-charter-M-Y-ELTON_9-DZQi4yIW.jpg",import.meta.url).href;function ag(){const[n,e]=S.useState([]),[t,r]=S.useState([]),[i,a]=S.useState(!0),[l,c]=S.useState(""),[u,h]=S.useState([]),[p,g]=S.useState(!0),[y,_]=S.useState({destination:"",dateDebut:"",dateFin:"",type:""}),[C,E]=S.useState(!1),[N,k]=S.useState(!1),[R,P]=S.useState("");S.useEffect(()=>{V(),f()},[]);const V=async()=>{try{a(!0),console.log("🔄 Récupération des bateaux depuis l'API MongoDB...");const b=await te(se.BOATS);console.log("📊 Structure de la réponse API:",b);const v=b.data||b.boats||b||[];console.log(`✅ ${v.length||0} bateaux récupérés depuis MongoDB`),e(v),r(v)}catch(b){c("Erreur lors de la récupération des bateaux: "+b.message),console.error("❌ Erreur lors de la récupération des bateaux:",b)}finally{a(!1)}},B=async()=>{try{if(!y.destination||y.destination.trim()===""){P("Veuillez renseigner la destination pour effectuer une recherche.");return}P(""),E(!0),k(!0);let b=n.filter(v=>y.destination&&v.destination!==y.destination||y.type&&v.type!==y.type?!1:(y.dateDebut&&y.dateFin,!0));r(b),E(!1),b.length>0?setTimeout(()=>{const v=document.getElementById("search-results");v&&v.scrollIntoView?v.scrollIntoView({behavior:"smooth"}):v?.scrollIntoView({behavior:"smooth",block:"start"})},300):alert("Aucun bateau trouvé pour vos critères de recherche. Essayez de modifier vos filtres.")}catch(b){console.error("Erreur lors de la recherche:",b),E(!1)}},O=(b,v)=>{_(M=>({...M,[b]:v}))},j=()=>{_({destination:"",dateDebut:"",dateFin:"",type:""}),r([]),k(!1),P("")},f=async()=>{try{g(!0),console.log("🔄 Récupération des avis 5 étoiles depuis MongoDB...");const b=await te(`${se.FIVE_STAR_REVIEWS}?limit=3`);console.log("✅ Données avis 5 étoiles reçues depuis MongoDB:",b),b.data&&b.data.length>0?(console.log(`📝 ${b.data.length} avis 5 étoiles trouvés dans MongoDB`),h(b.data)):(console.log("⚠️ Aucun avis 5 étoiles trouvé dans MongoDB"),h([]))}catch(b){console.error("💥 Erreur réseau lors de la récupération des avis 5 étoiles:",b),h([])}finally{g(!1)}},w=n.slice(0,6),T=!!localStorage.getItem("userId"),A=[{id:1,name:"Saint-Malo",image:"https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=800",description:"La cité corsaire et ses îles sauvages"},{id:2,name:"Les Glénan",image:"https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=800",description:"Archipel breton aux eaux turquoise"},{id:3,name:"Marseille",image:"https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=800",description:"Calanques et îles du Frioul"}];return s.jsxs("div",{className:"min-h-screen",children:[s.jsxs("section",{className:"relative h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700",children:[s.jsx("img",{src:ig,alt:"","aria-hidden":"true",className:"absolute inset-0 w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/60 via-black/40 to-black/20 pointer-events-none"}),s.jsxs("div",{className:"relative z-10 flex items-center justify-center h-full px-4",children:[s.jsxs("div",{className:"text-center text-white max-w-4xl",children:[s.jsxs("h1",{className:"text-6xl md:text-8xl font-bold mb-8 tracking-wider",children:["SAILINGLOC",s.jsx("span",{className:"text-orange-500",children:"."})]}),s.jsx("p",{className:"text-xl md:text-2xl mb-12 font-light max-w-3xl mx-auto leading-relaxed",children:"Découvrez les plus beaux bateaux pour vos aventures en mer"}),s.jsx("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl p-6 max-w-5xl mx-auto shadow-2xl",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Wt,{className:"h-4 w-4 text-gray-500"}),s.jsx("label",{className:"text-sm font-semibold text-gray-700 whitespace-nowrap",children:"Destination"})]}),s.jsxs("select",{className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700 mt-2",value:y.destination,onChange:b=>O("destination",b.target.value),children:[s.jsx("option",{value:"",children:"Destination"}),s.jsx("option",{value:"saint-malo",children:"Saint-Malo"}),s.jsx("option",{value:"les-glenan",children:"Les Glénan"}),s.jsx("option",{value:"crozon",children:"Crozon"}),s.jsx("option",{value:"la-rochelle",children:"La Rochelle"}),s.jsx("option",{value:"marseille",children:"Marseille"}),s.jsx("option",{value:"cannes",children:"Cannes"}),s.jsx("option",{value:"ajaccio",children:"Ajaccio"}),s.jsx("option",{value:"barcelone",children:"Barcelone"}),s.jsx("option",{value:"palma",children:"Palma de Majorque"}),s.jsx("option",{value:"athenes",children:"Athènes"}),s.jsx("option",{value:"venise",children:"Venise"}),s.jsx("option",{value:"amsterdam",children:"Amsterdam"}),s.jsx("option",{value:"split",children:"Split"})]})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(at,{className:"h-4 w-4 text-gray-500"}),s.jsx("label",{className:"text-sm font-semibold text-gray-700 whitespace-nowrap",children:"Date de début"})]}),s.jsx("input",{type:"date",placeholder:"Date de début",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700 mt-2",value:y.dateDebut,onChange:b=>O("dateDebut",b.target.value)})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(at,{className:"h-4 w-4 text-gray-500"}),s.jsx("label",{className:"text-sm font-semibold text-gray-700 whitespace-nowrap",children:"Date de fin"})]}),s.jsx("input",{type:"date",placeholder:"Date de fin",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700 mt-2",value:y.dateFin,onChange:b=>O("dateFin",b.target.value)})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(We,{className:"h-4 w-4 text-gray-500"}),s.jsx("label",{className:"text-sm font-semibold text-gray-700 whitespace-nowrap",children:"Type de bateau"})]}),s.jsxs("select",{className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700 mt-2 min-w-[140px]",value:y.type,onChange:b=>O("type",b.target.value),children:[s.jsx("option",{value:"",children:"Type"}),s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"})]})]}),s.jsx("div",{className:"flex items-end",children:s.jsx("button",{onClick:B,disabled:C,className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:C?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Recherche..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Lc,{size:20}),s.jsx("span",{children:"Rechercher"})]})})})]})})]}),R&&s.jsx("div",{className:"mt-6 max-w-5xl mx-auto transform transition-all duration-500 ease-out animate-bounce",children:s.jsxs("div",{className:"bg-gradient-to-r from-red-50 via-red-100 to-red-50 border-l-4 border-red-400 shadow-xl rounded-2xl p-5 flex items-center space-x-4 backdrop-blur-sm",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsxs("div",{className:"relative",children:[s.jsx(Ot,{className:"h-7 w-7 text-red-500 animate-pulse"}),s.jsx("div",{className:"absolute -top-1 -right-1 h-3 w-3 bg-red-400 rounded-full animate-ping"})]})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-red-800 font-semibold text-base leading-relaxed",children:R}),s.jsx("p",{className:"text-red-600 text-sm mt-1",children:"Sélectionnez une destination dans la liste déroulante ci-dessus"})]}),s.jsx("button",{onClick:()=>P(""),className:"flex-shrink-0 p-2 rounded-full hover:bg-red-200 transition-all duration-200 hover:scale-110 active:scale-95",title:"Fermer le message",children:s.jsx(Re,{className:"h-5 w-5 text-red-600"})})]})})]})]}),s.jsx("section",{className:"py-20 bg-gray-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Nos bateaux vedettes"}),s.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Découvrez notre sélection de bateaux les plus populaires pour vos escapades en mer"})]}),i?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement des bateaux..."})]}):l?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(We,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Erreur de chargement"}),s.jsx("p",{className:"text-gray-500",children:l})]}):w.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(We,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun bateau disponible"}),s.jsx("p",{className:"text-gray-500",children:"Revenez bientôt pour découvrir nos bateaux !"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:w.map(b=>s.jsx(ja,{boat:b},b._id))}),n.length>6&&s.jsx("div",{className:"text-center mt-12",children:s.jsxs(z,{to:"/bateaux",className:"inline-flex items-center space-x-2 bg-blue-600 text-white px-8 py-3 rounded-full font-medium hover:bg-blue-700 transition-colors",children:[s.jsx("span",{children:"Voir tous les bateaux"}),s.jsx(Dc,{size:20})]})})]})}),N&&s.jsx(rg,{boats:t,onReset:j,searchFilters:y}),s.jsx("section",{className:"py-20 bg-gradient-to-br from-blue-50 to-white",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsxs("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:["Ce que disent nos"," ",s.jsx("span",{className:"text-blue-600",children:"navigateurs"})]}),s.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Découvrez les expériences exceptionnelles de nos clients les plus satisfaits"})]}),p?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement des avis 5 étoiles depuis la table reviews..."})]}):u.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(We,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun avis 5 étoiles disponible"}),s.jsx("p",{className:"text-gray-500",children:"Revenez bientôt pour découvrir les avis exceptionnels de nos navigateurs !"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:u.map(b=>s.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-8 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 relative overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-semibold text-lg",children:b.userId?.nom?.charAt(0)||"U"})}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold text-gray-900",children:[b.userId?.nom," ",b.userId?.prenom]}),s.jsx("p",{className:"text-sm text-gray-500",children:b.boatId?.nom||"Bateau"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"flex items-center space-x-1 mb-2",children:[...Array(5)].map((v,M)=>s.jsx(tl,{size:20,className:"text-yellow-400 fill-current"},M))}),s.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Excellent"})]})]}),s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Sn,{className:"h-6 w-6 text-blue-500 mt-1 flex-shrink-0"}),s.jsxs("blockquote",{className:"text-gray-700 leading-relaxed italic text-lg",children:['"',b.comment,'"']})]})}),s.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 pt-4 border-t border-gray-100",children:[s.jsx("span",{children:new Date(b.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}),b.boatId?.type&&s.jsx("span",{className:"capitalize bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs font-medium",children:b.boatId.type})]})]},b._id))}),u.length>6&&s.jsx("div",{className:"text-center mt-12",children:s.jsxs(z,{to:"/avis",className:"inline-flex items-center space-x-2 bg-blue-600 text-white px-8 py-3 rounded-full font-medium hover:bg-blue-700 transition-colors",children:[s.jsx("span",{children:"Voir tous les avis"}),s.jsx(Dc,{size:20})]})})]})}),s.jsx("section",{className:"py-20 bg-gray-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsx("div",{className:"text-center mb-16",children:s.jsxs("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:["Cap sur les ",s.jsx("span",{className:"text-blue-600",children:"destinations"})," ","les plus prisées par nos navigateurs !"]})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:A.map(b=>s.jsx("div",{className:"relative group cursor-pointer",children:s.jsxs("div",{className:"relative overflow-hidden rounded-2xl shadow-xl",children:[s.jsx("img",{src:b.image,alt:b.name,className:"w-full h-80 object-cover group-hover:scale-105 transition-transform duration-500"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),s.jsxs("div",{className:"absolute bottom-8 left-8 text-white",children:[s.jsx("h3",{className:"text-2xl font-bold mb-2",children:b.name}),s.jsx("p",{className:"text-lg opacity-90",children:b.description})]})]})},b.id))})]})}),s.jsx("section",{className:"py-20 bg-blue-600",children:s.jsxs("div",{className:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8",children:[s.jsx("h2",{className:"text-4xl font-bold text-white mb-6",children:"Prêt à vivre l'aventure ?"}),s.jsx("p",{className:"text-xl text-blue-100 mb-8",children:"Rejoignez SailingLoc et commencez à explorer les mers du monde"}),s.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:T?s.jsxs(z,{to:"/bateaux",className:"inline-flex items-center space-x-2 bg-white text-blue-600 px-8 py-3 rounded-full font-medium hover:bg-gray-50 transition-colors",children:[s.jsx(Lc,{size:20}),s.jsx("span",{children:"Rechercher un bateau"})]}):s.jsxs(s.Fragment,{children:[s.jsxs(z,{to:"/inscription",className:"inline-flex items-center space-x-2 bg-white text-blue-600 px-8 py-3 rounded-full font-medium hover:bg-gray-50 transition-colors",children:[s.jsx(_f,{size:20}),s.jsx("span",{children:"S'inscrire"})]}),s.jsx(z,{to:"/connexion",className:"inline-flex items-center space-x-2 border-2 border-white text-white px-8 py-3 rounded-full font-medium hover:bg-white hover:text-blue-600 transition-colors",children:s.jsx("span",{children:"Se connecter"})})]})})]})})]})}function og(){const[n,e]=S.useState([]),[t,r]=S.useState([]),[i,a]=S.useState(!0),[l,c]=S.useState(""),[u,h]=S.useState({type:"",priceRange:"",capacity:""}),[p,g]=S.useState("grid");S.useEffect(()=>{y()},[]);const y=async()=>{try{a(!0),console.log("🔄 Récupération des bateaux depuis l'API MongoDB...");const E=await te(se.BOATS);console.log("📊 Structure de la réponse API:",E);const N=E.data||E.boats||E||[];console.log(`✅ ${N.length||0} bateaux récupérés depuis MongoDB`),e(N),r(N)}catch(E){c("Erreur lors de la récupération des bateaux: "+E.message),console.error("❌ Erreur lors de la récupération des bateaux:",E)}finally{a(!1)}},_=(E,N)=>{const k={...u,[E]:N};h(k);let R=n;if(k.type&&(R=R.filter(P=>P.type.toLowerCase().includes(k.type.toLowerCase()))),k.priceRange){const[P,V]=k.priceRange.split("-").map(Number);R=R.filter(B=>B.prix_jour>=P&&(V?B.prix_jour<=V:!0))}k.capacity&&(R=R.filter(P=>P.capacite>=parseInt(k.capacity))),r(R)},C=()=>{h({type:"",priceRange:"",capacity:""}),r(n)};return i?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement des bateaux..."})]})}):l?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(We,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Erreur de chargement"}),s.jsx("p",{className:"text-gray-500",children:l})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[s.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-4 sm:mb-0",children:"Nos bateaux"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[t.length," bateau",t.length>1?"x":""," trouvé",t.length>1?"s":""]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>g("grid"),className:`p-2 rounded-md ${p==="grid"?"bg-blue-100 text-blue-600":"text-gray-400"}`,children:s.jsx(df,{size:20})}),s.jsx("button",{onClick:()=>g("list"),className:`p-2 rounded-md ${p==="list"?"bg-blue-100 text-blue-600":"text-gray-400"}`,children:s.jsx(gf,{size:20})})]})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsx("div",{className:"lg:w-1/4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[s.jsx(_o,{size:20}),s.jsx("span",{children:"Filtres"})]}),s.jsx("button",{onClick:C,className:"text-sm text-blue-600 hover:text-blue-700",children:"Effacer"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de bateau"}),s.jsxs("select",{value:u.type,onChange:E=>_("type",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tous les types"}),s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fourchette de prix"}),s.jsxs("select",{value:u.priceRange,onChange:E=>_("priceRange",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tous les prix"}),s.jsx("option",{value:"0-100",children:"0€ - 100€"}),s.jsx("option",{value:"100-200",children:"100€ - 200€"}),s.jsx("option",{value:"200-300",children:"200€ - 300€"}),s.jsx("option",{value:"300-500",children:"300€ - 500€"}),s.jsx("option",{value:"500-1000",children:"500€+"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacité minimale"}),s.jsxs("select",{value:u.capacity,onChange:E=>_("capacity",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Toutes capacités"}),s.jsx("option",{value:"2",children:"2+ personnes"}),s.jsx("option",{value:"4",children:"4+ personnes"}),s.jsx("option",{value:"6",children:"6+ personnes"}),s.jsx("option",{value:"8",children:"8+ personnes"}),s.jsx("option",{value:"10",children:"10+ personnes"})]})]})]})]})}),s.jsx("div",{className:"lg:w-3/4",children:t.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(We,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun bateau trouvé"}),s.jsx("p",{className:"text-gray-500",children:"Essayez de modifier vos filtres ou revenez plus tard."})]}):s.jsx("div",{className:p==="grid"?"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6":"space-y-4",children:t.map(E=>s.jsx(ja,{boat:E,viewMode:p},E._id))})})]})})]})}const lg="/assets/apropos-Dvd8oeAQ.png";function cg(){const n=[{icon:We,title:"Large choix de bateaux",description:"Une sélection rigoureuse de bateaux entretenus et vérifiés pour votre sécurité et votre confort."},{icon:bt,title:"Réservation facile et rapide",description:"Réservez en quelques clics avec notre système de réservation en ligne simple et intuitif."},{icon:Nd,title:"Paiements sécurisés et service fiable",description:"Transactions 100% sécurisées et équipe disponible 7j/7 pour vous accompagner."}];return s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsxs("section",{className:"relative py-24 bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),s.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-8",children:"À propos."}),s.jsx("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto leading-relaxed",children:"Une question ? Écrivez-nous, nous vous répondons rapidement !"})]})]}),s.jsx("section",{className:"py-20 bg-white",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[s.jsx("div",{children:s.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl",children:[s.jsx("h2",{className:"text-3xl font-bold mb-6",children:"À PROPOS"}),s.jsxs("p",{style:{fontSize:"1.1rem",color:"var(--color-gray-800)",marginBottom:"1.5rem"},children:["SailingLoc est une start-up innovante fondée par M. Voisin, spécialisée dans la mise en relation pour la location de voiliers et de yachts. Basée à La Rochelle (Charente-Maritime), SailingLoc propose une plateforme collaborative, sécurisée et centrée sur l’expérience utilisateur.",s.jsx("br",{}),s.jsx("br",{}),"Notre service s’adresse aussi bien aux passionnés de navigation qu’aux vacanciers occasionnels, en facilitant la location de bateaux auprès de particuliers ou de professionnels partout en Europe. Que ce soit pour une sortie en mer, une croisière en famille, entre amis ou en couple, SailingLoc vous invite à vivre des aventures maritimes authentiques et inoubliables."]}),s.jsx("h2",{className:"text-orange-500 text-[1.3rem] mb-4 font-bold",children:"Informations légales"}),s.jsxs("ul",{style:{fontSize:"1.08rem",color:"var(--color-gray-800)",listStyle:"none",padding:0,lineHeight:1.8},children:[s.jsxs("li",{children:[s.jsx("b",{children:"Dénomination sociale"})," : SailingLoc"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Date de création"})," : 15/03/2024"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Siège social"})," : 12 Quai Louis Durand, 17000 La Rochelle"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Statut juridique"})," : Société par Actions Simplifiée (SAS)"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Capital social"})," : 15 000 €"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Numéro RCS"})," : LA ROCHELLE B 923 456 789"]}),s.jsxs("li",{children:[s.jsx("b",{children:"SIREN"})," : 923 456 789"]}),s.jsxs("li",{children:[s.jsx("b",{children:"SIRET"})," : 923 456 789 00014"]}),s.jsxs("li",{children:[s.jsx("b",{children:"Code APE/NAF"})," : 7990Z – Services de réservation et activités connexes"]}),s.jsxs("li",{children:[s.jsx("b",{children:"TVA intracommunautaire"})," : FR42923456789"]})]})]})}),s.jsx("div",{className:"relative",children:s.jsx("img",{src:lg,alt:"À propos SailingLoc",className:"rounded-2xl shadow-2xl w-full"})})]})})}),s.jsx("section",{className:"py-16 bg-gray-50",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:s.jsxs("p",{className:"text-lg text-gray-700 leading-relaxed",children:["Notre ",s.jsx("strong",{children:"mission"})," est de rendre la navigation ",s.jsx("strong",{children:"accessible"}),", ",s.jsx("strong",{children:"simple"})," et ",s.jsx("strong",{children:"sécurisée"})," pour tous les passionnés de mer."]})})}),s.jsx("section",{className:"py-20 bg-white",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsx("div",{className:"text-center mb-16",children:s.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"Nos trois piliers"})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:n.map((e,t)=>s.jsxs("div",{className:"text-center group",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-blue-100 rounded-full mb-6 group-hover:bg-blue-600 transition-colors",children:s.jsx(e.icon,{className:"h-10 w-10 text-blue-600 group-hover:text-white transition-colors"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:e.title}),s.jsx("p",{className:"text-gray-600 leading-relaxed",children:e.description})]},t))})]})}),s.jsx("section",{className:"py-20 bg-gradient-to-r from-blue-600 to-blue-800",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsx("h2",{className:"text-4xl font-bold text-white mb-6",children:"Prêt à naviguer avec nous ?"}),s.jsx("p",{className:"text-xl text-blue-100 mb-10 max-w-2xl mx-auto",children:"Découvrez notre sélection de bateaux et réservez votre prochaine aventure"}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[s.jsx(z,{to:"/bateaux",className:"bg-white text-blue-600 px-8 py-4 rounded-full font-medium hover:bg-gray-100 transition-colors text-center",children:"Voir les bateaux"}),s.jsx(z,{to:"/contact",className:"bg-orange-500 text-white px-8 py-4 rounded-full font-medium hover:bg-orange-600 transition-colors text-center",children:"Nous contacter"})]})]})})]})}function ug(){const[n,e]=S.useState({nom:"",prenom:"",telephone:"",message:"",email:""}),[t,r]=S.useState({}),[i,a]=S.useState(!1),[l,c]=S.useState(!1),u=g=>{const{name:y,value:_}=g.target;e(C=>({...C,[y]:_})),t[y]&&r(C=>({...C,[y]:""}))},h=()=>{const g={};return n.nom.trim()||(g.nom="Le nom est requis"),n.prenom.trim()||(g.prenom="Le prénom est requis"),n.telephone.trim()||(g.telephone="Le téléphone est requis"),n.message.trim()||(g.message="Le message est requis"),r(g),Object.keys(g).length===0},p=async g=>{if(g.preventDefault(),!!h()){a(!0);try{console.log("🔄 Envoi du message de contact..."),await te(se.CONTACT,{method:"POST",body:JSON.stringify({nom:n.nom,prenom:n.prenom,telephone:n.telephone,message:n.message,email:n.email})}),console.log("✅ Message envoyé avec succès"),c(!0),e({nom:"",prenom:"",telephone:"",message:"",email:""}),setTimeout(()=>{c(!1)},5e3)}catch(y){alert(y.message||"Erreur lors de l'envoi du message.")}finally{a(!1)}}};return s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[l&&s.jsx("div",{className:"fixed top-24 right-4 z-50 animate-slide-in-right",children:s.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-4 rounded-xl shadow-2xl flex items-center space-x-3 max-w-md border border-green-400",children:[s.jsx("div",{className:"animate-bounce-in",children:s.jsx(On,{className:"h-7 w-7 text-green-100 flex-shrink-0"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-bold text-lg",children:"Message envoyé ! 🎉"}),s.jsx("p",{className:"text-green-100 text-sm",children:"Nous vous répondrons dans les plus brefs délais."})]}),s.jsx("button",{onClick:()=>c(!1),className:"text-green-100 hover:text-white transition-colors duration-200 hover:bg-green-400 hover:bg-opacity-20 rounded-full p-1",children:s.jsx(Re,{className:"h-5 w-5"})})]})}),s.jsxs("section",{className:"relative py-24 bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),s.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-8",children:"Contact"}),s.jsx("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto leading-relaxed",children:"Nous simplifions la location de bateaux dans plus de 60 destinations, pour que vous puissiez profiter à tous vos besoins de navigation."})]})]}),s.jsx("section",{className:"py-20 bg-white",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[s.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:s.jsx(wd,{className:"h-8 w-8 text-blue-900"})}),s.jsx("h3",{className:"text-xl font-bold mb-4",children:"TÉLÉPHONE"}),s.jsx("p",{className:"text-blue-100 mb-2",children:"+33 2 99 40 78 90"}),s.jsx("p",{className:"text-sm text-blue-200",children:"Lun-Ven : 9h-18h"})]}),s.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:s.jsx(Vn,{className:"h-8 w-8 text-blue-900"})}),s.jsx("h3",{className:"text-xl font-bold mb-4",children:"INFORMATIONS"}),s.jsx("p",{className:"text-blue-100 mb-2",children:"sailinglocequipe@gmail.com"}),s.jsx("p",{className:"text-sm text-blue-200",children:"Réponse sous 24h"})]}),s.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:s.jsx(Wt,{className:"h-8 w-8 text-blue-900"})}),s.jsx("h3",{className:"text-xl font-bold mb-4",children:"ADRESSE"}),s.jsx("p",{className:"text-blue-100 mb-2",children:"12 Quai Louis Durand"}),s.jsx("p",{className:"text-sm text-blue-200",children:"17000 La Rochelle"})]}),s.jsxs("div",{className:"bg-blue-900 text-white p-8 rounded-2xl text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-6",children:s.jsx(bt,{className:"h-8 w-8 text-blue-900"})}),s.jsx("h3",{className:"text-xl font-bold mb-4",children:"HORAIRES"}),s.jsx("p",{className:"text-blue-100 mb-2",children:"Lun-Sam : 9h-18h"}),s.jsx("p",{className:"text-sm text-blue-200",children:"Fermé le dimanche"})]})]})})}),s.jsx("section",{className:"py-20 bg-gray-50",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 md:p-12",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Formulaire de contact"}),s.jsx("p",{className:"text-gray-600",children:"Remplissez le formulaire ci-dessous et nous vous répondrons rapidement"})]}),s.jsxs("form",{onSubmit:p,className:"space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"nom",className:"block text-sm font-bold text-gray-900 mb-3",children:"NOM"}),s.jsx("input",{type:"text",id:"nom",name:"nom",value:n.nom,onChange:u,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.nom?"border-red-500":"border-gray-200"}`,placeholder:"Votre nom"}),t.nom&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.nom})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"prenom",className:"block text-sm font-bold text-gray-900 mb-3",children:"PRÉNOM"}),s.jsx("input",{type:"text",id:"prenom",name:"prenom",value:n.prenom,onChange:u,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.prenom?"border-red-500":"border-gray-200"}`,placeholder:"Votre prénom"}),t.prenom&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.prenom})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-bold text-gray-900 mb-3",children:"EMAIL"}),s.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:u,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.email?"border-red-500":"border-gray-200"}`,placeholder:"Votre email"}),t.email&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.email})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"telephone",className:"block text-sm font-bold text-gray-900 mb-3",children:"TÉLÉPHONE"}),s.jsx("input",{type:"tel",id:"telephone",name:"telephone",value:n.telephone,onChange:u,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.telephone?"border-red-500":"border-gray-200"}`,placeholder:"Votre numéro de téléphone"}),t.telephone&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.telephone})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"message",className:"block text-sm font-bold text-gray-900 mb-3",children:"MESSAGE"}),s.jsx("textarea",{id:"message",name:"message",value:n.message,onChange:u,rows:6,className:`w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.message?"border-red-500":"border-gray-200"}`,placeholder:"Votre message..."}),t.message&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.message})]}),s.jsx("div",{className:"text-center",children:s.jsx("button",{type:"submit",disabled:i,className:`inline-flex items-center space-x-3 px-12 py-4 rounded-full font-bold text-lg transition-colors ${i?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white shadow-lg`,children:i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}),s.jsx("span",{children:"Envoi en cours..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(jd,{size:24}),s.jsx("span",{children:"ENVOYER"})]})})})]})]})})})]})}function dg({isOpen:n,onClose:e,onReviewAdded:t,boatData:r,bookingId:i}){const[a,l]=S.useState({rating:5,comment:""}),[c,u]=S.useState(!1),[h,p]=S.useState(""),[g,y]=S.useState(""),_=k=>{l(R=>({...R,rating:k}))},C=k=>{const{name:R,value:P}=k.target;l(V=>({...V,[R]:P}))},E=async k=>{k.preventDefault(),u(!0),p(""),y("");try{if(!a.comment.trim())throw new Error("Le commentaire est obligatoire");if(a.comment.trim().length<10)throw new Error("Le commentaire doit contenir au moins 10 caractères");if(a.comment.trim().length>1e3)throw new Error("Le commentaire ne peut pas dépasser 1000 caractères");const R=localStorage.getItem("token");if(!R)throw new Error("Vous devez être connecté");console.log("🔄 Ajout de l'avis dans MongoDB...");const P=await te(se.REVIEWS,{method:"POST",headers:he(R),body:JSON.stringify({boatId:r._id,bookingId:i,rating:a.rating,comment:a.comment.trim()})});console.log("✅ Avis ajouté avec succès:",P),y("Avis ajouté avec succès !"),t&&t(P.data),setTimeout(()=>{e(),y("")},2e3)}catch(R){p(R.message)}finally{u(!1)}},N=()=>{l({rating:5,comment:"",images:[]}),p(""),y(""),e()};return n?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(Sn,{className:"h-6 w-6 text-blue-600"}),"Laisser un avis"]}),s.jsx("button",{onClick:N,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx(Re,{className:"h-6 w-6 text-gray-500"})})]}),s.jsxs("form",{onSubmit:E,className:"p-6 space-y-6",children:[h&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:h}),g&&s.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:g}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h3",{className:"font-medium text-gray-900 mb-2",children:["Bateau : ",r?.nom]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Type : ",r?.type]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Note globale *"}),s.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(k=>s.jsx("button",{type:"button",onClick:()=>_(k),className:`p-1 transition-colors ${k<=a.rating?"text-yellow-400 hover:text-yellow-500":"text-gray-300 hover:text-gray-400"}`,children:s.jsx(tl,{className:"h-8 w-8 fill-current"})},k))}),s.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[a.rating===1&&"Très mauvais",a.rating===2&&"Mauvais",a.rating===3&&"Moyen",a.rating===4&&"Bon",a.rating===5&&"Excellent"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Votre avis *"}),s.jsx("textarea",{name:"comment",value:a.comment,onChange:C,rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Partagez votre expérience avec ce bateau... (minimum 10 caractères)",required:!0}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.comment.length,"/1000 caractères"]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:N,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:c?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Envoi en cours..."]}):s.jsxs(s.Fragment,{children:[s.jsx(jd,{className:"h-4 w-4"}),"Publier l'avis"]})})]})]})]})}):null}function hg({review:n,onHelpfulClick:e}){const t=i=>new Date(i).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),r=()=>{e&&e(n._id)};return s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:n.userId?.nom?.charAt(0)||"U"})}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-medium text-gray-900",children:[n.userId?.nom," ",n.userId?.prenom]}),s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[s.jsx(at,{className:"h-4 w-4"}),s.jsx("span",{children:t(n.createdAt)})]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(Ar,{rating:n.rating,size:20}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[n.rating===1&&"Très mauvais",n.rating===2&&"Mauvais",n.rating===3&&"Moyen",n.rating===4&&"Bon",n.rating===5&&"Excellent"]})]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Sn,{className:"h-5 w-5 text-gray-400 mt-0.5 flex-shrink-0"}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:n.comment})]})}),n.images&&n.images.length>0&&s.jsx("div",{className:"mb-4",children:s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:n.images.map((i,a)=>s.jsx("div",{className:"relative",children:s.jsx("img",{src:i,alt:`Image ${a+1}`,className:"w-full h-24 object-cover rounded-lg",onError:l=>{l.target.style.display="none"}})},a))})}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[s.jsx("div",{className:"flex items-center space-x-4",children:s.jsxs("button",{onClick:r,className:"flex items-center space-x-2 text-gray-600 hover:text-blue-600 transition-colors",children:[s.jsx(vf,{className:"h-4 w-4"}),s.jsxs("span",{className:"text-sm",children:["Utile (",n.helpful||0,")"]})]})}),n.bookingId&&s.jsx("div",{className:"text-xs text-gray-500",children:"Avis basé sur une réservation"})]})]})}function mg(){const{id:n}=bd(),[e,t]=S.useState(null),[r,i]=S.useState(!0),[a,l]=S.useState(""),[c,u]=S.useState([]),[h,p]=S.useState(!1),[g,y]=S.useState(0),[_,C]=S.useState(0);S.useEffect(()=>{E(),N()},[n]);const E=async()=>{try{i(!0),console.log("🔄 Récupération des détails du bateau depuis MongoDB...");const B=await te(se.BOAT_DETAIL(n));console.log("✅ Détails du bateau récupérés:",B),t(B)}catch(B){l("Bateau non trouvé: "+B.message),console.error("❌ Erreur lors de la récupération des détails:",B)}finally{i(!1)}},N=async()=>{try{console.log("🔄 Récupération des avis du bateau depuis MongoDB...");const B=await te(se.BOAT_REVIEWS(n));console.log("📊 Structure de la réponse API avis:",B);const O=B.data||B.reviews||B||[],j=B.averageRating||B.rating||0,f=B.total||B.count||O.length;console.log(`✅ ${O.length||0} avis récupérés depuis MongoDB`),u(O),y(j),C(f)}catch(B){console.error("❌ Erreur lors de la récupération des avis:",B)}},k=()=>{p(!0)},R=B=>{N(),p(!1)},P=()=>{p(!1)},V=async B=>{try{console.log("🔄 Mise à jour du vote utile..."),await te(`${se.REVIEWS}/${B}/helpful`,{method:"PUT"}),console.log("✅ Vote utile mis à jour"),N()}catch(O){console.error("Erreur lors du marquage utile:",O)}};return r?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(wt,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement du bateau..."})]})}):a||!e?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(We,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:a||"Bateau non trouvé"}),s.jsx(z,{to:"/bateaux",className:"text-blue-600 hover:text-blue-700",children:"Retourner à la liste des bateaux"})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[s.jsxs(z,{to:"/bateaux",className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 mb-4",children:[s.jsx(ya,{size:20}),s.jsx("span",{children:"Retour aux bateaux"})]}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e.nom}),s.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Ar,{rating:e.rating||0}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",e.reviews||0," avis)"]})]}),s.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[s.jsx(Wt,{size:16}),s.jsx("span",{className:"capitalize",children:e.destination})]})]})]})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:e.image,alt:e.nom,className:"w-full h-96 object-cover rounded-lg shadow-lg"}),s.jsx("div",{className:"absolute top-4 left-4 bg-blue-600 text-white px-3 py-1 rounded-md font-medium",children:e.type}),s.jsx(To,{boatId:e._id})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Description"}),e.description?s.jsx("p",{className:"text-gray-600 mb-6",children:e.description}):s.jsx("p",{className:"text-gray-500 italic mb-6",children:"Aucune description disponible pour ce bateau."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Caractéristiques"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ys,{size:16,className:"text-blue-600"}),s.jsxs("span",{children:["Capacité : ",e.capacite," personnes"]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(el,{size:16,className:"text-blue-600"}),s.jsxs("span",{children:["Longueur : ",e.longueur,"m"]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Wt,{size:16,className:"text-blue-600"}),s.jsxs("span",{children:["Destination : ",e.destination]})]})]})]}),e.equipements&&e.equipements.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Équipements"}),s.jsx("div",{className:"space-y-2 text-sm",children:e.equipements.map((B,O)=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Gi,{size:16,className:"text-green-600"}),s.jsx("span",{children:B})]},O))})]})]})]})]}),s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-24",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[e.prix_jour,"€"]}),s.jsx("div",{className:"text-gray-600",children:"par jour"})]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Capacité"}),s.jsxs("span",{className:"font-medium",children:[e.capacite," personnes"]})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Type"}),s.jsx("span",{className:"font-medium capitalize",children:e.type})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Longueur"}),s.jsxs("span",{className:"font-medium",children:[e.longueur,"m"]})]})]}),s.jsx(z,{to:`/reservation/${n}`,className:"w-full bg-orange-500 text-white py-3 px-6 rounded-lg font-medium hover:bg-orange-600 transition-colors flex items-center justify-center",children:"Réserver ce bateau"}),s.jsx("div",{className:"text-center mt-4",children:s.jsx("p",{className:"text-xs text-gray-500",children:"Réservation sécurisée • Annulation gratuite"})})]})})]}),s.jsx("div",{className:"mt-8",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Sn,{className:"h-6 w-6 text-blue-600"}),"Avis des clients"]}),s.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Ar,{rating:g,size:20}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",_," avis)"]})]}),g>0&&s.jsxs("span",{className:"text-sm text-gray-500",children:["Note moyenne : ",g.toFixed(1),"/5"]})]})]}),s.jsxs("button",{onClick:k,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[s.jsx(Sn,{className:"h-4 w-4"}),"Laisser un avis"]})]}),s.jsx("div",{className:"space-y-4",children:c.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Sn,{size:48,className:"mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"Aucun avis pour le moment"}),s.jsx("p",{className:"text-sm",children:"Soyez le premier à laisser un avis !"})]}):c.map(B=>s.jsx(hg,{review:B,onHelpfulClick:V},B._id))})]})})]}),s.jsx(dg,{isOpen:h,onClose:P,onReviewAdded:R,boatData:e})]})}const Dd=({onCaptchaChange:n,isCorrect:e,setIsCorrect:t})=>{const[r,i]=S.useState(""),[a,l]=S.useState(""),[c,u]=S.useState(null),h=S.useRef(null),p=()=>{const C="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let E="";for(let N=0;N<6;N++)E+=C.charAt(Math.floor(Math.random()*C.length));return E},g=C=>{const E=h.current;if(!E)return;const N=E.getContext("2d"),k=E.width,R=E.height;N.clearRect(0,0,k,R);const P=N.createLinearGradient(0,0,k,R);P.addColorStop(0,"#f3f4f6"),P.addColorStop(1,"#e5e7eb"),N.fillStyle=P,N.fillRect(0,0,k,R);for(let O=0;O<100;O++)N.fillStyle=`rgba(${Math.random()*255}, ${Math.random()*255}, ${Math.random()*255}, 0.1)`,N.fillRect(Math.random()*k,Math.random()*R,1,1);for(let O=0;O<3;O++)N.strokeStyle=`rgba(${Math.random()*255}, ${Math.random()*255}, ${Math.random()*255}, 0.3)`,N.lineWidth=1,N.beginPath(),N.moveTo(Math.random()*k,Math.random()*R),N.lineTo(Math.random()*k,Math.random()*R),N.stroke();N.font="bold 32px Arial",N.textAlign="center",N.textBaseline="middle";let V=k/2,B=R/2;for(let O=0;O<C.length;O++){const j=C[O];N.fillStyle=`rgb(${Math.random()*100+50}, ${Math.random()*100+50}, ${Math.random()*100+50})`,N.save();const f=V+(O-C.length/2)*35+(Math.random()-.5)*10,w=B+(Math.random()-.5)*15,T=(Math.random()-.5)*.4;N.translate(f,w),N.rotate(T),N.fillText(j,0,0),N.restore()}for(let O=0;O<5;O++)N.fillStyle=`rgba(${Math.random()*255}, ${Math.random()*255}, ${Math.random()*255}, 0.1)`,N.beginPath(),N.arc(Math.random()*k,Math.random()*R,Math.random()*10+5,0,2*Math.PI),N.fill()},y=()=>{const C=p();i(C),l(""),t(!1),setTimeout(()=>{g(C)},100),n&&n({question:C,answer:C})},_=C=>{l(C);const E=C.toUpperCase()===r;t(E),n&&n({question:r,answer:r,userAnswer:C,isCorrect:E})};return S.useEffect(()=>{y()},[]),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Vérification de sécurité *"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 text-center",children:[s.jsx("canvas",{ref:h,width:300,height:80,className:"mx-auto border border-gray-200 rounded",style:{imageRendering:"pixelated"}}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Recopiez les lettres et chiffres affichés ci-dessus"})]})}),s.jsx("button",{type:"button",onClick:y,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"Nouveau CAPTCHA",children:s.jsx(bf,{className:"h-5 w-5"})})]}),s.jsx("input",{type:"text",value:a,onChange:C=>_(C.target.value),placeholder:"Tapez le code ci-dessus",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${a&&!e?"border-red-300 focus:ring-red-500":a&&e?"border-green-300 focus:ring-green-500":"border-gray-300"}`,required:!0,maxLength:6}),a&&s.jsx("div",{className:`text-sm ${e?"text-green-600":"text-red-600"}`,children:e?s.jsx("span",{className:"flex items-center gap-1",children:"✅ Code correct"}):s.jsx("span",{className:"flex items-center gap-1",children:"❌ Code incorrect, réessayez"})}),s.jsx("p",{className:"text-xs text-gray-500",children:"Recopiez le code affiché pour vérifier que vous êtes humain"})]})};function pg(){const[n,e]=S.useState({email:"",password:""}),[t,r]=S.useState(!1),[i,a]=S.useState({}),[l,c]=S.useState(!1),[u,h]=S.useState({}),[p,g]=S.useState(!1),y=es(),_=N=>{const{name:k,value:R}=N.target;e(P=>({...P,[k]:R})),i[k]&&a(P=>({...P,[k]:""}))},C=()=>{const N={};return n.email.trim()?/\S+@\S+\.\S+/.test(n.email)||(N.email="Format d'email invalide"):N.email="L'email est requis",n.password.trim()?n.password.length<6&&(N.password="Le mot de passe doit contenir au moins 6 caractères"):N.password="Le mot de passe est requis",p||(N.captcha="Veuillez résoudre le CAPTCHA correctement"),a(N),Object.keys(N).length===0},E=async N=>{if(N.preventDefault(),!!C()){c(!0);try{console.log("🔄 Connexion en cours...");const k=await te(se.LOGIN,{method:"POST",body:JSON.stringify({email:n.email,password:n.password,captchaQuestion:u.question,captchaAnswer:u.answer,userAnswer:u.userAnswer})});console.log("✅ Connexion réussie:",k),localStorage.setItem("token",k.token),localStorage.setItem("userPrenom",k.user.prenom),localStorage.setItem("userRole",k.user.role),localStorage.setItem("userId",k.user.id),localStorage.setItem("userNom",k.user.nom),localStorage.setItem("userEmail",k.user.email),localStorage.setItem("userTel",k.user.tel),G.success(s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),s.jsxs("div",{children:[s.jsx("strong",{style:{color:"#16a34a"},children:"Connexion réussie !"}),s.jsx("br",{}),"Bienvenue ",s.jsx("span",{style:{color:"#16a34a"},children:k.user.prenom})," 👋"]})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1});const R=k.user.role==="admin"?"/admin":"/";setTimeout(()=>y(R),3100)}catch(k){alert(k.message||"Erreur lors de la connexion.")}finally{c(!1)}}};return s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx(wa,{}),s.jsxs("section",{className:"relative py-16 bg-gradient-to-br from-blue-800 via-blue-900 to-blue-800",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),s.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center mb-6",children:[s.jsx(fs,{className:"h-12 w-12 text-white mr-4"}),s.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white tracking-wider",children:"SAILINGLOC"})]}),s.jsx("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto",children:"Connectez-vous pour accéder à votre espace personnel"})]})]}),s.jsx("section",{className:"py-16",children:s.jsx("div",{className:"max-w-md mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"CONNEXION"}),s.jsx("p",{className:"text-gray-600",children:"Accédez à votre compte SailingLoc"})]}),s.jsxs("form",{onSubmit:E,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"EMAIL"}),s.jsxs("div",{className:"relative",children:[s.jsx(Vn,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:_,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.email?"border-red-500":"border-gray-200"}`,placeholder:"votre@email.com"})]}),i.email&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.email})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"MOT DE PASSE"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ki,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:t?"text":"password",id:"password",name:"password",value:n.password,onChange:_,className:`w-full pl-10 pr-12 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.password?"border-red-500":"border-gray-200"}`,placeholder:"Votre mot de passe"}),s.jsx("button",{type:"button",onClick:()=>r(!t),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:t?s.jsx(vo,{size:20}):s.jsx(Ln,{size:20})})]}),i.password&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.password})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Se souvenir de moi"})]}),s.jsx(z,{to:"/mot-de-passe-oublie",className:"text-sm text-blue-600 hover:text-blue-700",children:"Mot de passe oublié ?"})]}),s.jsx(Dd,{onCaptchaChange:h,isCorrect:p,setIsCorrect:g}),i.captcha&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:i.captcha}),s.jsx("button",{type:"submit",disabled:l,className:`w-full py-3 px-6 rounded-full font-bold text-lg transition-colors ${l?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white shadow-lg`,children:l?s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),s.jsx("span",{children:"CONNEXION..."})]}):"SE CONNECTER"})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsxs("p",{className:"text-gray-600",children:["Pas encore de compte ?"," ",s.jsx(z,{to:"/inscription",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Créer un compte"})]})})]})})})]})}function fg(){const[n,e]=S.useState({prenom:"",nom:"",email:"",telephone:"",password:"",confirmPassword:"",acceptTerms:!1,userType:"client",isProfessionnel:!1,siret:"",siren:""}),[t,r]=S.useState(!1),[i,a]=S.useState(!1),[l,c]=S.useState({}),[u,h]=S.useState(!1),[p,g]=S.useState({}),[y,_]=S.useState(!1),C=es(),E=R=>{const{name:P,value:V,type:B,checked:O}=R.target;e(j=>({...j,[P]:B==="checkbox"?O:V})),l[P]&&c(j=>({...j,[P]:""}))},N=()=>{const R={};return n.prenom.trim()||(R.prenom="Le prénom est requis"),n.nom.trim()||(R.nom="Le nom est requis"),n.email.trim()?/\S+@\S+\.\S+/.test(n.email)||(R.email="Format d'email invalide"):R.email="L'email est requis",n.telephone.trim()||(R.telephone="Le téléphone est requis"),n.password.trim()?n.password.length<6&&(R.password="Le mot de passe doit contenir au moins 6 caractères"):R.password="Le mot de passe est requis",n.password!==n.confirmPassword&&(R.confirmPassword="Les mots de passe ne correspondent pas"),n.acceptTerms||(R.acceptTerms="Vous devez accepter les conditions d'utilisation"),n.userType==="proprietaire"&&n.isProfessionnel&&(n.siret.trim()?/^\d{14}$/.test(n.siret)||(R.siret="Le SIRET doit contenir exactement 14 chiffres"):R.siret="Le SIRET est requis pour les professionnels",n.siren.trim()?/^\d{9}$/.test(n.siren)||(R.siren="Le SIREN doit contenir exactement 9 chiffres"):R.siren="Le SIREN est requis pour les professionnels"),y||(R.captcha="Veuillez résoudre le CAPTCHA correctement"),c(R),Object.keys(R).length===0},k=async R=>{if(R.preventDefault(),!!N()){h(!0);try{await new Promise(V=>setTimeout(V,1e3)),console.log("🔄 Création de l'utilisateur dans MongoDB...");const P=await te(se.REGISTER,{method:"POST",body:JSON.stringify({nom:n.nom,prenom:n.prenom,email:n.email,password:n.password,tel:n.telephone.replace(/\D/g,""),role:n.userType,...n.userType==="proprietaire"&&{isProfessionnel:n.isProfessionnel,...n.isProfessionnel&&{siret:n.siret,siren:n.siren}},captchaQuestion:p.question,captchaAnswer:p.answer,userAnswer:p.userAnswer})});console.log("✅ Utilisateur créé avec succès:",P),localStorage.setItem("userNom",P.user.nom),G.success(s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),s.jsxs("div",{children:[s.jsx("strong",{style:{color:"#16a34a"},children:"Inscription réussie !"}),s.jsx("br",{}),"Bienvenue ",s.jsx("span",{style:{color:"#16a34a"},children:P.user.nom})," 👋"]})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1}),setTimeout(()=>C("/connexion"),3100)}catch(P){G.error(P.message||"Erreur lors de l'inscription.",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#fde6e6",color:"#991b1b",fontWeight:500,fontSize:18,border:"2px solid #991b1b"},icon:!1})}finally{h(!1)}}};return s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx(wa,{}),s.jsxs("section",{className:"relative py-16 bg-gradient-to-br from-blue-800 via-blue-900 to-blue-800",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=1600)",opacity:.3}}),s.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center mb-6",children:[s.jsx(fs,{className:"h-12 w-12 text-white mr-4"}),s.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white tracking-wider",children:"SAILINGLOC"})]}),s.jsx("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto",children:"Rejoignez la communauté des passionnés de navigation"})]})]}),s.jsx("section",{className:"py-16",children:s.jsx("div",{className:"max-w-lg mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"INSCRIPTION"}),s.jsx("p",{className:"text-gray-600",children:"Créez votre compte SailingLoc"})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"TYPE DE COMPTE"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("label",{className:`flex items-center justify-center p-4 border-2 rounded-lg cursor-pointer transition-colors ${n.userType==="client"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"userType",value:"client",checked:n.userType==="client",onChange:E,className:"sr-only"}),s.jsxs("div",{className:"text-center",children:[s.jsx(gs,{className:"h-8 w-8 mx-auto mb-2"}),s.jsx("span",{className:"font-semibold",children:"CLIENT"}),s.jsx("p",{className:"text-xs mt-1",children:"Louer des bateaux"})]})]}),s.jsxs("label",{className:`flex items-center justify-center p-4 border-2 rounded-lg cursor-pointer transition-colors ${n.userType==="proprietaire"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"userType",value:"proprietaire",checked:n.userType==="proprietaire",onChange:E,className:"sr-only"}),s.jsxs("div",{className:"text-center",children:[s.jsx(fs,{className:"h-8 w-8 mx-auto mb-2"}),s.jsx("span",{className:"font-semibold",children:"PROPRIÉTAIRE"}),s.jsx("p",{className:"text-xs mt-1",children:"Mettre en location"})]})]})]})]}),n.userType==="proprietaire"&&s.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-6",children:[s.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center gap-2",children:[s.jsx(fs,{className:"h-5 w-5"}),"Statut du propriétaire"]}),s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"false",checked:n.isProfessionnel===!1,onChange:R=>e({...n,isProfessionnel:R.target.value==="true"}),className:"mr-3 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Particulier"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"true",checked:n.isProfessionnel===!0,onChange:R=>e({...n,isProfessionnel:R.target.value==="true"}),className:"mr-3 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Professionnel"})]})]}),n.isProfessionnel&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"border-t border-blue-300 pt-4 mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Informations professionnelles"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"siret",className:"block text-sm font-bold text-gray-900 mb-2",children:"SIRET *"}),s.jsx("input",{type:"text",id:"siret",name:"siret",value:n.siret,onChange:E,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.siret?"border-red-500":"border-gray-200"}`,placeholder:"12345678901234",maxLength:"14"}),l.siret&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.siret}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"14 chiffres sans espaces"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"siren",className:"block text-sm font-bold text-gray-900 mb-2",children:"SIREN *"}),s.jsx("input",{type:"text",id:"siren",name:"siren",value:n.siren,onChange:E,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.siren?"border-red-500":"border-gray-200"}`,placeholder:"123456789",maxLength:"9"}),l.siren&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.siren}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"9 chiffres sans espaces"})]})]})]})})]}),s.jsxs("form",{onSubmit:k,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"prenom",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"PRÉNOM"}),s.jsxs("div",{className:"relative",children:[s.jsx(gs,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"text",id:"prenom",name:"prenom",value:n.prenom,onChange:E,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.prenom?"border-red-500":"border-gray-200"}`,placeholder:"Prénom"})]}),l.prenom&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.prenom})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"nom",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"NOM"}),s.jsxs("div",{className:"relative",children:[s.jsx(gs,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"text",id:"nom",name:"nom",value:n.nom,onChange:E,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.nom?"border-red-500":"border-gray-200"}`,placeholder:"Nom"})]}),l.nom&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.nom})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"EMAIL"}),s.jsxs("div",{className:"relative",children:[s.jsx(Vn,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:E,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.email?"border-red-500":"border-gray-200"}`,placeholder:"votre@email.com"})]}),l.email&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.email})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"telephone",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"TÉLÉPHONE"}),s.jsxs("div",{className:"relative",children:[s.jsx(wd,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"tel",id:"telephone",name:"telephone",value:n.telephone,onChange:E,className:`w-full pl-10 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.telephone?"border-red-500":"border-gray-200"}`,placeholder:"06 12 34 56 78"})]}),l.telephone&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.telephone})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"MOT DE PASSE"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ki,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:t?"text":"password",id:"password",name:"password",value:n.password,onChange:E,className:`w-full pl-10 pr-12 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.password?"border-red-500":"border-gray-200"}`,placeholder:"Mot de passe"}),s.jsx("button",{type:"button",onClick:()=>r(!t),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:t?s.jsx(vo,{size:20}):s.jsx(Ln,{size:20})})]}),l.password&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.password})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-bold text-gray-900 mb-3 uppercase",children:"CONFIRMER LE MOT DE PASSE"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ki,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),s.jsx("input",{type:i?"text":"password",id:"confirmPassword",name:"confirmPassword",value:n.confirmPassword,onChange:E,className:`w-full pl-10 pr-12 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${l.confirmPassword?"border-red-500":"border-gray-200"}`,placeholder:"Confirmer le mot de passe"}),s.jsx("button",{type:"button",onClick:()=>a(!i),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:i?s.jsx(vo,{size:20}):s.jsx(Ln,{size:20})})]}),l.confirmPassword&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.confirmPassword})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-start space-x-3",children:[s.jsx("input",{type:"checkbox",name:"acceptTerms",checked:n.acceptTerms,onChange:E,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["J'accepte les"," ",s.jsx(z,{to:"/conditions",className:"text-blue-600 hover:text-blue-700",children:"conditions d'utilisation"})," ","et la"," ",s.jsx(z,{to:"/confidentialite",className:"text-blue-600 hover:text-blue-700",children:"politique de confidentialité"})]})]}),l.acceptTerms&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.acceptTerms})]}),s.jsx(Dd,{onCaptchaChange:g,isCorrect:y,setIsCorrect:_}),l.captcha&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.captcha}),s.jsx("button",{type:"submit",disabled:u,className:`w-full py-3 px-6 rounded-full font-bold text-lg transition-colors ${u?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white shadow-lg`,children:u?s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),s.jsx("span",{children:"INSCRIPTION..."})]}):"CRÉER MON COMPTE"})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsxs("p",{className:"text-gray-600",children:["Déjà un compte ?"," ",s.jsx(z,{to:"/connexion",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Se connecter"})]})})]})})})]})}function gg(){const[n,e]=S.useState([]),[t,r]=S.useState(!0),[i,a]=S.useState("");S.useEffect(()=>{l()},[]);const l=async()=>{try{r(!0);const u=localStorage.getItem("token")||sessionStorage.getItem("token");if(!u){a("Vous devez être connecté pour voir vos favoris"),r(!1);return}console.log("🔄 Récupération des favoris depuis MongoDB...");const h=await te(se.FAVORITES,{headers:he(u)});console.log("📊 Structure de la réponse API:",h);const p=h.data||h.favorites||h||[];console.log(`✅ ${p.length||0} favoris récupérés depuis MongoDB`),e(p)}catch(u){a(u.message)}finally{r(!1)}},c=async u=>{try{const h=localStorage.getItem("token")||sessionStorage.getItem("token");console.log("🔄 Suppression du favori depuis MongoDB..."),await te(`${se.FAVORITES}/${u}`,{method:"DELETE",headers:he(h)}),e(p=>p.filter(g=>g.boatId._id!==u)),G.success("Bateau retiré des favoris")}catch(h){G.error(h.message||"Erreur lors de la suppression du favori")}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(wt,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement de vos favoris..."})]})}):i?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto",children:[s.jsx(Ot,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Connexion requise"}),s.jsx("p",{className:"text-gray-600 mb-6",children:i}),s.jsx(z,{to:"/connexion",className:"inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mes Favoris"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Retrouvez tous vos bateaux favoris"})]}),s.jsx(z,{to:"/bateaux",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Découvrir plus de bateaux"})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:n.length===0?s.jsxs("div",{className:"text-center py-16",children:[s.jsx(Sr,{className:"h-24 w-24 text-gray-300 mx-auto mb-6"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Aucun bateau en favori pour le moment"}),s.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:"Vous n'avez pas encore ajouté de bateaux à vos favoris. Explorez notre catalogue et cliquez sur le cœur pour les ajouter !"}),s.jsx(z,{to:"/bateaux",className:"inline-block bg-orange-500 text-white px-8 py-4 rounded-lg text-lg font-medium hover:bg-orange-600 transition-colors",children:"Découvrir nos bateaux"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:s.jsx(Sr,{className:"h-6 w-6 text-red-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total des favoris"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.length})]})]})})}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Vos bateaux favoris"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(u=>s.jsxs("div",{className:"relative",children:[s.jsx(ja,{boat:u.boatId}),s.jsx("button",{onClick:()=>c(u.boatId._id),className:"absolute top-4 right-4 p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors shadow-lg z-10",title:"Retirer des favoris",children:s.jsx(Ks,{size:16})})]},u._id))})]})]})})]})}const xg=()=>{};var Mc={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},yg=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],l=n[t++],c=n[t++],u=((i&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=n[t++],l=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|l&63)}}return e.join("")},Ld={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],l=i+1<n.length,c=l?n[i+1]:0,u=i+2<n.length,h=u?n[i+2]:0,p=a>>2,g=(a&3)<<4|c>>4;let y=(c&15)<<2|h>>6,_=h&63;u||(_=64,l||(y=64)),r.push(t[p],t[g],t[y],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Od(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yg(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const h=i<n.length?t[n.charAt(i)]:64;++i;const g=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||c==null||h==null||g==null)throw new bg;const y=a<<2|c>>4;if(r.push(y),h!==64){const _=c<<4&240|h>>2;if(r.push(_),g!==64){const C=h<<6&192|g;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class bg extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vg=function(n){const e=Od(n);return Ld.encodeByteArray(e,!0)},Yi=function(n){return vg(n).replace(/\./g,"")},Vd=function(n){try{return Ld.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _g(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wg=()=>_g().__FIREBASE_DEFAULTS__,jg=()=>{if(typeof process>"u"||typeof Mc>"u")return;const n=Mc.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Ng=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Vd(n[1]);return e&&JSON.parse(e)},Na=()=>{try{return xg()||wg()||jg()||Ng()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Md=n=>Na()?.emulatorHosts?.[n],Fd=n=>{const e=Md(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ud=()=>Na()?.config,Bd=n=>Na()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function sl(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Yi(JSON.stringify(t)),Yi(JSON.stringify(l)),""].join(".")}const _r={};function Tg(){const n={prod:[],emulator:[]};for(const e of Object.keys(_r))_r[e]?n.emulator.push(e):n.prod.push(e);return n}function Ig(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Fc=!1;function nl(n,e){if(typeof window>"u"||typeof document>"u"||!As(window.location.host)||_r[n]===e||_r[n]||Fc)return;_r[n]=e;function t(y){return`__firebase__banner__${y}`}const r="__firebase__banner",a=Tg().prod.length>0;function l(){const y=document.getElementById(r);y&&y.remove()}function c(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,_){y.setAttribute("width","24"),y.setAttribute("id",_),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{Fc=!0,l()},y}function p(y,_){y.setAttribute("id",_),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function g(){const y=Ig(r),_=t("text"),C=document.getElementById(_)||document.createElement("span"),E=t("learnmore"),N=document.getElementById(E)||document.createElement("a"),k=t("preprendIcon"),R=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const P=y.element;c(P),p(N,E);const V=h();u(R,k),P.append(R,C,N,V),document.body.appendChild(P)}a?(C.innerText="Preview backend disconnected.",R.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(R.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Sg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(nt())}function Ag(){const n=Na()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Cg(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Rg(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function kg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Pg(){const n=nt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Dg(){return!Ag()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Og(){try{return typeof indexedDB=="object"}catch{return!1}}function Lg(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg="FirebaseError";class Mt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Vg,Object.setPrototypeOf(this,Mt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$r.prototype.create)}}class $r{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],l=a?Mg(a,r):"Error",c=`${this.serviceName}: ${l} (${i}).`;return new Mt(i,c,r)}}function Mg(n,e){return n.replace(Fg,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const Fg=/\{\$([^}]+)}/g;function Ug(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Zs(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],l=e[i];if(Uc(a)&&Uc(l)){if(!Zs(a,l))return!1}else if(a!==l)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Uc(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function gr(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function xr(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Bg(n,e){const t=new qg(n,e);return t.subscribe.bind(t)}class qg{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");zg(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=no),i.error===void 0&&(i.error=no),i.complete===void 0&&(i.complete=no);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function zg(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function no(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(n){return n&&n._delegate?n._delegate:n}class ws{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Eg;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Gg(e))try{this.getOrInitializeService({instanceIdentifier:$s})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=$s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$s){return this.instances.has(e)}getOptions(e=$s){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&l.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Hg(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$s){return this.component?this.component.multipleInstances?e:$s:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Hg(n){return n===$s?void 0:n}function Gg(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new $g(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var me;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(me||(me={}));const Kg={debug:me.DEBUG,verbose:me.VERBOSE,info:me.INFO,warn:me.WARN,error:me.ERROR,silent:me.SILENT},Qg=me.INFO,Xg={[me.DEBUG]:"log",[me.VERBOSE]:"log",[me.INFO]:"info",[me.WARN]:"warn",[me.ERROR]:"error"},Yg=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=Xg[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class rl{constructor(e){this.name=e,this._logLevel=Qg,this._logHandler=Yg,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Kg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,me.DEBUG,...e),this._logHandler(this,me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,me.VERBOSE,...e),this._logHandler(this,me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,me.INFO,...e),this._logHandler(this,me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,me.WARN,...e),this._logHandler(this,me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,me.ERROR,...e),this._logHandler(this,me.ERROR,...e)}}const Jg=(n,e)=>e.some(t=>n instanceof t);let Bc,qc;function Zg(){return Bc||(Bc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ex(){return qc||(qc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zd=new WeakMap,Io=new WeakMap,$d=new WeakMap,ro=new WeakMap,il=new WeakMap;function tx(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(xs(n.result)),i()},l=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&zd.set(t,n)}).catch(()=>{}),il.set(e,n),e}function sx(n){if(Io.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),i()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});Io.set(n,e)}let So={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Io.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$d.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return xs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function nx(n){So=n(So)}function rx(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(io(this),e,...t);return $d.set(r,e.sort?e.sort():[e]),xs(r)}:ex().includes(n)?function(...e){return n.apply(io(this),e),xs(zd.get(this))}:function(...e){return xs(n.apply(io(this),e))}}function ix(n){return typeof n=="function"?rx(n):(n instanceof IDBTransaction&&sx(n),Jg(n,Zg())?new Proxy(n,So):n)}function xs(n){if(n instanceof IDBRequest)return tx(n);if(ro.has(n))return ro.get(n);const e=ix(n);return e!==n&&(ro.set(n,e),il.set(e,n)),e}const io=n=>il.get(n);function ax(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const l=indexedDB.open(n,e),c=xs(l);return r&&l.addEventListener("upgradeneeded",u=>{r(xs(l.result),u.oldVersion,u.newVersion,xs(l.transaction),u)}),t&&l.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const ox=["get","getKey","getAll","getAllKeys","count"],lx=["put","add","delete","clear"],ao=new Map;function zc(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ao.get(e))return ao.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=lx.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ox.includes(t)))return;const a=async function(l,...c){const u=this.transaction(l,i?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),i&&u.done]))[0]};return ao.set(e,a),a}nx(n=>({...n,get:(e,t,r)=>zc(e,t)||n.get(e,t,r),has:(e,t)=>!!zc(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ux(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function ux(n){return n.getComponent()?.type==="VERSION"}const Ao="@firebase/app",$c="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt=new rl("@firebase/app"),dx="@firebase/app-compat",hx="@firebase/analytics-compat",mx="@firebase/analytics",px="@firebase/app-check-compat",fx="@firebase/app-check",gx="@firebase/auth",xx="@firebase/auth-compat",yx="@firebase/database",bx="@firebase/data-connect",vx="@firebase/database-compat",_x="@firebase/functions",wx="@firebase/functions-compat",jx="@firebase/installations",Nx="@firebase/installations-compat",Ex="@firebase/messaging",Tx="@firebase/messaging-compat",Ix="@firebase/performance",Sx="@firebase/performance-compat",Ax="@firebase/remote-config",Cx="@firebase/remote-config-compat",Rx="@firebase/storage",kx="@firebase/storage-compat",Px="@firebase/firestore",Dx="@firebase/ai",Ox="@firebase/firestore-compat",Lx="firebase",Vx="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co="[DEFAULT]",Mx={[Ao]:"fire-core",[dx]:"fire-core-compat",[mx]:"fire-analytics",[hx]:"fire-analytics-compat",[fx]:"fire-app-check",[px]:"fire-app-check-compat",[gx]:"fire-auth",[xx]:"fire-auth-compat",[yx]:"fire-rtdb",[bx]:"fire-data-connect",[vx]:"fire-rtdb-compat",[_x]:"fire-fn",[wx]:"fire-fn-compat",[jx]:"fire-iid",[Nx]:"fire-iid-compat",[Ex]:"fire-fcm",[Tx]:"fire-fcm-compat",[Ix]:"fire-perf",[Sx]:"fire-perf-compat",[Ax]:"fire-rc",[Cx]:"fire-rc-compat",[Rx]:"fire-gcs",[kx]:"fire-gcs-compat",[Px]:"fire-fst",[Ox]:"fire-fst-compat",[Dx]:"fire-vertex","fire-js":"fire-js",[Lx]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr=new Map,Fx=new Map,Ro=new Map;function Hc(n,e){try{n.container.addComponent(e)}catch(t){Xt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function en(n){const e=n.name;if(Ro.has(e))return Xt.debug(`There were multiple attempts to register component ${e}.`),!1;Ro.set(e,n);for(const t of Rr.values())Hc(t,n);for(const t of Fx.values())Hc(t,n);return!0}function Ea(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function dt(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ys=new $r("app","Firebase",Ux);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ws("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ys.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on=Vx;function Hd(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Co,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw ys.create("bad-app-name",{appName:String(i)});if(t||(t=Ud()),!t)throw ys.create("no-options");const a=Rr.get(i);if(a){if(Zs(t,a.options)&&Zs(r,a.config))return a;throw ys.create("duplicate-app",{appName:i})}const l=new Wg(i);for(const u of Ro.values())l.addComponent(u);const c=new Bx(t,r,l);return Rr.set(i,c),c}function al(n=Co){const e=Rr.get(n);if(!e&&n===Co&&Ud())return Hd();if(!e)throw ys.create("no-app",{appName:n});return e}function Gc(){return Array.from(Rr.values())}function It(n,e,t){let r=Mx[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${r}" with version "${e}":`];i&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xt.warn(l.join(" "));return}en(new ws(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="firebase-heartbeat-database",zx=1,kr="firebase-heartbeat-store";let oo=null;function Gd(){return oo||(oo=ax(qx,zx,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(kr)}catch(t){console.warn(t)}}}}).catch(n=>{throw ys.create("idb-open",{originalErrorMessage:n.message})})),oo}async function $x(n){try{const t=(await Gd()).transaction(kr),r=await t.objectStore(kr).get(Wd(n));return await t.done,r}catch(e){if(e instanceof Mt)Xt.warn(e.message);else{const t=ys.create("idb-get",{originalErrorMessage:e?.message});Xt.warn(t.message)}}}async function Wc(n,e){try{const r=(await Gd()).transaction(kr,"readwrite");await r.objectStore(kr).put(e,Wd(n)),await r.done}catch(t){if(t instanceof Mt)Xt.warn(t.message);else{const r=ys.create("idb-set",{originalErrorMessage:t?.message});Xt.warn(r.message)}}}function Wd(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hx=1024,Gx=30;class Wx{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Qx(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Kc();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Gx){const i=Xx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Kc(),{heartbeatsToSend:t,unsentEntries:r}=Kx(this._heartbeatsCache.heartbeats),i=Yi(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Xt.warn(e),""}}}function Kc(){return new Date().toISOString().substring(0,10)}function Kx(n,e=Hx){const t=[];let r=n.slice();for(const i of n){const a=t.find(l=>l.agent===i.agent);if(a){if(a.dates.push(i.date),Qc(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Qc(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Qx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Og()?Lg().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await $x(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Wc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Wc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Qc(n){return Yi(JSON.stringify({version:2,heartbeats:n})).length}function Xx(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(n){en(new ws("platform-logger",e=>new cx(e),"PRIVATE")),en(new ws("heartbeat",e=>new Wx(e),"PRIVATE")),It(Ao,$c,n),It(Ao,$c,"esm2020"),It("fire-js","")}Yx("");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kd="firebasestorage.googleapis.com",Qd="storageBucket",Jx=2*60*1e3,Zx=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe extends Mt{constructor(e,t,r=0){super(lo(e),`Firebase Storage: ${t} (${lo(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Pe.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return lo(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ke;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ke||(ke={}));function lo(n){return"storage/"+n}function ol(){const n="An unknown error occurred, please check the error payload for server response.";return new Pe(ke.UNKNOWN,n)}function e0(n){return new Pe(ke.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function t0(n){return new Pe(ke.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function s0(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Pe(ke.UNAUTHENTICATED,n)}function n0(){return new Pe(ke.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function r0(n){return new Pe(ke.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function i0(){return new Pe(ke.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function a0(){return new Pe(ke.CANCELED,"User canceled the upload/download.")}function o0(n){return new Pe(ke.INVALID_URL,"Invalid URL '"+n+"'.")}function l0(n){return new Pe(ke.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function c0(){return new Pe(ke.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Qd+"' property when initializing the app?")}function u0(){return new Pe(ke.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function d0(){return new Pe(ke.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function h0(n){return new Pe(ke.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ko(n){return new Pe(ke.INVALID_ARGUMENT,n)}function Xd(){return new Pe(ke.APP_DELETED,"The Firebase app was deleted.")}function m0(n){return new Pe(ke.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wr(n,e){return new Pe(ke.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function fr(n){throw new Pe(ke.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=ht.makeFromUrl(e,t)}catch{return new ht(e,"")}if(r.path==="")return r;throw l0(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function a(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const l="(/(.*))?$",c=new RegExp("^gs://"+i+l,"i"),u={bucket:1,path:3};function h(V){V.path_=decodeURIComponent(V.path)}const p="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",_=new RegExp(`^https?://${g}/${p}/b/${i}/o${y}`,"i"),C={bucket:1,path:3},E=t===Kd?"(?:storage.googleapis.com|storage.cloud.google.com)":t,N="([^?#]*)",k=new RegExp(`^https?://${E}/${i}/${N}`,"i"),P=[{regex:c,indices:u,postModify:a},{regex:_,indices:C,postModify:h},{regex:k,indices:{bucket:1,path:2},postModify:h}];for(let V=0;V<P.length;V++){const B=P[V],O=B.regex.exec(e);if(O){const j=O[B.indices.bucket];let f=O[B.indices.path];f||(f=""),r=new ht(j,f),B.postModify(r);break}}if(r==null)throw o0(e);return r}}class p0{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f0(n,e,t){let r=1,i=null,a=null,l=!1,c=0;function u(){return c===2}let h=!1;function p(...N){h||(h=!0,e.apply(null,N))}function g(N){i=setTimeout(()=>{i=null,n(_,u())},N)}function y(){a&&clearTimeout(a)}function _(N,...k){if(h){y();return}if(N){y(),p.call(null,N,...k);return}if(u()||l){y(),p.call(null,N,...k);return}r<64&&(r*=2);let P;c===1?(c=2,P=0):P=(r+Math.random())*1e3,g(P)}let C=!1;function E(N){C||(C=!0,y(),!h&&(i!==null?(N||(c=2),clearTimeout(i),g(0)):N||(c=1)))}return g(0),a=setTimeout(()=>{l=!0,E(!0)},t),E}function g0(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x0(n){return n!==void 0}function y0(n){return typeof n=="object"&&!Array.isArray(n)}function ll(n){return typeof n=="string"||n instanceof String}function Xc(n){return cl()&&n instanceof Blob}function cl(){return typeof Blob<"u"}function Yc(n,e,t,r){if(r<e)throw ko(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw ko(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ul(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function Yd(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Xs;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Xs||(Xs={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,a=e.indexOf(n)!==-1;return t||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e,t,r,i,a,l,c,u,h,p,g,y=!0,_=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=c,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=p,this.connectionFactory_=g,this.retry=y,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,E)=>{this.resolve_=C,this.reject_=E,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Ti(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const l=c=>{const u=c.loaded,h=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const c=a.getErrorCode()===Xs.NO_ERROR,u=a.getStatus();if(!c||b0(u,this.additionalRetryCodes_)&&this.retry){const p=a.getErrorCode()===Xs.ABORT;r(!1,new Ti(!1,null,p));return}const h=this.successCodes_.indexOf(u)!==-1;r(!0,new Ti(h,a))})},t=(r,i)=>{const a=this.resolve_,l=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(c,c.getResponse());x0(u)?a(u):a()}catch(u){l(u)}else if(c!==null){const u=ol();u.serverResponse=c.getErrorText(),this.errorCallback_?l(this.errorCallback_(c,u)):l(u)}else if(i.canceled){const u=this.appDelete_?Xd():a0();l(u)}else{const u=i0();l(u)}};this.canceled_?t(!1,new Ti(!1,null,!0)):this.backoffId_=f0(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&g0(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ti{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function _0(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function w0(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function j0(n,e){e&&(n["X-Firebase-GMPID"]=e)}function N0(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function E0(n,e,t,r,i,a,l=!0,c=!1){const u=Yd(n.urlParams),h=n.url+u,p=Object.assign({},n.headers);return j0(p,e),_0(p,t),w0(p,a),N0(p,r),new v0(h,n.method,p,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,l,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function I0(...n){const e=T0();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(cl())return new Blob(n);throw new Pe(ke.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function S0(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(n){if(typeof atob>"u")throw h0("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tt={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class co{constructor(e,t){this.data=e,this.contentType=t||null}}function C0(n,e){switch(n){case Tt.RAW:return new co(Jd(e));case Tt.BASE64:case Tt.BASE64URL:return new co(Zd(n,e));case Tt.DATA_URL:return new co(k0(e),P0(e))}throw ol()}function Jd(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const a=r,l=n.charCodeAt(++t);r=65536|(a&1023)<<10|l&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function R0(n){let e;try{e=decodeURIComponent(n)}catch{throw wr(Tt.DATA_URL,"Malformed data URL.")}return Jd(e)}function Zd(n,e){switch(n){case Tt.BASE64:{const i=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(i||a)throw wr(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Tt.BASE64URL:{const i=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(i||a)throw wr(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=A0(e)}catch(i){throw i.message.includes("polyfill")?i:wr(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class eh{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw wr(Tt.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=D0(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function k0(n){const e=new eh(n);return e.base64?Zd(Tt.BASE64,e.rest):R0(e.rest)}function P0(n){return new eh(n).contentType}function D0(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e,t){let r=0,i="";Xc(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(Xc(this.data_)){const r=this.data_,i=S0(r,e,t);return i===null?null:new cs(i)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new cs(r,!0)}}static getBlob(...e){if(cl()){const t=e.map(r=>r instanceof cs?r.data_:r);return new cs(I0.apply(null,t))}else{const t=e.map(l=>ll(l)?C0(Tt.RAW,l).data:l.data_);let r=0;t.forEach(l=>{r+=l.byteLength});const i=new Uint8Array(r);let a=0;return t.forEach(l=>{for(let c=0;c<l.length;c++)i[a++]=l[c]}),new cs(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(n){let e;try{e=JSON.parse(n)}catch{return null}return y0(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function L0(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function sh(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(n,e){return e}class rt{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||V0}}let Ii=null;function M0(n){return!ll(n)||n.length<2?n:sh(n)}function nh(){if(Ii)return Ii;const n=[];n.push(new rt("bucket")),n.push(new rt("generation")),n.push(new rt("metageneration")),n.push(new rt("name","fullPath",!0));function e(a,l){return M0(l)}const t=new rt("name");t.xform=e,n.push(t);function r(a,l){return l!==void 0?Number(l):l}const i=new rt("size");return i.xform=r,n.push(i),n.push(new rt("timeCreated")),n.push(new rt("updated")),n.push(new rt("md5Hash",null,!0)),n.push(new rt("cacheControl",null,!0)),n.push(new rt("contentDisposition",null,!0)),n.push(new rt("contentEncoding",null,!0)),n.push(new rt("contentLanguage",null,!0)),n.push(new rt("contentType",null,!0)),n.push(new rt("metadata","customMetadata",!0)),Ii=n,Ii}function F0(n,e){function t(){const r=n.bucket,i=n.fullPath,a=new ht(r,i);return e._makeStorageReference(a)}Object.defineProperty(n,"ref",{get:t})}function U0(n,e,t){const r={};r.type="file";const i=t.length;for(let a=0;a<i;a++){const l=t[a];r[l.local]=l.xform(r,e[l.server])}return F0(r,n),r}function rh(n,e,t){const r=th(e);return r===null?null:U0(n,r,t)}function B0(n,e,t,r){const i=th(e);if(i===null||!ll(i.downloadTokens))return null;const a=i.downloadTokens;if(a.length===0)return null;const l=encodeURIComponent;return a.split(",").map(h=>{const p=n.bucket,g=n.fullPath,y="/b/"+l(p)+"/o/"+l(g),_=ul(y,t,r),C=Yd({alt:"media",token:h});return _+C})[0]}function q0(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}class ih{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ah(n){if(!n)throw ol()}function z0(n,e){function t(r,i){const a=rh(n,i,e);return ah(a!==null),a}return t}function $0(n,e){function t(r,i){const a=rh(n,i,e);return ah(a!==null),B0(a,i,n.host,n._protocol)}return t}function oh(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=n0():i=s0():t.getStatus()===402?i=t0(n.bucket):t.getStatus()===403?i=r0(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function H0(n){const e=oh(n);function t(r,i){let a=e(r,i);return r.getStatus()===404&&(a=e0(n.path)),a.serverResponse=i.serverResponse,a}return t}function G0(n,e,t){const r=e.fullServerUrl(),i=ul(r,n.host,n._protocol),a="GET",l=n.maxOperationRetryTime,c=new ih(i,a,$0(n,t),l);return c.errorHandler=H0(e),c}function W0(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function K0(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=W0(null,e)),r}function Q0(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function c(){let P="";for(let V=0;V<2;V++)P=P+Math.random().toString().slice(2);return P}const u=c();l["Content-Type"]="multipart/related; boundary="+u;const h=K0(e,r,i),p=q0(h,t),g="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+u+`\r
Content-Type: `+h.contentType+`\r
\r
`,y=`\r
--`+u+"--",_=cs.getBlob(g,r,y);if(_===null)throw u0();const C={name:h.fullPath},E=ul(a,n.host,n._protocol),N="POST",k=n.maxUploadRetryTime,R=new ih(E,N,z0(n,t),k);return R.urlParams=C,R.headers=l,R.body=_.uploadData(),R.errorHandler=oh(e),R}class X0{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Xs.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Xs.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Xs.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i,a){if(this.sent_)throw fr("cannot .send() more than once");if(As(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),a!==void 0)for(const l in a)a.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,a[l].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw fr("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw fr("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw fr("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw fr("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Y0 extends X0{initXhr(){this.xhr_.responseType="text"}}function lh(){return new Y0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,t){this._service=e,t instanceof ht?this._location=t:this._location=ht.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new tn(e,t)}get root(){const e=new ht(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sh(this._location.path)}get storage(){return this._service}get parent(){const e=O0(this._location.path);if(e===null)return null;const t=new ht(this._location.bucket,e);return new tn(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw m0(e)}}function J0(n,e,t){n._throwIfRoot("uploadBytes");const r=Q0(n.storage,n._location,nh(),new cs(e,!0),t);return n.storage.makeRequestWithTokens(r,lh).then(i=>({metadata:i,ref:n}))}function Z0(n){n._throwIfRoot("getDownloadURL");const e=G0(n.storage,n._location,nh());return n.storage.makeRequestWithTokens(e,lh).then(t=>{if(t===null)throw d0();return t})}function ey(n,e){const t=L0(n._location.path,e),r=new ht(n._location.bucket,t);return new tn(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(n){return/^[A-Za-z]+:\/\//.test(n)}function sy(n,e){return new tn(n,e)}function ch(n,e){if(n instanceof dl){const t=n;if(t._bucket==null)throw c0();const r=new tn(t,t._bucket);return e!=null?ch(r,e):r}else return e!==void 0?ey(n,e):n}function ny(n,e){if(e&&ty(e)){if(n instanceof dl)return sy(n,e);throw ko("To use ref(service, url), the first argument must be a Storage instance.")}else return ch(n,e)}function Jc(n,e){const t=e?.[Qd];return t==null?null:ht.makeFromBucketSpec(t,n)}function ry(n,e,t,r={}){n.host=`${e}:${t}`;const i=As(e);i&&(sl(`https://${n.host}/b`),nl("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:a}=r;a&&(n._overrideAuthToken=typeof a=="string"?a:qd(a,n.app.options.projectId))}class dl{constructor(e,t,r,i,a,l=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=l,this._bucket=null,this._host=Kd,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Jx,this._maxUploadRetryTime=Zx,this._requests=new Set,i!=null?this._bucket=ht.makeFromBucketSpec(i,this._host):this._bucket=Jc(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ht.makeFromBucketSpec(this._url,e):this._bucket=Jc(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Yc("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Yc("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(dt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new tn(this,e)}_makeRequest(e,t,r,i,a=!0){if(this._deleted)return new p0(Xd());{const l=E0(e,this._appId,r,i,t,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const Zc="@firebase/storage",eu="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh="storage";function dh(n,e,t){return n=Qe(n),J0(n,e,t)}function hh(n){return n=Qe(n),Z0(n)}function mh(n,e){return n=Qe(n),ny(n,e)}function iy(n=al(),e){n=Qe(n);const r=Ea(n,uh).getImmediate({identifier:e}),i=Fd("storage");return i&&ay(r,...i),r}function ay(n,e,t,r={}){ry(n,e,t,r)}function oy(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new dl(t,r,i,e,on)}function ly(){en(new ws(uh,oy,"PUBLIC").setMultipleInstances(!0)),It(Zc,eu,""),It(Zc,eu,"esm2020")}ly();var cy="firebase",uy="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */It(cy,uy,"app");function ph(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dy=ph,fh=new $r("auth","Firebase",ph());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji=new rl("@firebase/auth");function hy(n,...e){Ji.logLevel<=me.WARN&&Ji.warn(`Auth (${on}): ${n}`,...e)}function Li(n,...e){Ji.logLevel<=me.ERROR&&Ji.error(`Auth (${on}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(n,...e){throw hl(n,...e)}function St(n,...e){return hl(n,...e)}function gh(n,e,t){const r={...dy(),[e]:t};return new $r("auth","Firebase",r).create(e,{appName:n.name})}function Kt(n){return gh(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hl(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return fh.create(n,...e)}function ne(n,e,...t){if(!n)throw hl(e,...t)}function Ht(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Li(e),new Error(e)}function Yt(n,e){n||Ht(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(){return typeof self<"u"&&self.location?.href||""}function my(){return tu()==="http:"||tu()==="https:"}function tu(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(my()||Rg()||"connection"in navigator)?navigator.onLine:!0}function fy(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,t){this.shortDelay=e,this.longDelay=t,Yt(t>e,"Short delay should be less than long delay!"),this.isMobile=Sg()||kg()}get(){return py()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ml(n,e){Yt(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ht("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ht("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ht("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],yy=new Gr(3e4,6e4);function Cs(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Rs(n,e,t,r,i={}){return yh(n,i,async()=>{let a={},l={};r&&(e==="GET"?l=r:a={body:JSON.stringify(r)});const c=Hr({key:n.config.apiKey,...l}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...a};return Cg()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&As(n.emulatorConfig.host)&&(h.credentials="include"),xh.fetch()(await bh(n,n.config.apiHost,t,c),h)})}async function yh(n,e,t){n._canInitEmulator=!1;const r={...gy,...e};try{const i=new vy(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Si(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const c=a.ok?l.errorMessage:l.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Si(n,"credential-already-in-use",l);if(u==="EMAIL_EXISTS")throw Si(n,"email-already-in-use",l);if(u==="USER_DISABLED")throw Si(n,"user-disabled",l);const p=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw gh(n,p,h);jt(n,p)}}catch(i){if(i instanceof Mt)throw i;jt(n,"network-request-failed",{message:String(i)})}}async function Wr(n,e,t,r,i={}){const a=await Rs(n,e,t,r,i);return"mfaPendingCredential"in a&&jt(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function bh(n,e,t,r){const i=`${e}${t}?${r}`,a=n,l=a.config.emulator?ml(n.config,i):`${n.config.apiScheme}://${i}`;return xy.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function by(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class vy{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(St(this.auth,"network-request-failed")),yy.get())})}}function Si(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=St(n,e,r);return i.customData._tokenResponse=t,i}function su(n){return n!==void 0&&n.enterprise!==void 0}class _y{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return by(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function wy(n,e){return Rs(n,"GET","/v2/recaptchaConfig",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jy(n,e){return Rs(n,"POST","/v1/accounts:delete",e)}async function Zi(n,e){return Rs(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ny(n,e=!1){const t=Qe(n),r=await t.getIdToken(e),i=pl(r);ne(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,l=a?.sign_in_provider;return{claims:i,token:r,authTime:jr(uo(i.auth_time)),issuedAtTime:jr(uo(i.iat)),expirationTime:jr(uo(i.exp)),signInProvider:l||null,signInSecondFactor:a?.sign_in_second_factor||null}}function uo(n){return Number(n)*1e3}function pl(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Li("JWT malformed, contained fewer than 3 sections"),null;try{const i=Vd(t);return i?JSON.parse(i):(Li("Failed to decode base64 JWT payload"),null)}catch(i){return Li("Caught error parsing JWT payload as JSON",i?.toString()),null}}function nu(n){const e=pl(n);return ne(e,"internal-error"),ne(typeof e.exp<"u","internal-error"),ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pr(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Mt&&Ey(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Ey({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=jr(this.lastLoginAt),this.creationTime=jr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ea(n){const e=n.auth,t=await n.getIdToken(),r=await Pr(n,Zi(e,{idToken:t}));ne(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=i.providerUserInfo?.length?vh(i.providerUserInfo):[],l=Sy(n.providerData,a),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!l?.length,h=c?u:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Do(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(n,p)}async function Iy(n){const e=Qe(n);await ea(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Sy(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function vh(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ay(n,e){const t=await yh(n,{},async()=>{const r=Hr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,l=await bh(n,i,"/v1/token",`key=${a}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return n.emulatorConfig&&As(n.emulatorConfig.host)&&(u.credentials="include"),xh.fetch()(l,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Cy(n,e){return Rs(n,"POST","/v2/accounts:revokeToken",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ne(e.idToken,"internal-error"),ne(typeof e.idToken<"u","internal-error"),ne(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nu(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ne(e.length!==0,"internal-error");const t=nu(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await Ay(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,l=new An;return r&&(ne(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),i&&(ne(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),a&&(ne(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new An,this.toJSON())}_performRefresh(){return Ht("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(n,e){ne(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class vt{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Ty(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Do(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Pr(this,this.stsTokenManager.getToken(this.auth,e));return ne(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Ny(this,e)}reload(){return Iy(this)}_assign(e){this!==e&&(ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new vt({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ea(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dt(this.auth.app))return Promise.reject(Kt(this.auth));const e=await this.getIdToken();return await Pr(this,jy(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:g,emailVerified:y,isAnonymous:_,providerData:C,stsTokenManager:E}=t;ne(g&&E,e,"internal-error");const N=An.fromJSON(this.name,E);ne(typeof g=="string",e,"internal-error"),ls(r,e.name),ls(i,e.name),ne(typeof y=="boolean",e,"internal-error"),ne(typeof _=="boolean",e,"internal-error"),ls(a,e.name),ls(l,e.name),ls(c,e.name),ls(u,e.name),ls(h,e.name),ls(p,e.name);const k=new vt({uid:g,auth:e,email:i,emailVerified:y,displayName:r,isAnonymous:_,photoURL:l,phoneNumber:a,tenantId:c,stsTokenManager:N,createdAt:h,lastLoginAt:p});return C&&Array.isArray(C)&&(k.providerData=C.map(R=>({...R}))),u&&(k._redirectEventId=u),k}static async _fromIdTokenResponse(e,t,r=!1){const i=new An;i.updateFromServerResponse(t);const a=new vt({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await ea(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];ne(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?vh(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!a?.length,c=new An;c.updateFromIdToken(r);const u=new vt({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:l}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Do(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ru=new Map;function Gt(n){Yt(n instanceof Function,"Expected a class definition");let e=ru.get(n);return e?(Yt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ru.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}_h.type="NONE";const iu=_h;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vi(n,e,t){return`firebase:${n}:${e}:${t}`}class Cn{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=Vi(this.userKey,i.apiKey,a),this.fullPersistenceKey=Vi("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Zi(this.auth,{idToken:e}).catch(()=>{});return t?vt._fromGetAccountInfoResponse(this.auth,t,e):null}return vt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Cn(Gt(iu),e,r);const i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let a=i[0]||Gt(iu);const l=Vi(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const p=await h._get(l);if(p){let g;if(typeof p=="string"){const y=await Zi(e,{idToken:p}).catch(()=>{});if(!y)break;g=await vt._fromGetAccountInfoResponse(e,y,p)}else g=vt._fromJSON(e,p);h!==a&&(c=g),a=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new Cn(a,e,r):(a=u[0],c&&await a._set(l,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==a)try{await h._remove(l)}catch{}})),new Cn(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Eh(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(wh(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ih(e))return"Blackberry";if(Sh(e))return"Webos";if(jh(e))return"Safari";if((e.includes("chrome/")||Nh(e))&&!e.includes("edge/"))return"Chrome";if(Th(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function wh(n=nt()){return/firefox\//i.test(n)}function jh(n=nt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Nh(n=nt()){return/crios\//i.test(n)}function Eh(n=nt()){return/iemobile/i.test(n)}function Th(n=nt()){return/android/i.test(n)}function Ih(n=nt()){return/blackberry/i.test(n)}function Sh(n=nt()){return/webos/i.test(n)}function fl(n=nt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Ry(n=nt()){return fl(n)&&!!window.navigator?.standalone}function ky(){return Pg()&&document.documentMode===10}function Ah(n=nt()){return fl(n)||Th(n)||Sh(n)||Ih(n)||/windows phone/i.test(n)||Eh(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ch(n,e=[]){let t;switch(n){case"Browser":t=au(nt());break;case"Worker":t=`${au(nt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${on}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((l,c)=>{try{const u=e(a);l(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dy(n,e={}){return Rs(n,"GET","/v2/passwordPolicy",Cs(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy=6;class Ly{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Oy,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ou(this),this.idTokenSubscription=new ou(this),this.beforeStateQueue=new Py(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fh,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Gt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Cn.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Zi(this,{idToken:e}),r=await vt._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(dt(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,l=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===l)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ea(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fy()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(dt(this.app))return Promise.reject(Kt(this));const t=e?Qe(e):null;return t&&ne(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return dt(this.app)?Promise.reject(Kt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return dt(this.app)?Promise.reject(Kt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Dy(this),t=new Ly(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new $r("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Cy(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Gt(e)||this._popupRedirectResolver;ne(t,this,"argument-error"),this.redirectPersistenceManager=await Cn.create(this,[Gt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ne(c,this,"internal-error"),c.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{l=!0,u()}}else{const u=e.addObserver(t);return()=>{l=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ch(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(dt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&hy(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ln(n){return Qe(n)}class ou{constructor(e){this.auth=e,this.observer=null,this.addObserver=Bg(t=>this.observer=t)}get next(){return ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ta={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function My(n){Ta=n}function Rh(n){return Ta.loadJS(n)}function Fy(){return Ta.recaptchaEnterpriseScript}function Uy(){return Ta.gapiScript}function By(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class qy{constructor(){this.enterprise=new zy}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class zy{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const $y="recaptcha-enterprise",kh="NO_RECAPTCHA";class Hy{constructor(e){this.type=$y,this.auth=ln(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,c)=>{wy(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const h=new _y(u);return a.tenantId==null?a._agentRecaptchaConfig=h:a._tenantRecaptchaConfigs[a.tenantId]=h,l(h.siteKey)}}).catch(u=>{c(u)})})}function i(a,l,c){const u=window.grecaptcha;su(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(h=>{l(h)}).catch(()=>{l(kh)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new qy().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{r(this.auth).then(c=>{if(!t&&su(window.grecaptcha))i(c,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let u=Fy();u.length!==0&&(u+=c),Rh(u).then(()=>{i(c,a,l)}).catch(h=>{l(h)})}}).catch(c=>{l(c)})})}}async function lu(n,e,t,r=!1,i=!1){const a=new Hy(n);let l;if(i)l=kh;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Oo(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await lu(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await lu(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(n,e){const t=Ea(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(Zs(a,e??{}))return i;jt(i,"already-initialized")}return t.initialize({options:e})}function Wy(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Gt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Ky(n,e,t){const r=ln(n);ne(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=Ph(e),{host:l,port:c}=Qy(e),u=c===null?"":`:${c}`,h={url:`${a}//${l}${u}/`},p=Object.freeze({host:l,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){ne(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ne(Zs(h,r.config.emulator)&&Zs(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,As(l)?(sl(`${a}//${l}${u}`),nl("Auth",!0)):Xy()}function Ph(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Qy(n){const e=Ph(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:cu(r.substr(a.length+1))}}else{const[a,l]=r.split(":");return{host:a,port:cu(l)}}}function cu(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Xy(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ht("not implemented")}_getIdTokenResponse(e){return Ht("not implemented")}_linkToIdToken(e,t){return Ht("not implemented")}_getReauthenticationResolver(e){return Ht("not implemented")}}async function Yy(n,e){return Rs(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jy(n,e){return Wr(n,"POST","/v1/accounts:signInWithPassword",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zy(n,e){return Wr(n,"POST","/v1/accounts:signInWithEmailLink",Cs(n,e))}async function eb(n,e){return Wr(n,"POST","/v1/accounts:signInWithEmailLink",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends gl{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Dr(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Dr(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Oo(e,t,"signInWithPassword",Jy);case"emailLink":return Zy(e,{email:this._email,oobCode:this._password});default:jt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Oo(e,r,"signUpPassword",Yy);case"emailLink":return eb(e,{idToken:t,email:this._email,oobCode:this._password});default:jt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rn(n,e){return Wr(n,"POST","/v1/accounts:signInWithIdp",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="http://localhost";class sn extends gl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new sn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):jt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const l=new sn(r,i);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Rn(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Rn(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Rn(e,t)}buildRequest(){const e={requestUri:tb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Hr(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function nb(n){const e=gr(xr(n)).link,t=e?gr(xr(e)).deep_link_id:null,r=gr(xr(n)).deep_link_id;return(r?gr(xr(r)).link:null)||r||t||e||n}class xl{constructor(e){const t=gr(xr(e)),r=t.apiKey??null,i=t.oobCode??null,a=sb(t.mode??null);ne(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=nb(e);try{return new xl(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(){this.providerId=Hn.PROVIDER_ID}static credential(e,t){return Dr._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=xl.parseLink(t);return ne(r,"argument-error"),Dr._fromEmailAndCode(e,r.code,r.tenantId)}}Hn.PROVIDER_ID="password";Hn.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Hn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr extends Dh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us extends Kr{constructor(){super("facebook.com")}static credential(e){return sn._fromParams({providerId:us.PROVIDER_ID,signInMethod:us.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return us.credentialFromTaggedObject(e)}static credentialFromError(e){return us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return us.credential(e.oauthAccessToken)}catch{return null}}}us.FACEBOOK_SIGN_IN_METHOD="facebook.com";us.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds extends Kr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return sn._fromParams({providerId:ds.PROVIDER_ID,signInMethod:ds.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ds.credentialFromTaggedObject(e)}static credentialFromError(e){return ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ds.credential(t,r)}catch{return null}}}ds.GOOGLE_SIGN_IN_METHOD="google.com";ds.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs extends Kr{constructor(){super("github.com")}static credential(e){return sn._fromParams({providerId:hs.PROVIDER_ID,signInMethod:hs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hs.credentialFromTaggedObject(e)}static credentialFromError(e){return hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hs.credential(e.oauthAccessToken)}catch{return null}}}hs.GITHUB_SIGN_IN_METHOD="github.com";hs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms extends Kr{constructor(){super("twitter.com")}static credential(e,t){return sn._fromParams({providerId:ms.PROVIDER_ID,signInMethod:ms.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ms.credentialFromTaggedObject(e)}static credentialFromError(e){return ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ms.credential(t,r)}catch{return null}}}ms.TWITTER_SIGN_IN_METHOD="twitter.com";ms.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rb(n,e){return Wr(n,"POST","/v1/accounts:signUp",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await vt._fromIdTokenResponse(e,r,i),l=uu(r);return new nn({user:a,providerId:l,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=uu(r);return new nn({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function uu(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta extends Mt{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,ta.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new ta(e,t,r,i)}}function Oh(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?ta._fromErrorAndOperation(n,a,e,r):a})}async function ib(n,e,t=!1){const r=await Pr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return nn._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ab(n,e,t=!1){const{auth:r}=n;if(dt(r.app))return Promise.reject(Kt(r));const i="reauthenticate";try{const a=await Pr(n,Oh(r,i,e,n),t);ne(a.idToken,r,"internal-error");const l=pl(a.idToken);ne(l,r,"internal-error");const{sub:c}=l;return ne(n.uid===c,r,"user-mismatch"),nn._forOperation(n,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&jt(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lh(n,e,t=!1){if(dt(n.app))return Promise.reject(Kt(n));const r="signIn",i=await Oh(n,r,e),a=await nn._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}async function ob(n,e){return Lh(ln(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vh(n){const e=ln(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function lb(n,e,t){if(dt(n.app))return Promise.reject(Kt(n));const r=ln(n),l=await Oo(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rb).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Vh(n),u}),c=await nn._fromIdTokenResponse(r,"signIn",l);return await r._updateCurrentUser(c.user),c}function cb(n,e,t){return dt(n.app)?Promise.reject(Kt(n)):ob(Qe(n),Hn.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Vh(n),r})}function ub(n,e,t,r){return Qe(n).onIdTokenChanged(e,t,r)}function db(n,e,t){return Qe(n).beforeAuthStateChanged(e,t)}function hb(n){return Qe(n).signOut()}const sa="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(sa,"1"),this.storage.removeItem(sa),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb=1e3,pb=10;class Fh extends Mh{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ah(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,u)=>{this.notifyListeners(l,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(r);!t&&this.localCache[r]===l||this.notifyListeners(r,l)},a=this.storage.getItem(r);ky()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,pb):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},mb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Fh.type="LOCAL";const fb=Fh;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh extends Mh{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Uh.type="SESSION";const Bh=Uh;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gb(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Ia(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,l=this.handlersMap[i];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(l).map(async h=>h(t.origin,a)),u=await gb(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ia.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,l;return new Promise((c,u)=>{const h=yl("",20);i.port1.start();const p=setTimeout(()=>{u(new Error("unsupported_event"))},r);l={messageChannel:i,onMessage(g){const y=g;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(p),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(y.data.response);break;default:clearTimeout(p),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(){return window}function yb(n){At().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qh(){return typeof At().WorkerGlobalScope<"u"&&typeof At().importScripts=="function"}async function bb(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vb(){return navigator?.serviceWorker?.controller||null}function _b(){return qh()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh="firebaseLocalStorageDb",wb=1,na="firebaseLocalStorage",$h="fbase_key";class Qr{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Sa(n,e){return n.transaction([na],e?"readwrite":"readonly").objectStore(na)}function jb(){const n=indexedDB.deleteDatabase(zh);return new Qr(n).toPromise()}function Lo(){const n=indexedDB.open(zh,wb);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(na,{keyPath:$h})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(na)?e(r):(r.close(),await jb(),e(await Lo()))})})}async function du(n,e,t){const r=Sa(n,!0).put({[$h]:e,value:t});return new Qr(r).toPromise()}async function Nb(n,e){const t=Sa(n,!1).get(e),r=await new Qr(t).toPromise();return r===void 0?null:r.value}function hu(n,e){const t=Sa(n,!0).delete(e);return new Qr(t).toPromise()}const Eb=800,Tb=3;class Hh{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Lo(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>Tb)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return qh()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ia._getInstance(_b()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await bb(),!this.activeServiceWorker)return;this.sender=new xb(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Lo();return await du(e,sa,"1"),await hu(e,sa),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>du(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Nb(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>hu(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Sa(i,!1).getAll();return new Qr(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Eb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Hh.type="LOCAL";const Ib=Hh;new Gr(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sb(n,e){return e?Gt(e):(ne(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl extends gl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Rn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Rn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Rn(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ab(n){return Lh(n.auth,new bl(n),n.bypassAuthState)}function Cb(n){const{auth:e,user:t}=n;return ne(t,e,"internal-error"),ab(t,new bl(n),n.bypassAuthState)}async function Rb(n){const{auth:e,user:t}=n;return ne(t,e,"internal-error"),ib(t,new bl(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:l,type:c}=e;if(l){this.reject(l);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ab;case"linkViaPopup":case"linkViaRedirect":return Rb;case"reauthViaPopup":case"reauthViaRedirect":return Cb;default:jt(this.auth,"internal-error")}}resolve(e){Yt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb=new Gr(2e3,1e4);class In extends Gh{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,In.currentPopupAction&&In.currentPopupAction.cancel(),In.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ne(e,this.auth,"internal-error"),e}async onExecution(){Yt(this.filter.length===1,"Popup operations only handle one event");const e=yl();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(St(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(St(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,In.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(St(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,kb.get())};e()}}In.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pb="pendingRedirect",Mi=new Map;class Db extends Gh{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Mi.get(this.auth._key());if(!e){try{const r=await Ob(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Mi.set(this.auth._key(),e)}return this.bypassAuthState||Mi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Ob(n,e){const t=Mb(e),r=Vb(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function Lb(n,e){Mi.set(n._key(),e)}function Vb(n){return Gt(n._redirectPersistence)}function Mb(n){return Vi(Pb,n.config.apiKey,n.name)}async function Fb(n,e,t=!1){if(dt(n.app))return Promise.reject(Kt(n));const r=ln(n),i=Sb(r,e),l=await new Db(r,i,t).execute();return l&&!t&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub=10*60*1e3;class Bb{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qb(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Wh(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(St(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ub&&this.cachedEventUids.clear(),this.cachedEventUids.has(mu(e))}saveEventToCache(e){this.cachedEventUids.add(mu(e)),this.lastProcessedEventTime=Date.now()}}function mu(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Wh({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function qb(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Wh(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zb(n,e={}){return Rs(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Hb=/^https?/;async function Gb(n){if(n.config.emulator)return;const{authorizedDomains:e}=await zb(n);for(const t of e)try{if(Wb(t))return}catch{}jt(n,"unauthorized-domain")}function Wb(n){const e=Po(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===r}if(!Hb.test(t))return!1;if($b.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb=new Gr(3e4,6e4);function pu(){const n=At().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Qb(n){return new Promise((e,t)=>{function r(){pu(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pu(),t(St(n,"network-request-failed"))},timeout:Kb.get()})}if(At().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(At().gapi?.load)r();else{const i=By("iframefcb");return At()[i]=()=>{gapi.load?r():t(St(n,"network-request-failed"))},Rh(`${Uy()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw Fi=null,e})}let Fi=null;function Xb(n){return Fi=Fi||Qb(n),Fi}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb=new Gr(5e3,15e3),Jb="__/auth/iframe",Zb="emulator/auth/iframe",ev={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tv=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sv(n){const e=n.config;ne(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ml(e,Zb):`https://${n.config.authDomain}/${Jb}`,r={apiKey:e.apiKey,appName:n.name,v:on},i=tv.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${Hr(r).slice(1)}`}async function nv(n){const e=await Xb(n),t=At().gapi;return ne(t,n,"internal-error"),e.open({where:document.body,url:sv(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ev,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const l=St(n,"network-request-failed"),c=At().setTimeout(()=>{a(l)},Yb.get());function u(){At().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},iv=500,av=600,ov="_blank",lv="http://localhost";class fu{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function cv(n,e,t,r=iv,i=av){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...rv,width:r.toString(),height:i.toString(),top:a,left:l},h=nt().toLowerCase();t&&(c=Nh(h)?ov:t),wh(h)&&(e=e||lv,u.scrollbars="yes");const p=Object.entries(u).reduce((y,[_,C])=>`${y}${_}=${C},`,"");if(Ry(h)&&c!=="_self")return uv(e||"",c),new fu(null);const g=window.open(e||"",c,p);ne(g,n,"popup-blocked");try{g.focus()}catch{}return new fu(g)}function uv(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv="__/auth/handler",hv="emulator/auth/handler",mv=encodeURIComponent("fac");async function gu(n,e,t,r,i,a){ne(n.config.authDomain,n,"auth-domain-config-required"),ne(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:on,eventId:i};if(e instanceof Dh){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",Ug(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,g]of Object.entries({}))l[p]=g}if(e instanceof Kr){const p=e.getScopes().filter(g=>g!=="");p.length>0&&(l.scopes=p.join(","))}n.tenantId&&(l.tid=n.tenantId);const c=l;for(const p of Object.keys(c))c[p]===void 0&&delete c[p];const u=await n._getAppCheckToken(),h=u?`#${mv}=${encodeURIComponent(u)}`:"";return`${pv(n)}?${Hr(c).slice(1)}${h}`}function pv({config:n}){return n.emulator?ml(n,hv):`https://${n.authDomain}/${dv}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho="webStorageSupport";class fv{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Bh,this._completeRedirectFn=Fb,this._overrideRedirectResult=Lb}async _openPopup(e,t,r,i){Yt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await gu(e,t,r,Po(),i);return cv(e,a,yl())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await gu(e,t,r,Po(),i);return yb(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Yt(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await nv(e),r=new Bb(e);return t.register("authEvent",i=>(ne(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ho,{type:ho},i=>{const a=i?.[0]?.[ho];a!==void 0&&t(!!a),jt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Gb(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ah()||jh()||fl()}}const gv=fv;var xu="@firebase/auth",yu="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bv(n){en(new ws("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=r.options;ne(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:l,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ch(n)},h=new Vy(r,i,a,u);return Wy(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),en(new ws("auth-internal",e=>{const t=ln(e.getProvider("auth").getImmediate());return(r=>new xv(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),It(xu,yu,yv(n)),It(xu,yu,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vv=5*60,_v=Bd("authIdTokenMaxAge")||vv;let bu=null;const wv=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>_v)return;const i=t?.token;bu!==i&&(bu=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function jv(n=al()){const e=Ea(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Gy(n,{popupRedirectResolver:gv,persistence:[Ib,fb,Bh]}),r=Bd("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const l=wv(a.toString());db(t,l,()=>l(t.currentUser)),ub(t,c=>l(c))}}const i=Md("auth");return i&&Ky(t,`http://${i}`),t}function Nv(){return document.getElementsByTagName("head")?.[0]??document}My({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=St("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",Nv().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bv("Browser");var vu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bs,Kh;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(j,f){function w(){}w.prototype=f.prototype,j.D=f.prototype,j.prototype=new w,j.prototype.constructor=j,j.C=function(T,A,b){for(var v=Array(arguments.length-2),M=2;M<arguments.length;M++)v[M-2]=arguments[M];return f.prototype[A].apply(T,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(j,f,w){w||(w=0);var T=Array(16);if(typeof f=="string")for(var A=0;16>A;++A)T[A]=f.charCodeAt(w++)|f.charCodeAt(w++)<<8|f.charCodeAt(w++)<<16|f.charCodeAt(w++)<<24;else for(A=0;16>A;++A)T[A]=f[w++]|f[w++]<<8|f[w++]<<16|f[w++]<<24;f=j.g[0],w=j.g[1],A=j.g[2];var b=j.g[3],v=f+(b^w&(A^b))+T[0]+3614090360&4294967295;f=w+(v<<7&4294967295|v>>>25),v=b+(A^f&(w^A))+T[1]+3905402710&4294967295,b=f+(v<<12&4294967295|v>>>20),v=A+(w^b&(f^w))+T[2]+606105819&4294967295,A=b+(v<<17&4294967295|v>>>15),v=w+(f^A&(b^f))+T[3]+3250441966&4294967295,w=A+(v<<22&4294967295|v>>>10),v=f+(b^w&(A^b))+T[4]+4118548399&4294967295,f=w+(v<<7&4294967295|v>>>25),v=b+(A^f&(w^A))+T[5]+1200080426&4294967295,b=f+(v<<12&4294967295|v>>>20),v=A+(w^b&(f^w))+T[6]+2821735955&4294967295,A=b+(v<<17&4294967295|v>>>15),v=w+(f^A&(b^f))+T[7]+4249261313&4294967295,w=A+(v<<22&4294967295|v>>>10),v=f+(b^w&(A^b))+T[8]+1770035416&4294967295,f=w+(v<<7&4294967295|v>>>25),v=b+(A^f&(w^A))+T[9]+2336552879&4294967295,b=f+(v<<12&4294967295|v>>>20),v=A+(w^b&(f^w))+T[10]+4294925233&4294967295,A=b+(v<<17&4294967295|v>>>15),v=w+(f^A&(b^f))+T[11]+2304563134&4294967295,w=A+(v<<22&4294967295|v>>>10),v=f+(b^w&(A^b))+T[12]+1804603682&4294967295,f=w+(v<<7&4294967295|v>>>25),v=b+(A^f&(w^A))+T[13]+4254626195&4294967295,b=f+(v<<12&4294967295|v>>>20),v=A+(w^b&(f^w))+T[14]+2792965006&4294967295,A=b+(v<<17&4294967295|v>>>15),v=w+(f^A&(b^f))+T[15]+1236535329&4294967295,w=A+(v<<22&4294967295|v>>>10),v=f+(A^b&(w^A))+T[1]+4129170786&4294967295,f=w+(v<<5&4294967295|v>>>27),v=b+(w^A&(f^w))+T[6]+3225465664&4294967295,b=f+(v<<9&4294967295|v>>>23),v=A+(f^w&(b^f))+T[11]+643717713&4294967295,A=b+(v<<14&4294967295|v>>>18),v=w+(b^f&(A^b))+T[0]+3921069994&4294967295,w=A+(v<<20&4294967295|v>>>12),v=f+(A^b&(w^A))+T[5]+3593408605&4294967295,f=w+(v<<5&4294967295|v>>>27),v=b+(w^A&(f^w))+T[10]+38016083&4294967295,b=f+(v<<9&4294967295|v>>>23),v=A+(f^w&(b^f))+T[15]+3634488961&4294967295,A=b+(v<<14&4294967295|v>>>18),v=w+(b^f&(A^b))+T[4]+3889429448&4294967295,w=A+(v<<20&4294967295|v>>>12),v=f+(A^b&(w^A))+T[9]+568446438&4294967295,f=w+(v<<5&4294967295|v>>>27),v=b+(w^A&(f^w))+T[14]+3275163606&4294967295,b=f+(v<<9&4294967295|v>>>23),v=A+(f^w&(b^f))+T[3]+4107603335&4294967295,A=b+(v<<14&4294967295|v>>>18),v=w+(b^f&(A^b))+T[8]+1163531501&4294967295,w=A+(v<<20&4294967295|v>>>12),v=f+(A^b&(w^A))+T[13]+2850285829&4294967295,f=w+(v<<5&4294967295|v>>>27),v=b+(w^A&(f^w))+T[2]+4243563512&4294967295,b=f+(v<<9&4294967295|v>>>23),v=A+(f^w&(b^f))+T[7]+1735328473&4294967295,A=b+(v<<14&4294967295|v>>>18),v=w+(b^f&(A^b))+T[12]+2368359562&4294967295,w=A+(v<<20&4294967295|v>>>12),v=f+(w^A^b)+T[5]+4294588738&4294967295,f=w+(v<<4&4294967295|v>>>28),v=b+(f^w^A)+T[8]+2272392833&4294967295,b=f+(v<<11&4294967295|v>>>21),v=A+(b^f^w)+T[11]+1839030562&4294967295,A=b+(v<<16&4294967295|v>>>16),v=w+(A^b^f)+T[14]+4259657740&4294967295,w=A+(v<<23&4294967295|v>>>9),v=f+(w^A^b)+T[1]+2763975236&4294967295,f=w+(v<<4&4294967295|v>>>28),v=b+(f^w^A)+T[4]+1272893353&4294967295,b=f+(v<<11&4294967295|v>>>21),v=A+(b^f^w)+T[7]+4139469664&4294967295,A=b+(v<<16&4294967295|v>>>16),v=w+(A^b^f)+T[10]+3200236656&4294967295,w=A+(v<<23&4294967295|v>>>9),v=f+(w^A^b)+T[13]+681279174&4294967295,f=w+(v<<4&4294967295|v>>>28),v=b+(f^w^A)+T[0]+3936430074&4294967295,b=f+(v<<11&4294967295|v>>>21),v=A+(b^f^w)+T[3]+3572445317&4294967295,A=b+(v<<16&4294967295|v>>>16),v=w+(A^b^f)+T[6]+76029189&4294967295,w=A+(v<<23&4294967295|v>>>9),v=f+(w^A^b)+T[9]+3654602809&4294967295,f=w+(v<<4&4294967295|v>>>28),v=b+(f^w^A)+T[12]+3873151461&4294967295,b=f+(v<<11&4294967295|v>>>21),v=A+(b^f^w)+T[15]+530742520&4294967295,A=b+(v<<16&4294967295|v>>>16),v=w+(A^b^f)+T[2]+3299628645&4294967295,w=A+(v<<23&4294967295|v>>>9),v=f+(A^(w|~b))+T[0]+4096336452&4294967295,f=w+(v<<6&4294967295|v>>>26),v=b+(w^(f|~A))+T[7]+1126891415&4294967295,b=f+(v<<10&4294967295|v>>>22),v=A+(f^(b|~w))+T[14]+2878612391&4294967295,A=b+(v<<15&4294967295|v>>>17),v=w+(b^(A|~f))+T[5]+4237533241&4294967295,w=A+(v<<21&4294967295|v>>>11),v=f+(A^(w|~b))+T[12]+1700485571&4294967295,f=w+(v<<6&4294967295|v>>>26),v=b+(w^(f|~A))+T[3]+2399980690&4294967295,b=f+(v<<10&4294967295|v>>>22),v=A+(f^(b|~w))+T[10]+4293915773&4294967295,A=b+(v<<15&4294967295|v>>>17),v=w+(b^(A|~f))+T[1]+2240044497&4294967295,w=A+(v<<21&4294967295|v>>>11),v=f+(A^(w|~b))+T[8]+1873313359&4294967295,f=w+(v<<6&4294967295|v>>>26),v=b+(w^(f|~A))+T[15]+4264355552&4294967295,b=f+(v<<10&4294967295|v>>>22),v=A+(f^(b|~w))+T[6]+2734768916&4294967295,A=b+(v<<15&4294967295|v>>>17),v=w+(b^(A|~f))+T[13]+1309151649&4294967295,w=A+(v<<21&4294967295|v>>>11),v=f+(A^(w|~b))+T[4]+4149444226&4294967295,f=w+(v<<6&4294967295|v>>>26),v=b+(w^(f|~A))+T[11]+3174756917&4294967295,b=f+(v<<10&4294967295|v>>>22),v=A+(f^(b|~w))+T[2]+718787259&4294967295,A=b+(v<<15&4294967295|v>>>17),v=w+(b^(A|~f))+T[9]+3951481745&4294967295,j.g[0]=j.g[0]+f&4294967295,j.g[1]=j.g[1]+(A+(v<<21&4294967295|v>>>11))&4294967295,j.g[2]=j.g[2]+A&4294967295,j.g[3]=j.g[3]+b&4294967295}r.prototype.u=function(j,f){f===void 0&&(f=j.length);for(var w=f-this.blockSize,T=this.B,A=this.h,b=0;b<f;){if(A==0)for(;b<=w;)i(this,j,b),b+=this.blockSize;if(typeof j=="string"){for(;b<f;)if(T[A++]=j.charCodeAt(b++),A==this.blockSize){i(this,T),A=0;break}}else for(;b<f;)if(T[A++]=j[b++],A==this.blockSize){i(this,T),A=0;break}}this.h=A,this.o+=f},r.prototype.v=function(){var j=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);j[0]=128;for(var f=1;f<j.length-8;++f)j[f]=0;var w=8*this.o;for(f=j.length-8;f<j.length;++f)j[f]=w&255,w/=256;for(this.u(j),j=Array(16),f=w=0;4>f;++f)for(var T=0;32>T;T+=8)j[w++]=this.g[f]>>>T&255;return j};function a(j,f){var w=c;return Object.prototype.hasOwnProperty.call(w,j)?w[j]:w[j]=f(j)}function l(j,f){this.h=f;for(var w=[],T=!0,A=j.length-1;0<=A;A--){var b=j[A]|0;T&&b==f||(w[A]=b,T=!1)}this.g=w}var c={};function u(j){return-128<=j&&128>j?a(j,function(f){return new l([f|0],0>f?-1:0)}):new l([j|0],0>j?-1:0)}function h(j){if(isNaN(j)||!isFinite(j))return g;if(0>j)return N(h(-j));for(var f=[],w=1,T=0;j>=w;T++)f[T]=j/w|0,w*=4294967296;return new l(f,0)}function p(j,f){if(j.length==0)throw Error("number format error: empty string");if(f=f||10,2>f||36<f)throw Error("radix out of range: "+f);if(j.charAt(0)=="-")return N(p(j.substring(1),f));if(0<=j.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=h(Math.pow(f,8)),T=g,A=0;A<j.length;A+=8){var b=Math.min(8,j.length-A),v=parseInt(j.substring(A,A+b),f);8>b?(b=h(Math.pow(f,b)),T=T.j(b).add(h(v))):(T=T.j(w),T=T.add(h(v)))}return T}var g=u(0),y=u(1),_=u(16777216);n=l.prototype,n.m=function(){if(E(this))return-N(this).m();for(var j=0,f=1,w=0;w<this.g.length;w++){var T=this.i(w);j+=(0<=T?T:4294967296+T)*f,f*=4294967296}return j},n.toString=function(j){if(j=j||10,2>j||36<j)throw Error("radix out of range: "+j);if(C(this))return"0";if(E(this))return"-"+N(this).toString(j);for(var f=h(Math.pow(j,6)),w=this,T="";;){var A=V(w,f).g;w=k(w,A.j(f));var b=((0<w.g.length?w.g[0]:w.h)>>>0).toString(j);if(w=A,C(w))return b+T;for(;6>b.length;)b="0"+b;T=b+T}},n.i=function(j){return 0>j?0:j<this.g.length?this.g[j]:this.h};function C(j){if(j.h!=0)return!1;for(var f=0;f<j.g.length;f++)if(j.g[f]!=0)return!1;return!0}function E(j){return j.h==-1}n.l=function(j){return j=k(this,j),E(j)?-1:C(j)?0:1};function N(j){for(var f=j.g.length,w=[],T=0;T<f;T++)w[T]=~j.g[T];return new l(w,~j.h).add(y)}n.abs=function(){return E(this)?N(this):this},n.add=function(j){for(var f=Math.max(this.g.length,j.g.length),w=[],T=0,A=0;A<=f;A++){var b=T+(this.i(A)&65535)+(j.i(A)&65535),v=(b>>>16)+(this.i(A)>>>16)+(j.i(A)>>>16);T=v>>>16,b&=65535,v&=65535,w[A]=v<<16|b}return new l(w,w[w.length-1]&-2147483648?-1:0)};function k(j,f){return j.add(N(f))}n.j=function(j){if(C(this)||C(j))return g;if(E(this))return E(j)?N(this).j(N(j)):N(N(this).j(j));if(E(j))return N(this.j(N(j)));if(0>this.l(_)&&0>j.l(_))return h(this.m()*j.m());for(var f=this.g.length+j.g.length,w=[],T=0;T<2*f;T++)w[T]=0;for(T=0;T<this.g.length;T++)for(var A=0;A<j.g.length;A++){var b=this.i(T)>>>16,v=this.i(T)&65535,M=j.i(A)>>>16,Q=j.i(A)&65535;w[2*T+2*A]+=v*Q,R(w,2*T+2*A),w[2*T+2*A+1]+=b*Q,R(w,2*T+2*A+1),w[2*T+2*A+1]+=v*M,R(w,2*T+2*A+1),w[2*T+2*A+2]+=b*M,R(w,2*T+2*A+2)}for(T=0;T<f;T++)w[T]=w[2*T+1]<<16|w[2*T];for(T=f;T<2*f;T++)w[T]=0;return new l(w,0)};function R(j,f){for(;(j[f]&65535)!=j[f];)j[f+1]+=j[f]>>>16,j[f]&=65535,f++}function P(j,f){this.g=j,this.h=f}function V(j,f){if(C(f))throw Error("division by zero");if(C(j))return new P(g,g);if(E(j))return f=V(N(j),f),new P(N(f.g),N(f.h));if(E(f))return f=V(j,N(f)),new P(N(f.g),f.h);if(30<j.g.length){if(E(j)||E(f))throw Error("slowDivide_ only works with positive integers.");for(var w=y,T=f;0>=T.l(j);)w=B(w),T=B(T);var A=O(w,1),b=O(T,1);for(T=O(T,2),w=O(w,2);!C(T);){var v=b.add(T);0>=v.l(j)&&(A=A.add(w),b=v),T=O(T,1),w=O(w,1)}return f=k(j,A.j(f)),new P(A,f)}for(A=g;0<=j.l(f);){for(w=Math.max(1,Math.floor(j.m()/f.m())),T=Math.ceil(Math.log(w)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),b=h(w),v=b.j(f);E(v)||0<v.l(j);)w-=T,b=h(w),v=b.j(f);C(b)&&(b=y),A=A.add(b),j=k(j,v)}return new P(A,j)}n.A=function(j){return V(this,j).h},n.and=function(j){for(var f=Math.max(this.g.length,j.g.length),w=[],T=0;T<f;T++)w[T]=this.i(T)&j.i(T);return new l(w,this.h&j.h)},n.or=function(j){for(var f=Math.max(this.g.length,j.g.length),w=[],T=0;T<f;T++)w[T]=this.i(T)|j.i(T);return new l(w,this.h|j.h)},n.xor=function(j){for(var f=Math.max(this.g.length,j.g.length),w=[],T=0;T<f;T++)w[T]=this.i(T)^j.i(T);return new l(w,this.h^j.h)};function B(j){for(var f=j.g.length+1,w=[],T=0;T<f;T++)w[T]=j.i(T)<<1|j.i(T-1)>>>31;return new l(w,j.h)}function O(j,f){var w=f>>5;f%=32;for(var T=j.g.length-w,A=[],b=0;b<T;b++)A[b]=0<f?j.i(b+w)>>>f|j.i(b+w+1)<<32-f:j.i(b+w);return new l(A,j.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Kh=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=h,l.fromString=p,bs=l}).apply(typeof vu<"u"?vu:typeof self<"u"?self:typeof window<"u"?window:{});var Ai=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Qh,yr,Xh,Ui,Vo,Yh,Jh,Zh;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,d,m){return o==Array.prototype||o==Object.prototype||(o[d]=m.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ai=="object"&&Ai];for(var d=0;d<o.length;++d){var m=o[d];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(o,d){if(d)e:{var m=r;o=o.split(".");for(var x=0;x<o.length-1;x++){var D=o[x];if(!(D in m))break e;m=m[D]}o=o[o.length-1],x=m[o],d=d(x),d!=x&&d!=null&&e(m,o,{configurable:!0,writable:!0,value:d})}}function a(o,d){o instanceof String&&(o+="");var m=0,x=!1,D={next:function(){if(!x&&m<o.length){var L=m++;return{value:d(L,o[L]),done:!1}}return x=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}i("Array.prototype.values",function(o){return o||function(){return a(this,function(d,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function u(o){var d=typeof o;return d=d!="object"?d:o?Array.isArray(o)?"array":d:"null",d=="array"||d=="object"&&typeof o.length=="number"}function h(o){var d=typeof o;return d=="object"&&o!=null||d=="function"}function p(o,d,m){return o.call.apply(o.bind,arguments)}function g(o,d,m){if(!o)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,x),o.apply(d,D)}}return function(){return o.apply(d,arguments)}}function y(o,d,m){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,y.apply(null,arguments)}function _(o,d){var m=Array.prototype.slice.call(arguments,1);return function(){var x=m.slice();return x.push.apply(x,arguments),o.apply(this,x)}}function C(o,d){function m(){}m.prototype=d.prototype,o.aa=d.prototype,o.prototype=new m,o.prototype.constructor=o,o.Qb=function(x,D,L){for(var $=Array(arguments.length-2),je=2;je<arguments.length;je++)$[je-2]=arguments[je];return d.prototype[D].apply(x,$)}}function E(o){const d=o.length;if(0<d){const m=Array(d);for(let x=0;x<d;x++)m[x]=o[x];return m}return[]}function N(o,d){for(let m=1;m<arguments.length;m++){const x=arguments[m];if(u(x)){const D=o.length||0,L=x.length||0;o.length=D+L;for(let $=0;$<L;$++)o[D+$]=x[$]}else o.push(x)}}class k{constructor(d,m){this.i=d,this.j=m,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function R(o){return/^[\s\xa0]*$/.test(o)}function P(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function V(o){return V[" "](o),o}V[" "]=function(){};var B=P().indexOf("Gecko")!=-1&&!(P().toLowerCase().indexOf("webkit")!=-1&&P().indexOf("Edge")==-1)&&!(P().indexOf("Trident")!=-1||P().indexOf("MSIE")!=-1)&&P().indexOf("Edge")==-1;function O(o,d,m){for(const x in o)d.call(m,o[x],x,o)}function j(o,d){for(const m in o)d.call(void 0,o[m],m,o)}function f(o){const d={};for(const m in o)d[m]=o[m];return d}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(o,d){let m,x;for(let D=1;D<arguments.length;D++){x=arguments[D];for(m in x)o[m]=x[m];for(let L=0;L<w.length;L++)m=w[L],Object.prototype.hasOwnProperty.call(x,m)&&(o[m]=x[m])}}function A(o){var d=1;o=o.split(":");const m=[];for(;0<d&&o.length;)m.push(o.shift()),d--;return o.length&&m.push(o.join(":")),m}function b(o){c.setTimeout(()=>{throw o},0)}function v(){var o=ue;let d=null;return o.g&&(d=o.g,o.g=o.g.next,o.g||(o.h=null),d.next=null),d}class M{constructor(){this.h=this.g=null}add(d,m){const x=Q.get();x.set(d,m),this.h?this.h.next=x:this.g=x,this.h=x}}var Q=new k(()=>new ie,o=>o.reset());class ie{constructor(){this.next=this.g=this.h=null}set(d,m){this.h=d,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let X,ee=!1,ue=new M,oe=()=>{const o=c.Promise.resolve(void 0);X=()=>{o.then(Ie)}};var Ie=()=>{for(var o;o=v();){try{o.h.call(o.g)}catch(m){b(m)}var d=Q;d.j(o),100>d.h&&(d.h++,o.next=d.g,d.g=o)}ee=!1};function de(){this.s=this.s,this.C=this.C}de.prototype.s=!1,de.prototype.ma=function(){this.s||(this.s=!0,this.N())},de.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function we(o,d){this.type=o,this.g=this.target=d,this.defaultPrevented=!1}we.prototype.h=function(){this.defaultPrevented=!0};var ks=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,d=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const m=()=>{};c.addEventListener("test",m,d),c.removeEventListener("test",m,d)}catch{}return o}();function ot(o,d){if(we.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var m=this.type=o.type,x=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=d,d=o.relatedTarget){if(B){e:{try{V(d.nodeName);var D=!0;break e}catch{}D=!1}D||(d=null)}}else m=="mouseover"?d=o.fromElement:m=="mouseout"&&(d=o.toElement);this.relatedTarget=d,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:ti[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&ot.aa.h.call(this)}}C(ot,we);var ti={2:"touch",3:"pen",4:"mouse"};ot.prototype.h=function(){ot.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var xt="closure_listenable_"+(1e6*Math.random()|0),si=0;function Ye(o,d,m,x,D){this.listener=o,this.proxy=null,this.src=d,this.type=m,this.capture=!!x,this.ha=D,this.key=++si,this.da=this.fa=!1}function Ft(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function mn(o){this.src=o,this.g={},this.h=0}mn.prototype.add=function(o,d,m,x,D){var L=o.toString();o=this.g[L],o||(o=this.g[L]=[],this.h++);var $=Xn(o,d,x,D);return-1<$?(d=o[$],m||(d.fa=!1)):(d=new Ye(d,this.src,L,!!x,D),d.fa=m,o.push(d)),d};function ts(o,d){var m=d.type;if(m in o.g){var x=o.g[m],D=Array.prototype.indexOf.call(x,d,void 0),L;(L=0<=D)&&Array.prototype.splice.call(x,D,1),L&&(Ft(d),o.g[m].length==0&&(delete o.g[m],o.h--))}}function Xn(o,d,m,x){for(var D=0;D<o.length;++D){var L=o[D];if(!L.da&&L.listener==d&&L.capture==!!m&&L.ha==x)return D}return-1}var pn="closure_lm_"+(1e6*Math.random()|0),fn={};function Ps(o,d,m,x,D){if(Array.isArray(d)){for(var L=0;L<d.length;L++)Ps(o,d[L],m,x,D);return null}return m=Zn(m),o&&o[xt]?o.K(d,m,h(x)?!!x.capture:!1,D):ni(o,d,m,!1,x,D)}function ni(o,d,m,x,D,L){if(!d)throw Error("Invalid event type");var $=h(D)?!!D.capture:!!D,je=ss(o);if(je||(o[pn]=je=new mn(o)),m=je.add(d,m,x,$,L),m.proxy)return m;if(x=gn(),m.proxy=x,x.src=o,x.listener=m,o.addEventListener)ks||(D=$),D===void 0&&(D=!1),o.addEventListener(d.toString(),x,D);else if(o.attachEvent)o.attachEvent(ri(d.toString()),x);else if(o.addListener&&o.removeListener)o.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return m}function gn(){function o(m){return d.call(o.src,o.listener,m)}const d=$a;return o}function Yn(o,d,m,x,D){if(Array.isArray(d))for(var L=0;L<d.length;L++)Yn(o,d[L],m,x,D);else x=h(x)?!!x.capture:!!x,m=Zn(m),o&&o[xt]?(o=o.i,d=String(d).toString(),d in o.g&&(L=o.g[d],m=Xn(L,m,x,D),-1<m&&(Ft(L[m]),Array.prototype.splice.call(L,m,1),L.length==0&&(delete o.g[d],o.h--)))):o&&(o=ss(o))&&(d=o.g[d.toString()],o=-1,d&&(o=Xn(d,m,x,D)),(m=-1<o?d[o]:null)&&be(m))}function be(o){if(typeof o!="number"&&o&&!o.da){var d=o.src;if(d&&d[xt])ts(d.i,o);else{var m=o.type,x=o.proxy;d.removeEventListener?d.removeEventListener(m,x,o.capture):d.detachEvent?d.detachEvent(ri(m),x):d.addListener&&d.removeListener&&d.removeListener(x),(m=ss(d))?(ts(m,o),m.h==0&&(m.src=null,d[pn]=null)):Ft(o)}}}function ri(o){return o in fn?fn[o]:fn[o]="on"+o}function $a(o,d){if(o.da)o=!0;else{d=new ot(d,this);var m=o.listener,x=o.ha||o.src;o.fa&&be(o),o=m.call(x,d)}return o}function ss(o){return o=o[pn],o instanceof mn?o:null}var Jn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zn(o){return typeof o=="function"?o:(o[Jn]||(o[Jn]=function(d){return o.handleEvent(d)}),o[Jn])}function Me(){de.call(this),this.i=new mn(this),this.M=this,this.F=null}C(Me,de),Me.prototype[xt]=!0,Me.prototype.removeEventListener=function(o,d,m,x){Yn(this,o,d,m,x)};function Oe(o,d){var m,x=o.F;if(x)for(m=[];x;x=x.F)m.push(x);if(o=o.M,x=d.type||d,typeof d=="string")d=new we(d,o);else if(d instanceof we)d.target=d.target||o;else{var D=d;d=new we(x,o),T(d,D)}if(D=!0,m)for(var L=m.length-1;0<=L;L--){var $=d.g=m[L];D=Ds($,x,!0,d)&&D}if($=d.g=o,D=Ds($,x,!0,d)&&D,D=Ds($,x,!1,d)&&D,m)for(L=0;L<m.length;L++)$=d.g=m[L],D=Ds($,x,!1,d)&&D}Me.prototype.N=function(){if(Me.aa.N.call(this),this.i){var o=this.i,d;for(d in o.g){for(var m=o.g[d],x=0;x<m.length;x++)Ft(m[x]);delete o.g[d],o.h--}}this.F=null},Me.prototype.K=function(o,d,m,x){return this.i.add(String(o),d,!1,m,x)},Me.prototype.L=function(o,d,m,x){return this.i.add(String(o),d,!0,m,x)};function Ds(o,d,m,x){if(d=o.i.g[String(d)],!d)return!0;d=d.concat();for(var D=!0,L=0;L<d.length;++L){var $=d[L];if($&&!$.da&&$.capture==m){var je=$.listener,$e=$.ha||$.src;$.fa&&ts(o.i,$),D=je.call($e,x)!==!1&&D}}return D&&!x.defaultPrevented}function Os(o,d,m){if(typeof o=="function")m&&(o=y(o,m));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:c.setTimeout(o,d||0)}function er(o){o.g=Os(()=>{o.g=null,o.i&&(o.i=!1,er(o))},o.l);const d=o.h;o.h=null,o.m.apply(null,d)}class _e extends de{constructor(d,m){super(),this.m=d,this.l=m,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:er(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ns(o){de.call(this),this.h=o,this.g={}}C(ns,de);var mt=[];function rs(o){O(o.g,function(d,m){this.g.hasOwnProperty(m)&&be(d)},o),o.g={}}ns.prototype.N=function(){ns.aa.N.call(this),rs(this)},ns.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var tr=c.JSON.stringify,Ut=c.JSON.parse,ii=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function Bt(){}Bt.prototype.h=null;function sr(o){return o.h||(o.h=o.i())}function ai(){}var Ls={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function nr(){we.call(this,"d")}C(nr,we);function rr(){we.call(this,"c")}C(rr,we);var qt={},ir=null;function xn(){return ir=ir||new Me}qt.La="serverreachability";function oi(o){we.call(this,qt.La,o)}C(oi,we);function Vs(o){const d=xn();Oe(d,new oi(d))}qt.STAT_EVENT="statevent";function li(o,d){we.call(this,qt.STAT_EVENT,o),this.stat=d}C(li,we);function ze(o){const d=xn();Oe(d,new li(d,o))}qt.Ma="timingevent";function ci(o,d){we.call(this,qt.Ma,o),this.size=d}C(ci,we);function Ms(o,d){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},d)}function Nt(){this.g=!0}Nt.prototype.xa=function(){this.g=!1};function ui(o,d,m,x,D,L){o.info(function(){if(o.g)if(L)for(var $="",je=L.split("&"),$e=0;$e<je.length;$e++){var ye=je[$e].split("=");if(1<ye.length){var Je=ye[0];ye=ye[1];var Ze=Je.split("_");$=2<=Ze.length&&Ze[1]=="type"?$+(Je+"="+ye+"&"):$+(Je+"=redacted&")}}else $=null;else $=L;return"XMLHTTP REQ ("+x+") [attempt "+D+"]: "+d+`
`+m+`
`+$})}function Fs(o,d,m,x,D,L,$){o.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+D+"]: "+d+`
`+m+`
`+L+" "+$})}function is(o,d,m,x){o.info(function(){return"XMLHTTP TEXT ("+d+"): "+H(o,m)+(x?" "+x:"")})}function I(o,d){o.info(function(){return"TIMEOUT: "+d})}Nt.prototype.info=function(){};function H(o,d){if(!o.g)return d;if(!d)return null;try{var m=JSON.parse(d);if(m){for(o=0;o<m.length;o++)if(Array.isArray(m[o])){var x=m[o];if(!(2>x.length)){var D=x[1];if(Array.isArray(D)&&!(1>D.length)){var L=D[0];if(L!="noop"&&L!="stop"&&L!="close")for(var $=1;$<D.length;$++)D[$]=""}}}}return tr(m)}catch{return d}}var q={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},W={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Fe;function Us(){}C(Us,Bt),Us.prototype.g=function(){return new XMLHttpRequest},Us.prototype.i=function(){return{}},Fe=new Us;function pt(o,d,m,x){this.j=o,this.i=d,this.l=m,this.R=x||1,this.U=new ns(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new di}function di(){this.i=null,this.g="",this.h=!1}var hi={},ce={};function yn(o,d,m){o.L=1,o.v=gi(zt(d)),o.m=m,o.P=!0,bn(o,null)}function bn(o,d){o.F=Date.now(),mi(o),o.A=zt(o.v);var m=o.A,x=o.R;Array.isArray(x)||(x=[String(x)]),cc(m.i,"t",x),o.C=0,m=o.j.J,o.h=new di,o.g=Ic(o.j,m?d:null,!o.m),0<o.O&&(o.M=new _e(y(o.Y,o,o.g),o.O)),d=o.U,m=o.g,x=o.ca;var D="readystatechange";Array.isArray(D)||(D&&(mt[0]=D.toString()),D=mt);for(var L=0;L<D.length;L++){var $=Ps(m,D[L],x||d.handleEvent,!1,d.h||d);if(!$)break;d.g[$.key]=$}d=o.H?f(o.H):{},o.m?(o.u||(o.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,d)):(o.u="GET",o.g.ea(o.A,o.u,null,d)),Vs(),ui(o.i,o.u,o.A,o.l,o.R,o.m)}pt.prototype.ca=function(o){o=o.target;const d=this.M;d&&$t(o)==3?d.j():this.Y(o)},pt.prototype.Y=function(o){try{if(o==this.g)e:{const Ze=$t(this.g);var d=this.g.Ba();const wn=this.g.Z();if(!(3>Ze)&&(Ze!=3||this.g&&(this.h.h||this.g.oa()||gc(this.g)))){this.J||Ze!=4||d==7||(d==8||0>=wn?Vs(3):Vs(2)),Ha(this);var m=this.g.Z();this.X=m;t:if(Xl(this)){var x=gc(this.g);o="";var D=x.length,L=$t(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Bs(this),ar(this);var $="";break t}this.h.i=new c.TextDecoder}for(d=0;d<D;d++)this.h.h=!0,o+=this.h.i.decode(x[d],{stream:!(L&&d==D-1)});x.length=0,this.h.g+=o,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=m==200,Fs(this.i,this.u,this.A,this.l,this.R,Ze,m),this.o){if(this.T&&!this.K){t:{if(this.g){var je,$e=this.g;if((je=$e.g?$e.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(je)){var ye=je;break t}}ye=null}if(m=ye)is(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ga(this,m);else{this.o=!1,this.s=3,ze(12),Bs(this),ar(this);break e}}if(this.P){m=!0;let yt;for(;!this.J&&this.C<$.length;)if(yt=Rp(this,$),yt==ce){Ze==4&&(this.s=4,ze(14),m=!1),is(this.i,this.l,null,"[Incomplete Response]");break}else if(yt==hi){this.s=4,ze(15),is(this.i,this.l,$,"[Invalid Chunk]"),m=!1;break}else is(this.i,this.l,yt,null),Ga(this,yt);if(Xl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ze!=4||$.length!=0||this.h.h||(this.s=1,ze(16),m=!1),this.o=this.o&&m,!m)is(this.i,this.l,$,"[Invalid Chunked Response]"),Bs(this),ar(this);else if(0<$.length&&!this.W){this.W=!0;var Je=this.j;Je.g==this&&Je.ba&&!Je.M&&(Je.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),Ja(Je),Je.M=!0,ze(11))}}else is(this.i,this.l,$,null),Ga(this,$);Ze==4&&Bs(this),this.o&&!this.J&&(Ze==4?jc(this.j,this):(this.o=!1,mi(this)))}else Kp(this.g),m==400&&0<$.indexOf("Unknown SID")?(this.s=3,ze(12)):(this.s=0,ze(13)),Bs(this),ar(this)}}}catch{}finally{}};function Xl(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Rp(o,d){var m=o.C,x=d.indexOf(`
`,m);return x==-1?ce:(m=Number(d.substring(m,x)),isNaN(m)?hi:(x+=1,x+m>d.length?ce:(d=d.slice(x,x+m),o.C=x+m,d)))}pt.prototype.cancel=function(){this.J=!0,Bs(this)};function mi(o){o.S=Date.now()+o.I,Yl(o,o.I)}function Yl(o,d){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Ms(y(o.ba,o),d)}function Ha(o){o.B&&(c.clearTimeout(o.B),o.B=null)}pt.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(I(this.i,this.A),this.L!=2&&(Vs(),ze(17)),Bs(this),this.s=2,ar(this)):Yl(this,this.S-o)};function ar(o){o.j.G==0||o.J||jc(o.j,o)}function Bs(o){Ha(o);var d=o.M;d&&typeof d.ma=="function"&&d.ma(),o.M=null,rs(o.U),o.g&&(d=o.g,o.g=null,d.abort(),d.ma())}function Ga(o,d){try{var m=o.j;if(m.G!=0&&(m.g==o||Wa(m.h,o))){if(!o.K&&Wa(m.h,o)&&m.G==3){try{var x=m.Da.g.parse(d)}catch{x=null}if(Array.isArray(x)&&x.length==3){var D=x;if(D[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<o.F)wi(m),vi(m);else break e;Ya(m),ze(18)}}else m.za=D[1],0<m.za-m.T&&37500>D[2]&&m.F&&m.v==0&&!m.C&&(m.C=Ms(y(m.Za,m),6e3));if(1>=ec(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else zs(m,11)}else if((o.K||m.g==o)&&wi(m),!R(d))for(D=m.Da.g.parse(d),d=0;d<D.length;d++){let ye=D[d];if(m.T=ye[0],ye=ye[1],m.G==2)if(ye[0]=="c"){m.K=ye[1],m.ia=ye[2];const Je=ye[3];Je!=null&&(m.la=Je,m.j.info("VER="+m.la));const Ze=ye[4];Ze!=null&&(m.Aa=Ze,m.j.info("SVER="+m.Aa));const wn=ye[5];wn!=null&&typeof wn=="number"&&0<wn&&(x=1.5*wn,m.L=x,m.j.info("backChannelRequestTimeoutMs_="+x)),x=m;const yt=o.g;if(yt){const Ni=yt.g?yt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ni){var L=x.h;L.g||Ni.indexOf("spdy")==-1&&Ni.indexOf("quic")==-1&&Ni.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(Ka(L,L.h),L.h=null))}if(x.D){const Za=yt.g?yt.g.getResponseHeader("X-HTTP-Session-Id"):null;Za&&(x.ya=Za,Ne(x.I,x.D,Za))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-o.F,m.j.info("Handshake RTT: "+m.R+"ms")),x=m;var $=o;if(x.qa=Tc(x,x.J?x.ia:null,x.W),$.K){tc(x.h,$);var je=$,$e=x.L;$e&&(je.I=$e),je.B&&(Ha(je),mi(je)),x.g=$}else _c(x);0<m.i.length&&_i(m)}else ye[0]!="stop"&&ye[0]!="close"||zs(m,7);else m.G==3&&(ye[0]=="stop"||ye[0]=="close"?ye[0]=="stop"?zs(m,7):Xa(m):ye[0]!="noop"&&m.l&&m.l.ta(ye),m.v=0)}}Vs(4)}catch{}}var kp=class{constructor(o,d){this.g=o,this.map=d}};function Jl(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Zl(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function ec(o){return o.h?1:o.g?o.g.size:0}function Wa(o,d){return o.h?o.h==d:o.g?o.g.has(d):!1}function Ka(o,d){o.g?o.g.add(d):o.h=d}function tc(o,d){o.h&&o.h==d?o.h=null:o.g&&o.g.has(d)&&o.g.delete(d)}Jl.prototype.cancel=function(){if(this.i=sc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function sc(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let d=o.i;for(const m of o.g.values())d=d.concat(m.D);return d}return E(o.i)}function Pp(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var d=[],m=o.length,x=0;x<m;x++)d.push(o[x]);return d}d=[],m=0;for(x in o)d[m++]=o[x];return d}function Dp(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var d=[];o=o.length;for(var m=0;m<o;m++)d.push(m);return d}d=[],m=0;for(const x in o)d[m++]=x;return d}}}function nc(o,d){if(o.forEach&&typeof o.forEach=="function")o.forEach(d,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,d,void 0);else for(var m=Dp(o),x=Pp(o),D=x.length,L=0;L<D;L++)d.call(void 0,x[L],m&&m[L],o)}var rc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Op(o,d){if(o){o=o.split("&");for(var m=0;m<o.length;m++){var x=o[m].indexOf("="),D=null;if(0<=x){var L=o[m].substring(0,x);D=o[m].substring(x+1)}else L=o[m];d(L,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function qs(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof qs){this.h=o.h,pi(this,o.j),this.o=o.o,this.g=o.g,fi(this,o.s),this.l=o.l;var d=o.i,m=new cr;m.i=d.i,d.g&&(m.g=new Map(d.g),m.h=d.h),ic(this,m),this.m=o.m}else o&&(d=String(o).match(rc))?(this.h=!1,pi(this,d[1]||"",!0),this.o=or(d[2]||""),this.g=or(d[3]||"",!0),fi(this,d[4]),this.l=or(d[5]||"",!0),ic(this,d[6]||"",!0),this.m=or(d[7]||"")):(this.h=!1,this.i=new cr(null,this.h))}qs.prototype.toString=function(){var o=[],d=this.j;d&&o.push(lr(d,ac,!0),":");var m=this.g;return(m||d=="file")&&(o.push("//"),(d=this.o)&&o.push(lr(d,ac,!0),"@"),o.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&o.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&o.push("/"),o.push(lr(m,m.charAt(0)=="/"?Mp:Vp,!0))),(m=this.i.toString())&&o.push("?",m),(m=this.m)&&o.push("#",lr(m,Up)),o.join("")};function zt(o){return new qs(o)}function pi(o,d,m){o.j=m?or(d,!0):d,o.j&&(o.j=o.j.replace(/:$/,""))}function fi(o,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);o.s=d}else o.s=null}function ic(o,d,m){d instanceof cr?(o.i=d,Bp(o.i,o.h)):(m||(d=lr(d,Fp)),o.i=new cr(d,o.h))}function Ne(o,d,m){o.i.set(d,m)}function gi(o){return Ne(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function or(o,d){return o?d?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function lr(o,d,m){return typeof o=="string"?(o=encodeURI(o).replace(d,Lp),m&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Lp(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var ac=/[#\/\?@]/g,Vp=/[#\?:]/g,Mp=/[#\?]/g,Fp=/[#\?@]/g,Up=/#/g;function cr(o,d){this.h=this.g=null,this.i=o||null,this.j=!!d}function as(o){o.g||(o.g=new Map,o.h=0,o.i&&Op(o.i,function(d,m){o.add(decodeURIComponent(d.replace(/\+/g," ")),m)}))}n=cr.prototype,n.add=function(o,d){as(this),this.i=null,o=vn(this,o);var m=this.g.get(o);return m||this.g.set(o,m=[]),m.push(d),this.h+=1,this};function oc(o,d){as(o),d=vn(o,d),o.g.has(d)&&(o.i=null,o.h-=o.g.get(d).length,o.g.delete(d))}function lc(o,d){return as(o),d=vn(o,d),o.g.has(d)}n.forEach=function(o,d){as(this),this.g.forEach(function(m,x){m.forEach(function(D){o.call(d,D,x,this)},this)},this)},n.na=function(){as(this);const o=Array.from(this.g.values()),d=Array.from(this.g.keys()),m=[];for(let x=0;x<d.length;x++){const D=o[x];for(let L=0;L<D.length;L++)m.push(d[x])}return m},n.V=function(o){as(this);let d=[];if(typeof o=="string")lc(this,o)&&(d=d.concat(this.g.get(vn(this,o))));else{o=Array.from(this.g.values());for(let m=0;m<o.length;m++)d=d.concat(o[m])}return d},n.set=function(o,d){return as(this),this.i=null,o=vn(this,o),lc(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[d]),this.h+=1,this},n.get=function(o,d){return o?(o=this.V(o),0<o.length?String(o[0]):d):d};function cc(o,d,m){oc(o,d),0<m.length&&(o.i=null,o.g.set(vn(o,d),E(m)),o.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],d=Array.from(this.g.keys());for(var m=0;m<d.length;m++){var x=d[m];const L=encodeURIComponent(String(x)),$=this.V(x);for(x=0;x<$.length;x++){var D=L;$[x]!==""&&(D+="="+encodeURIComponent(String($[x]))),o.push(D)}}return this.i=o.join("&")};function vn(o,d){return d=String(d),o.j&&(d=d.toLowerCase()),d}function Bp(o,d){d&&!o.j&&(as(o),o.i=null,o.g.forEach(function(m,x){var D=x.toLowerCase();x!=D&&(oc(this,x),cc(this,D,m))},o)),o.j=d}function qp(o,d){const m=new Nt;if(c.Image){const x=new Image;x.onload=_(os,m,"TestLoadImage: loaded",!0,d,x),x.onerror=_(os,m,"TestLoadImage: error",!1,d,x),x.onabort=_(os,m,"TestLoadImage: abort",!1,d,x),x.ontimeout=_(os,m,"TestLoadImage: timeout",!1,d,x),c.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=o}else d(!1)}function zp(o,d){const m=new Nt,x=new AbortController,D=setTimeout(()=>{x.abort(),os(m,"TestPingServer: timeout",!1,d)},1e4);fetch(o,{signal:x.signal}).then(L=>{clearTimeout(D),L.ok?os(m,"TestPingServer: ok",!0,d):os(m,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(D),os(m,"TestPingServer: error",!1,d)})}function os(o,d,m,x,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),x(m)}catch{}}function $p(){this.g=new ii}function Hp(o,d,m){const x=m||"";try{nc(o,function(D,L){let $=D;h(D)&&($=tr(D)),d.push(x+L+"="+encodeURIComponent($))})}catch(D){throw d.push(x+"type="+encodeURIComponent("_badmap")),D}}function xi(o){this.l=o.Ub||null,this.j=o.eb||!1}C(xi,Bt),xi.prototype.g=function(){return new yi(this.l,this.j)},xi.prototype.i=function(o){return function(){return o}}({});function yi(o,d){Me.call(this),this.D=o,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(yi,Me),n=yi.prototype,n.open=function(o,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=d,this.readyState=1,dr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(d.body=o),(this.D||c).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ur(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,dr(this)),this.g&&(this.readyState=3,dr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;uc(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function uc(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var d=o.value?o.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!o.done}))&&(this.response=this.responseText+=d)}o.done?ur(this):dr(this),this.readyState==3&&uc(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,ur(this))},n.Qa=function(o){this.g&&(this.response=o,ur(this))},n.ga=function(){this.g&&ur(this)};function ur(o){o.readyState=4,o.l=null,o.j=null,o.v=null,dr(o)}n.setRequestHeader=function(o,d){this.u.append(o,d)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],d=this.h.entries();for(var m=d.next();!m.done;)m=m.value,o.push(m[0]+": "+m[1]),m=d.next();return o.join(`\r
`)};function dr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(yi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function dc(o){let d="";return O(o,function(m,x){d+=x,d+=":",d+=m,d+=`\r
`}),d}function Qa(o,d,m){e:{for(x in m){var x=!1;break e}x=!0}x||(m=dc(m),typeof o=="string"?m!=null&&encodeURIComponent(String(m)):Ne(o,d,m))}function Ce(o){Me.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Ce,Me);var Gp=/^https?$/i,Wp=["POST","PUT"];n=Ce.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,d,m,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);d=d?d.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Fe.g(),this.v=this.o?sr(this.o):sr(Fe),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(d,String(o),!0),this.B=!1}catch(L){hc(this,L);return}if(o=m||"",m=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var D in x)m.set(D,x[D]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const L of x.keys())m.set(L,x.get(L));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(m.keys()).find(L=>L.toLowerCase()=="content-type"),D=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Wp,d,void 0))||x||D||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,$]of m)this.g.setRequestHeader(L,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{fc(this),this.u=!0,this.g.send(o),this.u=!1}catch(L){hc(this,L)}};function hc(o,d){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=d,o.m=5,mc(o),bi(o)}function mc(o){o.A||(o.A=!0,Oe(o,"complete"),Oe(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Oe(this,"complete"),Oe(this,"abort"),bi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bi(this,!0)),Ce.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?pc(this):this.bb())},n.bb=function(){pc(this)};function pc(o){if(o.h&&typeof l<"u"&&(!o.v[1]||$t(o)!=4||o.Z()!=2)){if(o.u&&$t(o)==4)Os(o.Ea,0,o);else if(Oe(o,"readystatechange"),$t(o)==4){o.h=!1;try{const $=o.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var m;if(!(m=d)){var x;if(x=$===0){var D=String(o.D).match(rc)[1]||null;!D&&c.self&&c.self.location&&(D=c.self.location.protocol.slice(0,-1)),x=!Gp.test(D?D.toLowerCase():"")}m=x}if(m)Oe(o,"complete"),Oe(o,"success");else{o.m=6;try{var L=2<$t(o)?o.g.statusText:""}catch{L=""}o.l=L+" ["+o.Z()+"]",mc(o)}}finally{bi(o)}}}}function bi(o,d){if(o.g){fc(o);const m=o.g,x=o.v[0]?()=>{}:null;o.g=null,o.v=null,d||Oe(o,"ready");try{m.onreadystatechange=x}catch{}}}function fc(o){o.I&&(c.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function $t(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<$t(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var d=this.g.responseText;return o&&d.indexOf(o)==0&&(d=d.substring(o.length)),Ut(d)}};function gc(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Kp(o){const d={};o=(o.g&&2<=$t(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<o.length;x++){if(R(o[x]))continue;var m=A(o[x]);const D=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const L=d[D]||[];d[D]=L,L.push(m)}j(d,function(x){return x.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function hr(o,d,m){return m&&m.internalChannelParams&&m.internalChannelParams[o]||d}function xc(o){this.Aa=0,this.i=[],this.j=new Nt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=hr("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=hr("baseRetryDelayMs",5e3,o),this.cb=hr("retryDelaySeedMs",1e4,o),this.Wa=hr("forwardChannelMaxRetries",2,o),this.wa=hr("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Jl(o&&o.concurrentRequestLimit),this.Da=new $p,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=xc.prototype,n.la=8,n.G=1,n.connect=function(o,d,m,x){ze(0),this.W=o,this.H=d||{},m&&x!==void 0&&(this.H.OSID=m,this.H.OAID=x),this.F=this.X,this.I=Tc(this,null,this.W),_i(this)};function Xa(o){if(yc(o),o.G==3){var d=o.U++,m=zt(o.I);if(Ne(m,"SID",o.K),Ne(m,"RID",d),Ne(m,"TYPE","terminate"),mr(o,m),d=new pt(o,o.j,d),d.L=2,d.v=gi(zt(m)),m=!1,c.navigator&&c.navigator.sendBeacon)try{m=c.navigator.sendBeacon(d.v.toString(),"")}catch{}!m&&c.Image&&(new Image().src=d.v,m=!0),m||(d.g=Ic(d.j,null),d.g.ea(d.v)),d.F=Date.now(),mi(d)}Ec(o)}function vi(o){o.g&&(Ja(o),o.g.cancel(),o.g=null)}function yc(o){vi(o),o.u&&(c.clearTimeout(o.u),o.u=null),wi(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function _i(o){if(!Zl(o.h)&&!o.s){o.s=!0;var d=o.Ga;X||oe(),ee||(X(),ee=!0),ue.add(d,o),o.B=0}}function Qp(o,d){return ec(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=d.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Ms(y(o.Ga,o,d),Nc(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const D=new pt(this,this.j,o);let L=this.o;if(this.S&&(L?(L=f(L),T(L,this.S)):L=this.S),this.m!==null||this.O||(D.H=L,L=null),this.P)e:{for(var d=0,m=0;m<this.i.length;m++){t:{var x=this.i[m];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(d+=x,4096<d){d=m;break e}if(d===4096||m===this.i.length-1){d=m+1;break e}}d=1e3}else d=1e3;d=vc(this,D,d),m=zt(this.I),Ne(m,"RID",o),Ne(m,"CVER",22),this.D&&Ne(m,"X-HTTP-Session-Id",this.D),mr(this,m),L&&(this.O?d="headers="+encodeURIComponent(String(dc(L)))+"&"+d:this.m&&Qa(m,this.m,L)),Ka(this.h,D),this.Ua&&Ne(m,"TYPE","init"),this.P?(Ne(m,"$req",d),Ne(m,"SID","null"),D.T=!0,yn(D,m,null)):yn(D,m,d),this.G=2}}else this.G==3&&(o?bc(this,o):this.i.length==0||Zl(this.h)||bc(this))};function bc(o,d){var m;d?m=d.l:m=o.U++;const x=zt(o.I);Ne(x,"SID",o.K),Ne(x,"RID",m),Ne(x,"AID",o.T),mr(o,x),o.m&&o.o&&Qa(x,o.m,o.o),m=new pt(o,o.j,m,o.B+1),o.m===null&&(m.H=o.o),d&&(o.i=d.D.concat(o.i)),d=vc(o,m,1e3),m.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Ka(o.h,m),yn(m,x,d)}function mr(o,d){o.H&&O(o.H,function(m,x){Ne(d,x,m)}),o.l&&nc({},function(m,x){Ne(d,x,m)})}function vc(o,d,m){m=Math.min(o.i.length,m);var x=o.l?y(o.l.Na,o.l,o):null;e:{var D=o.i;let L=-1;for(;;){const $=["count="+m];L==-1?0<m?(L=D[0].g,$.push("ofs="+L)):L=0:$.push("ofs="+L);let je=!0;for(let $e=0;$e<m;$e++){let ye=D[$e].g;const Je=D[$e].map;if(ye-=L,0>ye)L=Math.max(0,D[$e].g-100),je=!1;else try{Hp(Je,$,"req"+ye+"_")}catch{x&&x(Je)}}if(je){x=$.join("&");break e}}}return o=o.i.splice(0,m),d.D=o,x}function _c(o){if(!o.g&&!o.u){o.Y=1;var d=o.Fa;X||oe(),ee||(X(),ee=!0),ue.add(d,o),o.v=0}}function Ya(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Ms(y(o.Fa,o),Nc(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,wc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Ms(y(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ze(10),vi(this),wc(this))};function Ja(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function wc(o){o.g=new pt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var d=zt(o.qa);Ne(d,"RID","rpc"),Ne(d,"SID",o.K),Ne(d,"AID",o.T),Ne(d,"CI",o.F?"0":"1"),!o.F&&o.ja&&Ne(d,"TO",o.ja),Ne(d,"TYPE","xmlhttp"),mr(o,d),o.m&&o.o&&Qa(d,o.m,o.o),o.L&&(o.g.I=o.L);var m=o.g;o=o.ia,m.L=1,m.v=gi(zt(d)),m.m=null,m.P=!0,bn(m,o)}n.Za=function(){this.C!=null&&(this.C=null,vi(this),Ya(this),ze(19))};function wi(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function jc(o,d){var m=null;if(o.g==d){wi(o),Ja(o),o.g=null;var x=2}else if(Wa(o.h,d))m=d.D,tc(o.h,d),x=1;else return;if(o.G!=0){if(d.o)if(x==1){m=d.m?d.m.length:0,d=Date.now()-d.F;var D=o.B;x=xn(),Oe(x,new ci(x,m)),_i(o)}else _c(o);else if(D=d.s,D==3||D==0&&0<d.X||!(x==1&&Qp(o,d)||x==2&&Ya(o)))switch(m&&0<m.length&&(d=o.h,d.i=d.i.concat(m)),D){case 1:zs(o,5);break;case 4:zs(o,10);break;case 3:zs(o,6);break;default:zs(o,2)}}}function Nc(o,d){let m=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(m*=2),m*d}function zs(o,d){if(o.j.info("Error code "+d),d==2){var m=y(o.fb,o),x=o.Xa;const D=!x;x=new qs(x||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||pi(x,"https"),gi(x),D?qp(x.toString(),m):zp(x.toString(),m)}else ze(2);o.G=0,o.l&&o.l.sa(d),Ec(o),yc(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),ze(2)):(this.j.info("Failed to ping google.com"),ze(1))};function Ec(o){if(o.G=0,o.ka=[],o.l){const d=sc(o.h);(d.length!=0||o.i.length!=0)&&(N(o.ka,d),N(o.ka,o.i),o.h.i.length=0,E(o.i),o.i.length=0),o.l.ra()}}function Tc(o,d,m){var x=m instanceof qs?zt(m):new qs(m);if(x.g!="")d&&(x.g=d+"."+x.g),fi(x,x.s);else{var D=c.location;x=D.protocol,d=d?d+"."+D.hostname:D.hostname,D=+D.port;var L=new qs(null);x&&pi(L,x),d&&(L.g=d),D&&fi(L,D),m&&(L.l=m),x=L}return m=o.D,d=o.ya,m&&d&&Ne(x,m,d),Ne(x,"VER",o.la),mr(o,x),x}function Ic(o,d,m){if(d&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=o.Ca&&!o.pa?new Ce(new xi({eb:m})):new Ce(o.pa),d.Ha(o.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sc(){}n=Sc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ji(){}ji.prototype.g=function(o,d){return new ut(o,d)};function ut(o,d){Me.call(this),this.g=new xc(d),this.l=o,this.h=d&&d.messageUrlParams||null,o=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(o?o["X-WebChannel-Content-Type"]=d.messageContentType:o={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(o?o["X-WebChannel-Client-Profile"]=d.va:o={"X-WebChannel-Client-Profile":d.va}),this.g.S=o,(o=d&&d.Sb)&&!R(o)&&(this.g.m=o),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!R(d)&&(this.g.D=d,o=this.h,o!==null&&d in o&&(o=this.h,d in o&&delete o[d])),this.j=new _n(this)}C(ut,Me),ut.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ut.prototype.close=function(){Xa(this.g)},ut.prototype.o=function(o){var d=this.g;if(typeof o=="string"){var m={};m.__data__=o,o=m}else this.u&&(m={},m.__data__=tr(o),o=m);d.i.push(new kp(d.Ya++,o)),d.G==3&&_i(d)},ut.prototype.N=function(){this.g.l=null,delete this.j,Xa(this.g),delete this.g,ut.aa.N.call(this)};function Ac(o){nr.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var d=o.__sm__;if(d){e:{for(const m in d){o=m;break e}o=void 0}(this.i=o)&&(o=this.i,d=d!==null&&o in d?d[o]:void 0),this.data=d}else this.data=o}C(Ac,nr);function Cc(){rr.call(this),this.status=1}C(Cc,rr);function _n(o){this.g=o}C(_n,Sc),_n.prototype.ua=function(){Oe(this.g,"a")},_n.prototype.ta=function(o){Oe(this.g,new Ac(o))},_n.prototype.sa=function(o){Oe(this.g,new Cc)},_n.prototype.ra=function(){Oe(this.g,"b")},ji.prototype.createWebChannel=ji.prototype.g,ut.prototype.send=ut.prototype.o,ut.prototype.open=ut.prototype.m,ut.prototype.close=ut.prototype.close,Zh=function(){return new ji},Jh=function(){return xn()},Yh=qt,Vo={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},q.NO_ERROR=0,q.TIMEOUT=8,q.HTTP_ERROR=6,Ui=q,W.COMPLETE="complete",Xh=W,ai.EventType=Ls,Ls.OPEN="a",Ls.CLOSE="b",Ls.ERROR="c",Ls.MESSAGE="d",Me.prototype.listen=Me.prototype.K,yr=ai,Ce.prototype.listenOnce=Ce.prototype.L,Ce.prototype.getLastError=Ce.prototype.Ka,Ce.prototype.getLastErrorCode=Ce.prototype.Ba,Ce.prototype.getStatus=Ce.prototype.Z,Ce.prototype.getResponseJson=Ce.prototype.Oa,Ce.prototype.getResponseText=Ce.prototype.oa,Ce.prototype.send=Ce.prototype.ea,Ce.prototype.setWithCredentials=Ce.prototype.Ha,Qh=Ce}).apply(typeof Ai<"u"?Ai:typeof self<"u"?self:typeof window<"u"?window:{});const _u="@firebase/firestore",wu="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tt.UNAUTHENTICATED=new tt(null),tt.GOOGLE_CREDENTIALS=new tt("google-credentials-uid"),tt.FIRST_PARTY=new tt("first-party-uid"),tt.MOCK_USER=new tt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gn="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn=new rl("@firebase/firestore");function jn(){return rn.logLevel}function K(n,...e){if(rn.logLevel<=me.DEBUG){const t=e.map(vl);rn.debug(`Firestore (${Gn}): ${n}`,...t)}}function Jt(n,...e){if(rn.logLevel<=me.ERROR){const t=e.map(vl);rn.error(`Firestore (${Gn}): ${n}`,...t)}}function Mn(n,...e){if(rn.logLevel<=me.WARN){const t=e.map(vl);rn.warn(`Firestore (${Gn}): ${n}`,...t)}}function vl(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function re(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,em(n,r,t)}function em(n,e,t){let r=`FIRESTORE (${Gn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Jt(r),new Error(r)}function ve(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||em(e,i,r)}function le(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends Mt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ev{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(tt.UNAUTHENTICATED))}shutdown(){}}class Tv{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Iv{constructor(e){this.t=e,this.currentUser=tt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ve(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let a=new vs;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new vs,e.enqueueRetryable(()=>i(this.currentUser))};const l=()=>{const u=a;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new vs)}},0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve(typeof r.accessToken=="string",31837,{l:r}),new tm(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ve(e===null||typeof e=="string",2055,{h:e}),new tt(e)}}class Sv{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=tt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Av{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Sv(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(tt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ju{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Cv{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,dt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ve(this.o===void 0,3512);const r=a=>{a.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,K("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ju(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ve(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ju(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Rv(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function pe(n,e){return n<e?-1:n>e?1:0}function Mo(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return mo(i)===mo(a)?pe(i,a):mo(i)?1:-1}return pe(n.length,e.length)}const kv=55296,Pv=57343;function mo(n){const e=n.charCodeAt(0);return e>=kv&&e<=Pv}function Fn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nu="__name__";class Et{constructor(e,t,r){t===void 0?t=0:t>e.length&&re(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&re(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Et.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Et?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=Et.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return pe(e.length,t.length)}static compareSegments(e,t){const r=Et.isNumericId(e),i=Et.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Et.extractNumericId(e).compare(Et.extractNumericId(t)):Mo(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bs.fromString(e.substring(4,e.length-2))}}class Ee extends Et{construct(e,t,r){return new Ee(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Y(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Ee(t)}static emptyPath(){return new Ee([])}}const Dv=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ge extends Et{construct(e,t,r){return new Ge(e,t,r)}static isValidIdentifier(e){return Dv.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ge.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Nu}static keyField(){return new Ge([Nu])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Y(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Y(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Y(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(l=!l,i++):c!=="."||l?(r+=c,i++):(a(),i++)}if(a(),l)throw new Y(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ge(t)}static emptyPath(){return new Ge([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.path=e}static fromPath(e){return new Z(Ee.fromString(e))}static fromName(e){return new Z(Ee.fromString(e).popFirst(5))}static empty(){return new Z(Ee.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ee.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ee.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new Ee(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sm(n,e,t){if(!t)throw new Y(U.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Ov(n,e,t,r){if(e===!0&&r===!0)throw new Y(U.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Eu(n){if(!Z.isDocumentKey(n))throw new Y(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Tu(n){if(Z.isDocumentKey(n))throw new Y(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function nm(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function wl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":re(12329,{type:typeof n})}function Or(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Y(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=wl(n);throw new Y(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(n,e){const t={typeString:n};return e&&(t.value=e),t}function Xr(n,e){if(!nm(n))throw new Y(U.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(i&&typeof l!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Y(U.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iu=-62135596800,Su=1e6;class Te{static now(){return Te.fromMillis(Date.now())}static fromDate(e){return Te.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Su);return new Te(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Y(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Y(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Iu)throw new Y(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Su}_compareTo(e){return this.seconds===e.seconds?pe(this.nanoseconds,e.nanoseconds):pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Te._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Xr(e,Te._jsonSchema))return new Te(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Iu;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Te._jsonSchemaVersion="firestore/timestamp/1.0",Te._jsonSchema={type:Ve("string",Te._jsonSchemaVersion),seconds:Ve("number"),nanoseconds:Ve("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{static fromTimestamp(e){return new ae(e)}static min(){return new ae(new Te(0,0))}static max(){return new ae(new Te(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lr=-1;function Lv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ae.fromTimestamp(r===1e9?new Te(t+1,0):new Te(t,r));return new js(i,Z.empty(),e)}function Vv(n){return new js(n.readTime,n.key,Lr)}class js{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new js(ae.min(),Z.empty(),Lr)}static max(){return new js(ae.max(),Z.empty(),Lr)}}function Mv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Z.comparator(n.documentKey,e.documentKey),t!==0?t:pe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Uv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wn(n){if(n.code!==U.FAILED_PRECONDITION||n.message!==Fv)throw n;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new F((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof F?t:F.resolve(t)}catch(t){return F.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):F.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):F.reject(t)}static resolve(e){return new F((t,r)=>{t(e)})}static reject(e){return new F((t,r)=>{r(e)})}static waitFor(e){return new F((t,r)=>{let i=0,a=0,l=!1;e.forEach(c=>{++i,c.next(()=>{++a,l&&a===i&&t()},u=>r(u))}),l=!0,a===i&&t()})}static or(e){let t=F.resolve(!1);for(const r of e)t=t.next(i=>i?F.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new F((r,i)=>{const a=e.length,l=new Array(a);let c=0;for(let u=0;u<a;u++){const h=u;t(e[h]).next(p=>{l[h]=p,++c,c===a&&r(l)},p=>i(p))}})}static doWhile(e,t){return new F((r,i)=>{const a=()=>{e()===!0?t().next(()=>{a()},i):r()};a()})}}function Bv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Kn(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Aa.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jl=-1;function Ca(n){return n==null}function ra(n){return n===0&&1/n==-1/0}function qv(n){return typeof n=="number"&&Number.isInteger(n)&&!ra(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm="";function zv(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Au(e)),e=$v(n.get(t),e);return Au(e)}function $v(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case rm:t+="";break;default:t+=a}}return t}function Au(n){return n+rm+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function cn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function im(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e,t){this.comparator=e,this.root=t||He.EMPTY}insert(e,t){return new Ae(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,He.BLACK,null,null))}remove(e){return new Ae(this.comparator,this.root.remove(e,this.comparator).copy(null,null,He.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ci(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ci(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ci(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ci(this.root,e,this.comparator,!0)}}class Ci{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class He{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??He.RED,this.left=i??He.EMPTY,this.right=a??He.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new He(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return He.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return He.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,He.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,He.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw re(27949);return e+(this.isRed()?0:1)}}He.EMPTY=null,He.RED=!0,He.BLACK=!1;He.EMPTY=new class{constructor(){this.size=0}get key(){throw re(57766)}get value(){throw re(16141)}get color(){throw re(16727)}get left(){throw re(29726)}get right(){throw re(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new He(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e){this.comparator=e,this.data=new Ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ru(this.data.getIterator())}getIteratorFrom(e){return new Ru(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Be)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Be(this.comparator);return t.data=e,t}}class Ru{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.fields=e,e.sort(Ge.comparator)}static empty(){return new _t([])}unionWith(e){let t=new Be(Ge.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new _t(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fn(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new am("Invalid base64 string: "+a):a}}(e);return new Xe(t)}static fromUint8Array(e){const t=function(i){let a="";for(let l=0;l<i.length;++l)a+=String.fromCharCode(i[l]);return a}(e);return new Xe(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xe.EMPTY_BYTE_STRING=new Xe("");const Hv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ns(n){if(ve(!!n,39018),typeof n=="string"){let e=0;const t=Hv.exec(n);if(ve(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:De(n.seconds),nanos:De(n.nanos)}}function De(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Es(n){return typeof n=="string"?Xe.fromBase64String(n):Xe.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="server_timestamp",lm="__type__",cm="__previous_value__",um="__local_write_time__";function Nl(n){return(n?.mapValue?.fields||{})[lm]?.stringValue===om}function Ra(n){const e=n.mapValue.fields[cm];return Nl(e)?Ra(e):e}function Vr(n){const e=Ns(n.mapValue.fields[um].timestampValue);return new Te(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(e,t,r,i,a,l,c,u,h,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=p}}const ia="(default)";class Mr{constructor(e,t){this.projectId=e,this.database=t||ia}static empty(){return new Mr("","")}get isDefaultDatabase(){return this.database===ia}isEqual(e){return e instanceof Mr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dm="__type__",Wv="__max__",Ri={mapValue:{}},hm="__vector__",aa="value";function Ts(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Nl(n)?4:Qv(n)?9007199254740991:Kv(n)?10:11:re(28295,{value:n})}function Lt(n,e){if(n===e)return!0;const t=Ts(n);if(t!==Ts(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Vr(n).isEqual(Vr(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const l=Ns(i.timestampValue),c=Ns(a.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,a){return Es(i.bytesValue).isEqual(Es(a.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,a){return De(i.geoPointValue.latitude)===De(a.geoPointValue.latitude)&&De(i.geoPointValue.longitude)===De(a.geoPointValue.longitude)}(n,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return De(i.integerValue)===De(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const l=De(i.doubleValue),c=De(a.doubleValue);return l===c?ra(l)===ra(c):isNaN(l)&&isNaN(c)}return!1}(n,e);case 9:return Fn(n.arrayValue.values||[],e.arrayValue.values||[],Lt);case 10:case 11:return function(i,a){const l=i.mapValue.fields||{},c=a.mapValue.fields||{};if(Cu(l)!==Cu(c))return!1;for(const u in l)if(l.hasOwnProperty(u)&&(c[u]===void 0||!Lt(l[u],c[u])))return!1;return!0}(n,e);default:return re(52216,{left:n})}}function Fr(n,e){return(n.values||[]).find(t=>Lt(t,e))!==void 0}function Un(n,e){if(n===e)return 0;const t=Ts(n),r=Ts(e);if(t!==r)return pe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return pe(n.booleanValue,e.booleanValue);case 2:return function(a,l){const c=De(a.integerValue||a.doubleValue),u=De(l.integerValue||l.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(n,e);case 3:return ku(n.timestampValue,e.timestampValue);case 4:return ku(Vr(n),Vr(e));case 5:return Mo(n.stringValue,e.stringValue);case 6:return function(a,l){const c=Es(a),u=Es(l);return c.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(a,l){const c=a.split("/"),u=l.split("/");for(let h=0;h<c.length&&h<u.length;h++){const p=pe(c[h],u[h]);if(p!==0)return p}return pe(c.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(a,l){const c=pe(De(a.latitude),De(l.latitude));return c!==0?c:pe(De(a.longitude),De(l.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Pu(n.arrayValue,e.arrayValue);case 10:return function(a,l){const c=a.fields||{},u=l.fields||{},h=c[aa]?.arrayValue,p=u[aa]?.arrayValue,g=pe(h?.values?.length||0,p?.values?.length||0);return g!==0?g:Pu(h,p)}(n.mapValue,e.mapValue);case 11:return function(a,l){if(a===Ri.mapValue&&l===Ri.mapValue)return 0;if(a===Ri.mapValue)return 1;if(l===Ri.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),h=l.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let g=0;g<u.length&&g<p.length;++g){const y=Mo(u[g],p[g]);if(y!==0)return y;const _=Un(c[u[g]],h[p[g]]);if(_!==0)return _}return pe(u.length,p.length)}(n.mapValue,e.mapValue);default:throw re(23264,{he:t})}}function ku(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return pe(n,e);const t=Ns(n),r=Ns(e),i=pe(t.seconds,r.seconds);return i!==0?i:pe(t.nanos,r.nanos)}function Pu(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=Un(t[i],r[i]);if(a)return a}return pe(t.length,r.length)}function Bn(n){return Fo(n)}function Fo(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Ns(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Es(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Z.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=Fo(a);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const l of r)a?a=!1:i+=",",i+=`${l}:${Fo(t.fields[l])}`;return i+"}"}(n.mapValue):re(61005,{value:n})}function Bi(n){switch(Ts(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ra(n);return e?16+Bi(e):16;case 5:return 2*n.stringValue.length;case 6:return Es(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,a)=>i+Bi(a),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return cn(r.fields,(a,l)=>{i+=a.length+Bi(l)}),i}(n.mapValue);default:throw re(13486,{value:n})}}function Uo(n){return!!n&&"integerValue"in n}function El(n){return!!n&&"arrayValue"in n}function Du(n){return!!n&&"nullValue"in n}function Ou(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function qi(n){return!!n&&"mapValue"in n}function Kv(n){return(n?.mapValue?.fields||{})[dm]?.stringValue===hm}function Nr(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return cn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Nr(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Nr(n.arrayValue.values[t]);return e}return{...n}}function Qv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Wv}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.value=e}static empty(){return new ft({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!qi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nr(t)}setAll(e){let t=Ge.emptyPath(),r={},i=[];e.forEach((l,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}l?r[c.lastSegment()]=Nr(l):i.push(c.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());qi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Lt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];qi(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){cn(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new ft(Nr(this.value))}}function mm(n){const e=[];return cn(n.fields,(t,r)=>{const i=new Ge([t]);if(qi(r)){const a=mm(r.mapValue).fields;if(a.length===0)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new _t(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e,t,r,i,a,l,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=l,this.documentState=c}static newInvalidDocument(e){return new st(e,0,ae.min(),ae.min(),ae.min(),ft.empty(),0)}static newFoundDocument(e,t,r,i){return new st(e,1,t,ae.min(),r,i,0)}static newNoDocument(e,t){return new st(e,2,t,ae.min(),ae.min(),ft.empty(),0)}static newUnknownDocument(e,t){return new st(e,3,t,ae.min(),ae.min(),ft.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ft.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ft.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof st&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new st(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,t){this.position=e,this.inclusive=t}}function Lu(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(a.field.isKeyField()?r=Z.comparator(Z.fromName(l.referenceValue),t.key):r=Un(l,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function Vu(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Lt(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(e,t="asc"){this.field=e,this.dir=t}}function Xv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{}class Ue extends pm{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Jv(e,t,r):t==="array-contains"?new t_(e,r):t==="in"?new s_(e,r):t==="not-in"?new n_(e,r):t==="array-contains-any"?new r_(e,r):new Ue(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Zv(e,r):new e_(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Un(t,this.value)):t!==null&&Ts(this.value)===Ts(t)&&this.matchesComparison(Un(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vt extends pm{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Vt(e,t)}matches(e){return fm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function fm(n){return n.op==="and"}function gm(n){return Yv(n)&&fm(n)}function Yv(n){for(const e of n.filters)if(e instanceof Vt)return!1;return!0}function Bo(n){if(n instanceof Ue)return n.field.canonicalString()+n.op.toString()+Bn(n.value);if(gm(n))return n.filters.map(e=>Bo(e)).join(",");{const e=n.filters.map(t=>Bo(t)).join(",");return`${n.op}(${e})`}}function xm(n,e){return n instanceof Ue?function(r,i){return i instanceof Ue&&r.op===i.op&&r.field.isEqual(i.field)&&Lt(r.value,i.value)}(n,e):n instanceof Vt?function(r,i){return i instanceof Vt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((a,l,c)=>a&&xm(l,i.filters[c]),!0):!1}(n,e):void re(19439)}function ym(n){return n instanceof Ue?function(t){return`${t.field.canonicalString()} ${t.op} ${Bn(t.value)}`}(n):n instanceof Vt?function(t){return t.op.toString()+" {"+t.getFilters().map(ym).join(" ,")+"}"}(n):"Filter"}class Jv extends Ue{constructor(e,t,r){super(e,t,r),this.key=Z.fromName(r.referenceValue)}matches(e){const t=Z.comparator(e.key,this.key);return this.matchesComparison(t)}}class Zv extends Ue{constructor(e,t){super(e,"in",t),this.keys=bm("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class e_ extends Ue{constructor(e,t){super(e,"not-in",t),this.keys=bm("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function bm(n,e){return(e.arrayValue?.values||[]).map(t=>Z.fromName(t.referenceValue))}class t_ extends Ue{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return El(t)&&Fr(t.arrayValue,this.value)}}class s_ extends Ue{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Fr(this.value.arrayValue,t)}}class n_ extends Ue{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Fr(this.value.arrayValue,t)}}class r_ extends Ue{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!El(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Fr(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e,t=null,r=[],i=[],a=null,l=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=l,this.endAt=c,this.Te=null}}function Mu(n,e=null,t=[],r=[],i=null,a=null,l=null){return new i_(n,e,t,r,i,a,l)}function Tl(n){const e=le(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Bo(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),Ca(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Bn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Bn(r)).join(",")),e.Te=t}return e.Te}function Il(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Xv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!xm(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Vu(n.startAt,e.startAt)&&Vu(n.endAt,e.endAt)}function qo(n){return Z.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e,t=null,r=[],i=[],a=null,l="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=l,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function a_(n,e,t,r,i,a,l,c){return new ka(n,e,t,r,i,a,l,c)}function vm(n){return new ka(n)}function Fu(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function o_(n){return n.collectionGroup!==null}function Er(n){const e=le(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new Be(Ge.comparator);return l.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new la(a,r))}),t.has(Ge.keyField().canonicalString())||e.Ie.push(new la(Ge.keyField(),r))}return e.Ie}function Ct(n){const e=le(n);return e.Ee||(e.Ee=l_(e,Er(n))),e.Ee}function l_(n,e){if(n.limitType==="F")return Mu(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new la(i.field,a)});const t=n.endAt?new oa(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new oa(n.startAt.position,n.startAt.inclusive):null;return Mu(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function zo(n,e,t){return new ka(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Pa(n,e){return Il(Ct(n),Ct(e))&&n.limitType===e.limitType}function _m(n){return`${Tl(Ct(n))}|lt:${n.limitType}`}function Nn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>ym(i)).join(", ")}]`),Ca(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Bn(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Bn(i)).join(",")),`Target(${r})`}(Ct(n))}; limitType=${n.limitType})`}function Da(n,e){return e.isFoundDocument()&&function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):Z.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(n,e)&&function(r,i){for(const a of Er(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(l,c,u){const h=Lu(l,c,u);return l.inclusive?h<=0:h<0}(r.startAt,Er(r),i)||r.endAt&&!function(l,c,u){const h=Lu(l,c,u);return l.inclusive?h>=0:h>0}(r.endAt,Er(r),i))}(n,e)}function c_(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wm(n){return(e,t)=>{let r=!1;for(const i of Er(n)){const a=u_(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function u_(n,e,t){const r=n.field.isKeyField()?Z.comparator(e.key,t.key):function(a,l,c){const u=l.data.field(a),h=c.data.field(a);return u!==null&&h!==null?Un(u,h):re(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return re(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){cn(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return im(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=new Ae(Z.comparator);function Zt(){return d_}const jm=new Ae(Z.comparator);function br(...n){let e=jm;for(const t of n)e=e.insert(t.key,t);return e}function Nm(n){let e=jm;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Hs(){return Tr()}function Em(){return Tr()}function Tr(){return new un(n=>n.toString(),(n,e)=>n.isEqual(e))}const h_=new Ae(Z.comparator),m_=new Be(Z.comparator);function fe(...n){let e=m_;for(const t of n)e=e.add(t);return e}const p_=new Be(pe);function f_(){return p_}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ra(e)?"-0":e}}function Tm(n){return{integerValue:""+n}}function g_(n,e){return qv(e)?Tm(e):Sl(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(){this._=void 0}}function x_(n,e,t){return n instanceof ca?function(i,a){const l={fields:{[lm]:{stringValue:om},[um]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Nl(a)&&(a=Ra(a)),a&&(l.fields[cm]=a),{mapValue:l}}(t,e):n instanceof Ur?Sm(n,e):n instanceof Br?Am(n,e):function(i,a){const l=Im(i,a),c=Uu(l)+Uu(i.Ae);return Uo(l)&&Uo(i.Ae)?Tm(c):Sl(i.serializer,c)}(n,e)}function y_(n,e,t){return n instanceof Ur?Sm(n,e):n instanceof Br?Am(n,e):t}function Im(n,e){return n instanceof ua?function(r){return Uo(r)||function(a){return!!a&&"doubleValue"in a}(r)}(e)?e:{integerValue:0}:null}class ca extends Oa{}class Ur extends Oa{constructor(e){super(),this.elements=e}}function Sm(n,e){const t=Cm(e);for(const r of n.elements)t.some(i=>Lt(i,r))||t.push(r);return{arrayValue:{values:t}}}class Br extends Oa{constructor(e){super(),this.elements=e}}function Am(n,e){let t=Cm(e);for(const r of n.elements)t=t.filter(i=>!Lt(i,r));return{arrayValue:{values:t}}}class ua extends Oa{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Uu(n){return De(n.integerValue||n.doubleValue)}function Cm(n){return El(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function b_(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Ur&&i instanceof Ur||r instanceof Br&&i instanceof Br?Fn(r.elements,i.elements,Lt):r instanceof ua&&i instanceof ua?Lt(r.Ae,i.Ae):r instanceof ca&&i instanceof ca}(n.transform,e.transform)}class v_{constructor(e,t){this.version=e,this.transformResults=t}}class Rt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Rt}static exists(e){return new Rt(void 0,e)}static updateTime(e){return new Rt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zi(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class La{}function Rm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Al(n.key,Rt.none()):new Yr(n.key,n.data,Rt.none());{const t=n.data,r=ft.empty();let i=new Be(Ge.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?r.delete(a):r.set(a,l),i=i.add(a)}return new dn(n.key,r,new _t(i.toArray()),Rt.none())}}function __(n,e,t){n instanceof Yr?function(i,a,l){const c=i.value.clone(),u=qu(i.fieldTransforms,a,l.transformResults);c.setAll(u),a.convertToFoundDocument(l.version,c).setHasCommittedMutations()}(n,e,t):n instanceof dn?function(i,a,l){if(!zi(i.precondition,a))return void a.convertToUnknownDocument(l.version);const c=qu(i.fieldTransforms,a,l.transformResults),u=a.data;u.setAll(km(i)),u.setAll(c),a.convertToFoundDocument(l.version,u).setHasCommittedMutations()}(n,e,t):function(i,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,t)}function Ir(n,e,t,r){return n instanceof Yr?function(a,l,c,u){if(!zi(a.precondition,l))return c;const h=a.value.clone(),p=zu(a.fieldTransforms,u,l);return h.setAll(p),l.convertToFoundDocument(l.version,h).setHasLocalMutations(),null}(n,e,t,r):n instanceof dn?function(a,l,c,u){if(!zi(a.precondition,l))return c;const h=zu(a.fieldTransforms,u,l),p=l.data;return p.setAll(km(a)),p.setAll(h),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(g=>g.field))}(n,e,t,r):function(a,l,c){return zi(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c}(n,e,t)}function w_(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=Im(r.transform,i||null);a!=null&&(t===null&&(t=ft.empty()),t.set(r.field,a))}return t||null}function Bu(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Fn(r,i,(a,l)=>b_(a,l))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Yr extends La{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class dn extends La{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function km(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function qu(n,e,t){const r=new Map;ve(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,c=e.data.field(a.field);r.set(a.field,y_(l,c,t[i]))}return r}function zu(n,e,t){const r=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);r.set(i.field,x_(a,l,e))}return r}class Al extends La{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class j_ extends La{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&__(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ir(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Ir(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Em();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let c=this.applyToLocalView(l,a.mutatedFields);c=t.has(i.key)?null:c;const u=Rm(l,c);u!==null&&r.set(i.key,u),l.isValidDocument()||l.convertToNoDocument(ae.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),fe())}isEqual(e){return this.batchId===e.batchId&&Fn(this.mutations,e.mutations,(t,r)=>Bu(t,r))&&Fn(this.baseMutations,e.baseMutations,(t,r)=>Bu(t,r))}}class Cl{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ve(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return h_}();const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,r[l].version);return new Cl(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Le,ge;function I_(n){switch(n){case U.OK:return re(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return re(15467,{code:n})}}function Pm(n){if(n===void 0)return Jt("GRPC error has no .code"),U.UNKNOWN;switch(n){case Le.OK:return U.OK;case Le.CANCELLED:return U.CANCELLED;case Le.UNKNOWN:return U.UNKNOWN;case Le.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case Le.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case Le.INTERNAL:return U.INTERNAL;case Le.UNAVAILABLE:return U.UNAVAILABLE;case Le.UNAUTHENTICATED:return U.UNAUTHENTICATED;case Le.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case Le.NOT_FOUND:return U.NOT_FOUND;case Le.ALREADY_EXISTS:return U.ALREADY_EXISTS;case Le.PERMISSION_DENIED:return U.PERMISSION_DENIED;case Le.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case Le.ABORTED:return U.ABORTED;case Le.OUT_OF_RANGE:return U.OUT_OF_RANGE;case Le.UNIMPLEMENTED:return U.UNIMPLEMENTED;case Le.DATA_LOSS:return U.DATA_LOSS;default:return re(39323,{code:n})}}(ge=Le||(Le={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S_(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_=new bs([4294967295,4294967295],0);function $u(n){const e=S_().encode(n),t=new Kh;return t.update(e),new Uint8Array(t.digest())}function Hu(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new bs([t,r],0),new bs([i,a],0)]}class Rl{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new vr(`Invalid padding: ${t}`);if(r<0)throw new vr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new vr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new vr(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=bs.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(bs.fromNumber(r)));return i.compare(A_)===1&&(i=new bs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=$u(e),[r,i]=Hu(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(r,i,a);if(!this.we(l))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new Rl(a,i,t);return r.forEach(c=>l.insert(c)),l}insert(e){if(this.ge===0)return;const t=$u(e),[r,i]=Hu(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(r,i,a);this.Se(l)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class vr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Jr.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Va(ae.min(),i,new Ae(pe),Zt(),fe())}}class Jr{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Jr(r,t,fe(),fe(),fe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class Dm{constructor(e,t){this.targetId=e,this.Ce=t}}class Om{constructor(e,t,r=Xe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Gu{constructor(){this.ve=0,this.Fe=Wu(),this.Me=Xe.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=fe(),t=fe(),r=fe();return this.Fe.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:re(38017,{changeType:a})}}),new Jr(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Wu()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ve(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class C_{constructor(e){this.Ge=e,this.ze=new Map,this.je=Zt(),this.Je=ki(),this.He=ki(),this.Ye=new Ae(pe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:re(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(qo(a))if(r===0){const l=new Z(a.path);this.et(t,l,st.newNoDocument(l,ae.min()))}else ve(r===1,20013,{expectedCount:r});else{const l=this._t(t);if(l!==r){const c=this.ut(e),u=c?this.ct(c,e,l):1;if(u!==0){this.it(t);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let l,c;try{l=Es(r).toUint8Array()}catch(u){if(u instanceof am)return Mn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Rl(l,i,a)}catch(u){return Mn(u instanceof vr?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach(a=>{const l=this.Ge.ht(),c=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)}),i}Tt(e){const t=new Map;this.ze.forEach((a,l)=>{const c=this.ot(l);if(c){if(a.current&&qo(c.target)){const u=new Z(c.target.path);this.It(u).has(l)||this.Et(l,u)||this.et(l,u,st.newNoDocument(u,e))}a.Be&&(t.set(l,a.ke()),a.qe())}});let r=fe();this.He.forEach((a,l)=>{let c=!0;l.forEachWhile(u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(a))}),this.je.forEach((a,l)=>l.setReadTime(e));const i=new Va(e,t,this.Ye,this.je,r);return this.je=Zt(),this.Je=ki(),this.He=ki(),this.Ye=new Ae(pe),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Gu,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Be(pe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Be(pe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||K("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Gu),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ki(){return new Ae(Z.comparator)}function Wu(){return new Ae(Z.comparator)}const R_={asc:"ASCENDING",desc:"DESCENDING"},k_={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},P_={and:"AND",or:"OR"};class D_{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $o(n,e){return n.useProto3Json||Ca(e)?e:{value:e}}function da(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Lm(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function O_(n,e){return da(n,e.toTimestamp())}function kt(n){return ve(!!n,49232),ae.fromTimestamp(function(t){const r=Ns(t);return new Te(r.seconds,r.nanos)}(n))}function kl(n,e){return Ho(n,e).canonicalString()}function Ho(n,e){const t=function(i){return new Ee(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Vm(n){const e=Ee.fromString(n);return ve(qm(e),10190,{key:e.toString()}),e}function Go(n,e){return kl(n.databaseId,e.path)}function po(n,e){const t=Vm(e);if(t.get(1)!==n.databaseId.projectId)throw new Y(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Y(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Z(Fm(t))}function Mm(n,e){return kl(n.databaseId,e)}function L_(n){const e=Vm(n);return e.length===4?Ee.emptyPath():Fm(e)}function Wo(n){return new Ee(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Fm(n){return ve(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Ku(n,e,t){return{name:Go(n,e),fields:t.value.mapValue.fields}}function V_(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:re(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(h,p){return h.useProto3Json?(ve(p===void 0||typeof p=="string",58123),Xe.fromBase64String(p||"")):(ve(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Xe.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,c=l&&function(h){const p=h.code===void 0?U.UNKNOWN:Pm(h.code);return new Y(p,h.message||"")}(l);t=new Om(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=po(n,r.document.name),a=kt(r.document.updateTime),l=r.document.createTime?kt(r.document.createTime):ae.min(),c=new ft({mapValue:{fields:r.document.fields}}),u=st.newFoundDocument(i,a,l,c),h=r.targetIds||[],p=r.removedTargetIds||[];t=new $i(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=po(n,r.document),a=r.readTime?kt(r.readTime):ae.min(),l=st.newNoDocument(i,a),c=r.removedTargetIds||[];t=new $i([],c,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=po(n,r.document),a=r.removedTargetIds||[];t=new $i([],a,i,null)}else{if(!("filter"in e))return re(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,l=new T_(i,a),c=r.targetId;t=new Dm(c,l)}}return t}function M_(n,e){let t;if(e instanceof Yr)t={update:Ku(n,e.key,e.value)};else if(e instanceof Al)t={delete:Go(n,e.key)};else if(e instanceof dn)t={update:Ku(n,e.key,e.data),updateMask:W_(e.fieldMask)};else{if(!(e instanceof j_))return re(16599,{Vt:e.type});t={verify:Go(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(a,l){const c=l.transform;if(c instanceof ca)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ur)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Br)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ua)return{fieldPath:l.field.canonicalString(),increment:c.Ae};throw re(20930,{transform:l.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:O_(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:re(27497)}(n,e.precondition)),t}function F_(n,e){return n&&n.length>0?(ve(e!==void 0,14353),n.map(t=>function(i,a){let l=i.updateTime?kt(i.updateTime):kt(a);return l.isEqual(ae.min())&&(l=kt(a)),new v_(l,i.transformResults||[])}(t,e))):[]}function U_(n,e){return{documents:[Mm(n,e.path)]}}function B_(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Mm(n,i);const a=function(h){if(h.length!==0)return Bm(Vt.create(h,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const l=function(h){if(h.length!==0)return h.map(p=>function(y){return{field:En(y.field),direction:$_(y.dir)}}(p))}(e.orderBy);l&&(t.structuredQuery.orderBy=l);const c=$o(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:t,parent:i}}function q_(n){let e=L_(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){ve(r===1,65062);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let a=[];t.where&&(a=function(g){const y=Um(g);return y instanceof Vt&&gm(y)?y.getFilters():[y]}(t.where));let l=[];t.orderBy&&(l=function(g){return g.map(y=>function(C){return new la(Tn(C.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(y))}(t.orderBy));let c=null;t.limit&&(c=function(g){let y;return y=typeof g=="object"?g.value:g,Ca(y)?null:y}(t.limit));let u=null;t.startAt&&(u=function(g){const y=!!g.before,_=g.values||[];return new oa(_,y)}(t.startAt));let h=null;return t.endAt&&(h=function(g){const y=!g.before,_=g.values||[];return new oa(_,y)}(t.endAt)),a_(e,i,l,a,c,"F",u,h)}function z_(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return re(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Um(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Tn(t.unaryFilter.field);return Ue.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Tn(t.unaryFilter.field);return Ue.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Tn(t.unaryFilter.field);return Ue.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Tn(t.unaryFilter.field);return Ue.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return re(61313);default:return re(60726)}}(n):n.fieldFilter!==void 0?function(t){return Ue.create(Tn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return re(58110);default:return re(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Vt.create(t.compositeFilter.filters.map(r=>Um(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return re(1026)}}(t.compositeFilter.op))}(n):re(30097,{filter:n})}function $_(n){return R_[n]}function H_(n){return k_[n]}function G_(n){return P_[n]}function En(n){return{fieldPath:n.canonicalString()}}function Tn(n){return Ge.fromServerFormat(n.fieldPath)}function Bm(n){return n instanceof Ue?function(t){if(t.op==="=="){if(Ou(t.value))return{unaryFilter:{field:En(t.field),op:"IS_NAN"}};if(Du(t.value))return{unaryFilter:{field:En(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ou(t.value))return{unaryFilter:{field:En(t.field),op:"IS_NOT_NAN"}};if(Du(t.value))return{unaryFilter:{field:En(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:En(t.field),op:H_(t.op),value:t.value}}}(n):n instanceof Vt?function(t){const r=t.getFilters().map(i=>Bm(i));return r.length===1?r[0]:{compositeFilter:{op:G_(t.op),filters:r}}}(n):re(54877,{filter:n})}function W_(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function qm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,t,r,i,a=ae.min(),l=ae.min(),c=Xe.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new ps(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e){this.yt=e}}function Q_(n){const e=q_({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?zo(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(){this.Cn=new Y_}addToCollectionParentIndex(e,t){return this.Cn.add(t),F.resolve()}getCollectionParents(e,t){return F.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return F.resolve()}deleteFieldIndex(e,t){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,t){return F.resolve()}getDocumentsMatchingTarget(e,t){return F.resolve(null)}getIndexType(e,t){return F.resolve(0)}getFieldIndexes(e,t){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,t){return F.resolve(js.min())}getMinOffsetFromCollectionGroup(e,t){return F.resolve(js.min())}updateCollectionGroup(e,t,r){return F.resolve()}updateIndexEntries(e,t){return F.resolve()}}class Y_{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Be(Ee.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Be(Ee.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zm=41943040;class ct{static withCacheSize(e){return new ct(e,ct.DEFAULT_COLLECTION_PERCENTILE,ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ct.DEFAULT_COLLECTION_PERCENTILE=10,ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ct.DEFAULT=new ct(zm,ct.DEFAULT_COLLECTION_PERCENTILE,ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ct.DISABLED=new ct(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new qn(0)}static cr(){return new qn(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu="LruGarbageCollector",J_=1048576;function Yu([n,e],[t,r]){const i=pe(n,t);return i===0?pe(e,r):i}class Z_{constructor(e){this.Ir=e,this.buffer=new Be(Yu),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Yu(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ew{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){K(Xu,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Kn(t)?K(Xu,"Ignoring IndexedDB error during garbage collection: ",t):await Wn(t)}await this.Vr(3e5)})}}class tw{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return F.resolve(Aa.ce);const r=new Z_(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(Qu)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Qu):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,a,l,c,u,h;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,l=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(r=g,c=Date.now(),this.removeTargets(e,r,t))).next(g=>(a=g,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(h=Date.now(),jn()<=me.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${i} in `+(c-l)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-p}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:g})))}}function sw(n,e){return new tw(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(){this.changes=new un(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,st.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?F.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ir(r.mutation,i,_t.empty(),Te.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,fe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=fe()){const i=Hs();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let l=br();return a.forEach((c,u)=>{l=l.insert(c,u.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const r=Hs();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,fe()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,c)=>{t.set(l,c)})})}computeViews(e,t,r,i){let a=Zt();const l=Tr(),c=function(){return Tr()}();return t.forEach((u,h)=>{const p=r.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof dn)?a=a.insert(h.key,h):p!==void 0?(l.set(h.key,p.mutation.getFieldMask()),Ir(p.mutation,h,p.mutation.getFieldMask(),Te.now())):l.set(h.key,_t.empty())}),this.recalculateAndSaveOverlays(e,a).next(u=>(u.forEach((h,p)=>l.set(h,p)),t.forEach((h,p)=>c.set(h,new rw(p,l.get(h)??null))),c))}recalculateAndSaveOverlays(e,t){const r=Tr();let i=new Ae((l,c)=>l-c),a=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const c of l)c.keys().forEach(u=>{const h=t.get(u);if(h===null)return;let p=r.get(u)||_t.empty();p=c.applyToLocalView(h,p),r.set(u,p);const g=(i.get(c.batchId)||fe()).add(u);i=i.insert(c.batchId,g)})}).next(()=>{const l=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,p=u.value,g=Em();p.forEach(y=>{if(!a.has(y)){const _=Rm(t.get(y),r.get(y));_!==null&&g.set(y,_),a=a.add(y)}}),l.push(this.documentOverlayCache.saveOverlays(e,h,g))}return F.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(l){return Z.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):o_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):F.resolve(Hs());let c=Lr,u=a;return l.next(h=>F.forEach(h,(p,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),a.get(p)?F.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{u=u.insert(p,y)}))).next(()=>this.populateOverlays(e,h,a)).next(()=>this.computeViews(e,u,h,fe())).next(p=>({batchId:c,changes:Nm(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Z(t)).next(r=>{let i=br();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let l=br();return this.indexManager.getCollectionParents(e,a).next(c=>F.forEach(c,u=>{const h=function(g,y){return new ka(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(t,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(p=>{p.forEach((g,y)=>{l=l.insert(g,y)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i))).next(l=>{a.forEach((u,h)=>{const p=h.getKey();l.get(p)===null&&(l=l.insert(p,st.newInvalidDocument(p)))});let c=br();return l.forEach((u,h)=>{const p=a.get(u);p!==void 0&&Ir(p.mutation,h,_t.empty(),Te.now()),Da(t,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return F.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:kt(i.createTime)}}(t)),F.resolve()}getNamedQuery(e,t){return F.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(i){return{name:i.name,query:Q_(i.bundledQuery),readTime:kt(i.readTime)}}(t)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(){this.overlays=new Ae(Z.comparator),this.qr=new Map}getOverlay(e,t){return F.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Hs();return F.forEach(t,i=>this.getOverlay(e,i).next(a=>{a!==null&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.St(e,t,a)}),F.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(r)),F.resolve()}getOverlaysForCollection(e,t,r){const i=Hs(),a=t.length+1,l=new Z(t.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return F.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new Ae((h,p)=>h-p);const l=this.overlays.getIterator();for(;l.hasNext();){const h=l.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let p=a.get(h.largestBatchId);p===null&&(p=Hs(),a=a.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const c=Hs(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>c.set(h,p)),!(c.size()>=i)););return F.resolve(c)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new E_(t,r));let a=this.qr.get(t);a===void 0&&(a=fe(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(){this.sessionToken=Xe.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(){this.Qr=new Be(qe.$r),this.Ur=new Be(qe.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new qe(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new qe(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){const t=new Z(new Ee([])),r=new qe(t,e),i=new qe(t,e+1),a=[];return this.Ur.forEachInRange([r,i],l=>{this.Gr(l),a.push(l.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Z(new Ee([])),r=new qe(t,e),i=new qe(t,e+1);let a=fe();return this.Ur.forEachInRange([r,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new qe(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class qe{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Z.comparator(e.key,t.key)||pe(e.Yr,t.Yr)}static Kr(e,t){return pe(e.Yr,t.Yr)||Z.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Be(qe.$r)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new N_(a,t,r,i);this.mutationQueue.push(l);for(const c of i)this.Zr=this.Zr.add(new qe(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return F.resolve(l)}lookupMutationBatch(e,t){return F.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),a=i<0?0:i;return F.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?jl:this.tr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new qe(t,0),i=new qe(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],l=>{const c=this.Xr(l.Yr);a.push(c)}),F.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Be(pe);return t.forEach(i=>{const a=new qe(i,0),l=new qe(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],c=>{r=r.add(c.Yr)})}),F.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;Z.isDocumentKey(a)||(a=a.child(""));const l=new qe(new Z(a),0);let c=new Be(pe);return this.Zr.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Yr)),!0)},l),F.resolve(this.ti(c))}ti(e){const t=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ve(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return F.forEach(t.mutations,i=>{const a=new qe(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){const r=new qe(t,0),i=this.Zr.firstAfterOrEqual(r);return F.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e){this.ri=e,this.docs=function(){return new Ae(Z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,l=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return F.resolve(r?r.document.mutableCopy():st.newInvalidDocument(t))}getEntries(e,t){let r=Zt();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():st.newInvalidDocument(i))}),F.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=Zt();const l=t.path,c=new Z(l.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!l.isPrefixOf(h.path))break;h.path.length>l.length+1||Mv(Vv(p),r)<=0||(i.has(p.key)||Da(t,p))&&(a=a.insert(p.key,p.mutableCopy()))}return F.resolve(a)}getAllFromCollectionGroup(e,t,r,i){re(9500)}ii(e,t){return F.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new dw(this)}getSize(e){return F.resolve(this.size)}}class dw extends nw{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),F.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e){this.persistence=e,this.si=new un(t=>Tl(t),Il),this.lastRemoteSnapshotVersion=ae.min(),this.highestTargetId=0,this.oi=0,this._i=new Pl,this.targetCount=0,this.ai=qn.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),F.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new qn(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,F.resolve()}updateTargetData(e,t){return this.Pr(t),F.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.si.forEach((l,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),F.waitFor(a).next(()=>i)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return F.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),F.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),F.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),F.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return F.resolve(r)}containsKey(e,t){return F.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m{constructor(e,t){this.ui={},this.overlays={},this.ci=new Aa(0),this.li=!1,this.li=!0,this.hi=new lw,this.referenceDelegate=e(this),this.Pi=new hw(this),this.indexManager=new X_,this.remoteDocumentCache=function(i){return new uw(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new K_(t),this.Ii=new aw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ow,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new cw(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){K("MemoryPersistence","Starting transaction:",e);const i=new mw(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ai(e,t){return F.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}}class mw extends Uv{constructor(e){super(),this.currentSequenceNumber=e}}class Dl{constructor(e){this.persistence=e,this.Ri=new Pl,this.Vi=null}static mi(e){return new Dl(e)}get fi(){if(this.Vi)return this.Vi;throw re(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),F.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),F.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.fi.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.fi,r=>{const i=Z.fromPath(r);return this.gi(e,i).next(a=>{a||t.removeEntry(i,ae.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return F.or([()=>F.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class ha{constructor(e,t){this.persistence=e,this.pi=new un(r=>zv(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=sw(this,t)}static mi(e,t){return new ha(e,t)}Ei(){}di(e){return F.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return F.forEach(this.pi,(r,i)=>this.br(e,r,i).next(a=>a?F.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,l=>this.br(e,l,t).next(c=>{c||(r++,a.removeEntry(l,ae.min()))})).next(()=>a.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),F.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),F.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),F.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Bi(e.data.value)),t}br(e,t,r){return F.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return F.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=fe(),i=fe();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Ol(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Dg()?8:Bv(nt())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.ys(e,t).next(l=>{a.result=l}).next(()=>{if(!a.result)return this.ws(e,t,i,r).next(l=>{a.result=l})}).next(()=>{if(a.result)return;const l=new pw;return this.Ss(e,t,l).next(c=>{if(a.result=c,this.Vs)return this.bs(e,t,l,c.size)})}).next(()=>a.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(jn()<=me.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",Nn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),F.resolve()):(jn()<=me.DEBUG&&K("QueryEngine","Query:",Nn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(jn()<=me.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",Nn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ct(t))):F.resolve())}ys(e,t){if(Fu(t))return F.resolve(null);let r=Ct(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=zo(t,null,"F"),r=Ct(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const l=fe(...a);return this.ps.getDocuments(e,l).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.Ds(t,c);return this.Cs(t,h,l,u.readTime)?this.ys(e,zo(t,null,"F")):this.vs(e,h,t,u)}))})))}ws(e,t,r,i){return Fu(t)||i.isEqual(ae.min())?F.resolve(null):this.ps.getDocuments(e,r).next(a=>{const l=this.Ds(t,a);return this.Cs(t,l,r,i)?F.resolve(null):(jn()<=me.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Nn(t)),this.vs(e,l,t,Lv(i,Lr)).next(c=>c))})}Ds(e,t){let r=new Be(wm(e));return t.forEach((i,a)=>{Da(e,a)&&(r=r.add(a))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,r){return jn()<=me.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Nn(t)),this.ps.getDocumentsMatchingQuery(e,t,js.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll="LocalStore",gw=3e8;class xw{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Ae(pe),this.xs=new un(a=>Tl(a),Il),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new iw(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function yw(n,e,t,r){return new xw(n,e,t,r)}async function Hm(n,e){const t=le(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const l=[],c=[];let u=fe();for(const h of i){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of a){c.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return t.localDocuments.getDocuments(r,u).next(h=>({Ls:h,removedBatchIds:l,addedBatchIds:c}))})})}function bw(n,e){const t=le(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,h,p){const g=h.batch,y=g.keys();let _=F.resolve();return y.forEach(C=>{_=_.next(()=>p.getEntry(u,C)).next(E=>{const N=h.docVersions.get(C);ve(N!==null,48541),E.version.compareTo(N)<0&&(g.applyToRemoteDocument(E,h),E.isValidDocument()&&(E.setReadTime(h.commitVersion),p.addEntry(E)))})}),_.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=fe();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Gm(n){const e=le(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function vw(n,e){const t=le(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach((p,g)=>{const y=i.get(g);if(!y)return;c.push(t.Pi.removeMatchingKeys(a,p.removedDocuments,g).next(()=>t.Pi.addMatchingKeys(a,p.addedDocuments,g)));let _=y.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(g)!==null?_=_.withResumeToken(Xe.EMPTY_BYTE_STRING,ae.min()).withLastLimboFreeSnapshotVersion(ae.min()):p.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(p.resumeToken,r)),i=i.insert(g,_),function(E,N,k){return E.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=gw?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(y,_,p)&&c.push(t.Pi.updateTargetData(a,_))});let u=Zt(),h=fe();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,p))}),c.push(_w(a,l,e.documentUpdates).next(p=>{u=p.ks,h=p.qs})),!r.isEqual(ae.min())){const p=t.Pi.getLastRemoteSnapshotVersion(a).next(g=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r));c.push(p)}return F.waitFor(c).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,u,h)).next(()=>u)}).then(a=>(t.Ms=i,a))}function _w(n,e,t){let r=fe(),i=fe();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let l=Zt();return t.forEach((c,u)=>{const h=a.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(ae.min())?(e.removeEntry(c,u.readTime),l=l.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),l=l.insert(c,u)):K(Ll,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{ks:l,qs:i}})}function ww(n,e){const t=le(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=jl),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function jw(n,e){const t=le(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Pi.getTargetData(r,e).next(a=>a?(i=a,F.resolve(i)):t.Pi.allocateTargetId(r).next(l=>(i=new ps(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function Ko(n,e,t){const r=le(n),i=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,l=>r.persistence.referenceDelegate.removeTarget(l,i))}catch(l){if(!Kn(l))throw l;K(Ll,`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Ju(n,e,t){const r=le(n);let i=ae.min(),a=fe();return r.persistence.runTransaction("Execute query","readwrite",l=>function(u,h,p){const g=le(u),y=g.xs.get(p);return y!==void 0?F.resolve(g.Ms.get(y)):g.Pi.getTargetData(h,p)}(r,l,Ct(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(l,c.targetId).next(u=>{a=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(l,e,t?i:ae.min(),t?a:fe())).next(c=>(Nw(r,c_(e),c),{documents:c,Qs:a})))}function Nw(n,e,t){let r=n.Os.get(e)||ae.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Os.set(e,r)}class Zu{constructor(){this.activeTargetIds=f_()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ew{constructor(){this.Mo=new Zu,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Zu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ed="ConnectivityMonitor";class td{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){K(ed,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){K(ed,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pi=null;function Qo(){return Pi===null?Pi=function(){return 268435456+Math.round(2147483648*Math.random())}():Pi++,"0x"+Pi.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo="RestConnection",Iw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Sw{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===ia?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,a){const l=Qo(),c=this.zo(e,t.toUriEncodedString());K(fo,`Sending RPC '${e}' ${l}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:h}=new URL(c),p=As(h);return this.Jo(e,c,u,r,p).then(g=>(K(fo,`Received RPC '${e}' ${l}: `,g),g),g=>{throw Mn(fo,`RPC '${e}' ${l} failed with error: `,g,"url: ",c,"request:",r),g})}Ho(e,t,r,i,a,l){return this.Go(e,t,r,i,a)}jo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Gn}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}zo(e,t){const r=Iw[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const et="WebChannelConnection";class Cw extends Sw{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,a){const l=Qo();return new Promise((c,u)=>{const h=new Qh;h.setWithCredentials(!0),h.listenOnce(Xh.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Ui.NO_ERROR:const g=h.getResponseJson();K(et,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(g)),c(g);break;case Ui.TIMEOUT:K(et,`RPC '${e}' ${l} timed out`),u(new Y(U.DEADLINE_EXCEEDED,"Request time out"));break;case Ui.HTTP_ERROR:const y=h.getStatus();if(K(et,`RPC '${e}' ${l} failed with status:`,y,"response text:",h.getResponseText()),y>0){let _=h.getResponseJson();Array.isArray(_)&&(_=_[0]);const C=_?.error;if(C&&C.status&&C.message){const E=function(k){const R=k.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(R)>=0?R:U.UNKNOWN}(C.status);u(new Y(E,C.message))}else u(new Y(U.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Y(U.UNAVAILABLE,"Connection failed."));break;default:re(9055,{l_:e,streamId:l,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{K(et,`RPC '${e}' ${l} completed.`)}});const p=JSON.stringify(i);K(et,`RPC '${e}' ${l} sending request:`,i),h.send(t,"POST",p,r,15)})}T_(e,t,r){const i=Qo(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=Zh(),c=Jh(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const p=a.join("");K(et,`Creating RPC '${e}' stream ${i}: ${p}`,u);const g=l.createWebChannel(p,u);this.I_(g);let y=!1,_=!1;const C=new Aw({Yo:N=>{_?K(et,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(y||(K(et,`Opening RPC '${e}' stream ${i} transport.`),g.open(),y=!0),K(et,`RPC '${e}' stream ${i} sending:`,N),g.send(N))},Zo:()=>g.close()}),E=(N,k,R)=>{N.listen(k,P=>{try{R(P)}catch(V){setTimeout(()=>{throw V},0)}})};return E(g,yr.EventType.OPEN,()=>{_||(K(et,`RPC '${e}' stream ${i} transport opened.`),C.o_())}),E(g,yr.EventType.CLOSE,()=>{_||(_=!0,K(et,`RPC '${e}' stream ${i} transport closed`),C.a_(),this.E_(g))}),E(g,yr.EventType.ERROR,N=>{_||(_=!0,Mn(et,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),C.a_(new Y(U.UNAVAILABLE,"The operation could not be completed")))}),E(g,yr.EventType.MESSAGE,N=>{if(!_){const k=N.data[0];ve(!!k,16349);const R=k,P=R?.error||R[0]?.error;if(P){K(et,`RPC '${e}' stream ${i} received error:`,P);const V=P.status;let B=function(f){const w=Le[f];if(w!==void 0)return Pm(w)}(V),O=P.message;B===void 0&&(B=U.INTERNAL,O="Unknown error status: "+V+" with message "+P.message),_=!0,C.a_(new Y(B,O)),g.close()}else K(et,`RPC '${e}' stream ${i} received:`,k),C.u_(k)}}),E(c,Yh.STAT_EVENT,N=>{N.stat===Vo.PROXY?K(et,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Vo.NOPROXY&&K(et,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function go(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ma(n){return new D_(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&K("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sd="PersistentStream";class Km{constructor(e,t,r,i,a,l,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Wm(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===U.RESOURCE_EXHAUSTED?(Jt(t.toString()),Jt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{const i=new Y(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return K(sd,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(K(sd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Rw extends Km{constructor(e,t,r,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=V_(this.serializer,e),r=function(a){if(!("targetChange"in a))return ae.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?ae.min():l.readTime?kt(l.readTime):ae.min()}(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Wo(this.serializer),t.addTarget=function(a,l){let c;const u=l.target;if(c=qo(u)?{documents:U_(a,u)}:{query:B_(a,u).ft},c.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){c.resumeToken=Lm(a,l.resumeToken);const h=$o(a,l.expectedCount);h!==null&&(c.expectedCount=h)}else if(l.snapshotVersion.compareTo(ae.min())>0){c.readTime=da(a,l.snapshotVersion.toTimestamp());const h=$o(a,l.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const r=z_(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Wo(this.serializer),t.removeTarget=e,this.q_(t)}}class kw extends Km{constructor(e,t,r,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ve(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ve(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ve(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=F_(e.writeResults,e.commitTime),r=kt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Wo(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>M_(this.serializer,r))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{}class Dw extends Pw{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Y(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Go(e,Ho(t,r),i,a,l)).catch(a=>{throw a.name==="FirebaseError"?(a.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Y(U.UNKNOWN,a.toString())})}Ho(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,c])=>this.connection.Ho(e,Ho(t,r),i,l,c,a)).catch(l=>{throw l.name==="FirebaseError"?(l.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Y(U.UNKNOWN,l.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Ow{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Jt(t),this.aa=!1):K("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const an="RemoteStore";class Lw{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(l=>{r.enqueueAndForget(async()=>{hn(this)&&(K(an,"Restarting streams for network reachability change."),await async function(u){const h=le(u);h.Ea.add(4),await Zr(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Fa(h)}(this))})}),this.Ra=new Ow(r,i)}}async function Fa(n){if(hn(n))for(const e of n.da)await e(!0)}async function Zr(n){for(const e of n.da)await e(!1)}function Qm(n,e){const t=le(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Ul(t)?Fl(t):Qn(t).O_()&&Ml(t,e))}function Vl(n,e){const t=le(n),r=Qn(t);t.Ia.delete(e),r.O_()&&Xm(t,e),t.Ia.size===0&&(r.O_()?r.L_():hn(t)&&t.Ra.set("Unknown"))}function Ml(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ae.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Qn(n).Y_(e)}function Xm(n,e){n.Va.Ue(e),Qn(n).Z_(e)}function Fl(n){n.Va=new C_({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Qn(n).start(),n.Ra.ua()}function Ul(n){return hn(n)&&!Qn(n).x_()&&n.Ia.size>0}function hn(n){return le(n).Ea.size===0}function Ym(n){n.Va=void 0}async function Vw(n){n.Ra.set("Online")}async function Mw(n){n.Ia.forEach((e,t)=>{Ml(n,e)})}async function Fw(n,e){Ym(n),Ul(n)?(n.Ra.ha(e),Fl(n)):n.Ra.set("Unknown")}async function Uw(n,e,t){if(n.Ra.set("Online"),e instanceof Om&&e.state===2&&e.cause)try{await async function(i,a){const l=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,l),i.Ia.delete(c),i.Va.removeTarget(c))}(n,e)}catch(r){K(an,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ma(n,r)}else if(e instanceof $i?n.Va.Ze(e):e instanceof Dm?n.Va.st(e):n.Va.tt(e),!t.isEqual(ae.min()))try{const r=await Gm(n.localStore);t.compareTo(r)>=0&&await function(a,l){const c=a.Va.Tt(l);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=a.Ia.get(h);p&&a.Ia.set(h,p.withResumeToken(u.resumeToken,l))}}),c.targetMismatches.forEach((u,h)=>{const p=a.Ia.get(u);if(!p)return;a.Ia.set(u,p.withResumeToken(Xe.EMPTY_BYTE_STRING,p.snapshotVersion)),Xm(a,u);const g=new ps(p.target,u,h,p.sequenceNumber);Ml(a,g)}),a.remoteSyncer.applyRemoteEvent(c)}(n,t)}catch(r){K(an,"Failed to raise snapshot:",r),await ma(n,r)}}async function ma(n,e,t){if(!Kn(e))throw e;n.Ea.add(1),await Zr(n),n.Ra.set("Offline"),t||(t=()=>Gm(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{K(an,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Fa(n)})}function Jm(n,e){return e().catch(t=>ma(n,t,e))}async function Ua(n){const e=le(n),t=Is(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:jl;for(;Bw(e);)try{const i=await ww(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,qw(e,i)}catch(i){await ma(e,i)}Zm(e)&&ep(e)}function Bw(n){return hn(n)&&n.Ta.length<10}function qw(n,e){n.Ta.push(e);const t=Is(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Zm(n){return hn(n)&&!Is(n).x_()&&n.Ta.length>0}function ep(n){Is(n).start()}async function zw(n){Is(n).ra()}async function $w(n){const e=Is(n);for(const t of n.Ta)e.ea(t.mutations)}async function Hw(n,e,t){const r=n.Ta.shift(),i=Cl.from(r,e,t);await Jm(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Ua(n)}async function Gw(n,e){e&&Is(n).X_&&await async function(r,i){if(function(l){return I_(l)&&l!==U.ABORTED}(i.code)){const a=r.Ta.shift();Is(r).B_(),await Jm(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Ua(r)}}(n,e),Zm(n)&&ep(n)}async function nd(n,e){const t=le(n);t.asyncQueue.verifyOperationInProgress(),K(an,"RemoteStore received new credentials");const r=hn(t);t.Ea.add(3),await Zr(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Fa(t)}async function Ww(n,e){const t=le(n);e?(t.Ea.delete(2),await Fa(t)):e||(t.Ea.add(2),await Zr(t),t.Ra.set("Unknown"))}function Qn(n){return n.ma||(n.ma=function(t,r,i){const a=le(t);return a.sa(),new Rw(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(n.datastore,n.asyncQueue,{Xo:Vw.bind(null,n),t_:Mw.bind(null,n),r_:Fw.bind(null,n),H_:Uw.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),Ul(n)?Fl(n):n.Ra.set("Unknown")):(await n.ma.stop(),Ym(n))})),n.ma}function Is(n){return n.fa||(n.fa=function(t,r,i){const a=le(t);return a.sa(),new kw(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:zw.bind(null,n),r_:Gw.bind(null,n),ta:$w.bind(null,n),na:Hw.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Ua(n)):(await n.fa.stop(),n.Ta.length>0&&(K(an,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new vs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const l=Date.now()+r,c=new Bl(e,t,l,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ql(n,e){if(Jt("AsyncQueue",`${e}: ${n}`),Kn(n))return new Y(U.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{static emptySet(e){return new kn(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Z.comparator(t.key,r.key):(t,r)=>Z.comparator(t.key,r.key),this.keyedMap=br(),this.sortedSet=new Ae(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof kn)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new kn;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(){this.ga=new Ae(Z.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):re(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class zn{constructor(e,t,r,i,a,l,c,u,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,a){const l=[];return t.forEach(c=>{l.push({type:0,doc:c})}),new zn(e,t,kn.emptySet(t),l,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Qw{constructor(){this.queries=id(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=le(t),a=i.queries;i.queries=id(),a.forEach((l,c)=>{for(const u of c.Sa)u.onError(r)})})(this,new Y(U.ABORTED,"Firestore shutting down"))}}function id(){return new un(n=>_m(n),Pa)}async function Xw(n,e){const t=le(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new Kw,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(l){const c=ql(l,`Initialization of query '${Nn(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&zl(t)}async function Yw(n,e){const t=le(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const l=a.Sa.indexOf(e);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Jw(n,e){const t=le(n);let r=!1;for(const i of e){const a=i.query,l=t.queries.get(a);if(l){for(const c of l.Sa)c.Fa(i)&&(r=!0);l.wa=i}}r&&zl(t)}function Zw(n,e,t){const r=le(n),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);r.queries.delete(e)}function zl(n){n.Ca.forEach(e=>{e.next()})}var Xo,ad;(ad=Xo||(Xo={})).Ma="default",ad.Cache="cache";class ej{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new zn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=zn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Xo.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e){this.key=e}}class sp{constructor(e){this.key=e}}class tj{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=fe(),this.mutatedKeys=fe(),this.eu=wm(e),this.tu=new kn(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new rd,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,g)=>{const y=i.get(p),_=Da(this.query,g)?g:null,C=!!y&&this.mutatedKeys.has(y.key),E=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let N=!1;y&&_?y.data.isEqual(_.data)?C!==E&&(r.track({type:3,doc:_}),N=!0):this.su(y,_)||(r.track({type:2,doc:_}),N=!0,(u&&this.eu(_,u)>0||h&&this.eu(_,h)<0)&&(c=!0)):!y&&_?(r.track({type:0,doc:_}),N=!0):y&&!_&&(r.track({type:1,doc:y}),N=!0,(u||h)&&(c=!0)),N&&(_?(l=l.add(_),a=E?a.add(p):a.delete(p)):(l=l.delete(p),a=a.delete(p)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const p=this.query.limitType==="F"?l.last():l.first();l=l.delete(p.key),a=a.delete(p.key),r.track({type:1,doc:p})}return{tu:l,iu:r,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort((p,g)=>function(_,C){const E=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return re(20277,{Rt:N})}};return E(_)-E(C)}(p.type,g.type)||this.eu(p.doc,g.doc)),this.ou(r),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,h=u!==this.Za;return this.Za=u,l.length!==0||h?{snapshot:new zn(this.query,e.tu,a,l,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new rd,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=fe(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new sp(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new tp(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=fe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return zn.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const $l="SyncEngine";class sj{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class nj{constructor(e){this.key=e,this.hu=!1}}class rj{constructor(e,t,r,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new un(c=>_m(c),Pa),this.Iu=new Map,this.Eu=new Set,this.du=new Ae(Z.comparator),this.Au=new Map,this.Ru=new Pl,this.Vu={},this.mu=new Map,this.fu=qn.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function ij(n,e,t=!0){const r=lp(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await np(r,e,t,!0),i}async function aj(n,e){const t=lp(n);await np(t,e,!0,!1)}async function np(n,e,t,r){const i=await jw(n.localStore,Ct(e)),a=i.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let c;return r&&(c=await oj(n,e,a,l==="current",i.resumeToken)),n.isPrimaryClient&&t&&Qm(n.remoteStore,i),c}async function oj(n,e,t,r,i){n.pu=(g,y,_)=>async function(E,N,k,R){let P=N.view.ru(k);P.Cs&&(P=await Ju(E.localStore,N.query,!1).then(({documents:j})=>N.view.ru(j,P)));const V=R&&R.targetChanges.get(N.targetId),B=R&&R.targetMismatches.get(N.targetId)!=null,O=N.view.applyChanges(P,E.isPrimaryClient,V,B);return ld(E,N.targetId,O.au),O.snapshot}(n,g,y,_);const a=await Ju(n.localStore,e,!0),l=new tj(e,a.Qs),c=l.ru(a.documents),u=Jr.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=l.applyChanges(c,n.isPrimaryClient,u);ld(n,t,h.au);const p=new sj(e,t,l);return n.Tu.set(e,p),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function lj(n,e,t){const r=le(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter(l=>!Pa(l,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ko(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Vl(r.remoteStore,i.targetId),Yo(r,i.targetId)}).catch(Wn)):(Yo(r,i.targetId),await Ko(r.localStore,i.targetId,!0))}async function cj(n,e){const t=le(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Vl(t.remoteStore,r.targetId))}async function uj(n,e,t){const r=xj(n);try{const i=await function(l,c){const u=le(l),h=Te.now(),p=c.reduce((_,C)=>_.add(C.key),fe());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let C=Zt(),E=fe();return u.Ns.getEntries(_,p).next(N=>{C=N,C.forEach((k,R)=>{R.isValidDocument()||(E=E.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,C)).next(N=>{g=N;const k=[];for(const R of c){const P=w_(R,g.get(R.key).overlayedDocument);P!=null&&k.push(new dn(R.key,P,mm(P.value.mapValue),Rt.exists(!0)))}return u.mutationQueue.addMutationBatch(_,h,k,c)}).next(N=>{y=N;const k=N.applyToLocalDocumentSet(g,E);return u.documentOverlayCache.saveOverlays(_,N.batchId,k)})}).then(()=>({batchId:y.batchId,changes:Nm(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(l,c,u){let h=l.Vu[l.currentUser.toKey()];h||(h=new Ae(pe)),h=h.insert(c,u),l.Vu[l.currentUser.toKey()]=h}(r,i.batchId,t),await ei(r,i.changes),await Ua(r.remoteStore)}catch(i){const a=ql(i,"Failed to persist write");t.reject(a)}}async function rp(n,e){const t=le(n);try{const r=await vw(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.Au.get(a);l&&(ve(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?ve(l.hu,14607):i.removedDocuments.size>0&&(ve(l.hu,42227),l.hu=!1))}),await ei(t,r,e)}catch(r){await Wn(r)}}function od(n,e,t){const r=le(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach((a,l)=>{const c=l.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(l,c){const u=le(l);u.onlineState=c;let h=!1;u.queries.forEach((p,g)=>{for(const y of g.Sa)y.va(c)&&(h=!0)}),h&&zl(u)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function dj(n,e,t){const r=le(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let l=new Ae(Z.comparator);l=l.insert(a,st.newNoDocument(a,ae.min()));const c=fe().add(a),u=new Va(ae.min(),new Map,new Ae(pe),l,c);await rp(r,u),r.du=r.du.remove(a),r.Au.delete(e),Hl(r)}else await Ko(r.localStore,e,!1).then(()=>Yo(r,e,t)).catch(Wn)}async function hj(n,e){const t=le(n),r=e.batch.batchId;try{const i=await bw(t.localStore,e);ap(t,r,null),ip(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ei(t,i)}catch(i){await Wn(i)}}async function mj(n,e,t){const r=le(n);try{const i=await function(l,c){const u=le(l);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(ve(g!==null,37113),p=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(r.localStore,e);ap(r,e,t),ip(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ei(r,i)}catch(i){await Wn(i)}}function ip(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function ap(n,e,t){const r=le(n);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Yo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||op(n,r)})}function op(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Vl(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Hl(n))}function ld(n,e,t){for(const r of t)r instanceof tp?(n.Ru.addReference(r.key,e),pj(n,r)):r instanceof sp?(K($l,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||op(n,r.key)):re(19791,{wu:r})}function pj(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(K($l,"New document in limbo: "+t),n.Eu.add(r),Hl(n))}function Hl(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Z(Ee.fromString(e)),r=n.fu.next();n.Au.set(r,new nj(t)),n.du=n.du.insert(t,r),Qm(n.remoteStore,new ps(Ct(vm(t.path)),r,"TargetPurposeLimboResolution",Aa.ce))}}async function ei(n,e,t){const r=le(n),i=[],a=[],l=[];r.Tu.isEmpty()||(r.Tu.forEach((c,u)=>{l.push(r.pu(u,e,t).then(h=>{if((h||t)&&r.isPrimaryClient){const p=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(h){i.push(h);const p=Ol.As(u.targetId,h);a.push(p)}}))}),await Promise.all(l),r.Pu.H_(i),await async function(u,h){const p=le(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>F.forEach(h,y=>F.forEach(y.Es,_=>p.persistence.referenceDelegate.addReference(g,y.targetId,_)).next(()=>F.forEach(y.ds,_=>p.persistence.referenceDelegate.removeReference(g,y.targetId,_)))))}catch(g){if(!Kn(g))throw g;K(Ll,"Failed to update sequence numbers: "+g)}for(const g of h){const y=g.targetId;if(!g.fromCache){const _=p.Ms.get(y),C=_.snapshotVersion,E=_.withLastLimboFreeSnapshotVersion(C);p.Ms=p.Ms.insert(y,E)}}}(r.localStore,a))}async function fj(n,e){const t=le(n);if(!t.currentUser.isEqual(e)){K($l,"User change. New user:",e.toKey());const r=await Hm(t.localStore,e);t.currentUser=e,function(a,l){a.mu.forEach(c=>{c.forEach(u=>{u.reject(new Y(U.CANCELLED,l))})}),a.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ei(t,r.Ls)}}function gj(n,e){const t=le(n),r=t.Au.get(e);if(r&&r.hu)return fe().add(r.key);{let i=fe();const a=t.Iu.get(e);if(!a)return i;for(const l of a){const c=t.Tu.get(l);i=i.unionWith(c.view.nu)}return i}}function lp(n){const e=le(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=rp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dj.bind(null,e),e.Pu.H_=Jw.bind(null,e.eventManager),e.Pu.yu=Zw.bind(null,e.eventManager),e}function xj(n){const e=le(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mj.bind(null,e),e}class pa{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ma(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return yw(this.persistence,new fw,e.initialUser,this.serializer)}Cu(e){return new $m(Dl.mi,this.serializer)}Du(e){return new Ew}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}pa.provider={build:()=>new pa};class yj extends pa{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ve(this.persistence.referenceDelegate instanceof ha,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ew(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ct.withCacheSize(this.cacheSizeBytes):ct.DEFAULT;return new $m(r=>ha.mi(r,t),this.serializer)}}class Jo{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>od(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=fj.bind(null,this.syncEngine),await Ww(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Qw}()}createDatastore(e){const t=Ma(e.databaseInfo.databaseId),r=function(a){return new Cw(a)}(e.databaseInfo);return function(a,l,c,u){return new Dw(a,l,c,u)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,a,l,c){return new Lw(r,i,a,l,c)}(this.localStore,this.datastore,e.asyncQueue,t=>od(this.syncEngine,t,0),function(){return td.v()?new td:new Tw}())}createSyncEngine(e,t){return function(i,a,l,c,u,h,p){const g=new rj(i,a,l,c,u,h);return p&&(g.gu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(t){const r=le(t);K(an,"RemoteStore shutting down."),r.Ea.add(5),await Zr(r),r.Aa.shutdown(),r.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Jo.provider={build:()=>new Jo};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Jt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss="FirestoreClient";class vj{constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=tt.UNAUTHENTICATED,this.clientId=_l.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async l=>{K(Ss,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(r,l=>(K(Ss,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=ql(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function xo(n,e){n.asyncQueue.verifyOperationInProgress(),K(Ss,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Hm(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function cd(n,e){n.asyncQueue.verifyOperationInProgress();const t=await _j(n);K(Ss,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>nd(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>nd(e.remoteStore,i)),n._onlineComponents=e}async function _j(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){K(Ss,"Using user provided OfflineComponentProvider");try{await xo(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Mn("Error using user provided cache. Falling back to memory cache: "+t),await xo(n,new pa)}}else K(Ss,"Using default OfflineComponentProvider"),await xo(n,new yj(void 0));return n._offlineComponents}async function cp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(K(Ss,"Using user provided OnlineComponentProvider"),await cd(n,n._uninitializedComponentsProvider._online)):(K(Ss,"Using default OnlineComponentProvider"),await cd(n,new Jo))),n._onlineComponents}function wj(n){return cp(n).then(e=>e.syncEngine)}async function jj(n){const e=await cp(n),t=e.eventManager;return t.onListen=ij.bind(null,e.syncEngine),t.onUnlisten=lj.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=aj.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=cj.bind(null,e.syncEngine),t}function Nj(n,e,t={}){const r=new vs;return n.asyncQueue.enqueueAndForget(async()=>function(a,l,c,u,h){const p=new bj({next:y=>{p.Nu(),l.enqueueAndForget(()=>Yw(a,g)),y.fromCache&&u.source==="server"?h.reject(new Y(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new ej(c,p,{includeMetadataChanges:!0,qa:!0});return Xw(a,g)}(await jj(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function up(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ud=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp="firestore.googleapis.com",dd=!0;class hd{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Y(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=dp,this.ssl=dd}else this.host=e.host,this.ssl=e.ssl??dd;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=zm;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<J_)throw new Y(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Ov("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=up(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Y(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Y(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Y(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ba{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hd({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Y(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Y(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hd(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Ev;switch(r.type){case"firstParty":return new Av(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Y(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=ud.get(t);r&&(K("ComponentProvider","Removing Datastore"),ud.delete(t),r.terminate())}(this),Promise.resolve()}}function Ej(n,e,t,r={}){n=Or(n,Ba);const i=As(e),a=n._getSettings(),l={...a,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(sl(`https://${c}`),nl("Firestore",!0)),a.host!==dp&&a.host!==c&&Mn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!Zs(u,l)&&(n._setSettings(u),r.mockUserToken)){let h,p;if(typeof r.mockUserToken=="string")h=r.mockUserToken,p=tt.MOCK_USER;else{h=qd(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new Y(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new tt(g)}n._authCredentials=new Tv(new tm(h,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new qa(this.firestore,e,this._query)}}class Ke{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _s(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ke(this.firestore,e,this._key)}toJSON(){return{type:Ke._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Xr(t,Ke._jsonSchema))return new Ke(e,r||null,new Z(Ee.fromString(t.referencePath)))}}Ke._jsonSchemaVersion="firestore/documentReference/1.0",Ke._jsonSchema={type:Ve("string",Ke._jsonSchemaVersion),referencePath:Ve("string")};class _s extends qa{constructor(e,t,r){super(e,t,vm(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ke(this.firestore,null,new Z(e))}withConverter(e){return new _s(this.firestore,e,this._path)}}function md(n,e,...t){if(n=Qe(n),sm("collection","path",e),n instanceof Ba){const r=Ee.fromString(e,...t);return Tu(r),new _s(n,null,r)}{if(!(n instanceof Ke||n instanceof _s))throw new Y(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ee.fromString(e,...t));return Tu(r),new _s(n.firestore,null,r)}}function hp(n,e,...t){if(n=Qe(n),arguments.length===1&&(e=_l.newId()),sm("doc","path",e),n instanceof Ba){const r=Ee.fromString(e,...t);return Eu(r),new Ke(n,null,new Z(r))}{if(!(n instanceof Ke||n instanceof _s))throw new Y(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ee.fromString(e,...t));return Eu(r),new Ke(n.firestore,n instanceof _s?n.converter:null,new Z(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pd="AsyncQueue";class fd{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Wm(this,"async_queue_retry"),this._c=()=>{const r=go();r&&K(pd,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=go();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=go();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new vs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Kn(e))throw e;K(pd,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Jt("INTERNAL UNHANDLED ERROR: ",gd(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Bl.createAndSchedule(this,e,t,r,a=>this.hc(a));return this.tc.push(i),i}uc(){this.nc&&re(47125,{Pc:gd(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function gd(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class za extends Ba{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new fd,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new fd(e),this._firestoreClient=void 0,await e}}}function Tj(n,e){const t=typeof n=="object"?n:al(),r=typeof n=="string"?n:ia,i=Ea(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=Fd("firestore");a&&Ej(i,...a)}return i}function mp(n){if(n._terminated)throw new Y(U.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Ij(n),n._firestoreClient}function Ij(n){const e=n._freezeSettings(),t=function(i,a,l,c){return new Gv(i,a,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,up(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new vj(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gt(Xe.fromBase64String(e))}catch(t){throw new Y(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new gt(Xe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:gt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Xr(e,gt._jsonSchema))return gt.fromBase64String(e.bytes)}}gt._jsonSchemaVersion="firestore/bytes/1.0",gt._jsonSchema={type:Ve("string",gt._jsonSchemaVersion),bytes:Ve("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Y(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Y(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Y(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return pe(this._lat,e._lat)||pe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pt._jsonSchemaVersion}}static fromJSON(e){if(Xr(e,Pt._jsonSchema))return new Pt(e.latitude,e.longitude)}}Pt._jsonSchemaVersion="firestore/geoPoint/1.0",Pt._jsonSchema={type:Ve("string",Pt._jsonSchemaVersion),latitude:Ve("number"),longitude:Ve("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Dt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Xr(e,Dt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Dt(e.vectorValues);throw new Y(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Dt._jsonSchemaVersion="firestore/vectorValue/1.0",Dt._jsonSchema={type:Ve("string",Dt._jsonSchemaVersion),vectorValues:Ve("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sj=/^__.*__$/;class Aj{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new dn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Yr(e,this.data,t,this.fieldTransforms)}}function fp(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw re(40011,{Ac:n})}}class Wl{constructor(e,t,r,i,a,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Wl({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return fa(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fp(this.Ac)&&Sj.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Cj{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ma(e)}Cc(e,t,r,i=!1){return new Wl({Ac:e,methodName:t,Dc:r,path:Ge.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rj(n){const e=n._freezeSettings(),t=Ma(n._databaseId);return new Cj(n._databaseId,!!e.ignoreUndefinedProperties,t)}function kj(n,e,t,r,i,a={}){const l=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);bp("Data must be an object, but it was:",l,r);const c=xp(r,l);let u,h;if(a.merge)u=new _t(l.fieldMask),h=l.fieldTransforms;else if(a.mergeFields){const p=[];for(const g of a.mergeFields){const y=Pj(e,g,t);if(!l.contains(y))throw new Y(U.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Oj(p,y)||p.push(y)}u=new _t(p),h=l.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=l.fieldTransforms;return new Aj(new ft(c),u,h)}function gp(n,e){if(yp(n=Qe(n)))return bp("Unsupported field value:",e,n),xp(n,e);if(n instanceof pp)return function(r,i){if(!fp(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const a=[];let l=0;for(const c of r){let u=gp(c,i.wc(l));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),l++}return{arrayValue:{values:a}}}(n,e)}return function(r,i){if((r=Qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return g_(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=Te.fromDate(r);return{timestampValue:da(i.serializer,a)}}if(r instanceof Te){const a=new Te(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:da(i.serializer,a)}}if(r instanceof Pt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof gt)return{bytesValue:Lm(i.serializer,r._byteString)};if(r instanceof Ke){const a=i.databaseId,l=r.firestore._databaseId;if(!l.isEqual(a))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:kl(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Dt)return function(l,c){return{mapValue:{fields:{[dm]:{stringValue:hm},[aa]:{arrayValue:{values:l.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Sl(c.serializer,h)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${wl(r)}`)}(n,e)}function xp(n,e){const t={};return im(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):cn(n,(r,i)=>{const a=gp(i,e.mc(r));a!=null&&(t[r]=a)}),{mapValue:{fields:t}}}function yp(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Te||n instanceof Pt||n instanceof gt||n instanceof Ke||n instanceof pp||n instanceof Dt)}function bp(n,e,t){if(!yp(t)||!nm(t)){const r=wl(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Pj(n,e,t){if((e=Qe(e))instanceof Gl)return e._internalPath;if(typeof e=="string")return vp(n,e);throw fa("Field path arguments must be of type string or ",n,!1,void 0,t)}const Dj=new RegExp("[~\\*/\\[\\]]");function vp(n,e,t){if(e.search(Dj)>=0)throw fa(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Gl(...e.split("."))._internalPath}catch{throw fa(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fa(n,e,t,r,i){const a=r&&!r.isEmpty(),l=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||l)&&(u+=" (found",a&&(u+=` in field ${r}`),l&&(u+=` in document ${i}`),u+=")"),new Y(U.INVALID_ARGUMENT,c+n+u)}function Oj(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ke(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Lj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(wp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Lj extends _p{data(){return super.data()}}function wp(n,e){return typeof e=="string"?vp(n,e):e instanceof Gl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vj(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Y(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Mj{convertValue(e,t="none"){switch(Ts(e)){case 0:return null;case 1:return e.booleanValue;case 2:return De(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Es(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw re(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return cn(e,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertVectorValue(e){const t=e.fields?.[aa].arrayValue?.values?.map(r=>De(r.doubleValue));return new Dt(t)}convertGeoPoint(e){return new Pt(De(e.latitude),De(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Ra(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Vr(e));default:return null}}convertTimestamp(e){const t=Ns(e);return new Te(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ee.fromString(e);ve(qm(r),9688,{name:e});const i=new Mr(r.get(1),r.get(3)),a=new Z(r.popFirst(5));return i.isEqual(t)||Jt(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class Di{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Pn extends _p{constructor(e,t,r,i,a,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Hi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(wp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Y(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Pn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Pn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pn._jsonSchema={type:Ve("string",Pn._jsonSchemaVersion),bundleSource:Ve("string","DocumentSnapshot"),bundleName:Ve("string"),bundle:Ve("string")};class Hi extends Pn{data(e={}){return super.data(e)}}class Dn{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Di(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Hi(this._firestore,this._userDataWriter,r.key,r,new Di(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Y(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map(c=>{const u=new Hi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Di(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:l++}})}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>a||c.type!==3).map(c=>{const u=new Hi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Di(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return c.type!==0&&(h=l.indexOf(c.doc.key),l=l.delete(c.doc.key)),c.type!==1&&(l=l.add(c.doc),p=l.indexOf(c.doc.key)),{type:Uj(c.type),doc:u,oldIndex:h,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Y(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Dn._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=_l.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Uj(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return re(61501,{type:n})}}Dn._jsonSchemaVersion="firestore/querySnapshot/1.0",Dn._jsonSchema={type:Ve("string",Dn._jsonSchemaVersion),bundleSource:Ve("string","QuerySnapshot"),bundleName:Ve("string"),bundle:Ve("string")};class Bj extends Mj{constructor(e){super(),this.firestore=e}convertBytes(e){return new gt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ke(this.firestore,null,t)}}function qj(n){n=Or(n,qa);const e=Or(n.firestore,za),t=mp(e),r=new Bj(e);return Vj(n._query),Nj(t,n._query).then(i=>new Dn(e,r,n,i))}function zj(n){return jp(Or(n.firestore,za),[new Al(n._key,Rt.none())])}function $j(n,e){const t=Or(n.firestore,za),r=hp(n),i=Fj(n.converter,e);return jp(t,[kj(Rj(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Rt.exists(!1))]).then(()=>r)}function jp(n,e){return function(r,i){const a=new vs;return r.asyncQueue.enqueueAndForget(async()=>uj(await wj(r),i,a)),a.promise}(mp(n),e)}(function(e,t=!0){(function(i){Gn=i})(on),en(new ws("firestore",(r,{instanceIdentifier:i,options:a})=>{const l=r.getProvider("app").getImmediate(),c=new za(new Iv(r.getProvider("auth-internal")),new Cv(l,r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Y(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mr(h.options.projectId,p)}(l,i),l);return a={useFetchStreams:t,...a},c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),It(_u,wu,e),It(_u,wu,"esm2020")})();const Np={apiKey:"AIzaSyCtpOMtw3GR5yZhokfVox8eP9Ldo5srLrE",authDomain:"mypictures-9dc8b.firebaseapp.com",projectId:"mypictures-9dc8b",storageBucket:"mypictures-9dc8b.firebasestorage.app",messagingSenderId:"722783244073",appId:"1:722783244073:web:e29da99ccd0602e2b3b138"},Kl=Gc().length===0?Hd(Np):Gc()[0],Oi=jv(Kl),yo=Tj(Kl),Ql=iy(Kl);console.log("Firebase Storage configuré:",Ql);console.log("Storage bucket:",Np.storageBucket);const Ep=({boatId:n,existingPeriods:e=[],onAvailabilityChange:t,isEditing:r=!1})=>{const[i,a]=S.useState(e),[l,c]=S.useState({startDate:"",endDate:"",notes:""}),[u,h]=S.useState(!1),[p,g]=S.useState(null),[y,_]=S.useState({}),[C,E]=S.useState("");S.useEffect(()=>{a(e)},[e]),S.useEffect(()=>{n&&e.length===0&&N()},[n,e.length]);const N=async()=>{try{console.log("🔄 Chargement des disponibilités pour le bateau:",n),console.log("🔄 Chargement des disponibilités depuis MongoDB...");try{const f=await te(`${se.BOAT_DETAIL(n)}/availability`);console.log("✅ Disponibilités chargées depuis MongoDB:",f),a(f)}catch(f){console.error("❌ Erreur lors du chargement des disponibilités:",f.message)}}catch(f){console.error("❌ Erreur lors du chargement des disponibilités:",f)}},k=()=>{if(console.log("🔄 Ajout d'une nouvelle période:",l),!l.startDate||!l.endDate){E("Veuillez remplir toutes les dates");return}if(new Date(l.startDate)>new Date(l.endDate)){E("La date de fin doit être égale ou postérieure à la date de début");return}if(console.log("✅ Validation des données réussie"),i.length>0){E("Une disponibilité existe déjà. Vous pouvez la modifier ou la supprimer.");return}const f={...l,id:Date.now(),boatId:n};console.log("📅 Période à ajouter:",f),console.log("📋 Périodes existantes avant ajout:",i),a([f]),E(""),t&&(console.log("📤 Notification au composant parent avec la nouvelle disponibilité"),t([f]))},R=()=>{a([]),E(""),t&&t([])},P=f=>{g(f.id||f._id),_({startDate:f.startDate.split("T")[0],endDate:f.endDate.split("T")[0],notes:f.notes||""})},V=()=>{if(!y.startDate||!y.endDate){E("Veuillez remplir toutes les dates");return}if(new Date(y.startDate)>new Date(y.endDate)){E("La date de fin doit être égale ou postérieure à la date de début");return}if(i.some(T=>{if(T.id===p||T._id===p)return!1;const A=new Date(y.startDate),b=new Date(y.endDate),v=new Date(T.startDate),M=new Date(T.endDate);return A<M&&b>v})){E("Cette période chevauche une période existante");return}const w=i.map(T=>T.id===p||T._id===p?{...T,startDate:y.startDate,endDate:y.endDate,notes:y.notes}:T);a(w),g(null),_({}),E(""),t&&t(w)},B=()=>{g(null),_({}),E("")},O=f=>new Date(f).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),j=(f,w)=>{const T=new Date(f),A=new Date(w);T.setHours(0,0,0,0),A.setHours(0,0,0,0);const v=(A.getTime()-T.getTime())/(1e3*60*60*24);return Math.max(1,Math.ceil(v))};return s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[s.jsx(at,{className:"h-5 w-5 text-blue-600 mr-2"}),"Gestion de la disponibilité"]}),!u&&i.length===0&&s.jsxs("button",{onClick:()=>h(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(Ws,{className:"h-4 w-4"}),s.jsx("span",{children:"Ajouter une disponibilité"})]})]}),u&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Nouvelle période de disponibilité"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de début *"}),s.jsx("input",{type:"date",value:l.startDate,onChange:f=>c({...l,startDate:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:new Date().toISOString().split("T")[0]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin *"}),s.jsx("input",{type:"date",value:l.endDate,onChange:f=>c({...l,endDate:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:l.startDate||new Date().toISOString().split("T")[0]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),s.jsx("input",{type:"text",value:l.notes,onChange:f=>c({...l,notes:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Conditions spéciales..."})]})]}),(l.startDate||l.endDate)&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[s.jsx("h5",{className:"font-medium text-blue-900 mb-2 flex items-center",children:i.length>0?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-green-600 mr-2",children:"✅"}),"Disponibilité confirmée et visible ci-dessous"]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-blue-600 mr-2",children:"👁️"}),"Prévisualisation de la disponibilité"]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Période :"}),s.jsxs("p",{className:"text-blue-900",children:[l.startDate?O(l.startDate):"Non définie"," - ",l.endDate?O(l.endDate):"Non définie"]}),l.startDate&&l.endDate&&s.jsxs("span",{className:"text-xs text-blue-600",children:[j(l.startDate,l.endDate)," jours"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Notes :"}),s.jsx("p",{className:"text-blue-900",children:l.notes||"Aucune note"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Statut :"}),s.jsx("p",{className:"text-blue-900",children:i.length>0?"✅ Confirmée et visible":"⏳ En cours de saisie"})]})]}),i.length>0&&s.jsx("div",{className:"mt-3 p-2 bg-green-100 border border-green-300 rounded text-green-800 text-xs",children:'💡 La disponibilité a été confirmée ! Elle apparaît maintenant dans la section "Disponibilité actuelle" ci-dessous.'})]}),C&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-center space-x-2 text-red-800",children:[s.jsx(Gs,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:C})]})}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsxs("button",{onClick:k,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[s.jsx(Gi,{className:"h-4 w-4"}),s.jsx("span",{children:"Confirmer"})]}),s.jsxs("button",{onClick:()=>{h(!1),E(""),c({startDate:"",endDate:"",notes:""})},className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center space-x-2",children:[s.jsx(Re,{className:"h-4 w-4"}),s.jsx("span",{children:"Annuler"})]}),i.length>0&&s.jsxs("button",{onClick:()=>{h(!1),E(""),c({startDate:"",endDate:"",notes:""})},className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(Re,{className:"h-4 w-4"}),s.jsx("span",{children:"Fermer le formulaire"})]})]})]}),i.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(at,{className:"h-5 w-5 text-green-600 mr-2"}),"Disponibilité actuelle"]}),s.jsx("div",{className:"space-y-3",children:i.map((f,w)=>s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[p===(f.id||f._id)?s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de début"}),s.jsx("input",{type:"date",value:y.startDate,onChange:T=>_({...y,startDate:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin"}),s.jsx("input",{type:"date",value:y.endDate,onChange:T=>_({...y,endDate:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),s.jsx("input",{type:"text",value:y.notes,onChange:T=>_({...y,notes:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}):s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-center",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-green-700",children:"Période"}),s.jsxs("p",{className:"text-green-900 font-semibold",children:[O(f.startDate)," - ",O(f.endDate)]}),s.jsxs("span",{className:"text-xs text-green-600",children:[j(f.startDate,f.endDate)," jours"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-green-700",children:"Notes"}),s.jsx("p",{className:"text-green-900",children:f.notes||"Aucune note"})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>P(f),className:"bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 transition-colors",title:"Modifier",children:s.jsx(Qi,{className:"h-4 w-4"})}),s.jsx("button",{onClick:R,className:"bg-red-600 text-white p-2 rounded-lg hover:bg-red-700 transition-colors",title:"Supprimer",children:s.jsx(Re,{className:"h-4 w-4"})})]})]}),p===(f.id||f._id)&&s.jsxs("div",{className:"flex space-x-3 mt-4",children:[s.jsxs("button",{onClick:V,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[s.jsx(Gi,{className:"h-4 w-4"}),s.jsx("span",{children:"Sauvegarder"})]}),s.jsxs("button",{onClick:B,className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center space-x-2",children:[s.jsx(Re,{className:"h-4 w-4"}),s.jsx("span",{children:"Annuler"})]})]})]},f.id||f._id||w))})]}),i.length===0&&!u&&s.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[s.jsx(at,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),s.jsx("p",{className:"text-lg font-medium mb-2",children:"Aucune disponibilité définie"}),s.jsx("p",{className:"text-sm",children:'Cliquez sur "Ajouter une disponibilité" pour commencer'})]}),s.jsx("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Gs,{className:"h-5 w-5 text-yellow-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-yellow-800",children:[s.jsx("p",{className:"font-medium mb-1",children:"Gestion automatique des réservations"}),s.jsx("p",{children:"Les clients ne pourront réserver que pendant les périodes de disponibilité définies. Les dates déjà réservées seront automatiquement exclues des périodes disponibles."}),s.jsxs("p",{className:"mt-2 text-xs italic",children:["💡 ",s.jsx("strong",{children:"Conseil :"})," Définissez vos disponibilités avant d'ajouter le bateau pour une meilleure visibilité."]})]})]})})]})};function Tp({isOpen:n,onClose:e,onBoatAdded:t}){const[r,i]=S.useState({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:[]}),[a,l]=S.useState(null),[c,u]=S.useState(null),[h,p]=S.useState(""),[g,y]=S.useState(!1),[_,C]=S.useState([]),[E,N]=S.useState(!1),[k,R]=S.useState(""),[P,V]=S.useState(""),B=!!localStorage.getItem("token");console.log("🔍 AddBoat: État des disponibilités:",_);const O=["Climatisation","Wifi","Cuisine équipée","Salle de bain","Pont solarium","GPS","Radio VHF","Gilets de sauvetage","Équipement de pêche","Panneaux solaires"],j=M=>{const{name:Q,value:ie,type:X,checked:ee}=M.target;i(X==="checkbox"?ee?ue=>({...ue,equipements:[...ue.equipements,ie]}):ue=>({...ue,equipements:ue.equipements.filter(oe=>oe!==ie)}):ue=>({...ue,[Q]:ie}))},f=()=>{h.trim()&&!r.equipements.includes(h.trim())&&(i(M=>({...M,equipements:[...M.equipements,h.trim()]})),p(""))},w=M=>{i(Q=>({...Q,equipements:Q.equipements.filter(ie=>ie!==M)}))},T=M=>{M.key==="Enter"&&(M.preventDefault(),f())},A=M=>{const Q=M.target.files[0];if(Q){l(Q);const ie=new FileReader;ie.onload=X=>{u(X.target.result)},ie.readAsDataURL(Q)}},b=M=>{console.log("📥 AddBoat: Mise à jour des disponibilités reçue:",M),C(M)},v=async M=>{M.preventDefault(),N(!0),R(""),V("");try{let Q="";if(a){const Ie=mh(Ql,`boats/${Date.now()}_${a.name}`),de=await dh(Ie,a);Q=await hh(de.ref)}const X=(Ie=>({"Saint-malo":"saint-malo","Les Glénan":"les-glenan",Crozon:"crozon","La Rochelle":"la-rochelle",Marseille:"marseille",Cannes:"cannes",Ajaccio:"ajaccio",Barcelone:"barcelone","Palma de Majorque":"palma",Athènes:"athenes",Venise:"venise",Amsterdam:"amsterdam",Split:"split"})[Ie]||Ie)(r.destination);console.log("🔄 Destination convertie pour l'API:",X);const ee={nom:r.nom,type:r.type,longueur:parseFloat(r.longueur),prix_jour:parseFloat(r.prix_jour),capacite:parseInt(r.capacite),image:Q,destination:X,description:r.description,equipements:r.equipements,availability:_.length>0?{startDate:_[0].startDate,endDate:_[0].endDate,notes:_[0].notes||""}:null},ue=localStorage.getItem("token");if(!ue)throw new Error("Vous devez être connecté pour ajouter un bateau");console.log("🔄 Ajout du bateau dans MongoDB...");const oe=await te(se.BOATS,{method:"POST",headers:he(ue),body:JSON.stringify(ee)});console.log("✅ Bateau ajouté avec succès:",oe),console.log("✅ Bateau créé avec succès:",oe),console.log("📋 Disponibilités incluses:",oe.availabilities),V("Bateau et disponibilités ajoutés avec succès !"),i({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:[]}),l(null),u(null),_.length>0&&(C([]),y(!1)),t&&t(oe),setTimeout(()=>{e()},2e3)}catch(Q){console.error("Erreur:",Q),R(Q.message||"Une erreur est survenue")}finally{N(!1)}};return n?B?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx(Ws,{className:"h-6 w-6 text-blue-600 mr-2"}),"Ajouter un nouveau bateau"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(Re,{className:"h-6 w-6"})})]}),s.jsxs("form",{onSubmit:v,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du bateau *"}),s.jsx("input",{type:"text",name:"nom",value:r.nom,onChange:j,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nom du bateau"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de bateau *"}),s.jsxs("select",{name:"type",value:r.type,onChange:j,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longueur (mètres) *"}),s.jsx("input",{type:"number",name:"longueur",value:r.longueur,onChange:j,required:!0,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Longueur en mètres"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacité (personnes) *"}),s.jsx("input",{type:"number",name:"capacite",value:r.capacite,onChange:j,required:!0,min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de personnes"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prix par jour (€) *"}),s.jsx("input",{type:"number",name:"prix_jour",value:r.prix_jour,onChange:j,required:!0,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Prix en euros"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination *"}),s.jsxs("select",{name:"destination",value:r.destination,onChange:j,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Sélectionner une destination"}),s.jsx("option",{value:"Saint-malo",children:"Saint-Malo"}),s.jsx("option",{value:"Les Glénan",children:"Les Glénan"}),s.jsx("option",{value:"Crozon",children:"Crozon"}),s.jsx("option",{value:"La Rochelle",children:"La Rochelle"}),s.jsx("option",{value:"Marseille",children:"Marseille"}),s.jsx("option",{value:"Cannes",children:"Cannes"}),s.jsx("option",{value:"Ajaccio",children:"Ajaccio"}),s.jsx("option",{value:"Barcelone",children:"Barcelone"}),s.jsx("option",{value:"Palma de Majorque",children:"Palma de Majorque"}),s.jsx("option",{value:"Athènes",children:"Athènes"}),s.jsx("option",{value:"Venise",children:"Venise"}),s.jsx("option",{value:"Amsterdam",children:"Amsterdam"}),s.jsx("option",{value:"Split",children:"Split"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),s.jsx("textarea",{name:"description",value:r.description,onChange:j,required:!0,rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description détaillée du bateau..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image du bateau *"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:A,className:"hidden",id:"image-upload"}),s.jsxs("label",{htmlFor:"image-upload",className:"cursor-pointer bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(Ed,{className:"h-4 w-4"}),s.jsx("span",{children:"Choisir une image"})]}),c&&s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:c,alt:"Aperçu",className:"w-20 h-20 object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{l(null),u(null)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600",children:s.jsx(Re,{className:"h-3 w-3"})})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Équipements disponibles"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:O.map(M=>s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",value:M,checked:r.equipements.includes(M),onChange:j,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:M})]},M))}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("input",{type:"text",value:h,onChange:M=>p(M.target.value),onKeyPress:T,placeholder:"Ajouter un équipement personnalisé",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("button",{type:"button",onClick:f,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"Ajouter"})]}),r.equipements.length>0&&s.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:r.equipements.map(M=>s.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[M,s.jsx("button",{type:"button",onClick:()=>w(M),className:"ml-2 text-blue-600 hover:text-blue-800",children:s.jsx(Re,{className:"h-3 w-3"})})]},M))})]}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(at,{className:"h-5 w-5 text-blue-600 mr-2"}),"Gestion des disponibilités"]}),s.jsxs("button",{type:"button",onClick:()=>y(!g),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[g?s.jsx(Re,{className:"h-4 w-4"}):s.jsx(Ws,{className:"h-4 w-4"}),s.jsx("span",{children:g?"Masquer":"Gérer les disponibilités"})]})]}),g&&s.jsx(Ep,{boatId:null,onAvailabilityChange:b})]}),k&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-red-800",children:k})}),P&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsx("p",{className:"text-green-800",children:P})}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[s.jsx("button",{type:"button",onClick:e,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",disabled:E,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:E?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Ajout en cours..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ws,{className:"h-4 w-4"}),s.jsx("span",{children:"Ajouter le bateau"})]})})]})]})]})})}):s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 text-center",children:[s.jsx("div",{className:"text-red-600 mb-4",children:s.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Connexion requise"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Vous devez être connecté pour ajouter un bateau."}),s.jsx("button",{onClick:e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Fermer"})]})}):null}function Hj({isOpen:n,onClose:e,onBoatUpdated:t,boatData:r}){const[i,a]=S.useState({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:[]}),[l,c]=S.useState(null),[u,h]=S.useState(null),[p,g]=S.useState(!1),[y,_]=S.useState(""),[C,E]=S.useState(!1),[N,k]=S.useState([]),[R,P]=S.useState(!1),[V,B]=S.useState(""),[O,j]=S.useState(""),f=!!localStorage.getItem("token"),w=["Climatisation","Wifi","Cuisine équipée","Salle de bain","Pont solarium","GPS","Radio VHF","Gilets de sauvetage","Équipement de pêche","Panneaux solaires"];S.useEffect(()=>{if(r&&n){console.log("🔄 Initialisation du formulaire avec les données du bateau:",r),console.log("📍 Destination actuelle du bateau:",r.destination),console.log("📍 Type de la destination:",typeof r.destination);const ee=(ue=>ue?{"saint-malo":"Saint-malo","Saint-malo":"Saint-malo","les-glenan":"Les Glénan","Les Glénan":"Les Glénan",crozon:"Crozon",Crozon:"Crozon","la-rochelle":"La Rochelle","La Rochelle":"La Rochelle",rochelle:"La Rochelle",marseille:"Marseille",Marseille:"Marseille",cannes:"Cannes",Cannes:"Cannes",ajaccio:"Ajaccio",Ajaccio:"Ajaccio",barcelone:"Barcelone",Barcelone:"Barcelone",palma:"Palma de Majorque","Palma de Majorque":"Palma de Majorque",athenes:"Athènes",Athènes:"Athènes",venise:"Venise",Venise:"Venise",amsterdam:"Amsterdam",Amsterdam:"Amsterdam",split:"Split",Split:"Split"}[ue]||ue:"")(r.destination);console.log("🎯 Destination normalisée:",ee),a({nom:r.nom||"",type:r.type||"voilier",longueur:r.longueur||"",prix_jour:r.prix_jour||"",capacite:r.capacite||"",image:r.image||"",destination:ee,description:r.description||"",equipements:r.equipements||[]}),r.image&&h(r.image),c(null),g(!1),_(""),r.availability&&r.availability.startDate?(console.log("📋 Disponibilité trouvée dans le bateau:",r.availability),k([{startDate:r.availability.startDate.split("T")[0],endDate:r.availability.endDate.split("T")[0],price:r.availability.price,notes:r.availability.notes||""}])):(console.log("ℹ️ Aucune disponibilité trouvée dans le bateau"),k([]))}},[r,n]);const T=X=>{const{name:ee,value:ue,type:oe,checked:Ie}=X.target;a(oe==="checkbox"?Ie?de=>({...de,equipements:[...de.equipements,ue]}):de=>({...de,equipements:de.equipements.filter(we=>we!==ue)}):de=>({...de,[ee]:ue}))},A=()=>{y.trim()&&!i.equipements.includes(y.trim())&&(a(X=>({...X,equipements:[...X.equipements,y.trim()]})),_(""))},b=X=>{a(ee=>({...ee,equipements:ee.equipements.filter(ue=>ue!==X)}))},v=X=>{X.key==="Enter"&&(X.preventDefault(),A())},M=X=>{const ee=X.target.files[0];if(ee){c(ee),g(!0);const ue=new FileReader;ue.onload=oe=>{h(oe.target.result)},ue.readAsDataURL(ee)}},Q=X=>{k(X)},ie=async X=>{X.preventDefault(),P(!0),B(""),j("");try{const ee=localStorage.getItem("token");if(!ee)throw new Error("Vous devez être connecté pour modifier un bateau");if(!i.nom||!i.type||!i.longueur||!i.prix_jour||!i.capacite||!i.destination)throw new Error("Veuillez remplir tous les champs obligatoires");const oe=(we=>({"Saint-malo":"saint-malo","Les Glénan":"les-glenan",Crozon:"crozon","La Rochelle":"la-rochelle",Marseille:"marseille",Cannes:"cannes",Ajaccio:"ajaccio",Barcelone:"barcelone","Palma de Majorque":"palma",Athènes:"athenes",Venise:"venise",Amsterdam:"amsterdam",Split:"split"})[we]||we)(i.destination);console.log("🔄 Destination convertie pour l'API:",oe);const Ie={nom:i.nom,type:i.type,longueur:parseFloat(i.longueur),prix_jour:parseFloat(i.prix_jour),capacite:parseInt(i.capacite),destination:oe,description:i.description,equipements:i.equipements,availability:N.length>0?{startDate:N[0].startDate,endDate:N[0].endDate,price:parseFloat(N[0].price),notes:N[0].notes||""}:null};if(console.log("🔍 Données à envoyer pour la mise à jour:",Ie),console.log("🎯 Destination sélectionnée:",i.destination),console.log("📤 Destination envoyée à l'API:",oe),p&&l){const we=mh(Ql,`boats/${Date.now()}_${l.name}`),ks=await dh(we,l),ot=await hh(ks.ref);Ie.image=ot}console.log("🔄 Modification du bateau dans MongoDB...");const de=await te(se.BOAT_DETAIL(r._id),{method:"PUT",headers:he(ee),body:JSON.stringify(Ie)});console.log("✅ Bateau modifié avec succès:",de),console.log("📋 Disponibilités mises à jour:",de.availability),j("Bateau modifié avec succès !"),a({nom:"",type:"voilier",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:[]}),c(null),h(null),g(!1),_(""),k([]),E(!1),t&&t(de),setTimeout(()=>{e()},2e3)}catch(ee){console.error("Erreur:",ee),B(ee.message||"Une erreur est survenue")}finally{P(!1)}};return n?f?r?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx(Qi,{className:"h-6 w-6 text-blue-600 mr-2"}),"Modifier le bateau : ",r.nom]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(Re,{className:"h-6 w-6"})})]}),s.jsxs("form",{onSubmit:ie,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du bateau *"}),s.jsx("input",{type:"text",name:"nom",value:i.nom,onChange:T,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nom du bateau"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de bateau *"}),s.jsxs("select",{name:"type",value:i.type,onChange:T,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longueur (mètres) *"}),s.jsx("input",{type:"number",name:"longueur",value:i.longueur,onChange:T,required:!0,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Longueur en mètres"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacité (personnes) *"}),s.jsx("input",{type:"number",name:"capacite",value:i.capacite,onChange:T,required:!0,min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de personnes"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prix par jour (€) *"}),s.jsx("input",{type:"number",name:"prix_jour",value:i.prix_jour,onChange:T,required:!0,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Prix en euros"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination *"}),s.jsxs("select",{name:"destination",value:i.destination,onChange:T,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Sélectionner une destination"}),s.jsx("option",{value:"Saint-malo",children:"Saint-Malo"}),s.jsx("option",{value:"Les Glénan",children:"Les Glénan"}),s.jsx("option",{value:"Crozon",children:"Crozon"}),s.jsx("option",{value:"La Rochelle",children:"La Rochelle"}),s.jsx("option",{value:"Marseille",children:"Marseille"}),s.jsx("option",{value:"Cannes",children:"Cannes"}),s.jsx("option",{value:"Ajaccio",children:"Ajaccio"}),s.jsx("option",{value:"Barcelone",children:"Barcelone"}),s.jsx("option",{value:"Palma de Majorque",children:"Palma de Majorque"}),s.jsx("option",{value:"Athènes",children:"Athènes"}),s.jsx("option",{value:"Venise",children:"Venise"}),s.jsx("option",{value:"Amsterdam",children:"Amsterdam"}),s.jsx("option",{value:"Split",children:"Split"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),s.jsx("textarea",{name:"description",value:i.description,onChange:T,required:!0,rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description détaillée du bateau..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image du bateau *"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:M,className:"hidden",id:"image-upload-edit"}),s.jsxs("label",{htmlFor:"image-upload-edit",className:"cursor-pointer bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(Ed,{className:"h-4 w-4"}),s.jsx("span",{children:p?"Changer l'image":"Modifier l'image"})]}),u&&s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:u,alt:"Aperçu",className:"w-20 h-20 object-cover rounded-lg"}),p&&s.jsx("button",{type:"button",onClick:()=>{c(null),h(r.image),g(!1)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600",children:s.jsx(Re,{className:"h-3 w-3"})})]})]}),!p&&r.image&&s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:`Image actuelle conservée. Cliquez sur "Modifier l'image" pour la changer.`})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Équipements disponibles"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-4",children:w.map(X=>s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",value:X,checked:i.equipements.includes(X),onChange:T,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:X})]},X))}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("input",{type:"text",value:y,onChange:X=>_(X.target.value),onKeyPress:v,placeholder:"Ajouter un équipement personnalisé",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("button",{type:"button",onClick:A,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"Ajouter"})]}),i.equipements.length>0&&s.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:i.equipements.map(X=>s.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[X,s.jsx("button",{type:"button",onClick:()=>b(X),className:"ml-2 text-blue-600 hover:text-blue-800",children:s.jsx(Re,{className:"h-3 w-3"})})]},X))})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{type:"button",onClick:()=>E(!C),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 font-medium",children:[s.jsx(at,{className:"h-5 w-5"}),s.jsx("span",{children:"Gestion des disponibilités"})]}),C&&s.jsx("div",{className:"mt-4",children:s.jsx(Ep,{boatId:r._id,existingPeriods:N,onAvailabilityChange:Q,isEditing:!0})})]}),V&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-red-800",children:V})}),O&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsx("p",{className:"text-green-800",children:O})}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[s.jsx("button",{type:"button",onClick:e,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",disabled:R,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:R?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Mise à jour en cours..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Qi,{className:"h-4 w-4"}),s.jsx("span",{children:"Mettre à jour le bateau"})]})})]})]})]})})}):s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 text-center",children:[s.jsx("div",{className:"text-red-600 mb-4",children:s.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Données manquantes"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Les données du bateau ne sont pas disponibles."}),s.jsx("button",{onClick:e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Fermer"})]})}):s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 text-center",children:[s.jsx("div",{className:"text-red-600 mb-4",children:s.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Connexion requise"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Vous devez être connecté pour modifier un bateau."}),s.jsx("button",{onClick:e,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Fermer"})]})}):null}function Gj(){const[n,e]=S.useState([]),[t,r]=S.useState(!1),[i,a]=S.useState(!1),[l,c]=S.useState(null),[u,h]=S.useState(!0),[p,g]=S.useState("");S.useEffect(()=>{y()},[]);const y=async()=>{try{h(!0);const O=localStorage.getItem("token");if(!O){g("Vous devez être connecté pour accéder à la gestion de vos bateaux");return}console.log("🔄 Récupération des bateaux depuis MongoDB...");const j=await te(se.MY_BOATS,{headers:he(O)});console.log("📊 Structure de la réponse API:",j);const f=j.data||j.boats||j||[];console.log(`✅ ${f.length||0} bateaux récupérés depuis MongoDB`),e(f)}catch(O){g(O.message)}finally{h(!1)}},_=async O=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer ce bateau ?"))try{const j=localStorage.getItem("token");console.log("🔄 Suppression du bateau depuis MongoDB..."),await te(se.BOAT_DETAIL(O),{method:"DELETE",headers:he(j)}),console.log("✅ Bateau supprimé avec succès"),e(n.filter(f=>f._id!==O))}catch(j){g(j.message)}},C=O=>{c(O),a(!0)},E=()=>{r(!0)},N=O=>{e([...n,O])},k=O=>{e(n.map(j=>j._id===O._id?O:j))},R=()=>{r(!1)},P=()=>{a(!1),c(null)},V=!!localStorage.getItem("token"),B=localStorage.getItem("userRole");return u?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(wt,{className:"h-12 w-12 text-blue-500 animate-spin"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]}):V?B!=="proprietaire"?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(Ot,{className:"h-16 w-16 text-red-500 mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Accès refusé"}),s.jsx("p",{className:"text-lg text-gray-800 mb-6",children:"Vous devez être propriétaire pour accéder à la gestion des bateaux"}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx(z,{to:"/bateaux",children:s.jsx("button",{className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Voir les bateaux"})}),s.jsx(z,{to:"/inscription",children:s.jsx("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Inscription"})})]})]}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-24 flex flex-col items-center",children:[s.jsxs("div",{className:"w-full max-w-6xl bg-white rounded-2xl shadow-xl p-8",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("h2",{className:"text-3xl font-bold text-blue-700 flex items-center gap-3",children:[s.jsx(We,{className:"h-8 w-8"}),"Gestion de mes bateaux"]}),s.jsxs("button",{onClick:E,className:"inline-flex items-center space-x-2 bg-orange-500 text-white px-6 py-3 rounded-full font-bold hover:bg-orange-600 transition-colors shadow-lg",children:[s.jsx(Ws,{className:"h-5 w-5"}),"Ajouter un bateau"]})]}),p&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:p}),n.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(We,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-medium text-gray-600 mb-2",children:"Aucun bateau trouvé"}),s.jsx("p",{className:"text-gray-500",children:"Commencez par ajouter votre premier bateau !"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(O=>s.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"h-48 bg-gray-200 rounded-t-xl flex items-center justify-center",children:[O.image?s.jsx("img",{src:O.image,alt:O.nom,className:"w-full h-full object-cover rounded-t-xl",onError:j=>{j.target.style.display="none",j.target.nextSibling.style.display="flex"}}):null,s.jsx("div",{className:"hidden items-center justify-center text-gray-400",children:s.jsx(mf,{className:"h-12 w-12"})})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:O.nom}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(We,{className:"h-4 w-4"}),s.jsx("span",{className:"capitalize",children:O.type})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(el,{className:"h-4 w-4"}),s.jsxs("span",{children:[O.longueur,"m"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Ys,{className:"h-4 w-4"}),s.jsxs("span",{children:[O.capacite," personnes"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Wi,{className:"h-4 w-4"}),s.jsxs("span",{children:[O.prix_jour,"€/jour"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Wt,{className:"h-4 w-4"}),s.jsx("span",{children:O.destination})]})]}),O.description&&s.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:O.description}),O.equipements&&O.equipements.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"Équipements :"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[O.equipements.slice(0,3).map((j,f)=>s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:j},f)),O.equipements.length>3&&s.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",O.equipements.length-3]})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-100",children:[s.jsxs("button",{onClick:()=>C(O),className:"flex items-center gap-2 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[s.jsx(Qi,{className:"h-4 w-4"}),"Modifier"]}),s.jsxs("button",{onClick:()=>_(O._id),className:"flex items-center gap-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[s.jsx(Ks,{className:"h-4 w-4"}),"Supprimer"]})]})]})]},O._id))})]}),s.jsx(Tp,{isOpen:t,onClose:R,onBoatAdded:N}),s.jsx(Hj,{isOpen:i,onClose:P,onBoatUpdated:k,boatData:l})]}):s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(Ot,{className:"h-16 w-16 text-red-500 mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Connexion requise"}),s.jsx("p",{className:"text-lg text-gray-800 mb-6",children:"Vous devez être connecté pour accéder à la gestion de vos bateaux"}),s.jsx(z,{to:"/connexion",children:s.jsx("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})})]})}function Wj(){const n=es(),[e,t]=S.useState(!0),[r,i]=S.useState("");S.useEffect(()=>{a()},[]);const a=()=>{try{if(t(!0),!(localStorage.getItem("token")||sessionStorage.getItem("token"))){i("Vous devez être connecté pour ajouter un bateau"),t(!1);return}if(localStorage.getItem("userRole")!=="proprietaire"){i("Vous devez être propriétaire pour ajouter un bateau"),t(!1);return}t(!1)}catch{i("Erreur lors de la vérification de l'authentification"),t(!1)}},l=u=>{console.log("Nouveau bateau ajouté:",u),n("/gestion-bateaux")},c=()=>{n("/gestion-bateaux")};if(e)return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(wt,{className:"h-12 w-12 text-blue-500 animate-spin"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]});if(r){const u=r.includes("connecté");return r.includes("propriétaire"),s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(Ot,{className:"h-16 w-16 text-red-500 mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:u?"Connexion requise":"Accès refusé"}),s.jsx("p",{className:"text-lg text-gray-800 mb-6",children:r}),u?s.jsx(z,{to:"/connexion",children:s.jsx("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})}):s.jsxs("div",{className:"flex space-x-3",children:[s.jsx(z,{to:"/bateaux",children:s.jsx("button",{className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Voir les bateaux"})}),s.jsx(z,{to:"/inscription",children:s.jsx("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Inscription"})})]})]})}return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx($n,{}),s.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-4xl",children:[s.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-6 text-center",children:"Ajouter un nouveau bateau"}),s.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Remplissez le formulaire ci-dessous pour ajouter votre bateau à notre plateforme de location."}),s.jsx(Tp,{isOpen:!0,onClose:c,onBoatAdded:l})]})}),s.jsx(Td,{})]})}function Kj(){const[n,e]=S.useState("overview"),[t,r]=S.useState([]),[i,a]=S.useState([]),[l,c]=S.useState(!0),[u,h]=S.useState(!1),[p,g]=S.useState(!1),[y,_]=S.useState(!1),[C,E]=S.useState(!1),[N,k]=S.useState(null),[R,P]=S.useState(null),[V,B]=S.useState(null),[O,j]=S.useState(null),[f,w]=S.useState(!1),[T,A]=S.useState([]),[b,v]=S.useState({nom:"",prenom:"",email:"",tel:"",role:"client",isProfessionnel:!1,siret:"",siren:""}),[M,Q]=S.useState({nom:"",prenom:"",email:"",tel:"",password:"",role:"client",isProfessionnel:!1,siret:"",siren:""}),[ie,X]=S.useState({nom:"",type:"",longueur:"",prix_jour:"",capacite:"",image:"",destination:"",description:"",equipements:""}),[ee,ue]=S.useState({totalUsers:0,totalBoats:0,totalBookings:0,totalReviews:0}),[oe,Ie]=S.useState(1),[de]=S.useState(10),[we,ks]=S.useState(""),[ot,ti]=S.useState("all"),[xt,si]=S.useState("all"),[Ye,Ft]=S.useState({currentPage:1,totalPages:1,totalUsers:0,usersPerPage:10}),[mn,ts]=S.useState(1),[Xn]=S.useState(10),[pn,fn]=S.useState(""),[Ps,ni]=S.useState("all"),[gn,Yn]=S.useState("all"),[be,ri]=S.useState({currentPage:1,totalPages:1,totalBoats:0,boatsPerPage:10}),[$a,ss]=S.useState(1),[Jn]=S.useState(10),[Zn,Me]=S.useState(""),[Oe,Ds]=S.useState("all"),[Os,er]=S.useState("all"),[_e,ns]=S.useState({currentPage:1,totalPages:1,totalReviews:0,reviewsPerPage:10});S.useEffect(()=>{mt(),rs(),Nt()},[]),S.useEffect(()=>{(Ps!=="all"||gn!=="all")&&(ts(1),rs())},[Ps,gn]),S.useEffect(()=>{if(ot!=="all"||xt!=="all"){Ie(1);const I=new URLSearchParams({page:"1",limit:de.toString(),search:we,role:ot,status:xt}),H=localStorage.getItem("token");H&&(console.log("🔄 Récupération des utilisateurs depuis MongoDB..."),te(`${se.DASHBOARD}?${I}`,{headers:he(H)}).then(q=>{console.log("✅ Utilisateurs récupérés depuis MongoDB:",q),r(q.allUsers.map(W=>({id:W._id,nom:W.nom,prenom:W.prenom,email:W.email,role:W.role,status:W.status||"actif",tel:W.tel||"",siret:W.siret||"",siren:W.siren||"",isProfessionnel:W.isProfessionnel||!1}))),q.pagination&&Ft(q.pagination)}).catch(q=>{console.error("Erreur lors du changement de filtre:",q),G.error("Erreur lors du changement de filtre")}))}},[ot,xt]),S.useEffect(()=>{(Oe!=="all"||Os!=="all")&&(ss(1),Nt())},[Oe,Os]);const mt=async()=>{try{c(!0);const I=localStorage.getItem("token");if(!I){G.error("Token d'authentification manquant"),window.location.href="/connexion";return}const H=new URLSearchParams({page:oe.toString(),limit:de.toString(),search:we,role:ot,status:xt});console.log("🔄 Récupération des données du dashboard depuis MongoDB...");const q=await te(`${se.DASHBOARD}?${H}`,{headers:he(I)});let W=[];try{console.log("🔄 Récupération des bateaux depuis MongoDB..."),W=await te(se.BOATS,{headers:he(I)})||[],console.log(`✅ ${W.length} bateaux récupérés depuis MongoDB`)}catch(ce){console.log("❌ Erreur API bateaux:",ce.message)}let Fe=[];try{console.log("🔄 Récupération des réservations depuis MongoDB..."),Fe=(await te(`${se.BOOKINGS}?limit=1000`,{headers:he(I)})).data||[],console.log(`✅ ${Fe.length} réservations récupérées depuis MongoDB`)}catch(ce){console.log("❌ Erreur API réservations:",ce.message)}let Us=0,pt=[];for(const ce of W)try{const bn=(await te(se.BOAT_REVIEWS(ce._id),{headers:he(I)})).data||[];Us+=bn.length,pt.push({...ce,reviews:bn,reviewCount:bn.length})}catch(yn){console.log(`Erreur lors de la récupération des avis pour ${ce.nom}:`,yn.message),pt.push({...ce,reviews:[],reviewCount:0})}const di=W.length,hi=Fe.length;W.length===0?console.log("Aucun bateau trouvé dans la base de données"):console.log("Bateaux récupérés:",W.map(ce=>({nom:ce.nom,type:ce.type,prix:ce.prix_jour}))),Fe.length===0&&console.log("Aucune réservation trouvée dans la base de données"),ue({totalUsers:q.stats.totalUsers,totalBoats:di,totalBookings:hi,totalReviews:Us}),r(q.allUsers.map(ce=>({id:ce._id,nom:ce.nom,prenom:ce.prenom,email:ce.email,role:ce.role,status:ce.status||"actif",tel:ce.tel||"",siret:ce.siret||"",siren:ce.siren||"",isProfessionnel:ce.isProfessionnel||!1}))),q.pagination&&Ft(q.pagination),a(pt.map(ce=>({id:ce._id,nom:ce.nom,type:ce.type,longueur:ce.longueur,capacite:ce.capacite,prix:ce.prix_jour,localisation:ce.localisation,status:ce.disponible?"disponible":"indisponible",image:ce.image,createdAt:ce.createdAt,reviews:ce.reviews,reviewCount:ce.reviewCount})))}catch(I){G.error("Erreur lors du chargement des données"),console.error(I)}finally{c(!1)}},rs=async()=>{try{const I=localStorage.getItem("token");if(!I){G.error("Token d'authentification manquant");return}const H=new URLSearchParams({page:mn.toString(),limit:Xn.toString(),search:pn,type:Ps,status:gn});console.log("🔄 Récupération des bateaux depuis MongoDB...");const q=await te(`${se.BOATS}?${H}`,{headers:he(I)});a(q.boats.map(W=>({id:W._id,nom:W.nom,type:W.type,longueur:W.longueur,capacite:W.capacite,prix:W.prix_jour,localisation:W.localisation,status:W.disponible?"disponible":"indisponible",image:W.image,createdAt:W.createdAt,proprietaire:W.proprietaire}))),q.pagination&&ri(q.pagination)}catch(I){console.error("Erreur lors de la récupération des bateaux:",I),G.error("Erreur lors de la récupération des bateaux")}},tr=()=>{localStorage.removeItem("token"),localStorage.removeItem("userNom"),localStorage.removeItem("userPrenom"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("userTel"),window.location.href="/connexion"},Ut=I=>{Ie(I);const H=new URLSearchParams({page:I.toString(),limit:de.toString(),search:we,role:ot,status:xt}),q=localStorage.getItem("token");q&&(console.log("🔄 Récupération des utilisateurs depuis MongoDB..."),te(`${se.DASHBOARD}?${H}`,{headers:he(q)}).then(W=>{console.log("✅ Utilisateurs récupérés depuis MongoDB:",W),r(W.allUsers.map(Fe=>({id:Fe._id,nom:Fe.nom,prenom:Fe.prenom,email:Fe.email,role:Fe.role,status:Fe.status||"actif",tel:Fe.tel||"",siret:Fe.siret||"",siren:Fe.siren||"",isProfessionnel:Fe.isProfessionnel||!1}))),W.pagination&&Ft(W.pagination)}).catch(W=>{console.error("Erreur lors du changement de page:",W),G.error("Erreur lors du chargement de la page")}))},ii=()=>{Ie(1),mt()},Bt=I=>{ts(I),rs()},sr=()=>{ts(1),rs()},ai=()=>{fn(""),ni("all"),Yn("all"),ts(1),rs()},Ls=()=>{ks(""),ti("all"),si("all"),Ie(1);const I=new URLSearchParams({page:"1",limit:de.toString(),search:"",role:"all",status:"all"}),H=localStorage.getItem("token");H&&(console.log("🔄 Récupération des utilisateurs depuis MongoDB..."),te(`${se.DASHBOARD}?${I}`,{headers:he(H)}).then(q=>{console.log("✅ Utilisateurs récupérés depuis MongoDB:",q),r(q.allUsers.map(W=>({id:W._id,nom:W.nom,prenom:W.prenom,email:W.email,role:W.role,status:W.status||"actif",tel:W.tel||"",siret:W.siret||"",siren:W.siren||"",isProfessionnel:W.isProfessionnel||!1}))),q.pagination&&Ft(q.pagination)}).catch(q=>{console.error("Erreur lors du rechargement:",q),G.error("Erreur lors du rechargement des données")}))},nr=async I=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer cet utilisateur ?"))try{const H=localStorage.getItem("token");if(!H){G.error("Token d'authentification manquant"),window.location.href="/connexion";return}console.log("🔄 Suppression de l'utilisateur depuis MongoDB..."),await te(`${se.USERS}/${I}`,{method:"DELETE",headers:he(H)}),console.log("✅ Utilisateur supprimé avec succès"),r(t.filter(q=>q.id!==I)),G.success("Utilisateur supprimé avec succès"),mt()}catch(H){G.error(H.message||"Erreur lors de la suppression de l'utilisateur"),console.error(H)}},rr=I=>{B(I),g(!0)},qt=I=>{j(I),w(!0)},ir=I=>{k(I),v({nom:I.nom,prenom:I.prenom,email:I.email,tel:I.tel||"",role:I.role,isProfessionnel:I.isProfessionnel||!1,siret:I.siret||"",siren:I.siren||""}),h(!0)},xn=()=>{Q({nom:"",prenom:"",email:"",tel:"",password:"",role:"client",isProfessionnel:!1,siret:"",siren:""}),_(!0)},oi=async I=>{if(I.preventDefault(),M.role==="proprietaire"&&M.isProfessionnel){if(!M.siret||M.siret.length!==14){G.error("Le SIRET doit contenir exactement 14 chiffres pour les professionnels");return}if(!M.siren||M.siren.length!==9){G.error("Le SIREN doit contenir exactement 9 chiffres pour les professionnels");return}}try{const H=localStorage.getItem("token");if(!H){G.error("Token d'authentification manquant"),window.location.href="/connexion";return}console.log("🔄 Création de l'utilisateur dans MongoDB...");const q=await te(se.REGISTER,{method:"POST",headers:he(H),body:JSON.stringify({nom:M.nom,prenom:M.prenom,email:M.email,password:M.password,tel:M.tel,role:M.role,...M.role==="proprietaire"&&{isProfessionnel:M.isProfessionnel,...M.isProfessionnel&&{siret:M.siret,siren:M.siren}}})});console.log("✅ Utilisateur créé avec succès:",q);const W={id:q.user.id,nom:q.user.nom,prenom:q.user.prenom,email:q.user.email,tel:q.user.tel,role:q.user.role,status:q.user.status||"actif",siret:q.user.siret||"",siren:q.user.siren||"",isProfessionnel:q.user.isProfessionnel||!1};r([W,...t]),G.success("Utilisateur créé avec succès"),_(!1),mt()}catch(H){G.error(H.message||"Erreur lors de la création de l'utilisateur"),console.error(H)}},Vs=async I=>{if(I.preventDefault(),b.role==="proprietaire"&&b.isProfessionnel){if(!b.siret||b.siret.length!==14){G.error("Le SIRET doit contenir exactement 14 chiffres pour les professionnels");return}if(!b.siren||b.siren.length!==9){G.error("Le SIREN doit contenir exactement 9 chiffres pour les professionnels");return}}try{const H=localStorage.getItem("token");if(!H){G.error("Token d'authentification manquant"),window.location.href="/connexion";return}console.log("🔄 Modification de l'utilisateur dans MongoDB..."),await te(`${se.USERS}/${N.id}`,{method:"PUT",headers:he(H),body:JSON.stringify(b)}),console.log("✅ Utilisateur modifié avec succès"),r(t.map(q=>q.id===N.id?{...q,...b}:q)),G.success("Utilisateur modifié avec succès"),h(!1),k(null),mt()}catch(H){G.error(H.message||"Erreur lors de la modification de l'utilisateur"),console.error(H)}},li=async I=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer ce bateau ?"))try{const H=localStorage.getItem("token");if(!H){G.error("Token d'authentification manquant");return}console.log("🔄 Suppression du bateau depuis MongoDB..."),await te(se.BOAT_DETAIL(I),{method:"DELETE",headers:he(H)}),console.log("✅ Bateau supprimé avec succès"),a(i.filter(q=>q.id!==I)),G.success("Bateau supprimé avec succès"),mt()}catch(H){G.error(H.message||"Erreur lors de la suppression du bateau"),console.error(H)}},ze=I=>{P(I),X({nom:I.nom||"",type:I.type||"",longueur:I.longueur||"",prix_jour:I.prix||I.prix_jour||"",capacite:I.capacite||"",image:I.image||"",destination:I.destination||I.localisation||"",description:I.description||"",equipements:I.equipements||""}),E(!0)},ci=async()=>{try{const I=localStorage.getItem("token");if(!I){G.error("Token d'authentification manquant");return}console.log("🔄 Modification du bateau dans MongoDB..."),await te(se.BOAT_DETAIL(R.id),{method:"PUT",headers:he(I),body:JSON.stringify(ie)}),console.log("✅ Bateau modifié avec succès"),a(i.map(H=>H.id===R.id?{...H,...ie}:H)),G.success("Bateau modifié avec succès"),E(!1),P(null),mt()}catch(I){G.error(I.message||"Erreur lors de la modification du bateau"),console.error(I)}},Ms=async I=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer cet avis ?"))try{const H=localStorage.getItem("token");if(!H){G.error("Token d'authentification manquant");return}console.log("🔄 Suppression de l'avis depuis MongoDB..."),await te(`${se.REVIEWS}/${I}`,{method:"DELETE",headers:he(H)}),console.log("✅ Avis supprimé avec succès"),A(T.filter(q=>q.id!==I)),G.success("Avis supprimé avec succès"),mt()}catch(H){G.error(H.message||"Erreur lors de la suppression de l'avis"),console.error(H)}},Nt=async()=>{try{const I=localStorage.getItem("token");if(!I){G.error("Token d'authentification manquant");return}const H=new URLSearchParams({page:$a.toString(),limit:Jn.toString(),search:Zn,rating:Oe,boatId:Os});console.log("Appel API avis avec paramètres:",H.toString()),console.log("🔄 Récupération des avis depuis MongoDB...");const q=await te(`${se.REVIEWS}?${H}`,{headers:he(I)});console.log("✅ Avis récupérés depuis MongoDB:",q),A(q.reviews.map(W=>({id:W._id,userId:W.userId,boatId:W.boatId,rating:W.rating,comment:W.comment,createdAt:W.createdAt}))),q.pagination&&ns(q.pagination)}catch(I){console.error("Erreur réseau avis:",I),G.error("Erreur réseau lors de la récupération des avis")}},ui=()=>{ss(1),Nt()},Fs=I=>{ss(I),Nt()},is=()=>{Me(""),Ds("all"),er("all"),ss(1);const I=new URLSearchParams({page:"1",limit:"10",search:"",rating:"all",boatId:"all"}),H=localStorage.getItem("token");H&&(console.log("🔄 Récupération des avis depuis MongoDB..."),te(`${se.REVIEWS}?${I}`,{headers:he(H)}).then(q=>{console.log("✅ Avis récupérés depuis MongoDB:",q),A(q.reviews.map(W=>({id:W._id,userId:W.userId,boatId:W.boatId,rating:W.rating,comment:W.comment,createdAt:W.createdAt}))),q.pagination&&ns(q.pagination)}).catch(q=>{console.error("Erreur lors de l'effacement des filtres:",q),G.error("Erreur lors de l'effacement des filtres")}))};return l?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement du tableau de bord..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx(wa,{}),s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center py-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de Bord Admin"}),s.jsx("p",{className:"text-gray-600",children:"Gestion de la plateforme SailingLoc"})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsxs("button",{onClick:mt,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Rafraîchir les données",children:[s.jsx(to,{className:"h-5 w-5 mr-2"}),"Actualiser"]}),s.jsxs("button",{onClick:tr,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[s.jsx(xf,{className:"h-5 w-5 mr-2"}),"Déconnexion"]})]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:s.jsx(Ys,{className:"h-8 w-8 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ee.totalUsers})]})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:s.jsx(fs,{className:"h-8 w-8 text-green-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Bateaux"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ee.totalBoats})]})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:s.jsx(to,{className:"h-8 w-8 text-purple-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Réservations"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ee.totalBookings})]})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:s.jsx(to,{className:"h-8 w-8 text-yellow-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avis"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ee.totalReviews})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border mb-8",children:[s.jsx("div",{className:"border-b border-gray-200",children:s.jsxs("nav",{className:"flex space-x-8 px-6",children:[s.jsx("button",{onClick:()=>e("overview"),className:`py-4 px-1 border-b-2 font-medium text-sm ${n==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Vue d'ensemble"}),s.jsx("button",{onClick:()=>e("users"),className:`py-4 px-1 border-b-2 font-medium text-sm ${n==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Utilisateurs"}),s.jsx("button",{onClick:()=>e("boats"),className:`py-4 px-1 border-b-2 font-medium text-sm ${n==="boats"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Bateaux"}),s.jsx("button",{onClick:()=>e("reviews"),className:`py-4 px-1 border-b-2 font-medium text-sm ${n==="reviews"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Avis"})]})}),s.jsxs("div",{className:"p-6",children:[n==="overview"&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activité récente"}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Utilisateurs récents"}),s.jsx("div",{className:"space-y-2",children:t.slice(0,3).map(I=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[I.prenom," ",I.nom," (",I.role,")"]}),s.jsx("span",{className:"text-xs text-gray-400",children:I.email})]},I.id))})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Bateaux disponibles"}),s.jsx("div",{className:"space-y-2",children:i.slice(0,3).map(I=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:I.nom}),s.jsxs("span",{className:"text-xs text-gray-400",children:[I.prix,"€/jour - ",I.type]})]},I.id))})]})]})]}),n==="users"&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestion des utilisateurs"}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Total : ",Ye.totalUsers," utilisateurs • Page ",Ye.currentPage," sur ",Ye.totalPages]})]}),s.jsxs("button",{onClick:xn,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(Ws,{className:"h-4 w-4 mr-2"}),"Ajouter un utilisateur"]})]}),s.jsx("div",{className:"bg-white p-4 rounded-lg border mb-4",children:s.jsxs("div",{className:"flex items-end gap-4",children:[s.jsxs("div",{className:"w-2/3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rechercher"}),s.jsx("input",{type:"text",placeholder:"Nom, prénom ou email...",value:we,onChange:I=>ks(I.target.value),onKeyPress:I=>I.key==="Enter"&&ii(),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rôle"}),s.jsxs("select",{value:ot,onChange:I=>ti(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Tous"}),s.jsx("option",{value:"client",children:"Client"}),s.jsx("option",{value:"proprietaire",children:"Propriétaire"}),s.jsx("option",{value:"admin",children:"Admin"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),s.jsxs("select",{value:xt,onChange:I=>si(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Tous"}),s.jsx("option",{value:"actif",children:"Actif"}),s.jsx("option",{value:"inactif",children:"Inactif"}),s.jsx("option",{value:"suspendu",children:"Suspendu"})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:ii,className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",children:"Rechercher"}),s.jsx("button",{onClick:Ls,className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:"Effacer"})]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilisateur"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rôle"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut Pro"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(I=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[I.prenom," ",I.nom]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:I.email})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I.role==="admin"?"bg-red-100 text-red-800":I.role==="proprietaire"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:I.role})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.role==="proprietaire"?s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I.isProfessionnel?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:I.isProfessionnel?"Professionnel":"Particulier"}):s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:"N/A"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I.status==="actif"?"bg-green-100 text-green-800":I.status==="inactif"?"bg-red-100 text-red-800":I.status==="suspendu"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:I.status})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>rr(I),className:"text-blue-600 hover:text-blue-900",title:"Voir les détails",children:s.jsx(Ln,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>ir(I),className:"text-indigo-600 hover:text-indigo-900",title:"Modifier",children:s.jsx(so,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>nr(I.id),className:"text-red-600 hover:text-red-900",title:"Supprimer",children:s.jsx(Ks,{className:"h-4 w-4"})})]})})]},I.id))})]})}),Ye.totalPages>1&&s.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6 mt-4 rounded-lg",children:[s.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[s.jsx("button",{onClick:()=>Ut(oe-1),disabled:oe===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Précédent"}),s.jsx("button",{onClick:()=>Ut(oe+1),disabled:oe===Ye.totalPages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Suivant"})]}),s.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[s.jsx("div",{children:s.jsxs("p",{className:"text-sm text-gray-700",children:["Affichage de ",s.jsx("span",{className:"font-medium",children:(oe-1)*de+1})," à"," ",s.jsx("span",{className:"font-medium",children:Math.min(oe*de,Ye.totalUsers)})," ","sur ",s.jsx("span",{className:"font-medium",children:Ye.totalUsers})," résultats"]})}),s.jsx("div",{children:s.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[s.jsxs("button",{onClick:()=>Ut(1),disabled:oe===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx("span",{className:"sr-only",children:"Première page"}),"«"]}),s.jsxs("button",{onClick:()=>Ut(oe-1),disabled:oe===1,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx("span",{className:"sr-only",children:"Précédent"}),"‹"]}),Array.from({length:Math.min(5,Ye.totalPages)},(I,H)=>{let q;return Ye.totalPages<=5||oe<=3?q=H+1:oe>=Ye.totalPages-2?q=Ye.totalPages-4+H:q=oe-2+H,s.jsx("button",{onClick:()=>Ut(q),className:`relative inline-flex items-center px-4 py-2 text-sm font-medium border ${oe===q?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:q},q)}),s.jsxs("button",{onClick:()=>Ut(oe+1),disabled:oe===Ye.totalPages,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx("span",{className:"sr-only",children:"Suivant"}),"›"]}),s.jsxs("button",{onClick:()=>Ut(Ye.totalPages),disabled:oe===Ye.totalPages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx("span",{className:"sr-only",children:"Dernière page"}),"»"]})]})})]})]})]}),n==="boats"&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestion des bateaux"}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Total : ",be.totalBoats," bateaux • Page ",be.currentPage," sur ",be.totalPages]})]}),s.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(Ws,{className:"h-4 w-4 mr-2"}),"Ajouter un bateau"]})]}),s.jsx("div",{className:"bg-white p-4 rounded-lg border mb-4",children:s.jsxs("div",{className:"flex items-end gap-4",children:[s.jsxs("div",{className:"w-2/3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rechercher"}),s.jsx("input",{type:"text",placeholder:"Rechercher par nom ou type...",value:pn,onChange:I=>fn(I.target.value),onKeyPress:I=>I.key==="Enter"&&sr(),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),s.jsxs("select",{value:Ps,onChange:I=>ni(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Tous"}),s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"moteur",children:"Moteur"}),s.jsx("option",{value:"catamaran",children:"Catamaran"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"pneumatique",children:"Pneumatique"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),s.jsxs("select",{value:gn,onChange:I=>Yn(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Tous"}),s.jsx("option",{value:"disponible",children:"Disponible"}),s.jsx("option",{value:"loué",children:"Loué"}),s.jsx("option",{value:"maintenance",children:"Maintenance"}),s.jsx("option",{value:"réservé",children:"Réservé"})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:sr,className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",children:"Rechercher"}),s.jsx("button",{onClick:ai,className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:"Effacer"})]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bateau"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Longueur"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capacité"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avis"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(I=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.nom})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900 capitalize",children:I.type})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[I.longueur,"m"]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[I.capacite," pers."]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:s.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:[I.reviewCount||0," avis"]})})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I.status==="disponible"?"bg-green-100 text-green-800":I.status==="loué"?"bg-blue-100 text-blue-800":I.status==="maintenance"?"bg-yellow-100 text-yellow-800":I.status==="réservé"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:I.status})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>qt(I),className:"text-blue-600 hover:text-blue-900",title:"Voir les avis",children:s.jsx(Ln,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>ze(I),className:"text-indigo-600 hover:text-indigo-900",title:"Modifier le bateau",children:s.jsx(so,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>li(I.id),className:"text-red-600 hover:text-red-900",title:"Supprimer le bateau",children:s.jsx(Ks,{className:"h-4 w-4"})})]})})]},I.id))})]})}),be.totalPages>1&&s.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",(be.currentPage-1)*be.boatsPerPage+1," à"," ",Math.min(be.currentPage*be.boatsPerPage,be.totalBoats)," sur"," ",be.totalBoats," bateaux"]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>Bt(1),disabled:be.currentPage===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Première"}),s.jsx("button",{onClick:()=>Bt(be.currentPage-1),disabled:be.currentPage===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Précédente"}),s.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,be.totalPages)},(I,H)=>{let q;return be.totalPages<=5||be.currentPage<=3?q=H+1:be.currentPage>=be.totalPages-2?q=be.totalPages-4+H:q=be.currentPage-2+H,s.jsx("button",{onClick:()=>Bt(q),className:`px-3 py-2 text-sm font-medium rounded-md ${q===be.currentPage?"bg-blue-600 text-white":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50"}`,children:q},q)})}),s.jsx("button",{onClick:()=>Bt(be.currentPage+1),disabled:be.currentPage===be.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Suivante"}),s.jsx("button",{onClick:()=>Bt(be.totalPages),disabled:be.currentPage===be.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Dernière"})]})]})]}),n==="reviews"&&s.jsxs("div",{children:[s.jsx("div",{className:"flex justify-between items-center mb-4",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestion des avis"}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Total : ",_e.totalReviews," avis • Page ",_e.currentPage," sur ",_e.totalPages]})]})}),s.jsx("div",{className:"bg-white p-4 rounded-lg border mb-4",children:s.jsxs("div",{className:"flex items-end gap-4",children:[s.jsxs("div",{className:"w-2/3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rechercher"}),s.jsx("input",{type:"text",placeholder:"Rechercher par commentaire...",value:Zn,onChange:I=>Me(I.target.value),onKeyPress:I=>I.key==="Enter"&&ui(),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note"}),s.jsxs("select",{value:Oe,onChange:I=>Ds(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Toutes"}),s.jsx("option",{value:"5",children:"5 étoiles"}),s.jsx("option",{value:"4",children:"4 étoiles"}),s.jsx("option",{value:"3",children:"3 étoiles"}),s.jsx("option",{value:"2",children:"2 étoiles"}),s.jsx("option",{value:"1",children:"1 étoile"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bateau"}),s.jsxs("select",{value:Os,onChange:I=>er(I.target.value),className:"w-36 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"Tous"}),i.map(I=>s.jsx("option",{value:I.id,children:I.nom},I.id))]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:ui,className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",children:"Rechercher"}),s.jsx("button",{onClick:is,className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm",children:"Effacer"})]})]})}),T.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun avis disponible"}),s.jsx("p",{className:"text-gray-500",children:"Aucun utilisateur n'a encore laissé d'avis sur les bateaux."})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilisateur"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bateau"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Note"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commentaire"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(I=>s.jsxs("tr",{children:[s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[I.userId?.prenom," ",I.userId?.nom]}),s.jsx("div",{className:"text-xs text-gray-500",children:I.userId?.email})]}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:i.find(H=>H.id===I.boatId?._id||H.id===I.boatId)?.nom||"Bateau supprimé"}),s.jsx("div",{className:"text-xs text-gray-500",children:i.find(H=>H.id===I.boatId?._id||H.id===I.boatId)?.type||""})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center space-x-1",children:[[...Array(5)].map((H,q)=>s.jsx("span",{className:`text-lg ${q<I.rating?"text-yellow-400":"text-gray-300"}`,children:"★"},q)),s.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",I.rating,"/5)"]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"max-w-xs",children:s.jsxs("p",{className:"text-sm text-gray-900 truncate",title:I.comment,children:['"',I.comment,'"']})})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(I.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsx("div",{className:"flex space-x-2",children:s.jsx("button",{onClick:()=>Ms(I.id),className:"text-red-600 hover:text-red-900",title:"Supprimer l'avis",children:s.jsx(Ks,{className:"h-4 w-4"})})})})]},I.id))})]})}),_e.totalPages>1&&s.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",(_e.currentPage-1)*_e.reviewsPerPage+1," à"," ",Math.min(_e.currentPage*_e.reviewsPerPage,_e.totalReviews)," sur"," ",_e.totalReviews," avis"]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>Fs(1),disabled:_e.currentPage===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Première"}),s.jsx("button",{onClick:()=>Fs(_e.currentPage-1),disabled:_e.currentPage===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:cursor-not-allowed",children:"Précédent"}),Array.from({length:Math.min(5,_e.totalPages)},(I,H)=>{let q;return _e.totalPages<=5||_e.currentPage<=3?q=H+1:_e.currentPage>=_e.totalPages-2?q=_e.totalPages-4+H:q=_e.currentPage-2+H,s.jsx("button",{onClick:()=>Fs(q),className:`relative inline-flex items-center px-4 py-2 text-sm font-medium border ${_e.currentPage===q?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:q},q)}),s.jsx("button",{onClick:()=>Fs(_e.currentPage+1),disabled:_e.currentPage===_e.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Suivant"}),s.jsx("button",{onClick:()=>Fs(_e.totalPages),disabled:_e.currentPage===_e.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Dernière"})]})]})]})]})]})]}),u&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b flex-shrink-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Modifier l'utilisateur"}),s.jsx("button",{onClick:()=>{h(!1),k(null)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(Re,{className:"h-6 w-6"})})]}),s.jsxs("form",{id:"editUserForm",onSubmit:Vs,className:"p-6 space-y-4 flex-1 overflow-y-auto",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prénom"}),s.jsx("input",{type:"text",value:b.prenom,onChange:I=>v({...b,prenom:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom"}),s.jsx("input",{type:"text",value:b.nom,onChange:I=>v({...b,nom:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),s.jsx("input",{type:"email",value:b.email,onChange:I=>v({...b,email:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Téléphone"}),s.jsx("input",{type:"tel",value:b.tel,onChange:I=>v({...b,tel:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0123456789"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rôle"}),s.jsxs("select",{value:b.role,onChange:I=>v({...b,role:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"client",children:"Client"}),s.jsx("option",{value:"proprietaire",children:"Propriétaire"}),s.jsx("option",{value:"admin",children:"Admin"})]})]}),b.role==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"false",checked:b.isProfessionnel===!1,onChange:I=>v({...b,isProfessionnel:I.target.value==="true"}),className:"mr-2 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Particulier"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"true",checked:b.isProfessionnel===!0,onChange:I=>v({...b,isProfessionnel:I.target.value==="true"}),className:"mr-2 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Professionnel"})]})]})]}),b.isProfessionnel&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Informations professionnelles"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SIRET *"}),s.jsx("input",{type:"text",value:b.siret||"",onChange:I=>v({...b,siret:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"12345678901234",pattern:"[0-9]{14}"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"14 chiffres sans espaces"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SIREN *"}),s.jsx("input",{type:"text",value:b.siren||"",onChange:I=>v({...b,siren:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"123456789",pattern:"[0-9]{9}"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"9 chiffres sans espaces"})]})]})]})})]})]}),s.jsx("div",{className:"p-6 border-t bg-gray-50 flex-shrink-0",children:s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>{h(!1),k(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",form:"editUserForm",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Modifier"})]})})]})}),p&&V&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Détails de l'utilisateur"}),s.jsx("button",{onClick:()=>{g(!1),B(null)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(Re,{className:"h-6 w-6"})})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[V.prenom.charAt(0),V.nom.charAt(0)]})}),s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xl font-semibold text-gray-900",children:[V.prenom," ",V.nom]}),s.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${V.role==="admin"?"bg-red-100 text-red-800":V.role==="proprietaire"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:V.role})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Prénom"}),s.jsx("span",{className:"text-sm text-gray-900",children:V.prenom})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Nom"}),s.jsx("span",{className:"text-sm text-gray-900",children:V.nom})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Email"}),s.jsx("span",{className:"text-sm text-gray-900",children:V.email})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Téléphone"}),s.jsx("span",{className:"text-sm text-gray-900",children:V.tel||"Non renseigné"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Statut"}),s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:V.status||"Actif"})]}),V.role==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Statut"}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${V.isProfessionnel?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:V.isProfessionnel?"Professionnel":"Particulier"})]}),V.isProfessionnel&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"SIRET"}),s.jsx("span",{className:"text-sm text-gray-900",children:V.siret||"Non renseigné"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"SIREN"}),s.jsx("span",{className:"text-sm text-gray-900",children:V.siren||"Non renseigné"})]})]})]})]}),s.jsxs("div",{className:"flex space-x-3 pt-6",children:[s.jsx("button",{onClick:()=>{g(!1),B(null),ir(V)},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Modifier"}),s.jsx("button",{onClick:()=>{g(!1),B(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Fermer"})]})]})]})}),y&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b flex-shrink-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ajouter un utilisateur"}),s.jsx("button",{onClick:()=>{_(!1)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(Re,{className:"h-6 w-6"})})]}),s.jsxs("form",{id:"addUserForm",onSubmit:oi,className:"p-6 space-y-4 flex-1 overflow-y-auto",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prénom *"}),s.jsx("input",{type:"text",value:M.prenom,onChange:I=>Q({...M,prenom:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom *"}),s.jsx("input",{type:"text",value:M.nom,onChange:I=>Q({...M,nom:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),s.jsx("input",{type:"email",value:M.email,onChange:I=>Q({...M,email:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe *"}),s.jsx("input",{type:"password",value:M.password,onChange:I=>Q({...M,password:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,minLength:"6"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Téléphone *"}),s.jsx("input",{type:"tel",value:M.tel,onChange:I=>Q({...M,tel:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0123456789",pattern:"[0-9]{10}",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rôle *"}),s.jsxs("select",{value:M.role,onChange:I=>Q({...M,role:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"client",children:"Client"}),s.jsx("option",{value:"proprietaire",children:"Propriétaire"}),s.jsx("option",{value:"admin",children:"Admin"})]})]}),M.role==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"false",checked:M.isProfessionnel===!1,onChange:I=>Q({...M,isProfessionnel:I.target.value==="true"}),className:"mr-2 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Particulier"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"isProfessionnel",value:"true",checked:M.isProfessionnel===!0,onChange:I=>Q({...M,isProfessionnel:I.target.value==="true"}),className:"mr-2 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Professionnel"})]})]})]}),M.isProfessionnel&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Informations professionnelles"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SIRET *"}),s.jsx("input",{type:"text",value:M.siret||"",onChange:I=>Q({...M,siret:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"12345678901234",pattern:"[0-9]{14}",required:!0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"14 chiffres sans espaces"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SIREN *"}),s.jsx("input",{type:"text",value:M.siren||"",onChange:I=>Q({...M,siren:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"123456789",pattern:"[0-9]{9}",required:!0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"9 chiffres sans espaces"})]})]})]})})]})]}),s.jsx("div",{className:"p-6 border-t bg-gray-50 flex-shrink-0",children:s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>{_(!1)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",form:"addUserForm",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Créer"})]})})]})}),f&&O&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Avis du bateau : ",O.nom]}),s.jsx("button",{onClick:()=>{w(!1),j(null)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(Re,{className:"h-6 w-6"})})]}),s.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:O.reviews&&O.reviews.length>0?s.jsx("div",{className:"space-y-4",children:O.reviews.map((I,H)=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-sm font-semibold text-blue-600",children:I.userId?.nom?.charAt(0)||I.userId?.prenom?.charAt(0)||"U"})}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-medium text-gray-900",children:[I.userId?.prenom," ",I.userId?.nom]}),s.jsx("p",{className:"text-sm text-gray-500",children:new Date(I.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})})]})]}),s.jsx("div",{className:"flex items-center space-x-1",children:[...Array(5)].map((q,W)=>s.jsx("span",{className:`text-lg ${W<I.rating?"text-yellow-400":"text-gray-300"}`,children:"★"},W))})]}),s.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-100",children:s.jsxs("p",{className:"text-gray-700 italic",children:['"',I.comment,'"']})})]},H))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun avis disponible"}),s.jsx("p",{className:"text-gray-500",children:"Ce bateau n'a pas encore reçu d'avis."})]})}),s.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:s.jsx("button",{onClick:()=>{w(!1),j(null)},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Fermer"})})]})}),C&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(so,{className:"h-6 w-6 text-blue-600"}),"Modifier le bateau"]}),s.jsx("button",{onClick:()=>E(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx(Re,{className:"h-6 w-6 text-gray-500"})})]}),s.jsxs("form",{onSubmit:I=>{I.preventDefault(),ci()},className:"p-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du bateau *"}),s.jsx("input",{type:"text",value:ie.nom,onChange:I=>X({...ie,nom:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nom du bateau",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type *"}),s.jsxs("select",{value:ie.type,onChange:I=>X({...ie,type:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Sélectionner un type"}),s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longueur (m) *"}),s.jsx("input",{type:"number",value:ie.longueur,onChange:I=>X({...ie,longueur:parseFloat(I.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Longueur en mètres",min:"2",max:"100",step:"0.1",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix par jour (€) *"}),s.jsx("input",{type:"number",value:ie.prix_jour,onChange:I=>X({...ie,prix_jour:parseFloat(I.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Prix par jour",min:"1",step:"0.01",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacité (personnes) *"}),s.jsx("input",{type:"number",value:ie.capacite,onChange:I=>X({...ie,capacite:parseInt(I.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de personnes",min:"1",max:"50",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Destination *"}),s.jsxs("select",{value:ie.destination,onChange:I=>X({...ie,destination:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Sélectionner une destination"}),s.jsx("option",{value:"saint-malo",children:"Saint-Malo"}),s.jsx("option",{value:"les-glenan",children:"Les Glénan"}),s.jsx("option",{value:"crozon",children:"Crozon"}),s.jsx("option",{value:"la-rochelle",children:"La Rochelle"}),s.jsx("option",{value:"marseille",children:"Marseille"}),s.jsx("option",{value:"cannes",children:"Cannes"}),s.jsx("option",{value:"ajaccio",children:"Ajaccio"}),s.jsx("option",{value:"barcelone",children:"Barcelone"}),s.jsx("option",{value:"palma",children:"Palma"}),s.jsx("option",{value:"athenes",children:"Athènes"}),s.jsx("option",{value:"venise",children:"Venise"}),s.jsx("option",{value:"amsterdam",children:"Amsterdam"}),s.jsx("option",{value:"split",children:"Split"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL de l'image *"}),s.jsx("input",{type:"url",value:ie.image,onChange:I=>X({...ie,image:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com/image.jpg",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{value:ie.description,onChange:I=>X({...ie,description:I.target.value}),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description du bateau"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Équipements"}),s.jsx("textarea",{value:ie.equipements,onChange:I=>X({...ie,equipements:I.target.value}),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Équipements disponibles (séparés par des virgules)"})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:()=>E(!1),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Modifier le bateau"})]})]})]})})]})}function Qj(){return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx($n,{}),s.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-4xl",children:[s.jsxs("header",{className:"text-center mb-12",children:[s.jsx("h1",{className:"text-4xl font-bold text-blue-700 mb-4",children:"Politique de confidentialité"}),s.jsx("p",{className:"text-gray-600 text-lg",children:"Dernière mise à jour : 01/01/2025"})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(Nd,{className:"h-7 w-7 mr-3"}),"1. Introduction"]}),s.jsx("p",{className:"text-gray-700 leading-relaxed text-lg",children:"La présente politique de confidentialité a pour but d'expliquer comment SailingLoc collecte, utilise, protège et partage les données personnelles de ses utilisateurs conformément au Règlement Général sur la Protection des Données (RGPD)."})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(Ln,{className:"h-7 w-7 mr-3"}),"2. Données collectées"]}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Lors de l'utilisation de la plateforme SailingLoc, nous pouvons collecter les données suivantes :"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Nom, prénom"}),s.jsx("li",{children:"Adresse e-mail"}),s.jsx("li",{children:"Numéro de téléphone"}),s.jsx("li",{children:"Adresse IP et données de navigation"})]}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Données de géolocalisation (si autorisées)"}),s.jsx("li",{children:"Informations de paiement (via Stripe ou PayPal)"}),s.jsx("li",{children:"Historique des réservations"}),s.jsx("li",{children:"Préférences de navigation"})]})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"3. Finalités de la collecte"}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Les données collectées ont pour objectif :"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"La création et la gestion du compte utilisateur"}),s.jsx("li",{children:"La mise en relation entre propriétaires et locataires"}),s.jsx("li",{children:"Le traitement des paiements"}),s.jsx("li",{children:"La gestion des réservations"})]}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Le service client"}),s.jsx("li",{children:"L'envoi de notifications ou emails (rappels, suggestions, sécurité)"}),s.jsx("li",{children:"L'amélioration continue de nos services"}),s.jsx("li",{children:"La personnalisation de l'expérience utilisateur"})]})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"4. Consentement"}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Le consentement est obtenu explicitement via :"}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Case à cocher lors de la création de compte"}),s.jsx("li",{children:"Bandeau cookie au premier accès au site"}),s.jsx("li",{children:"Formulaires spécifiques pour la newsletter ou contact"}),s.jsx("li",{children:"Paramètres de confidentialité dans le profil utilisateur"})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"5. Cookies"}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Le site utilise des cookies pour :"}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Analyser la fréquentation (Google Analytics)"}),s.jsx("li",{children:"Optimiser les performances du site"}),s.jsx("li",{children:"Mémoriser vos préférences de navigation"}),s.jsx("li",{children:"Assurer la sécurité de votre session"})]}),s.jsx("p",{className:"text-gray-700 mt-4 text-lg",children:"Vous pouvez configurer les cookies à tout moment via notre bandeau de gestion (outil : Axeptio, Cookiebot...)"})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"6. Durée de conservation"}),s.jsx("p",{className:"text-gray-700 leading-relaxed text-lg",children:"Les données sont conservées pour une durée maximale de 3 ans après la dernière interaction. Les données liées aux paiements sont conservées selon les obligations fiscales et légales."})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"7. Vos droits"}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"Conformément au RGPD, vous disposez des droits suivants :"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Droit d'accès à vos données"}),s.jsx("li",{children:"Droit de rectification"}),s.jsx("li",{children:`Droit à l'effacement ("droit à l'oubli")`}),s.jsx("li",{children:"Droit à la portabilité"})]}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Droit d'opposition et de retrait du consentement"}),s.jsx("li",{children:"Droit à la limitation du traitement"}),s.jsx("li",{children:"Droit de réclamation auprès de la CNIL"}),s.jsx("li",{children:"Droit à la notification des violations"})]})]}),s.jsxs("p",{className:"text-gray-700 mt-4 text-lg",children:["Pour exercer vos droits, envoyez un e-mail à : ",s.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"sailinglocequipe@gmail.com"})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(Ki,{className:"h-7 w-7 mr-3"}),"8. Sécurité des données"]}),s.jsx("p",{className:"text-gray-700 mb-4 text-lg",children:"SailingLoc utilise les technologies suivantes pour assurer la sécurité des données :"}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-2",children:[s.jsx("li",{children:"Hachage des mots de passe via bcryptjs"}),s.jsx("li",{children:"Token d'authentification sécurisés (JWT)"}),s.jsx("li",{children:"Certificat SSL (HTTPS)"}),s.jsx("li",{children:"Accès limité au personnel autorisé"}),s.jsx("li",{children:"Chiffrement des données sensibles"}),s.jsx("li",{children:"Audit de sécurité régulier"})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(_d,{className:"h-7 w-7 mr-3"}),"9. Hébergement"]}),s.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-4",children:"Vercel Inc."}),s.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Adresse :"})," 340 S Lemon Ave #4133, Walnut, CA 91789, États-Unis"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Site web :"})," ",s.jsx("a",{href:"https://vercel.com",target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"vercel.com"})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Conformité :"})," RGPD, SOC 2 Type II, ISO 27001"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Sécurité :"})," Infrastructure cloud sécurisée avec chiffrement des données en transit et au repos"]})]})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(bo,{className:"h-7 w-7 mr-3"}),"10. Développement et maintenance"]}),s.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-4",children:"Agence Pandawan"}),s.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Dénomination sociale :"})," Pandawan"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Date de création :"})," 14/03/2014"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Siège social :"})," 25 Rue du Faubourg Saint-Antoine, 75011 Paris"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Statut juridique :"})," SAS"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Expertise :"})," Développement web, IA, UX design, référencement"]})]}),s.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:s.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed",children:[s.jsx("strong",{children:"Présentation :"})," Pandawan est une agence digitale internationale spécialisée dans la création de contenus digitaux de haute qualité, valorisant l'identité de ses clients à travers l'innovation et la créativité."]})})]}),s.jsxs("section",{className:"mb-10",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-700",children:"11. Modifications"}),s.jsx("p",{className:"text-gray-700 leading-relaxed text-lg",children:"Cette politique peut être modifiée à tout moment. Les utilisateurs seront informés des changements par notification sur le site ou par e-mail."})]}),s.jsxs("section",{className:"mb-10",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[s.jsx(Vn,{className:"h-7 w-7 mr-3"}),"12. Contact"]}),s.jsxs("p",{className:"text-gray-700 leading-relaxed text-lg",children:["Pour toute question concernant cette politique de confidentialité ou pour exercer vos droits, contactez-nous à : ",s.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"sailinglocequipe@gmail.com"})]}),s.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:s.jsxs("p",{className:"text-gray-600 text-sm",children:[s.jsx("strong",{children:"Note :"})," Cette politique est conforme au RGPD et aux dernières recommandations de la CNIL. Pour plus d'informations sur vos droits, consultez le site de la ",s.jsx("a",{href:"https://www.cnil.fr",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline hover:text-blue-700 transition-colors",children:"CNIL"}),"."]})})]})]})})]})}var Ip={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},xd=xe.createContext&&xe.createContext(Ip),Xj=["attr","size","title"];function Yj(n,e){if(n==null)return{};var t=Jj(n,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function Jj(n,e){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function ga(){return ga=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ga.apply(this,arguments)}function yd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function xa(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?yd(Object(t),!0).forEach(function(r){Zj(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):yd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Zj(n,e,t){return e=eN(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eN(n){var e=tN(n,"string");return typeof e=="symbol"?e:e+""}function tN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Sp(n){return n&&n.map((e,t)=>xe.createElement(e.tag,xa({key:t},e.attr),Sp(e.child)))}function Ap(n){return e=>xe.createElement(sN,ga({attr:xa({},n.attr)},e),Sp(n.child))}function sN(n){var e=t=>{var{attr:r,size:i,title:a}=n,l=Yj(n,Xj),c=i||t.size||"1em",u;return t.className&&(u=t.className),n.className&&(u=(u?u+" ":"")+n.className),xe.createElement("svg",ga({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,l,{className:u,style:xa(xa({color:n.color||t.color},t.style),n.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),a&&xe.createElement("title",null,a),n.children)};return xd!==void 0?xe.createElement(xd.Consumer,null,t=>e(t)):e(Ip)}function nN(n){return Ap({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(n)}function rN(n){return Ap({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(n)}function iN(){const n=es(),[e,t]=S.useState(!0),[r,i]=S.useState(""),[a,l]=S.useState({nom:localStorage.getItem("userNom")||"",prenom:localStorage.getItem("userPrenom")||"",email:localStorage.getItem("userEmail")||"",telephone:localStorage.getItem("userTel")||"",password:"",siret:localStorage.getItem("userSiret")||"",siren:localStorage.getItem("userSiren")||""}),[c,u]=S.useState(""),[h,p]=S.useState(!1),[g,y]=S.useState(!1),[_,C]=S.useState(!1);S.useEffect(()=>{E()},[]);const E=()=>{try{if(t(!0),!(localStorage.getItem("token")||sessionStorage.getItem("token"))){i("Vous devez être connecté pour voir votre profil"),t(!1);return}t(!1)}catch{i("Erreur lors de la vérification de l'authentification"),t(!1)}},N=P=>{l({...a,[P.target.name]:P.target.value})},k=async P=>{P.preventDefault(),u("");try{const V=localStorage.getItem("userId");console.log("🔄 Mise à jour du profil dans MongoDB...");const B=await te("https://sailingloc-back-lilac.vercel.app/api/user/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:V,nom:a.nom,prenom:a.prenom,email:a.email,telephone:a.telephone,password:a.password,siret:a.siret,siren:a.siren})});console.log("✅ Profil mis à jour avec succès:",B),localStorage.setItem("userNom",B.user.nom),localStorage.setItem("userPrenom",B.user.prenom),localStorage.setItem("userEmail",B.user.email),localStorage.setItem("userTel",B.user.tel),B.user.siret&&localStorage.setItem("userSiret",B.user.siret),B.user.siren&&localStorage.setItem("userSiren",B.user.siren),G.success(s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),s.jsx("div",{children:s.jsx("strong",{style:{color:"#16a34a"},children:"Profil mis à jour avec succès !"})})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1}),u("")}catch(V){u(V.message)}},R=async()=>{C(!0);try{const P=localStorage.getItem("token");if(!P)throw new Error("Vous devez être connecté");console.log("🔄 Suppression du compte depuis MongoDB..."),await te("https://sailingloc-back-lilac.vercel.app/api/user/delete-account",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`}}),console.log("✅ Compte supprimé avec succès"),localStorage.clear(),G.success(s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:22,marginRight:10},children:"✅"}),s.jsxs("div",{children:[s.jsx("strong",{style:{color:"#16a34a"},children:"Compte supprimé avec succès"}),s.jsx("br",{}),s.jsx("span",{style:{fontSize:14},children:"Vous allez être redirigé vers l'accueil"})]})]}),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#e6f9ec",color:"#16a34a",fontWeight:500,fontSize:18,border:"2px solid #16a34a"},icon:!1}),setTimeout(()=>{n("/")},3e3)}catch(P){G.error(s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:22,marginRight:10},children:"❌"}),s.jsxs("div",{children:[s.jsx("strong",{style:{color:"#dc2626"},children:"Erreur"}),s.jsx("br",{}),s.jsx("span",{style:{fontSize:14},children:P.message})]})]}),{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",style:{background:"#fef2f2",color:"#dc2626",fontWeight:500,fontSize:18,border:"2px solid #dc2626"},icon:!1})}finally{C(!1),y(!1)}};return e?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(wt,{className:"h-12 w-12 text-blue-500 animate-spin"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement du profil..."})]}):r?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(Ot,{className:"h-12 w-12 text-red-500 mb-4"}),s.jsx("p",{className:"text-lg text-gray-800 mb-2",children:r}),s.jsx(z,{to:"/connexion",children:s.jsx("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})})]}):s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx($n,{}),s.jsx(wa,{}),s.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md",children:[s.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-6 text-center",children:"Mon profil"}),s.jsxs("form",{onSubmit:k,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Nom"}),s.jsx("input",{type:"text",name:"nom",value:a.nom,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre nom"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Prénom"}),s.jsx("input",{type:"text",name:"prenom",value:a.prenom,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre prénom"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Email"}),s.jsx("input",{type:"email",name:"email",value:a.email,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre email"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Téléphone"}),s.jsx("input",{type:"tel",name:"telephone",value:a.telephone,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"Votre téléphone"})]}),localStorage.getItem("userRole")==="proprietaire"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"SIRET"}),s.jsx("input",{type:"text",name:"siret",value:a.siret,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"12345678901234",maxLength:"14"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"14 chiffres sans espaces"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"SIREN"}),s.jsx("input",{type:"text",name:"siren",value:a.siren,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200",placeholder:"123456789",maxLength:"9"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"9 chiffres sans espaces"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Mot de passe"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:h?"text":"password",name:"password",value:a.password,onChange:N,className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-200 pr-12",placeholder:"Nouveau mot de passe (laisser vide pour ne pas changer)"}),s.jsx("span",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 cursor-pointer text-gray-500",onClick:()=>p(P=>!P),tabIndex:0,role:"button","aria-label":h?"Masquer le mot de passe":"Afficher le mot de passe",children:h?s.jsx(nN,{size:22}):s.jsx(rN,{size:22})})]})]}),s.jsx("button",{type:"submit",className:"w-full py-3 px-6 rounded-full font-bold text-lg bg-orange-500 text-white hover:bg-orange-600 transition-colors shadow-lg",children:"Enregistrer"}),c&&s.jsx("div",{className:"text-green-600 text-center mt-2",children:c})]}),s.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zone dangereuse"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"La suppression de votre compte est irréversible. Toutes vos données, réservations et bateaux seront définitivement supprimés."}),s.jsxs("button",{onClick:()=>y(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:[s.jsx(Ks,{className:"h-5 w-5"}),"Supprimer mon compte"]})]})})]})}),g&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:s.jsx(Gs,{className:"h-6 w-6 text-red-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Supprimer votre compte ?"}),s.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Cette action est irréversible. Toutes vos données seront définitivement supprimées."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:()=>y(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),s.jsx("button",{type:"button",onClick:R,disabled:_,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:_?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Suppression..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ks,{className:"h-4 w-4"}),"Supprimer définitivement"]})})]})]})})})]})}function aN(){return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx($n,{}),s.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-2xl",children:[s.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-6 text-center",children:"Conditions Générales d’Utilisation (CGU) et de Vente (CGV)"}),s.jsx("p",{className:"mb-4 text-gray-700 text-center",children:"Dernière mise à jour : 01/04/2025"}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"1. Présentation de la plateforme"}),s.jsx("p",{className:"text-gray-700",children:"SailingLoc est une plateforme de mise en relation entre propriétaires de bateaux et particuliers souhaitant louer un voilier ou yacht en Europe. La société est basée à La Rochelle, sous le statut SAS (RCS La Rochelle B 923 456 789)."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"2. Acceptation des CGU/CGV"}),s.jsx("p",{className:"text-gray-700",children:"En accédant ou en utilisant le site SailingLoc, tout utilisateur reconnaît avoir lu, compris et accepté les présentes CGU/CGV sans réserve."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"3. Obligations des parties"}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 mb-2",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Propriétaires :"})," doivent fournir des informations exactes sur leur bateau (entretien, assurance, équipements)."]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Locataires :"})," s’engagent à utiliser les bateaux de manière responsable et à respecter les conditions de location."]}),s.jsxs("li",{children:[s.jsx("strong",{children:"SailingLoc :"})," s’assure de la conformité juridique des contrats et du respect du RGPD."]})]})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"4. Réservation et Paiement"}),s.jsx("p",{className:"text-gray-700",children:"Les réservations sont effectuées directement via la plateforme, avec paiement sécurisé via Stripe ou PayPal. Des frais de service peuvent s’appliquer."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"5. Droit de rétractation et annulation"}),s.jsx("p",{className:"text-gray-700",children:"Les conditions d’annulation sont définies dans chaque annonce. SailingLoc permet l’annulation selon les délais spécifiés par le propriétaire."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"6. Données personnelles"}),s.jsxs("p",{className:"text-gray-700",children:["Les données collectées (nom, email, numéro, localisation, etc.) sont utilisées dans le cadre de la mise en relation et sont traitées conformément au RGPD. Consultez notre "," ",s.jsx(z,{to:"/politique-confidentialite",className:"text-orange-500 underline",children:"politique de confidentialité"}),"."]})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"7. Responsabilité"}),s.jsx("p",{className:"text-gray-700",children:"SailingLoc décline toute responsabilité en cas de litige entre les utilisateurs. Toutefois, une équipe de modération peut intervenir en cas de signalement."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"8. Modification des CGU/CGV"}),s.jsx("p",{className:"text-gray-700",children:"SailingLoc se réserve le droit de modifier les présentes conditions à tout moment. Les utilisateurs seront notifiés lors de la mise à jour."})]}),s.jsxs("section",{className:"mb-6",children:[s.jsx("h3",{className:"text-xl font-bold mb-2 text-blue-700",children:"9. Contact"}),s.jsxs("p",{className:"text-gray-700",children:["Pour toute question, vous pouvez contacter l’équipe via : ",s.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline",children:"sailinglocequipe@gmail.com"}),"."]})]})]})})]})}function oN(){return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx($n,{}),s.jsx("main",{className:"flex-1 flex flex-col items-center justify-center pt-24 pb-12",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-4xl",children:[s.jsx("h2",{className:"text-3xl font-bold text-blue-700 mb-8 text-center",children:"Mentions légales"}),s.jsxs("section",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[s.jsx(bo,{className:"h-6 w-6 mr-2"}),"1. Éditeur du site"]}),s.jsx("p",{className:"text-gray-700 mb-3",children:"Le site SailingLoc est édité par :"}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 mb-3 space-y-1",children:[s.jsx("li",{children:"SailingLoc SAS"}),s.jsx("li",{children:"Société par actions simplifiée au capital de [à compléter] €"}),s.jsx("li",{children:"RCS La Rochelle B 923 456 789"}),s.jsx("li",{children:"Siège social : 12 Rue du Port, 17000 La Rochelle, France"}),s.jsxs("li",{children:["Email : ",s.jsx("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"sailinglocequipe@gmail.com"})]}),s.jsx("li",{children:"Directeur de la publication : [Nom du responsable légal ou fondateur]"})]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[s.jsx(_d,{className:"h-6 w-6 mr-2"}),"2. Hébergement"]}),s.jsxs("ul",{className:"list-disc pl-6 text-gray-700 mb-3 space-y-1",children:[s.jsx("li",{children:"Le site est hébergé par :"}),s.jsx("li",{children:s.jsx("strong",{children:"Vercel Inc."})}),s.jsxs("li",{children:[s.jsx("strong",{children:"Adresse :"})," 340 S Lemon Ave #4133, Walnut, CA 91789, États-Unis"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Site web :"})," ",s.jsx("a",{href:"https://vercel.com",target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"vercel.com"})]}),s.jsx("li",{children:"Le prestataire assure un niveau de sécurité conforme aux exigences du RGPD."})]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[s.jsx(bo,{className:"h-6 w-6 mr-2"}),"3. Conception et développement"]}),s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200",children:[s.jsx("h4",{className:"text-lg font-semibold text-blue-800 mb-4",children:"Agence Pandawan"}),s.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Dénomination sociale :"})," Pandawan"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Date de création :"})," 14/03/2014"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Siège social :"})," 25 Rue du Faubourg Saint-Antoine, 75011 Paris"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Statut juridique :"})," SAS"]})]}),s.jsxs("div",{className:"mt-4 p-4 bg-white rounded-lg border border-blue-100",children:[s.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed",children:[s.jsx("strong",{children:"Présentation :"})," Pandawan est une agence digitale internationale fondée en 2014, spécialisée dans le développement web, l'intelligence artificielle, le UX design et le référencement performant. Experte dans la création de contenus digitaux, tant pour le web que pour le mobile, l'agence poursuit son expansion dans plusieurs grandes villes à travers le monde."]}),s.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed mt-2",children:[s.jsx("strong",{children:"Son ambition :"})," offrir des services et produits de haute qualité, en valorisant l'identité de ses clients tout en y apportant une véritable valeur ajoutée à travers l'innovation et la créativité."]})]})]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"4. Propriété intellectuelle"}),s.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["L'ensemble des éléments du site (textes, images, graphismes, logo, vidéos, base de données, etc.) est protégé par le Code de la propriété intellectuelle.",s.jsx("br",{}),"Toute reproduction, représentation, modification ou extraction, totale ou partielle, sans autorisation écrite de SailingLoc est interdite."]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"5. Responsabilité"}),s.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["SailingLoc met tout en œuvre pour assurer l'exactitude des informations diffusées, mais ne saurait être tenue responsable des erreurs ou omissions.",s.jsx("br",{}),"SailingLoc décline toute responsabilité quant à l'utilisation du site ou aux dommages directs ou indirects pouvant en résulter."]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"6. Données personnelles"}),s.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Pour consulter notre politique de confidentialité, veuillez vous rendre sur la page dédiée :",s.jsx("br",{}),s.jsx(z,{to:"/politique-confidentialite",className:"text-orange-500 underline hover:text-orange-600 transition-colors inline-flex items-center mt-2",children:s.jsx("span",{children:"👉 Politique de confidentialité"})})]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-700",children:"7. Cookies"}),s.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Lors de votre navigation, des cookies peuvent être déposés sur votre terminal. Vous pouvez à tout moment gérer vos préférences via notre bandeau dédié.",s.jsx("br",{}),"Pour plus d'informations, consultez notre ",s.jsx(z,{to:"/politique-confidentialite",className:"text-orange-500 underline hover:text-orange-600 transition-colors",children:"politique de confidentialité"}),"."]})]}),s.jsxs("section",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-bold mb-4 text-blue-700 flex items-center",children:[s.jsx(Vn,{className:"h-6 w-6 mr-2"}),"8. Contact"]}),s.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Pour toute question ou signalement, vous pouvez nous écrire à :",s.jsx("br",{}),s.jsxs("a",{href:"mailto:sailinglocequipe@gmail.com",className:"text-orange-500 underline hover:text-orange-600 transition-colors inline-flex items-center mt-2",children:[s.jsx(Vn,{className:"h-4 w-4 mr-1"}),s.jsx("span",{children:"📧 sailinglocequipe@gmail.com"})]})]})]})]})})]})}const Cp=({isOpen:n,onClose:e,title:t,message:r,type:i="error",details:a=null})=>{if(!n)return null;const l=()=>{switch(i){case"warning":return s.jsx(Gs,{className:"h-6 w-6 text-yellow-500"});case"success":return s.jsx(at,{className:"h-6 w-6 text-green-500"});default:return s.jsx(Gs,{className:"h-6 w-6 text-red-500"})}},c=()=>{switch(i){case"warning":return"bg-yellow-50 border-yellow-200";case"success":return"bg-green-50 border-green-200";default:return"bg-red-50 border-red-200"}},u=()=>{switch(i){case"warning":return"text-yellow-800";case"success":return"text-green-800";default:return"text-red-800"}},h=()=>{switch(i){case"warning":return"bg-yellow-600 hover:bg-yellow-700";case"success":return"bg-green-600 hover:bg-green-700";default:return"bg-red-600 hover:bg-red-700"}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:`${c()} border rounded-lg shadow-xl max-w-md w-full mx-4`,children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[l(),s.jsx("h3",{className:`text-lg font-semibold ${u()}`,children:t})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(Re,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("p",{className:`text-sm ${u()} mb-4`,children:r}),i==="error"&&s.jsx("div",{className:"bg-red-100 border border-red-300 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Gs,{className:"h-5 w-5 text-red-600"}),s.jsx("span",{className:"font-semibold text-red-800 text-sm",children:"⚠️ ATTENTION : Ces dates ne peuvent pas être réservées"})]})}),a&&a.conflictingBookings&&a.conflictingBookings.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:`font-medium text-sm ${u()} mb-2`,children:"Périodes déjà réservées :"}),s.jsx("div",{className:"space-y-2",children:a.conflictingBookings.map((p,g)=>s.jsxs("div",{className:"bg-white border border-gray-200 rounded p-3",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(gs,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-xs text-gray-600",children:["Client #",p.userId.slice(-6)]})]}),s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Du :"}),s.jsx("span",{className:"font-medium",children:new Date(p.startDate).toLocaleDateString("fr-FR")})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Au :"}),s.jsx("span",{className:"font-medium",children:new Date(p.endDate).toLocaleDateString("fr-FR")})]})]})]},g))})]}),a&&a.availabilityPeriods&&a.availabilityPeriods.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:`font-medium text-sm ${u()} mb-2`,children:"Disponibilité :"}),s.jsx("div",{className:"space-y-2",children:a.availabilityPeriods.map((p,g)=>s.jsx("div",{className:"bg-white border border-gray-200 rounded p-3",children:s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Du :"}),s.jsx("span",{className:"font-medium",children:new Date(p.startDate).toLocaleDateString("fr-FR")})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Au :"}),s.jsx("span",{className:"font-medium",children:new Date(p.endDate).toLocaleDateString("fr-FR")})]}),s.jsxs("div",{className:"flex justify-between mt-1",children:[s.jsx("span",{children:"Prix :"}),s.jsxs("span",{className:"font-medium text-green-600",children:[p.price,"€/jour"]})]})]})},g))})]}),i==="error"&&s.jsxs("div",{className:"bg-white border border-gray-200 rounded p-3",children:[s.jsx("h4",{className:"font-medium text-sm text-gray-800 mb-2",children:"Que faire ?"}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsx("li",{children:"• Choisir une autre période disponible"}),s.jsx("li",{children:"• Contacter le propriétaire pour plus d'options"}),s.jsx("li",{children:"• Vérifier le calendrier pour voir les disponibilités"})]})]})]}),s.jsx("div",{className:"flex justify-end p-4 border-t border-gray-200",children:s.jsx("button",{onClick:e,className:`${h()} text-white px-4 py-2 rounded-lg font-medium transition-colors`,children:"Compris"})})]})})},lN=({boatAvailability:n,existingBookings:e=[],onDateSelect:t,selectedStartDate:r,selectedEndDate:i})=>{const[a,l]=S.useState(new Date),[c,u]=S.useState(null),[h,p]=S.useState({isOpen:!1,title:"",message:"",type:"error",details:null}),g=b=>new Date(b.getFullYear(),b.getMonth(),1),y=b=>new Date(b.getFullYear(),b.getMonth()+1,0),_=b=>y(b).getDate(),C=b=>g(b).getDay(),E=b=>{if(!n||!n.startDate||!n.endDate)return!1;const v=new Date(n.startDate),M=new Date(n.endDate),Q=new Date(b);return Q.setHours(0,0,0,0),v.setHours(0,0,0,0),M.setHours(0,0,0,0),Q>=v&&Q<=M},N=b=>{if(!e||e.length===0)return!1;const v=new Date(b);return v.setHours(0,0,0,0),e.some(M=>{if(M.status==="cancelled")return!1;const Q=new Date(M.startDate),ie=new Date(M.endDate);return Q.setHours(0,0,0,0),ie.setHours(0,0,0,0),v>=Q&&v<=ie})},k=b=>{if(!e||e.length===0)return[];const v=new Date(b);return v.setHours(0,0,0,0),e.filter(M=>{if(M.status==="cancelled")return!1;const Q=new Date(M.startDate),ie=new Date(M.endDate);return Q.setHours(0,0,0,0),ie.setHours(0,0,0,0),v>=Q&&v<=ie})},R=b=>{if(!r||!i)return!1;const v=new Date(b),M=new Date(r),Q=new Date(i);return v.setHours(0,0,0,0),M.setHours(0,0,0,0),Q.setHours(0,0,0,0),v>=M&&v<=Q},P=b=>{if(!r)return!1;const v=new Date(b),M=new Date(r);return v.setHours(0,0,0,0),M.setHours(0,0,0,0),v.getTime()===M.getTime()},V=b=>{if(!i)return!1;const v=new Date(b),M=new Date(i);return v.setHours(0,0,0,0),M.setHours(0,0,0,0),v.getTime()===M.getTime()},B=b=>{const v=new Date;v.setHours(0,0,0,0);const M=new Date(b);return M.setHours(0,0,0,0),E(b)&&!N(b)&&M>=v},O=b=>{if(N(b)){const M=k(b);p({isOpen:!0,title:"Dates indisponibles",message:"Ces dates sont déjà réservées par un autre client.",type:"error",details:{conflictingBookings:M}});return}if(!E(b)){p({isOpen:!0,title:"Période non disponible",message:"Cette date n'est pas dans la disponibilité générale du bateau.",type:"error",details:null});return}if(!B(b))return;const v=b.toISOString().split("T")[0];r?i?t(v,null):new Date(v)>new Date(r)?t(r,v):t(v,r):t(v,null)},j=()=>{l(new Date(a.getFullYear(),a.getMonth()-1,1))},f=()=>{l(new Date(a.getFullYear(),a.getMonth()+1,1))},w=()=>{l(new Date)},A=(()=>{g(a),y(a);const b=_(a),v=C(a),M=[],Q=new Date(a.getFullYear(),a.getMonth()-1,1),ie=_(Q);for(let ee=v-1;ee>=0;ee--){const ue=ie-ee,oe=new Date(Q.getFullYear(),Q.getMonth(),ue);M.push({date:oe,isCurrentMonth:!1,isClickable:!1})}for(let ee=1;ee<=b;ee++){const ue=new Date(a.getFullYear(),a.getMonth(),ee);M.push({date:ue,isCurrentMonth:!0,isClickable:B(ue)})}const X=42-M.length;for(let ee=1;ee<=X;ee++){const ue=new Date(a.getFullYear(),a.getMonth()+1,ee);M.push({date:ue,isCurrentMonth:!1,isClickable:!1})}return M})();return s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[s.jsx(at,{className:"h-5 w-5 text-blue-600 mr-2"}),"Calendrier de disponibilité"]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:j,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:"←"}),s.jsx("button",{onClick:w,className:"px-3 py-2 text-sm text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",children:"Aujourd'hui"}),s.jsx("button",{onClick:f,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:"→"})]})]}),n&&n.startDate&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-blue-800 mb-2",children:[s.jsx(Gi,{className:"h-4 w-4"}),s.jsx("span",{className:"font-medium",children:"Disponibilité du bateau"})]}),s.jsxs("p",{className:"text-sm text-blue-700",children:["Du ",new Date(n.startDate).toLocaleDateString("fr-FR"),"au ",new Date(n.endDate).toLocaleDateString("fr-FR")]}),s.jsxs("p",{className:"text-sm text-blue-700",children:["Prix : ",n.price,"€ par jour"]}),n.notes&&s.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Notes : ",n.notes]})]}),s.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"].map((b,v)=>s.jsx("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:b},v))}),s.jsx("div",{className:"grid grid-cols-7 gap-1",children:A.map((b,v)=>{const M=E(b.date),Q=N(b.date),ie=R(b.date),X=P(b.date),ee=V(b.date),ue=b.date.toDateString()===new Date().toDateString();let oe="bg-white",Ie="text-gray-400",de="border-gray-200";return b.isCurrentMonth&&(ie?X||ee?(oe="bg-blue-600",Ie="text-white",de="border-blue-600"):(oe="bg-blue-100",Ie="text-blue-800",de="border-blue-200"):Q?(oe="bg-red-100",Ie="text-red-800",de="border-red-200"):M?(oe="bg-green-50",Ie="text-green-800",de="border-green-200"):Ie="text-gray-900"),ue&&(de="border-blue-500"),s.jsxs("div",{className:`
                ${oe} ${Ie} ${de}
                border rounded-lg p-2 text-center text-sm cursor-pointer
                transition-all duration-200 hover:shadow-md
                ${b.isClickable?"hover:scale-105":""}
                ${b.isCurrentMonth?"":"opacity-50"}
                ${b.isClickable?"":"cursor-not-allowed"}
              `,onClick:()=>O(b.date),onMouseEnter:()=>u(b.date),onMouseLeave:()=>u(null),children:[s.jsx("div",{className:"font-medium",children:b.date.getDate()}),ue&&s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mx-auto mt-1"}),M&&!ie&&!Q&&s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mx-auto mt-1"}),Q&&s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mx-auto mt-1"}),X&&s.jsx("div",{className:"text-xs font-bold mt-1",children:"Début"}),ee&&s.jsx("div",{className:"text-xs font-bold mt-1",children:"Fin"}),Q&&s.jsx("div",{className:"text-xs font-bold text-red-700 bg-red-200 px-2 py-1 rounded-full mt-1",children:"❌ RÉSERVÉ"})]},v)})}),s.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-green-50 border border-green-200 rounded"}),s.jsx("span",{children:"Disponible"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-red-100 border border-red-200 rounded"}),s.jsx("span",{children:"Réservé"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-blue-100 border border-blue-200 rounded"}),s.jsx("span",{children:"Sélectionné"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-blue-600 rounded"}),s.jsx("span",{children:"Début/Fin"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-white border border-blue-500 rounded"}),s.jsx("span",{children:"Aujourd'hui"})]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Instructions :"})," Cliquez sur une date disponible pour sélectionner le début de votre réservation, puis cliquez sur une autre date pour sélectionner la fin."]})}),s.jsx(Cp,{isOpen:h.isOpen,onClose:()=>p({...h,isOpen:!1}),title:h.title,message:h.message,type:h.type,details:h.details})]})},cN=({startDate:n,endDate:e,boatAvailability:t,existingBookings:r,onConflictDetected:i})=>{if(S.useEffect(()=>{if(n&&e&&i&&l()){const _=c();i({title:"Conflit de réservation détecté",message:"La période sélectionnée chevauche des réservations existantes.",type:"error",details:{conflictingBookings:_}})}},[n,e,r,i]),!n||!e)return null;const a=()=>{if(!t||!t.startDate||!t.endDate)return!1;const y=new Date(t.startDate),_=new Date(t.endDate),C=new Date(n),E=new Date(e);return y.setHours(0,0,0,0),_.setHours(0,0,0,0),C.setHours(0,0,0,0),E.setHours(0,0,0,0),C>=y&&E<=_},l=()=>{if(!r||r.length===0)return!1;const y=new Date(n),_=new Date(e);return y.setHours(0,0,0,0),_.setHours(0,0,0,0),r.some(C=>{if(C.status==="cancelled")return!1;const E=new Date(C.startDate),N=new Date(C.endDate);return E.setHours(0,0,0,0),N.setHours(0,0,0,0),!(_<=E||y>=N)})},c=()=>{if(!r||r.length===0)return[];const y=new Date(n),_=new Date(e);return y.setHours(0,0,0,0),_.setHours(0,0,0,0),r.filter(C=>{if(C.status==="cancelled")return!1;const E=new Date(C.startDate),N=new Date(C.endDate);return E.setHours(0,0,0,0),N.setHours(0,0,0,0),!(_<=E||y>=N)})},u=(y,_)=>{const C=new Date(y),E=new Date(_);C.setHours(0,0,0,0),E.setHours(0,0,0,0);const k=(E.getTime()-C.getTime())/(1e3*60*60*24);return Math.max(1,Math.ceil(k))},h=a(),p=l(),g=c();return h?p?s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-red-800 mb-2",children:[s.jsx(Gs,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"⚠️ DATES INDISPONIBLES"})]}),s.jsx("p",{className:"text-sm text-red-700 mb-3",children:"La période sélectionnée chevauche des réservations existantes :"}),s.jsx("div",{className:"space-y-2",children:g.map((y,_)=>s.jsxs("div",{className:"bg-red-100 border border-red-200 rounded p-2",children:[s.jsxs("div",{className:"text-sm text-red-800",children:[s.jsx("span",{className:"font-medium",children:"Réservé du :"})," ",new Date(y.startDate).toLocaleDateString("fr-FR")]}),s.jsxs("div",{className:"text-sm text-red-800",children:[s.jsx("span",{className:"font-medium",children:"Au :"})," ",new Date(y.endDate).toLocaleDateString("fr-FR")]})]},_))}),s.jsx("p",{className:"text-sm text-red-600 mt-3",children:"Veuillez sélectionner une autre période ou contacter le propriétaire."})]}):s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-green-800 mb-2",children:[s.jsx(On,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"Période disponible"})]}),s.jsx("p",{className:"text-sm text-green-700",children:"La période sélectionnée est disponible et peut être réservée."}),s.jsxs("div",{className:"mt-2 text-sm text-green-600",children:[s.jsxs("div",{children:["Du : ",new Date(n).toLocaleDateString("fr-FR")]}),s.jsxs("div",{children:["Au : ",new Date(e).toLocaleDateString("fr-FR")]}),s.jsxs("div",{className:"font-medium mt-1",children:["Durée : ",u(n,e)," jours"]})]})]}):s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-red-800 mb-2",children:[s.jsx(Xi,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"Période non disponible"})]}),s.jsx("p",{className:"text-sm text-red-700",children:"La période sélectionnée n'est pas dans la disponibilité générale du bateau."}),s.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Disponibilité : du ",new Date(t?.startDate).toLocaleDateString("fr-FR"),"au ",new Date(t?.endDate).toLocaleDateString("fr-FR")]})]})};function uN(){const{boatId:n}=bd();es();const[e,t]=S.useState(null),[r,i]=S.useState(!0),[a,l]=S.useState(!1),[c,u]=S.useState(!1),[h,p]=S.useState(""),[g,y]=S.useState([]),[_,C]=S.useState({isOpen:!1,title:"",message:"",type:"error",details:null}),[E,N]=S.useState({startDate:"",endDate:"",numberOfGuests:1,specialRequests:"",totalPrice:0});S.useEffect(()=>{n&&k()},[n]),S.useEffect(()=>{E.startDate&&E.endDate&&e&&R()},[E.startDate,E.endDate,E.numberOfGuests,e]),S.useEffect(()=>{if(E.startDate&&E.endDate&&e){const f=new Date(E.startDate),w=new Date(E.endDate),T=new Date;T.setHours(0,0,0,0),f<=w&&f>=T&&p("")}},[E.startDate,E.endDate,e]);const k=async()=>{try{i(!0),console.log("🔄 Récupération des détails du bateau depuis MongoDB...");const f=await te(se.BOAT_DETAIL(n));console.log("✅ Détails du bateau récupérés:",f),t(f),console.log("🔄 Récupération des réservations existantes depuis MongoDB...");try{const w=await te(`${se.BOOKINGS}/boat/${n}`);w.success&&(y(w.data),console.log("✅ Réservations existantes chargées:",w.data))}catch(w){console.log("⚠️ Erreur lors de la récupération des réservations:",w.message)}}catch(f){p("Bateau non trouvé: "+f.message),console.error("❌ Erreur lors de la récupération des détails:",f)}finally{i(!1)}},R=()=>{if(!E.startDate||!E.endDate||!e)return;const f=new Date(E.startDate),w=new Date(E.endDate),A=Math.max(1,Math.ceil((w-f)/(1e3*60*60*24)))*e.prix_jour;N(b=>({...b,totalPrice:A}))},P=(f,w)=>{const T=new Date(f),A=new Date(w);T.setHours(0,0,0,0),A.setHours(0,0,0,0);const v=(A.getTime()-T.getTime())/(1e3*60*60*24);return Math.max(1,Math.ceil(v))},V=(f,w)=>{N(T=>({...T,[f]:w})),(f==="startDate"||f==="endDate")&&p("")},B=(f,w)=>{N(T=>({...T,startDate:f||"",endDate:w||""})),p("")},O=f=>{C(f),f.title==="Période non disponible"&&p("Période non disponible - Veuillez sélectionner des dates valides")},j=async f=>{if(f.preventDefault(),!E.startDate||!E.endDate){p("Veuillez sélectionner les dates de début et de fin");return}const w=new Date(E.startDate),T=new Date(E.endDate);if(w>T){p("La date de fin doit être égale ou postérieure à la date de début");return}const A=new Date;if(A.setHours(0,0,0,0),w<A){p("La date de début ne peut pas être dans le passé");return}if(g&&g.length>0&&g.some(v=>{if(v.status==="cancelled")return!1;const M=new Date(v.startDate),Q=new Date(v.endDate);return w.setHours(0,0,0,0),T.setHours(0,0,0,0),M.setHours(0,0,0,0),Q.setHours(0,0,0,0),!(T<=M||w>=Q)})){p("La période sélectionnée chevauche des réservations existantes. Veuillez choisir une autre période.");return}try{l(!0),p("");const b=localStorage.getItem("token")||sessionStorage.getItem("token");if(!b){p("Vous devez être connecté pour effectuer une réservation");return}console.log("🔄 Création de la session de paiement...");const v=await te("https://sailingloc-back-lilac.vercel.app/api/payment/create-checkout-session",{method:"POST",headers:he(b),body:JSON.stringify({boatId:n,startDate:E.startDate,endDate:E.endDate,numberOfGuests:E.numberOfGuests,specialRequests:E.specialRequests,successUrl:"https://sailingloc-front.vercel.app/payment/success?session_id={CHECKOUT_SESSION_ID}",cancelUrl:"https://sailingloc-front.vercel.app/payment/cancel"})});if(!v||!v.url)throw new Error(v?.message||"Erreur lors de l'initiation du paiement");const{url:M}=v;window.location.href=M}catch(b){p(b.message)}finally{l(!1)}};return r?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(wt,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement du bateau..."})]})}):h&&!e?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(We,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:h}),s.jsx(z,{to:"/bateaux",className:"text-blue-600 hover:text-blue-700",children:"Retourner à la liste des bateaux"})]})}):c?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto",children:[s.jsx(On,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Réservation confirmée !"}),s.jsx("p",{className:"text-gray-600 mb-6",children:'Votre réservation a été créée avec succès ! Elle apparaîtra dans votre espace "Mes Réservations".'}),s.jsx("p",{className:"text-sm text-gray-500",children:'Redirection vers "Mes Réservations" dans quelques secondes...'})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[s.jsxs(z,{to:`/bateaux/${n}`,className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 mb-4",children:[s.jsx(ya,{size:20}),s.jsx("span",{children:"Retour au bateau"})]}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Réserver ce bateau"})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Détails de la réservation"}),h&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6",children:h}),s.jsxs("form",{onSubmit:j,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de début"}),s.jsx("input",{type:"date",value:E.startDate,onChange:f=>V("startDate",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de fin"}),s.jsx("input",{type:"date",value:E.endDate,onChange:f=>V("endDate",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de personnes"}),s.jsx("select",{value:E.numberOfGuests,onChange:f=>V("numberOfGuests",parseInt(f.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[...Array(e.capacite)].map((f,w)=>s.jsxs("option",{value:w+1,children:[w+1," personne",w+1>1?"s":""]},w+1))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Demandes spéciales (optionnel)"}),s.jsx("textarea",{value:E.specialRequests,onChange:f=>V("specialRequests",f.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Équipements supplémentaires, préférences particulières..."})]}),!h&&s.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx(wt,{className:"h-5 w-5 animate-spin"}),s.jsx("span",{children:"Redirection vers le paiement..."})]}):"Confirmer la réservation"})]}),E.startDate&&E.endDate&&s.jsx(cN,{startDate:E.startDate,endDate:E.endDate,boatAvailability:e?.availability,existingBookings:g,onConflictDetected:O})]}),e&&e.availability&&e.availability.startDate&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Calendrier de disponibilité"}),s.jsx(lN,{boatAvailability:e.availability,existingBookings:g,onDateSelect:B,selectedStartDate:E.startDate,selectedEndDate:E.endDate})]})]}),s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-24",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Résumé"}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx("img",{src:e.image,alt:e.nom,className:"w-16 h-16 object-cover rounded-lg"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.nom}),s.jsx("p",{className:"text-sm text-gray-600 capitalize",children:e.type})]})]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Wt,{size:16}),s.jsx("span",{children:e.destination})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ys,{size:16}),s.jsxs("span",{children:["Capacité : ",e.capacite," personnes"]})]})]}),e.availability&&e.availability.startDate&&s.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-md",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-green-800 mb-2",children:[s.jsx(at,{size:16}),s.jsx("span",{className:"font-medium text-sm",children:"Disponibilité"})]}),s.jsxs("div",{className:"text-xs text-green-700 space-y-1",children:[s.jsxs("div",{children:["Du ",new Date(e.availability.startDate).toLocaleDateString("fr-FR")]}),s.jsxs("div",{children:["Au ",new Date(e.availability.endDate).toLocaleDateString("fr-FR")]}),e.availability.notes&&s.jsx("div",{className:"italic",children:e.availability.notes})]})]})]}),s.jsxs("div",{className:"space-y-3 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Prix par jour"}),s.jsxs("span",{className:"font-medium",children:[e.prix_jour,"€"]})]}),E.startDate&&E.endDate&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Durée"}),s.jsxs("span",{className:"font-medium",children:[P(E.startDate,E.endDate)," jours"]})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Nombre de personnes"}),s.jsx("span",{className:"font-medium",children:E.numberOfGuests})]})]}),s.jsx("div",{className:"border-t pt-3",children:s.jsxs("div",{className:"flex items-center justify-between font-semibold",children:[s.jsx("span",{children:"Total"}),s.jsxs("span",{className:"text-lg text-blue-600",children:[E.totalPrice,"€"]})]})})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Informations importantes"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[s.jsx("li",{children:"• Réservation sécurisée"}),s.jsx("li",{children:"• Annulation gratuite jusqu'à 24h avant"}),s.jsx("li",{children:"• Paiement sécurisé"}),s.jsx("li",{children:"• Support client 24/7"})]})]})]})})]})}),s.jsx(Cp,{isOpen:_.isOpen,onClose:()=>C({..._,isOpen:!1}),title:_.title,message:_.message,type:_.type,details:_.details})]})}function dN(){const[n,e]=S.useState([]),[t,r]=S.useState(!0),[i,a]=S.useState("");S.useEffect(()=>{l()},[]);const l=async()=>{try{r(!0);const p=localStorage.getItem("token")||sessionStorage.getItem("token");if(!p){a("Vous devez être connecté pour voir vos réservations"),r(!1);return}console.log("🔄 Récupération des réservations depuis MongoDB...");const g=await te(se.MY_BOOKINGS,{headers:he(p)});console.log("📊 Structure de la réponse API:",g);const y=g.data||g.reservations||g||[];console.log(`✅ ${y.length||0} réservations récupérées depuis MongoDB`),e(y)}catch(p){a(p.message)}finally{r(!1)}},c=p=>{switch(p){case"confirmed":return{icon:s.jsx(bt,{size:20,className:"text-blue-600"}),label:"Confirmée",color:"bg-blue-100 text-blue-800 border-blue-200"};case"pending":return{icon:s.jsx(bt,{size:20,className:"text-yellow-600"}),label:"En attente",color:"bg-yellow-100 text-yellow-800 border-yellow-200"};case"cancelled":return{icon:s.jsx(Xi,{size:20,className:"text-red-600"}),label:"Annulée",color:"bg-red-100 text-red-800 border-red-200"};default:return{icon:s.jsx(Ot,{size:20,className:"text-gray-600"}),label:p,color:"bg-gray-100 text-gray-800 border-gray-200"}}},u=p=>new Date(p).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),h=(p,g)=>{const y=new Date(p),_=new Date(g);y.setHours(0,0,0,0),_.setHours(0,0,0,0);const E=(_.getTime()-y.getTime())/(1e3*60*60*24);return Math.max(1,Math.ceil(E))};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(wt,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement de vos réservations..."})]})}):i?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto",children:[s.jsx(Ot,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Connexion requise"}),s.jsx("p",{className:"text-gray-600 mb-6",children:i}),s.jsx(z,{to:"/connexion",className:"inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mes Réservations"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Gérez et suivez toutes vos réservations de bateaux"})]}),s.jsx(z,{to:"/bateaux",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Réserver un bateau"})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:n.length===0?s.jsxs("div",{className:"text-center py-16",children:[s.jsx(We,{className:"h-24 w-24 text-gray-300 mx-auto mb-6"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Aucune réservation pour le moment"}),s.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:"Vous n'avez pas encore de réservations. Commencez par explorer nos bateaux disponibles et réservez votre première sortie en mer !"}),s.jsx(z,{to:"/bateaux",className:"inline-block bg-orange-500 text-white px-8 py-4 rounded-lg text-lg font-medium hover:bg-orange-600 transition-colors",children:"Découvrir nos bateaux"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(at,{className:"h-6 w-6 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.length})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(bt,{className:"h-6 w-6 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Confirmées"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.filter(p=>p.status==="confirmed").length})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:s.jsx(bt,{className:"h-6 w-6 text-yellow-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En attente"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.filter(p=>p.status==="pending").length})]})]})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Toutes vos réservations"}),n.map(p=>{const g=c(p.status),y=h(p.startDate,p.endDate);return s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:p.boatId?.nom||"Bateau"}),s.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${g.color}`,children:[g.icon,s.jsx("span",{className:"ml-1",children:g.label})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(at,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-600",children:["Du ",u(p.startDate)," au ",u(p.endDate)]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(bt,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-600",children:[y," jour",y>1?"s":""]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ys,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-600",children:[p.numberOfGuests," personne",p.numberOfGuests>1?"s":""]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Wi,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-600 font-medium",children:[p.totalPrice,"€"]})]})]}),p.specialRequests&&s.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Demandes spéciales :"})," ",p.specialRequests]})})]}),s.jsx("div",{className:"flex flex-col items-end space-y-2",children:s.jsx(z,{to:`/bateaux/${p.boatId?._id||p.boatId}`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Voir le bateau"})})]})})},p._id)})]})]})})]})}const hN=()=>{const[n,e]=S.useState([]),[t,r]=S.useState(!0),[i,a]=S.useState("");S.useEffect(()=>{l()},[]);const l=async()=>{try{r(!0),a("");const _=localStorage.getItem("token")||sessionStorage.getItem("token");if(!_)throw new Error("Token d'authentification manquant");console.log("🔄 Récupération des réservations du propriétaire depuis MongoDB...");const C=await te(`${se.BOOKINGS}/owner`,{headers:he(_)});if(console.log("✅ Réservations du propriétaire récupérées:",C),C.success)e(C.data),C.message&&console.log(C.message);else throw new Error(C.message||"Erreur lors du chargement des réservations")}catch(_){console.error("Erreur loadOwnerBookings:",_),a(_.message)}finally{r(!1)}},c=async(_,C)=>{try{const E=localStorage.getItem("token")||sessionStorage.getItem("token");if(!E)throw new Error("Token d'authentification manquant");console.log("🔄 Action du propriétaire sur la réservation...");const N=await te(`${se.BOOKINGS}/${_}/owner-action`,{method:"PUT",headers:he(E),body:JSON.stringify({action:C})});if(console.log("✅ Action du propriétaire effectuée:",N),N.success)await l(),alert(N.message);else throw new Error(N.message||"Erreur lors de l'action")}catch(E){console.error("Erreur handleOwnerAction:",E),alert(`Erreur: ${E.message}`)}},u=_=>{switch(_){case"pending":return s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[s.jsx(bt,{className:"h-3 w-3 mr-1"}),"En attente"]});case"confirmed":return s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[s.jsx(On,{className:"h-3 w-3 mr-1"}),"Confirmée"]});case"cancelled":return s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[s.jsx(Xi,{className:"h-3 w-3 mr-1"}),"Annulée"]});case"completed":return s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Terminée"});default:return s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:_})}},h=_=>new Date(_).toLocaleDateString("fr-FR"),p=(_,C)=>{const E=new Date(_),N=new Date(C);E.setHours(0,0,0,0),N.setHours(0,0,0,0);const R=(N.getTime()-E.getTime())/(1e3*60*60*24);return Math.max(1,Math.ceil(R))};if(t)return s.jsx("div",{className:"flex items-center justify-center p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx(bt,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-600",children:"Chargement des réservations..."})]})});if(i)return s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("p",{className:"text-red-800",children:["Erreur: ",i]})});const g=n.filter(_=>_.status==="pending"),y=n.filter(_=>_.status!=="pending");return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(bt,{className:"h-5 w-5 text-yellow-600 mr-2"}),"Réservations en attente de confirmation (",g.length,")"]}),g.length===0?s.jsx("p",{className:"text-gray-500 text-sm",children:"Aucune réservation en attente"}):s.jsx("div",{className:"space-y-4",children:g.map(_=>s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(gs,{className:"h-5 w-5 text-yellow-600"}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[_.userId?.nom," ",_.userId?.prenom]}),s.jsx("p",{className:"text-sm text-gray-600",children:_.userId?.email})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(We,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:_.boatId?.nom})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(at,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm text-gray-700",children:["Du ",h(_.startDate)," au ",h(_.endDate)]})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(Wi,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm text-gray-700",children:["Total: ",_.totalPrice,"€ (",p(_.startDate,_.endDate)," jours)"]})]}),_.numberOfGuests&&s.jsxs("p",{className:"text-sm text-gray-600",children:["Nombre de personnes: ",_.numberOfGuests]}),_.specialRequests&&s.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[s.jsx("span",{className:"font-medium",children:"Demandes spéciales:"})," ",_.specialRequests]})]}),s.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[u(_.status),s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs("button",{onClick:()=>c(_._id,"confirm"),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[s.jsx(On,{className:"h-4 w-4 mr-1"}),"Confirmer"]}),s.jsxs("button",{onClick:()=>c(_._id,"refuse"),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[s.jsx(Xi,{className:"h-4 w-4 mr-1"}),"Refuser"]})]})]})]})},_._id))})]}),y.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Autres réservations"}),s.jsx("div",{className:"space-y-4",children:y.map(_=>s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(gs,{className:"h-5 w-5 text-gray-600"}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[_.userId?.nom," ",_.userId?.prenom]}),s.jsx("p",{className:"text-sm text-gray-600",children:_.userId?.email})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(We,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:_.boatId?.nom})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(at,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm text-gray-700",children:["Du ",h(_.startDate)," au ",h(_.endDate)]})]}),s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(Wi,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm text-gray-700",children:["Total: ",_.totalPrice,"€"]})]})]}),s.jsx("div",{className:"ml-4",children:u(_.status)})]})},_._id))})]})]})};function mN(){const n=es(),[e,t]=S.useState(!0),[r,i]=S.useState("");S.useEffect(()=>{a()},[]);const a=()=>{try{if(t(!0),!(localStorage.getItem("token")||sessionStorage.getItem("token"))){i("Vous devez être connecté pour accéder à la gestion de vos réservations"),t(!1);return}t(!1)}catch{i("Erreur lors de la vérification de l'authentification"),t(!1)}};return e?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(wt,{className:"h-12 w-12 text-blue-500 animate-spin"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]}):r?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(Ot,{className:"h-16 w-16 text-red-500 mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Connexion requise"}),s.jsx("p",{className:"text-lg text-gray-800 mb-6",children:r}),s.jsx(z,{to:"/connexion",children:s.jsx("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Se connecter"})})]}):localStorage.getItem("userRole")!=="proprietaire"?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[s.jsx(Ot,{className:"h-16 w-16 text-red-500 mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Accès refusé"}),s.jsx("p",{className:"text-lg text-gray-800 mb-6",children:"Vous devez être propriétaire pour accéder à la gestion des réservations"}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx(z,{to:"/bateaux",children:s.jsx("button",{className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Voir les bateaux"})}),s.jsx(z,{to:"/inscription",children:s.jsx("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Inscription"})})]})]}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[s.jsxs("button",{onClick:()=>n(-1),className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 mb-4",children:[s.jsx(ya,{size:20}),s.jsx("span",{children:"Retour"})]}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des réservations"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Gérez les réservations de vos bateaux et confirmez ou refusez les demandes"})]})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8",children:[s.jsxs("h2",{className:"text-lg font-semibold text-blue-900 mb-4 flex items-center",children:[s.jsx(bt,{className:"h-5 w-5 text-blue-600 mr-2"}),"Comment ça fonctionne ?"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"bg-blue-100 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3",children:s.jsx("span",{className:"text-blue-600 font-bold text-lg",children:"1"})}),s.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Client réserve et paie"}),s.jsx("p",{className:"text-sm text-blue-700",children:'Le client sélectionne ses dates, paie et la réservation passe en statut "En attente"'})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"bg-blue-100 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3",children:s.jsx("span",{className:"text-blue-600 font-bold text-lg",children:"2"})}),s.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Dates bloquées"}),s.jsx("p",{className:"text-sm text-blue-700",children:"Les dates sont automatiquement bloquées (rouge) pour éviter les conflits"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"bg-blue-100 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3",children:s.jsx("span",{className:"text-blue-600 font-bold text-lg",children:"3"})}),s.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Vous confirmez"}),s.jsx("p",{className:"text-sm text-blue-700",children:"Vous confirmez ou refusez la réservation selon votre disponibilité"})]})]})]}),s.jsx(hN,{})]})]})}function pN(){return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-50 pt-20",children:s.jsx("section",{className:"relative py-20",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"relative inline-block",children:[s.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-2xl",children:s.jsx(We,{className:"h-16 w-16 text-white"})}),s.jsx("div",{className:"absolute -top-2 -right-2 w-12 h-12 bg-red-500 rounded-full flex items-center justify-center shadow-lg",children:s.jsx("span",{className:"text-white font-bold text-xl",children:"!"})})]}),s.jsx("h1",{className:"text-8xl md:text-9xl font-bold text-blue-600 mb-4 tracking-wider",children:"404"}),s.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-6",children:"Page introuvable"}),s.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed",children:"Oups ! Il semble que vous ayez navigué vers des eaux inconnues. Cette page n'existe pas ou a été déplacée."})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-12 border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-6",children:[s.jsx(Oc,{className:"h-8 w-8 text-blue-500"}),s.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Navigation perdue"})]}),s.jsx("p",{className:"text-gray-600 text-lg mb-6",children:"Ne vous inquiétez pas, même les meilleurs navigateurs peuvent se perdre ! Utilisez la boussole ci-dessous pour retrouver votre route."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"🌊"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Océans explorés"}),s.jsx("div",{className:"text-2xl font-bold text-blue-800",children:"7"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"⚓"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Ports visités"}),s.jsx("div",{className:"text-2xl font-bold text-green-800",children:"42"})]}),s.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[s.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:"🧭"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Direction trouvée"}),s.jsx("div",{className:"text-2xl font-bold text-orange-800",children:"100%"})]})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-12",children:[s.jsxs(z,{to:"/",className:"inline-flex items-center space-x-3 bg-blue-600 text-white px-8 py-4 rounded-full font-bold text-lg hover:bg-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg",children:[s.jsx(hf,{size:24}),s.jsx("span",{children:"Retour à l'accueil"})]}),s.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center space-x-3 border-2 border-blue-600 text-blue-600 px-8 py-4 rounded-full font-bold text-lg hover:bg-blue-50 transition-all duration-300 transform hover:scale-105",children:[s.jsx(ya,{size:24}),s.jsx("span",{children:"Page précédente"})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:[s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Destinations populaires"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs(z,{to:"/bateaux",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[s.jsx(fs,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"Nos bateaux"})]}),s.jsxs(z,{to:"/a-propos",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[s.jsx(We,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"À propos"})]}),s.jsxs(z,{to:"/contact",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[s.jsx(Oc,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"Contact"})]}),s.jsxs(z,{to:"/inscription",className:"flex items-center space-x-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 group",children:[s.jsx(fs,{className:"h-6 w-6 text-blue-500 group-hover:text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-700 group-hover:text-blue-700",children:"S'inscrire"})]})]})]}),s.jsxs("div",{className:"mt-12 text-center",children:[s.jsxs("p",{className:"text-lg text-gray-600 mb-4",children:["💡 ",s.jsx("strong",{children:"Conseil de navigateur :"}),"Gardez toujours un œil sur votre boussole !"]}),s.jsxs("div",{className:"flex items-center justify-center space-x-2 text-blue-600",children:[s.jsx(fs,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"SailingLoc - Votre boussole vers l'aventure"})]})]})]})})})}function fN(){const{pathname:n}=Zo();return S.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[n]),null}function gN(){const[n,e]=S.useState(!1);S.useEffect(()=>{try{(typeof window<"u"?window.localStorage.getItem("cookieConsent"):null)||e(!0)}catch{e(!0)}},[]),S.useEffect(()=>{if(!(typeof document>"u")&&n){const r=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=r}}},[n]);const t=r=>{try{typeof window<"u"&&(window.localStorage.setItem("cookieConsent",r),window.localStorage.setItem("cookieConsentAt",new Date().toISOString()))}catch{}e(!1)};return n?s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm",role:"dialog","aria-modal":"true","aria-labelledby":"cookie-consent-title",children:s.jsx("div",{className:"min-h-full flex items-end md:items-center justify-center p-4",children:s.jsxs("div",{className:"w-full md:max-w-3xl rounded-2xl bg-white shadow-2xl border border-gray-200 p-6 md:p-8",children:[s.jsx("h2",{id:"cookie-consent-title",className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3",children:"Gestion des cookies"}),s.jsxs("p",{className:"text-base md:text-lg text-gray-700 leading-relaxed mb-4",children:["Nous utilisons des cookies pour assurer le bon fonctionnement du site, améliorer votre expérience, mesurer l'audience et sécuriser votre session. Vous pouvez"," ",s.jsx("span",{className:"font-semibold",children:"refuser"})," les cookies non essentiels ou ",s.jsx("span",{className:"font-semibold",children:"accepter"})," tous les cookies. Pour en savoir plus, consultez notre",s.jsxs(z,{to:"/politique-confidentialite",className:"text-blue-600 underline hover:text-blue-700",children:[" ","politique de confidentialité"]}),"."]}),s.jsxs("ul",{className:"text-sm md:text-base text-gray-600 list-disc pl-5 space-y-1 mb-6",children:[s.jsx("li",{children:"Cookies essentiels: nécessaires au fonctionnement et à la sécurité (toujours actifs)."}),s.jsx("li",{children:"Cookies de mesure d’audience et de personnalisation: activés uniquement si vous acceptez."})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3",children:[s.jsx("button",{type:"button",onClick:()=>t("rejected"),className:"w-full sm:w-auto px-5 py-3 rounded-xl border border-gray-300 text-gray-800 bg-white hover:bg-gray-50 text-base font-medium",children:"Refuser"}),s.jsx("button",{type:"button",onClick:()=>t("accepted"),className:"w-full sm:w-auto px-5 py-3 rounded-xl bg-blue-600 text-white hover:bg-blue-700 text-base font-semibold",children:"Accepter"})]})]})})}):null}function xN(){const n=Zo();es();const[e,t]=S.useState(!0),[r,i]=S.useState(""),a=new URLSearchParams(n.search),l=a.get("boatId"),c=a.get("startDate"),u=a.get("endDate"),h=a.get("numberOfGuests")?parseInt(a.get("numberOfGuests"),10):1,p=a.get("specialRequests")||"",g=async()=>{try{t(!0),i("");const y=localStorage.getItem("token")||sessionStorage.getItem("token");if(!y)throw new Error("Vous devez être connecté pour payer.");if(!l||!c||!u)throw new Error("Paramètres de réservation manquants.");console.log("🔄 Création de la session de paiement...");const _=await te("https://sailingloc-back-lilac.vercel.app/api/payment/create-checkout-session",{method:"POST",headers:he(y),body:JSON.stringify({boatId:l,startDate:c,endDate:u,numberOfGuests:h,specialRequests:p,successUrl:"https://sailingloc-front.vercel.app/payment/success?session_id={CHECKOUT_SESSION_ID}",cancelUrl:"https://sailingloc-front.vercel.app/payment/cancel"})});if(!_||!_.url)throw new Error(_?.message||"Échec de l'initiation du paiement.");const{url:C}=_;window.location.href=C}catch(y){i(y.message)}finally{t(!1)}};return S.useEffect(()=>{l&&c&&u?g():(t(!1),i("Paramètres manquants. Veuillez recommencer la réservation."))},[]),e?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(wt,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-700",children:"Redirection vers le paiement sécurisé..."})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-8 max-w-md w-full text-center",children:[s.jsx(vd,{className:"h-12 w-12 text-blue-600 mx-auto mb-3"}),s.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Paiement"}),r?s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-red-600 mb-4",children:r}),s.jsxs("div",{className:"space-x-3",children:[s.jsx(z,{to:"/bateaux",className:"text-blue-600 hover:text-blue-700",children:"Retour aux bateaux"}),l&&c&&u&&s.jsx("button",{onClick:g,className:"inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Réessayer le paiement"})]})]}):s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-gray-700 mb-4",children:"Cliquez sur le bouton ci-dessous si vous n’avez pas été redirigé automatiquement."}),s.jsx("button",{onClick:g,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Continuer vers Stripe"})]})]})})}function yN(){const n=es(),[e,t]=S.useState("Validation du paiement en cours..."),[r,i]=S.useState("");return S.useEffect(()=>{const l=new URLSearchParams(window.location.search).get("session_id"),c=localStorage.getItem("token")||sessionStorage.getItem("token");async function u(){try{if(!l)throw new Error("Identifiant de session Stripe manquant.");if(!c)throw new Error("Vous devez être connecté pour finaliser la réservation.");console.log("🔄 Confirmation du paiement...");const h=await te("https://sailingloc-back-lilac.vercel.app/api/payment/confirm",{method:"POST",headers:he(c),body:JSON.stringify({session_id:l})});if(!h||!h.success)throw new Error(h?.message||"Échec de la confirmation du paiement.");t("Paiement confirmé ! Votre réservation est en attente de confirmation par le propriétaire."),setTimeout(()=>n("/mes-reservations"),4e3)}catch(h){i(h.message)}}u()},[n]),r?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-600 mb-4",children:r}),s.jsx("button",{onClick:()=>n("/"),className:"text-blue-600 hover:text-blue-700",children:"Retour à l’accueil"})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(On,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-800",children:e}),s.jsx(wt,{className:"h-6 w-6 animate-spin text-blue-600 mx-auto mt-4"}),s.jsx("div",{className:"mt-6",children:s.jsx("button",{onClick:()=>n("/mes-reservations"),className:"text-blue-600 hover:text-blue-700",children:"Aller à mes réservations"})})]})})}function bN(){const[n]=Jp(),e=es(),[t,r]=S.useState("Paiement annulé. Annulation de la réservation en cours..."),[i,a]=S.useState("");return S.useEffect(()=>{const l=n.get("bookingId"),c=localStorage.getItem("token")||sessionStorage.getItem("token");async function u(){try{if(!l){r("Paiement annulé.");return}if(!c){a("Veuillez vous connecter pour annuler la réservation.");return}console.log("🔄 Annulation de la réservation...");const h=await te(`${se.BOOKINGS}/${l}/cancel`,{method:"PUT",headers:he(c)});if(!h||!h.success)throw new Error(h?.message||"Impossible d'annuler la réservation.");r("Réservation annulée suite à l’annulation du paiement.")}catch(h){a(h.message)}}u()},[n]),s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-8 max-w-md w-full text-center",children:[s.jsx("h1",{className:"text-2xl font-bold mb-3",children:"Paiement annulé"}),i?s.jsx("p",{className:"text-red-600 mb-6",children:i}):s.jsx("p",{className:"text-gray-700 mb-6",children:t}),s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx("button",{onClick:()=>e(-1),className:"text-blue-600 hover:text-blue-700",children:"Revenir en arrière"}),s.jsx(z,{to:"/bateaux",className:"text-blue-600 hover:text-blue-700",children:"Voir les bateaux"})]})]})})}function vN(){const[n,e]=S.useState(null),[t,r]=S.useState(""),[i,a]=S.useState(""),[l,c]=S.useState([]),[u,h]=S.useState({nom:"",type:"voilier",prix:"",capacite:""}),[p,g]=S.useState(null),[y,_]=S.useState(null),[C,E]=S.useState("");S.useEffect(()=>{const O=Oi.onAuthStateChanged(j=>{e(j),j&&N()});return()=>O()},[]);const N=async()=>{try{const j=(await qj(md(yo,"boats"))).docs.map(f=>({id:f.id,...f.data()}));c(j)}catch(O){E(`Erreur lors de la récupération: ${O.message}`)}},k=async O=>{try{O?(await cb(Oi,t,i),E("Connexion réussie !")):(await lb(Oi,t,i),E("Compte créé avec succès !")),r(""),a("")}catch(j){E(`Erreur: ${j.message}`)}},R=async()=>{try{await hb(Oi),E("Déconnexion réussie !")}catch(O){E(`Erreur lors de la déconnexion: ${O.message}`)}},P=async O=>{if(O.preventDefault(),!n){E("Vous devez être connecté pour ajouter un bateau");return}try{const j={...u,prix:parseFloat(u.prix),capacite:parseInt(u.capacite),userId:n.uid,createdAt:new Date,imageName:p?p.name:null,imagePreview:y||null};await $j(md(yo,"boats"),j),E("Bateau ajouté avec succès !"),h({nom:"",type:"voilier",prix:"",capacite:""}),g(null),_(null),N()}catch(j){E(`Erreur lors de l'ajout: ${j.message}`)}},V=O=>{const j=O.target.files[0];if(j){g(j);const f=new FileReader;f.onload=w=>{_(w.target.result)},f.readAsDataURL(j)}},B=async O=>{try{await zj(hp(yo,"boats",O)),E("Bateau supprimé avec succès !"),N()}catch(j){E(`Erreur lors de la suppression: ${j.message}`)}};return s.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Test Firebase - Nouvelle Configuration"}),s.jsxs("div",{className:"mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-orange-800",children:"🗄️ Test API MongoDB"}),s.jsx("p",{className:"text-orange-700 mb-3",children:"Testez la connexion à votre API backend MongoDB pour récupérer les données des bateaux et avis."}),s.jsx(z,{to:"/api-test",className:"inline-block bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition-colors",children:"🧪 Tester l'API MongoDB"})]}),s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3 text-blue-800",children:"🔐 Authentication"}),n?s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-blue-800",children:[s.jsx("strong",{children:"Connecté :"})," ",n.email]}),s.jsxs("p",{className:"text-sm text-blue-600",children:["UID: ",n.uid]})]}),s.jsx("button",{onClick:R,className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors",children:"Se déconnecter"})]}):s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:O=>r(O.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"password",placeholder:"Mot de passe",value:i,onChange:O=>a(O.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>k(!1),className:"flex-1 bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition-colors",children:"Créer un compte"}),s.jsx("button",{onClick:()=>k(!0),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 transition-colors",children:"Se connecter"})]})]})]}),s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3 text-green-800",children:"🗄️ Firestore Database"}),n?s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:P,className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[s.jsx("input",{type:"text",placeholder:"Nom du bateau",value:u.nom,onChange:O=>h({...u,nom:O.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),s.jsxs("select",{value:u.type,onChange:O=>h({...u,type:O.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[s.jsx("option",{value:"voilier",children:"Voilier"}),s.jsx("option",{value:"yacht",children:"Yacht"}),s.jsx("option",{value:"catamaran",children:"Catamaran"})]}),s.jsx("input",{type:"number",placeholder:"Prix/jour",value:u.prix,onChange:O=>h({...u,prix:O.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),s.jsx("input",{type:"number",placeholder:"Capacité",value:u.capacite,onChange:O=>h({...u,capacite:O.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:V,className:"hidden",id:"image-upload"}),s.jsx("div",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"📷 Ajouter une image"})]}),p&&s.jsxs("span",{className:"text-sm text-green-600",children:["✓ ",p.name]})]}),y&&s.jsxs("div",{className:"mt-3",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Aperçu de l'image :"}),s.jsx("img",{src:y,alt:"Aperçu",className:"w-32 h-32 object-cover rounded-lg border"})]})]}),s.jsx("button",{type:"submit",className:"w-full bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition-colors",children:"Ajouter le bateau"})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-medium mb-2",children:["Bateaux enregistrés (",l.length,")"]}),l.length===0?s.jsx("p",{className:"text-gray-500 text-center py-4",children:"Aucun bateau trouvé"}):s.jsx("div",{className:"space-y-2",children:l.map(O=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border",children:[s.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[O.imagePreview&&s.jsx("img",{src:O.imagePreview,alt:O.nom,className:"w-16 h-16 object-cover rounded-lg border"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:O.nom}),s.jsxs("div",{className:"text-sm text-gray-600",children:[O.type," • ",O.prix,"€/jour • ",O.capacite," personnes"]}),O.imageName&&s.jsxs("div",{className:"text-xs text-blue-600",children:["📷 ",O.imageName]})]})]}),s.jsx("button",{onClick:()=>B(O.id),className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors",children:"Supprimer"})]},O.id))})]})]}):s.jsx("p",{className:"text-green-700",children:"Connectez-vous pour gérer les bateaux"})]}),C&&s.jsx("div",{className:"mt-4 p-3 bg-blue-100 border border-blue-300 rounded-md",children:s.jsx("p",{className:"text-sm text-blue-800",children:C})}),s.jsxs("div",{className:"mt-6 text-xs text-gray-500",children:[s.jsx("p",{children:"✅ Firebase configuré avec le projet : mypictures-9dc8b"}),s.jsx("p",{children:"🔐 Authentication et Firestore activés"})]})]})}function _N(){const[n,e]=S.useState("Vérification..."),[t,r]=S.useState(0),[i,a]=S.useState(0),[l,c]=S.useState("");S.useEffect(()=>{u()},[]);const u=async()=>{try{e("🔄 Test de connexion à l'API MongoDB..."),console.log("🧪 Test 1: Récupération des bateaux...");const g=await te(se.BOATS);r(g.length||0),console.log(`✅ ${g.length||0} bateaux trouvés`),console.log("🧪 Test 2: Récupération des avis...");const y=await te(se.FIVE_STAR_REVIEWS);a(y.data?.length||0),console.log(`✅ ${y.data?.length||0} avis trouvés`),console.log("🧪 Test 3: Test de l'API de réservation...");try{const _=localStorage.getItem("token");if(_){const C=await te(se.BOOKINGS,{headers:he(_)});console.log("✅ API de réservation accessible:",C)}else console.log("⚠️ Pas de token, test de réservation ignoré")}catch(_){console.log("⚠️ API de réservation non accessible:",_.message)}console.log("🧪 Test 4: Test de l'API d'ajout de bateaux...");try{const _=localStorage.getItem("token");if(_){const C=await te(se.BOATS,{method:"GET",headers:he(_)});console.log("✅ API d'ajout de bateaux accessible:",C)}else console.log("⚠️ Pas de token, test d'ajout de bateaux ignoré")}catch(_){console.log("⚠️ API d'ajout de bateaux non accessible:",_.message)}e(`✅ API MongoDB accessible - ${g.length||0} bateaux, ${y.data?.length||0} avis`),c("")}catch(g){console.error("❌ Erreur de connexion API:",g),e(`❌ Erreur de connexion: ${g.message}`),c(g.message)}},h=()=>{u()},p=async()=>{try{e("🧪 Test d'ajout de bateau...");const g=localStorage.getItem("token");if(!g){c("Vous devez être connecté pour tester l'ajout de bateau");return}const y={nom:"Bateau Test",type:"voilier",longueur:10,prix_jour:100,capacite:4,image:"https://via.placeholder.com/300x200?text=Test",destination:"saint-malo",description:"Bateau de test",equipements:["GPS","Radio VHF"]};console.log("🧪 Test d'ajout de bateau avec:",y);const _=await te(se.BOATS,{method:"POST",headers:he(g),body:JSON.stringify(y)});console.log("✅ Test d'ajout réussi:",_),e("✅ Test d'ajout de bateau réussi !"),c("")}catch(g){console.error("❌ Test d'ajout échoué:",g),e("❌ Test d'ajout de bateau échoué"),c("Erreur lors du test: "+g.message)}};return s.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"🧪 Test de Connexion API MongoDB"}),s.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-800",children:"Statut de l'API"}),s.jsx("p",{className:"text-blue-700",children:n}),l&&s.jsx("div",{className:"mt-3 p-3 bg-red-100 border border-red-300 rounded",children:s.jsxs("p",{className:"text-red-800 text-sm",children:[s.jsx("strong",{children:"Erreur:"})," ",l]})}),s.jsxs("div",{className:"mt-3 space-x-3",children:[s.jsx("button",{onClick:h,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"🔄 Réessayer"}),s.jsx("button",{onClick:p,className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors",children:"🧪 Tester Ajout Bateau"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-green-800",children:"📊 Bateaux"}),s.jsx("p",{className:"text-3xl font-bold text-green-600",children:t}),s.jsx("p",{className:"text-green-700 text-sm",children:"bateaux trouvés dans MongoDB"})]}),s.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-purple-800",children:"⭐ Avis"}),s.jsx("p",{className:"text-3xl font-bold text-purple-600",children:i}),s.jsx("p",{className:"text-purple-700 text-sm",children:"avis 5 étoiles trouvés"})]})]}),s.jsxs("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-800",children:"🔧 Informations techniques"}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"URL de base:"})," ",se.BOATS.replace("/api/boats","")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Endpoint bateaux:"})," ",se.BOATS]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Endpoint avis:"})," ",se.FIVE_STAR_REVIEWS]})]})]})]})}function wN(){return s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"container mx-auto px-4",children:s.jsx(_N,{})})})}function jN(){return s.jsxs(Zp,{children:[s.jsx(fN,{}),s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx($n,{}),s.jsx("main",{children:s.jsxs(ef,{children:[s.jsx(Se,{path:"/",element:s.jsx(ag,{})}),s.jsx(Se,{path:"/bateaux",element:s.jsx(og,{})}),s.jsx(Se,{path:"/bateaux/:id",element:s.jsx(mg,{})}),s.jsx(Se,{path:"/reservation/:boatId",element:s.jsx(uN,{})}),s.jsx(Se,{path:"/mes-reservations",element:s.jsx(dN,{})}),s.jsx(Se,{path:"/payment",element:s.jsx(xN,{})}),s.jsx(Se,{path:"/payment/success",element:s.jsx(yN,{})}),s.jsx(Se,{path:"/payment/cancel",element:s.jsx(bN,{})}),s.jsx(Se,{path:"/a-propos",element:s.jsx(cg,{})}),s.jsx(Se,{path:"/contact",element:s.jsx(ug,{})}),s.jsx(Se,{path:"/connexion",element:s.jsx(pg,{})}),s.jsx(Se,{path:"/inscription",element:s.jsx(fg,{})}),s.jsx(Se,{path:"/favoris",element:s.jsx(gg,{})}),s.jsx(Se,{path:"/gestion-bateaux",element:s.jsx(Gj,{})}),s.jsx(Se,{path:"/gestion-reservations",element:s.jsx(mN,{})}),s.jsx(Se,{path:"/ajouter-bateau",element:s.jsx(Wj,{})}),s.jsx(Se,{path:"/admin",element:s.jsx(Kj,{})}),s.jsx(Se,{path:"/politique-confidentialite",element:s.jsx(Qj,{})}),s.jsx(Se,{path:"/profil",element:s.jsx(iN,{})}),s.jsx(Se,{path:"/cgu-cgv",element:s.jsx(aN,{})}),s.jsx(Se,{path:"/mentions-legales",element:s.jsx(oN,{})}),s.jsx(Se,{path:"/firebase-test",element:s.jsx(vN,{})}),s.jsx(Se,{path:"/api-test",element:s.jsx(wN,{})}),s.jsx(Se,{path:"*",element:s.jsx(pN,{})})]})}),s.jsx(Td,{}),s.jsx(gN,{})]})]})}rf.createRoot(document.getElementById("root")).render(s.jsx(S.StrictMode,{children:s.jsx(jN,{})}));
